```
{
  "cveId": "CVE-2020-15208",
  "description": "In tensorflow-lite before versions 1.15.4, 2.0.3, 2.1.2, 2.2.1 and 2.3.1, when determining the common dimension size of two tensors, TFLite uses a `DCHECK` which is no-op outside of debug compilation modes. Since the function always returns the dimension of the first tensor, malicious attackers can craft cases where this is larger than that of the second tensor. In turn, this would result in reads/writes outside of bounds since the interpreter will wrongly assume that there is enough data in both tensors.",
  "vulnerability": {
    "rootCause": "The vulnerability lies in the `MatchingDim` function within TensorFlow Lite (TFLite). This function, responsible for determining the common dimension size of two tensors, uses a `DCHECK` which only operates during debug compilation. In non-debug builds, this check is effectively bypassed. The function also always returns the dimension size of the first tensor, leading to potential dimension mismatches if the second tensor has a smaller dimension, allowing out-of-bounds reads and writes.",
    "weaknesses": [
      "The primary weakness is the insufficient validation of tensor dimensions. The reliance on a debug-only check (`DCHECK`) allows the program to proceed with mismatched dimensions in release builds.",
      "The function `MatchingDim` naively returns the first tensor’s dimension, even if the dimensions do not match. This lack of proper handling for mismatched dimensions is a core issue."
    ],
    "impact": "The impact of this vulnerability is that a maliciously crafted TFLite model can cause out-of-bounds read/write operations. This can result in data corruption, potentially leading to crashes, arbitrary code execution, or other forms of unexpected behavior.",
    "attackVectors": [
        "An attacker can craft a malicious TFLite model where, during the processing of an operator, the `MatchingDim` function is called. By crafting the tensor dimensions within this model, an attacker can cause the function to return a dimension from the first tensor that is larger than that of the second tensor. This causes subsequent reads/writes to go outside of the second tensor's bounds, leading to a security vulnerability.",
        "Exploitation of this vulnerability is achieved by providing the crafted TFLite model to an application or system using the affected version of TFLite, thereby triggering the vulnerability during model processing."
    ],
    "requiredCapabilities": "An attacker would require the ability to create a custom TFLite model and pass it to a system or application using a vulnerable version of TensorFlow-Lite. No special system access is required beyond this model input.",
    "additionalDetails": [
        "The vulnerability is located in the file `tensorflow/lite/kernels/internal/types.h`, specifically within the `MatchingDim` function. The vulnerable code can be found in the commit [8ee24e7](https://github.com/tensorflow/tensorflow/commit/8ee24e7949a203d234489f9da2c5bf45a7d5157d), which also includes the fix by returning the minimum dimension value instead of just the first tensor’s dimension.",
        "The patch for this vulnerability modifies the `MatchingDim` function to return the minimum of the two dimensions rather than relying on the first, thereby preventing out-of-bounds memory access due to dimension mismatch."

        ]
  }
}
```