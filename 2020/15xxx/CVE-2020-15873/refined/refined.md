Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from a lack of proper input sanitization in the `customoid.inc.php` file, specifically within the `device_id` POST parameter. This allows for the injection of malicious SQL queries.

**Weaknesses/Vulnerabilities Present:**

*   **Blind SQL Injection:** The primary weakness is a blind SQL injection vulnerability. This means the attacker doesn't see the direct output of the query, but they can infer information based on the server's response time (e.g., using `sleep()` function in the injected SQL).

**Impact of Exploitation:**

*   **Data Exfiltration:** An attacker can potentially extract complete database information. The provided proof-of-concept (PoC) demonstrates how to extract the database version, which is an example of the broader capability.
*   **Arbitrary Data Access:**  The SQL injection allows an attacker to access and potentially manipulate arbitrary data stored in the database.

**Attack Vectors:**

*   **HTTP POST Request:** The vulnerability is triggered by sending a crafted HTTP POST request to the `ajax_form.php` endpoint, with `action` parameter set to `test` and `type` to `customoid`.
*   **`device_id` POST Parameter:** The malicious SQL code is injected via the `device_id` parameter.

**Required Attacker Capabilities/Position:**

*   **Authentication:** The attacker must be an authenticated user on the LibreNMS platform to exploit the vulnerability.
*   **Network Access:** The attacker needs network access to the LibreNMS instance.

**Technical Details:**

*   The vulnerable code is located in `includes/html/forms/customoid.inc.php`.
*   The fix involves replacing the direct variable insertion in the SQL query with parameterized queries, using placeholders and binding variables instead of direct string concatenation.
    *   Original (Vulnerable): `$query = "SELECT * FROM \`devices\` WHERE \`device_id\` = $device_id LIMIT 1";`
    *   Fixed: `$query = "SELECT * FROM \`devices\` WHERE \`device_id\` = ? LIMIT 1"; $device = dbFetchRow($query, [$device_id]);`
* The provided python PoC script demonstrates how to exploit this vulnerability:
    * It sends a crafted POST request to `/ajax_form.php`
    * It uses a time-based method (`sleep()`) to infer information from the server.
    * It performs a character-by-character extraction of the database version.

**Additional Notes:**

*   The vulnerability was reported by Loginsoft.
*   The fix was implemented in commit `8f3a29cde5bbd8608f9b42923a7d7e2598bcac4e` and included in version 1.65.1.
*   The issue is labeled with "Security" and "WebUI", indicating that it is a security flaw affecting the web user interface.