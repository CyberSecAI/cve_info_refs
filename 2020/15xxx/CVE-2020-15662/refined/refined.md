Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2020-15662:

**Root Cause of Vulnerability:**

The vulnerability arises from the fact that the `DownloadHelper.js` script, responsible for handling downloads, was injected at the `AtDocumentEnd` timing in the WKWebView lifecycle of Firefox for iOS. This allowed malicious web content to define a rogue download handler (`window.__firefox__.download`) during the `Load web document` stage. Because the handler was defined as an immutable object, the legitimate download handler set by `DownloadHelper.js` was rejected, effectively allowing the attacker's handler to take over.

**Weaknesses/Vulnerabilities Present:**

*   **Insecure JS Injection Timing:** The `DownloadHelper.js` script was injected too late in the page loading process, making it susceptible to being overridden by malicious scripts that execute earlier.
*   **Lack of Immutable Handler Definition:** The legitimate download handler was not defined in a way that prevents malicious scripts from overriding it.
*   **Cross-Origin Information Leakage:**  The rogue download handler could access the URL that the victim was trying to download, even if it was from a different origin.
*   **Potential for Security Token Leakage:** The vulnerability could be exploited to leak a security token used by Firefox for iOS to verify privileged JS bridge calls, potentially allowing an attacker to disable Tracking Protection.

**Impact of Exploitation:**

*   **Downloading Unintended Files:** An attacker could trick a user into downloading a file different from what the user intended.
*   **Cross-Origin Data Leakage:** Attackers could leak information about resources from other domains that the user is trying to download.
*   **Security Token Leakage:**  Attackers could obtain a security token and potentially abuse it to disable browser features like Tracking Protection.

**Attack Vectors:**

*   **Malicious Web Pages:** Attackers can host malicious web pages designed to inject the rogue download handler.
*   **Iframe Injection:** Malicious code in an iframe could override the download handler of a parent page, leading to attacks if a user tries to download something from the iframe.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to host or inject a malicious web page into a victim's browser.
*   The attacker does not need to have any special privileges or access to the user's device.
*   The attacker leverages the page load lifecycle to inject the malicious handler before the legitimate handler is set.

**Additional Notes:**

*   The vulnerability was reported by Muneaki Nishimura.
*   The fix involved ensuring the legitimate download handler is set at the `AtDocumentStart` stage and using a different technique to verify security tokens.
*   The issue was fixed in Firefox for iOS version 28.
*   The vulnerability was rated as "high" impact.