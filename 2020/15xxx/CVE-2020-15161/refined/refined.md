Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2020-15161

**Root Cause of Vulnerability:**
The vulnerability stems from the improper handling of user-supplied data within the contact form of PrestaShop. Specifically, the application was using `htmlentitiesDecodeUTF8` in email templates which decodes HTML entities, which can result in injected JavaScript code being executed when the email is viewed by a user.

**Weaknesses/Vulnerabilities Present:**
- **Cross-Site Scripting (XSS):** The primary vulnerability is a potential Stored XSS injection. An attacker can inject malicious JavaScript code through the contact form, and this code can later be executed in the context of other users when they view the affected data, primarily via email.

**Impact of Exploitation:**
- **JavaScript execution:** Successful exploitation would allow an attacker to execute arbitrary JavaScript code in the context of other users' browsers.
- **Potential Actions:** This could potentially allow the attacker to:
    - Steal sensitive information (e.g., cookies, session tokens).
    - Modify content on the page.
    - Redirect users to malicious websites.
    - Perform actions on behalf of the victim.
- **Impact on Users:** This impacts both the shop's administrators and customers by allowing execution of malicious code within the email client or back office, when viewing the contact form submission details.

**Attack Vectors:**
- **Contact Form:** The attacker exploits the contact form provided by the PrestaShop platform to inject malicious script through the message field, or potentially via other form fields as well.
- **Email rendering:** The injected script is activated when the email with the injected content is viewed.

**Required Attacker Capabilities/Position:**
- **No special privileges are required:** An attacker doesn't require any specific privileges or administrator access to exploit this vulnerability. It can be achieved by simply submitting a carefully crafted message via the contact form.
- **Access to the Contact Form:** The attacker needs to be able to access the contact form interface on a vulnerable PrestaShop instance.
- **Knowledge of XSS:** The attacker needs to have knowledge of crafting XSS payloads to inject the malicious JavaScript.

**Additional Notes from the provided content:**

- The vulnerability is classified as "Low" severity.
- The issue is fixed in PrestaShop version 1.7.6.8.
- The provided commit diff shows that `htmlentitiesDecodeUTF8` was removed in several places and replaced with `Tools::htmlentitiesUTF8` or `stripslashes`, to prevent the decoding of HTML entities within the email templates and admin panel output.
- The commit includes changes in `Mail.php`, `AdminCustomerThreadsController.php`, `AdminOrdersController.php`, and `OrderDetailController.php`.