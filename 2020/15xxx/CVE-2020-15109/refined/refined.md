Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2020-15109

**Root Cause:** The vulnerability stems from how Solidus (an e-commerce platform) structures permitted attributes during the checkout process. It uses a single list of permitted attributes across the entire checkout flow, regardless of the specific step being submitted (e.g., address, delivery, payment).

**Weaknesses/Vulnerabilities:**
*   **Inconsistent attribute validation:** The system does not properly validate attributes based on the checkout step, allowing attributes intended for one step to be used in another.
*   **Lack of step-specific attribute restrictions:** The application allows address information to be modified even in later checkout steps like payment, bypassing validations that should occur earlier.
*   **Inadequate enforcement of shipping zone restrictions:**  The system relies on shipping methods to filter out unwanted zones, but this can be circumvented.

**Impact of Exploitation:**
*   **Shipping cost manipulation:** Attackers can manipulate shipping costs by initially selecting a cheaper shipping zone during the address step and then changing the address to a more expensive zone in a later step (e.g., during the payment step), all while keeping the cheaper shipping cost.
*   **Bypass shipping restrictions:** Attackers can bypass shipping restrictions by initially entering an address in an allowed zone and then changing it to an address in a disallowed zone, potentially receiving goods at a location where they shouldn't.

**Attack Vectors:**
*   **Crafted HTTP requests:** Attackers can craft malicious HTTP requests with modified `ship_address_attributes` to change the shipping address during a later checkout step (e.g., payment) while retaining previously determined shipping costs.
*   **Direct manipulation of request parameters:** Attackers manipulate the order parameters sent during checkout.

**Required Attacker Capabilities/Position:**
*   **Authenticated user:** The attacker needs to be a customer of the online store.
*   **Knowledge of store configuration:** The attacker benefits from understanding how the store is configured with shipping zones and their associated costs.
*   **Ability to intercept and modify requests:** The attacker must be able to intercept or craft HTTP requests to modify the `order` parameters.

**Additional Notes:**
*   The provided gist (`security_2020-07-15.rb`) contains a workaround for the vulnerability, by patching the permitted attributes for each step.
*   The vulnerability affects stores using Solidus, particularly those with multiple shipping zones with differing costs.

This is a good explanation of the vulnerability and how it can be exploited.