=== Content from bugzilla.mozilla.org_d3b54c50_20250119_115842.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1656957)
* [XML](/show_bug.cgi?ctype=xml&id=1656957)

Closed
[Bug 1656957](/show_bug.cgi?id=1656957)
(CVE-2020-15669)

Opened 4 years ago
Closed 4 years ago

# AddressSanitizer: heap-use-after-free /builds/worker/workspace/obj-build/dist/include/nsTArray.h:413:37 in Length

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

AddressSanitizer: heap-use-after-free /builds/worker/workspace/obj-build/dist/include/nsTArray.h:413:37 in Length

## Categories

### (Core :: DOM: Core & HTML, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML#DOM%3A%20Core%20%26%20HTML)

DOM: Core & HTML
▾

Core :: DOM: Core & HTML
Issues in DOM tree [https://dom.spec.whatwg.org](https://dom.spec.whatwg.org/) & HTML [https://html.spec.whatwg.org](https://html.spec.whatwg.org/) that do not fit into any other DOM or HTML component or which span multiple DOM or HTML components.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

81 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | [80+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=80%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=verified) |
| firefox-esr78 | [80+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=80%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=verified) |
| firefox79 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=wontfix) |
| firefox80 | [+](/buglist.cgi?f1=cf_tracking_firefox80&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=verified) |
| firefox81 | --- | [verified](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr68 | 80+ | verified |
| firefox-esr78 | 80+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox79 |  | wontfix |
| firefox80 | + | verified |
| firefox81 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jkratzer, Assigned: sg)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/7c2ab46d52baf496dec7a3c0eeaa4a3e?d=mm&size=40)  [sg](/user_profile?user_id=642231)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/5c25f7e70acfdf0e73a58871a52f95b2?d=mm&size=40)  [jkratzer](/user_profile?user_id=586683)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/b89a42ca4c4d59c27f33c399bb1ecc7b?d=mm&size=40)  [farre](/user_profile?user_id=566192)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[domino](/show_bug.cgi?id=1340565 "NEW - [meta] (domino) Bugs found while fuzzing with domino"), [1660954](/show_bug.cgi?id=1660954 "RESOLVED FIXED - AbortSignal instance must be pinned in AbortSignal::Abort rather than AbortSignalImpl::Abort")

Dependency [tree](/showdependencytree.cgi?id=1656957&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1656957)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [bugmon:],bisected,confirmed,[adv-main80+r][adv-esr68.12+r][adv-esr78.2+r][sec-survey])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-15669

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[bugmon:],bisected,confirmed,[adv-main80+r][adv-esr68.12+r][adv-esr78.2+r][sec-survey]

QA Whiteboard:

[post-critsmash-triage] [qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [jkratzer](/user_profile?user_id=586683) | [in-testsuite](#c0 "4 years ago") | ? |
| --- | --- | --- |
| [jkratzer](/user_profile?user_id=586683) | in-testsuite | ? |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [testcase.html](/attachment.cgi?id=9167723)  [4 years ago](#c0)  [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)   1.41 KB, text/html |  | [Details](/attachment.cgi?id=9167723&action=edit) |
| --- | --- | --- |
| [Bug 1656957 - Pin AbortSignalImpl instance while signaling followers. r=baku](/attachment.cgi?id=9168158)  [4 years ago](#c10)  [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c15 "4 years ago")  RyanVM : [approval-mozilla-esr68+](#c15 "4 years ago")  RyanVM : [approval-mozilla-esr78+](#c15 "4 years ago")  tjr : [sec-approval+](#c12 "4 years ago") | [Details](/attachment.cgi?id=9168158&action=edit) | [Review](/attachment.cgi?id=9168158) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1656957#c0)• 4 years ago |
|  | |

Attached file
[testcase.html](attachment.cgi?id=9167723)
— [Details](attachment.cgi?id=9167723&action=edit)

Testcase found while fuzzing mozilla-central rev 84b257d07031 (built with --enable-fuzzing). Testcase must be served over HTTP in order to reproduce.

```
==26094==ERROR: AddressSanitizer: heap-use-after-free on address 0x60f0000617f0 at pc 0x7f82d6863c37 bp 0x7ffd199d96b0 sp 0x7ffd199d96a8
READ of size 8 at 0x60f0000617f0 thread T0 (file:// Content)
    #0 0x7f82d6863c36 in Length /builds/worker/workspace/obj-build/dist/include/nsTArray.h:413:37
    #1 0x7f82d6863c36 in Length /builds/worker/workspace/obj-build/dist/include/nsTObserverArray.h:88:44
    #2 0x7f82d6863c36 in HasMore /builds/worker/workspace/obj-build/dist/include/nsTObserverArray.h:326:55
    #3 0x7f82d6863c36 in nsAutoTObserverArray<mozilla::dom::AbortFollower*, 0ul>::STLIterator<nsAutoTObserverArray<mozilla::dom::AbortFollower*, 0ul>::ForwardIterator, mozilla::dom::AbortFollower*>::operator++() /builds/worker/workspace/obj-build/dist/include/nsTObserverArray.h:435:28
    #4 0x7f82d6863a34 in mozilla::dom::AbortSignalImpl::Abort() /builds/worker/checkouts/gecko/dom/abort/AbortSignal.cpp:30:32
    #5 0x7f82d68634d8 in mozilla::dom::AbortSignal::Abort() /builds/worker/checkouts/gecko/dom/abort/AbortSignal.cpp:77:20
    #6 0x7f82d6863a2c in mozilla::dom::AbortSignalImpl::Abort() /builds/worker/checkouts/gecko/dom/abort/AbortSignal.cpp:31:15
    #7 0x7f82d68634d8 in mozilla::dom::AbortSignal::Abort() /builds/worker/checkouts/gecko/dom/abort/AbortSignal.cpp:77:20
    #8 0x7f82d6f82b74 in mozilla::dom::AbortController_Binding::abort(JSContext*, JS::Handle<JSObject*>, void*, JSJitMethodCallArgs const&) /builds/worker/workspace/obj-build/dom/bindings/AbortControllerBinding.cpp:72:24
    #9 0x7f82d89638b8 in bool mozilla::dom::binding_detail::GenericMethod<mozilla::dom::binding_detail::NormalThisPolicy, mozilla::dom::binding_detail::ThrowExceptions>(JSContext*, unsigned int, JS::Value*) /builds/worker/checkouts/gecko/dom/bindings/BindingUtils.cpp:3221:13
    #10 0x7f82df0e4f0b in CallJSNative /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:487:13
    #11 0x7f82df0e4f0b in js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:579:12
    #12 0x7f82df0e71a8 in InternalCall(JSContext*, js::AnyInvokeArgs const&, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:642:10
    #13 0x7f82df0cd77f in CallFromStack /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:646:10
    #14 0x7f82df0cd77f in Interpret(JSContext*, js::RunState&) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:3314:16
    #15 0x7f82df0b0761 in js::RunScript(JSContext*, js::RunState&) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:459:10
    #16 0x7f82df0e4fed in js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:614:13
    #17 0x7f82df0e71a8 in InternalCall(JSContext*, js::AnyInvokeArgs const&, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:642:10
    #18 0x7f82df0e7486 in js::Call(JSContext*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, js::AnyInvokeArgs const&, JS::MutableHandle<JS::Value>, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:659:8
    #19 0x7f82df45fe30 in js::PromiseObject::create(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, bool) /builds/worker/checkouts/gecko/js/src/builtin/Promise.cpp:2444:15
    #20 0x7f82df4a6b4f in PromiseConstructor(JSContext*, unsigned int, JS::Value*) /builds/worker/checkouts/gecko/js/src/builtin/Promise.cpp:2365:7
    #21 0x7f82df0e7dc0 in CallJSNative /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:487:13
    #22 0x7f82df0e7dc0 in CallJSNativeConstructor /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:503:8
    #23 0x7f82df0e7dc0 in InternalConstruct(JSContext*, js::AnyConstructArgs const&) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:686:14
    #24 0x7f82df0e7714 in js::ConstructFromStack(JSContext*, JS::CallArgs const&) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:732:10
    #25 0x7f82df0bacf2 in Interpret(JSContext*, js::RunState&) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:3304:16
    #26 0x7f82df0b0761 in js::RunScript(JSContext*, js::RunState&) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:459:10
    #27 0x7f82df0e4fed in js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:614:13
    #28 0x7f82df0e71a8 in InternalCall(JSContext*, js::AnyInvokeArgs const&, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:642:10
    #29 0x7f82df0e7486 in js::Call(JSContext*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, js::AnyInvokeArgs const&, JS::MutableHandle<JS::Value>, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:659:8
    #30 0x7f82df286be0 in JS::Call(JSContext*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, JS::HandleValueArray const&, JS::MutableHandle<JS::Value>) /builds/worker/checkouts/gecko/js/src/jsapi.cpp:2831:10
    #31 0x7f82d86153bf in mozilla::dom::Function::Call(mozilla::dom::BindingCallContext&, JS::Handle<JS::Value>, nsTArray<JS::Value> const&, JS::MutableHandle<JS::Value>, mozilla::ErrorResult&) /builds/worker/workspace/obj-build/dom/bindings/FunctionBinding.cpp:43:8
    #32 0x7f82d6d7f887 in void mozilla::dom::Function::Call<nsCOMPtr<nsIGlobalObject> >(nsCOMPtr<nsIGlobalObject> const&, nsTArray<JS::Value> const&, JS::MutableHandle<JS::Value>, mozilla::ErrorResult&, char const*, mozilla::dom::CallbackObject::ExceptionHandling, JS::Realm*) /builds/worker/workspace/obj-build/dist/include/mozilla/dom/FunctionBinding.h:73:12
    #33 0x7f82d6d7f4e8 in mozilla::dom::CallbackTimeoutHandler::Call(char const*) /builds/worker/checkouts/gecko/dom/base/TimeoutHandler.cpp:167:29
    #34 0x7f82d69b9f1f in nsGlobalWindowInner::RunTimeoutHandler(mozilla::dom::Timeout*, nsIScriptContext*) /builds/worker/checkouts/gecko/dom/base/nsGlobalWindowInner.cpp:6024:38
    #35 0x7f82d6d7abbe in mozilla::dom::TimeoutManager::RunTimeout(mozilla::TimeStamp const&, mozilla::TimeStamp const&, bool) /builds/worker/checkouts/gecko/dom/base/TimeoutManager.cpp:911:44
    #36 0x7f82d6d7950f in mozilla::dom::TimeoutExecutor::MaybeExecute() /builds/worker/checkouts/gecko/dom/base/TimeoutExecutor.cpp:179:11
    #37 0x7f82d6d7d0eb in mozilla::dom::TimeoutExecutor::Run() /builds/worker/checkouts/gecko/dom/base/TimeoutExecutor.cpp:234:5
    #38 0x7f82d2ca828e in mozilla::ThrottledEventQueue::Inner::ExecuteRunnable() /builds/worker/checkouts/gecko/xpcom/threads/ThrottledEventQueue.cpp:254:22
    #39 0x7f82d2c9c48f in mozilla::ThrottledEventQueue::Inner::Executor::Run() /builds/worker/checkouts/gecko/xpcom/threads/ThrottledEventQueue.cpp:81:15
    #40 0x7f82d2c4e0b9 in mozilla::RunnableTask::Run() /builds/worker/checkouts/gecko/xpcom/threads/TaskController.cpp:242:16
    #41 0x7f82d2c4a5a5 in mozilla::TaskController::DoExecuteNextTaskOnlyMainThreadInternal(mozilla::detail::BaseAutoLock<mozilla::Mutex&> const&) /builds/worker/checkouts/gecko/xpcom/threads/TaskController.cpp:512:26
    #42 0x7f82d2c48462 in mozilla::TaskController::ExecuteNextTaskOnlyMainThreadInternal(mozilla::detail::BaseAutoLock<mozilla::Mutex&> const&) /builds/worker/checkouts/gecko/xpcom/threads/TaskController.cpp:371:15
    #43 0x7f82d2c4889f in mozilla::TaskController::ProcessPendingMTTask(bool) /builds/worker/checkouts/gecko/xpcom/threads/TaskController.cpp:168:36
    #44 0x7f82d2c59ec1 in operator() /builds/worker/checkouts/gecko/xpcom/threads/TaskController.cpp:83:37
    #45 0x7f82d2c59ec1 in mozilla::detail::RunnableFunction<mozilla::TaskController::InitializeInternal()::$_4>::Run() /builds/worker/workspace/obj-build/dist/include/nsThreadUtils.h:577:5
    #46 0x7f82d2c7ef7c in nsThread::ProcessNextEvent(bool, bool*) /builds/worker/checkouts/gecko/xpcom/threads/nsThread.cpp:1234:14
    #47 0x7f82d2c89e6c in NS_ProcessNextEvent(nsIThread*, bool) /builds/worker/checkouts/gecko/xpcom/threads/nsThreadUtils.cpp:513:10
    #48 0x7f82d404a63f in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) /builds/worker/checkouts/gecko/ipc/glue/MessagePump.cpp:87:21
    #49 0x7f82d3f2b0e7 in RunInternal /builds/worker/checkouts/gecko/ipc/chromium/src/base/message_loop.cc:334:10
    #50 0x7f82d3f2b0e7 in RunHandler /builds/worker/checkouts/gecko/ipc/chromium/src/base/message_loop.cc:327:3
    #51 0x7f82d3f2b0e7 in MessageLoop::Run() /builds/worker/checkouts/gecko/ipc/chromium/src/base/message_loop.cc:309:3
    #52 0x7f82db288c48 in nsBaseAppShell::Run() /builds/worker/checkouts/gecko/widget/nsBaseAppShell.cpp:137:27
    #53 0x7f82dee72516 in XRE_RunAppShell() /builds/worker/checkouts/gecko/toolkit/xre/nsEmbedFunctions.cpp:913:20
    #54 0x7f82d3f2b0e7 in RunInternal /builds/worker/checkouts/gecko/ipc/chromium/src/base/message_loop.cc:334:10
    #55 0x7f82d3f2b0e7 in RunHandler /builds/worker/checkouts/gecko/ipc/chromium/src/base/message_loop.cc:327:3
    #56 0x7f82d3f2b0e7 in MessageLoop::Run() /builds/worker/checkouts/gecko/ipc/chromium/src/base/message_loop.cc:309:3
    #57 0x7f82dee71aff in XRE_InitChildProcess(int, char**, XREChildData const*) /builds/worker/checkouts/gecko/toolkit/xre/nsEmbedFunctions.cpp:744:34
    #58 0x5587981768b3 in content_process_main /builds/worker/checkouts/gecko/browser/app/../../ipc/contentproc/plugin-container.cpp:56:28
    #59 0x5587981768b3 in main /builds/worker/checkouts/gecko/browser/app/nsBrowserApp.cpp:303:18
    #60 0x7f82f6d61b96 in __libc_start_main /build/glibc-2ORdQG/glibc-2.27/csu/../csu/libc-start.c:310

0x60f0000617f0 is located 160 bytes inside of 176-byte region [0x60f000061750,0x60f000061800)
freed by thread T0 (file:// Content) here:
    #0 0x55879814394d in free /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:123:3
    #1 0x7f82d2abec82 in SnowWhiteKiller::~SnowWhiteKiller() /builds/worker/checkouts/gecko/xpcom/base/nsCycleCollector.cpp:2419:7
    #2 0x7f82d2abe0d8 in nsCycleCollector::FreeSnowWhite(bool) /builds/worker/checkouts/gecko/xpcom/base/nsCycleCollector.cpp:2607:3
    #3 0x7f82d2ac59bd in nsCycleCollector::BeginCollection(ccType, nsICycleCollectorListener*) /builds/worker/checkouts/gecko/xpcom/base/nsCycleCollector.cpp:3580:3
    #4 0x7f82d2ac51cc in nsCycleCollector::Collect(ccType, js::SliceBudget&, nsICycleCollectorListener*, bool) /builds/worker/checkouts/gecko/xpcom/base/nsCycleCollector.cpp:3409:9
    #5 0x7f82d2ac859e in nsCycleCollector_collect(nsICycleCollectorListener*) /builds/worker/checkouts/gecko/xpcom/base/nsCycleCollector.cpp:3907:28
    #6 0x7f82d6ea4474 in nsJSContext::CycleCollectNow(nsICycleCollectorListener*) /builds/worker/checkouts/gecko/dom/base/nsJSEnvironment.cpp:1533:3
    #7 0x7f82d866dd71 in mozilla::dom::FuzzingFunctions_Binding::cycleCollect(JSContext*, unsigned int, JS::Value*) /builds/worker/workspace/obj-build/dom/bindings/FuzzingFunctionsBinding.cpp:68:3
    #8 0x7f82df0e4f0b in CallJSNative /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:487:13
    #9 0x7f82df0e4f0b in js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:579:12
    #10 0x7f82df0e71a8 in InternalCall(JSContext*, js::AnyInvokeArgs const&, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:642:10
    #11 0x7f82df0cd77f in CallFromStack /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:646:10
    #12 0x7f82df0cd77f in Interpret(JSContext*, js::RunState&) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:3314:16
    #13 0x7f82df0b0761 in js::RunScript(JSContext*, js::RunState&) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:459:10
    #14 0x7f82df0e4fed in js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:614:13
    #15 0x7f82df0e71a8 in InternalCall(JSContext*, js::AnyInvokeArgs const&, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:642:10
    #16 0x7f82df0e7486 in js::Call(JSContext*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, js::AnyInvokeArgs const&, JS::MutableHandle<JS::Value>, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:659:8
    #17 0x7f82df45fe30 in js::PromiseObject::create(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, bool) /builds/worker/checkouts/gecko/js/src/builtin/Promise.cpp:2444:15
    #18 0x7f82df4a6b4f in PromiseConstructor(JSContext*, unsigned int, JS::Value*) /builds/worker/checkouts/gecko/js/src/builtin/Promise.cpp:2365:7
    #19 0x7f82df0e7dc0 in CallJSNative /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:487:13
    #20 0x7f82df0e7dc0 in CallJSNativeConstructor /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:503:8
    #21 0x7f82df0e7dc0 in InternalConstruct(JSContext*, js::AnyConstructArgs const&) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:686:14
    #22 0x7f82df0e7714 in js::ConstructFromStack(JSContext*, JS::CallArgs const&) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:732:10
    #23 0x7f82df0bacf2 in Interpret(JSContext*, js::RunState&) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:3304:16

previously allocated by thread T0 (file:// Content) here:
    #0 0x558798143bcd in malloc /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:145:3
    #1 0x558798179cbd in moz_xmalloc /builds/worker/checkouts/gecko/memory/mozalloc/mozalloc.cpp:52:15
    #2 0x7f82d916ab89 in operator new /builds/worker/workspace/obj-build/dist/include/mozilla/cxxalloc.h:33:10
    #3 0x7f82d916ab89 in mozilla::dom::Request::Request(nsIGlobalObject*, mozilla::SafeRefPtr<mozilla::dom::InternalRequest>, mozilla::dom::AbortSignal*) /builds/worker/checkouts/gecko/dom/fetch/Request.cpp:67:15
    #4 0x7f82d91724d6 in mozilla::SafeRefPtr<mozilla::dom::Request> mozilla::MakeSafeRefPtr<mozilla::dom::Request, nsIGlobalObject*&, mozilla::SafeRefPtr<mozilla::dom::InternalRequest>, RefPtr<mozilla::dom::AbortSignal>&>(nsIGlobalObject*&, mozilla::SafeRefPtr<mozilla::dom::InternalRequest>&&, RefPtr<mozilla::dom::AbortSignal>&) /builds/worker/workspace/obj-build/dist/include/mozilla/dom/SafeRefPtr.h:382:25
    #5 0x7f82d916f30d in mozilla::dom::Request::Constructor(nsIGlobalObject*, JSContext*, mozilla::dom::RequestOrUSVString const&, mozilla::dom::RequestInit const&, mozilla::ErrorResult&) /builds/worker/checkouts/gecko/dom/fetch/Request.cpp:609:7
    #6 0x7f82d913d412 in mozilla::dom::Request::Constructor(mozilla::dom::GlobalObject const&, mozilla::dom::RequestOrUSVString const&, mozilla::dom::RequestInit const&, mozilla::ErrorResult&) /builds/worker/checkouts/gecko/dom/fetch/Request.cpp:268:10
    #7 0x7f82d913b73d in mozilla::dom::FetchRequest(nsIGlobalObject*, mozilla::dom::RequestOrUSVString const&, mozilla::dom::RequestInit const&, mozilla::dom::CallerType, mozilla::ErrorResult&) /builds/worker/checkouts/gecko/dom/fetch/Fetch.cpp:454:7
    #8 0x7f82d8143ffd in fetch /builds/worker/workspace/obj-build/dom/bindings/WindowBinding.cpp:19041:60
    #9 0x7f82d8143ffd in mozilla::dom::Window_Binding::fetch_promiseWrapper(JSContext*, JS::Handle<JSObject*>, void*, JSJitMethodCallArgs const&) /builds/worker/workspace/obj-build/dom/bindings/WindowBinding.cpp:19057:13
    #10 0x7f82d8967b82 in bool mozilla::dom::binding_detail::GenericMethod<mozilla::dom::binding_detail::MaybeCrossOriginObjectThisPolicy, mozilla::dom::binding_detail::ConvertExceptionsToPromises>(JSContext*, unsigned int, JS::Value*) /builds/worker/checkouts/gecko/dom/bindings/BindingUtils.cpp:3221:13
    #11 0x7f82df0e4f0b in CallJSNative /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:487:13
    #12 0x7f82df0e4f0b in js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:579:12
    #13 0x7f82df0e71a8 in InternalCall(JSContext*, js::AnyInvokeArgs const&, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:642:10
    #14 0x7f82df0cd77f in CallFromStack /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:646:10
    #15 0x7f82df0cd77f in Interpret(JSContext*, js::RunState&) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:3314:16
    #16 0x7f82df0b0761 in js::RunScript(JSContext*, js::RunState&) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:459:10
    #17 0x7f82df0e4fed in js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:614:13
    #18 0x7f82df0e71a8 in InternalCall(JSContext*, js::AnyInvokeArgs const&, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:642:10
    #19 0x7f82df0e7486 in js::Call(JSContext*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, js::AnyInvokeArgs const&, JS::MutableHandle<JS::Value>, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:659:8
    #20 0x7f82df742e30 in js::CallSelfHostedFunction(JSContext*, JS::Handle<js::PropertyName*>, JS::Handle<JS::Value>, js::AnyInvokeArgs const&, JS::MutableHandle<JS::Value>) /builds/worker/checkouts/gecko/js/src/vm/SelfHosting.cpp:1719:10
    #21 0x7f82df36779c in AsyncFunctionResume(JSContext*, JS::Handle<js::AsyncFunctionGeneratorObject*>, ResumeKind, JS::Handle<JS::Value>) /builds/worker/checkouts/gecko/js/src/vm/AsyncFunction.cpp:128:8
    #22 0x7f82df4b0d61 in AsyncFunctionPromiseReactionJob /builds/worker/checkouts/gecko/js/src/builtin/Promise.cpp:1700:10
    #23 0x7f82df4b0d61 in PromiseReactionJob(JSContext*, unsigned int, JS::Value*) /builds/worker/checkouts/gecko/js/src/builtin/Promise.cpp:1852:12
    #24 0x7f82df0e4f0b in CallJSNative /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:487:13
    #25 0x7f82df0e4f0b in js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason) /builds/worker/checkouts/gecko/js/src/vm/Interpreter.cpp:579:12

SUMMARY: AddressSanitizer: heap-use-after-free /builds/worker/workspace/obj-build/dist/include/nsTArray.h:413:37 in Length
Shadow bytes around the buggy address:
  0x0c1e800042a0: fd fd fd fd fd fd fa fa fa fa fa fa fa fa 00 00
  0x0c1e800042b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c1e800042c0: 00 00 00 00 fa fa fa fa fa fa fa fa fd fd fd fd
  0x0c1e800042d0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c1e800042e0: fd fa fa fa fa fa fa fa fa fa fd fd fd fd fd fd
=>0x0c1e800042f0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd[fd]fd
  0x0c1e80004300: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
  0x0c1e80004310: fd fd fd fd fd fd fd fd fd fd fd fd fd fa fa fa
  0x0c1e80004320: fa fa fa fa fa fa 00 00 00 00 00 00 00 00 00 00
  0x0c1e80004330: 00 00 00 00 00 00 00 00 00 00 04 fa fa fa fa fa
  0x0c1e80004340: fa fa fa fa fd fd fd fd fd fd fd fd fd fd fd fd
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==26094==ABORTING

```
Flags: in-testsuite?

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1656957#c1)• 4 years ago |
|  | |

(Assuming this was meant to be filed as security)

Group: core-security

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1656957#a19463_75935)• 4 years ago |

Group: core-security → dom-core-security

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1656957#c2)• 4 years ago |
|  | |

I see that something changed recently around [`ForwardIterator`](https://searchfox.org/mozilla-central/rev/72a1334982cadde0ca8b3d3583877afea80f5639/xpcom/ds/nsTObserverArray.h#475-478), maybe related?

Flags: needinfo?(sgiesecke)

|  | [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1656957#c3)• 4 years ago |
|  | |

There was a change in the implementation of `AbortSignalImpl::Abort` regarding the iteration, but AFAIU this is not related to this issue. The UAF does not happen when accessing an array element, but the array (length) itself. It seems that the `AbortSignalImpl` is being destroyed (and deallocated) during the iteration, which destroys the whole `mFollowers` array.

Maybe we need to add `RefPtr pinThis = this;` in the `AbortSignalImpl::Abort`?

Jason, can we get a regression window?

Flags: needinfo?(sgiesecke) → needinfo?(jkratzer)

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1656957#a73281_586683)• 4 years ago |

Keywords: [bugmon](/buglist.cgi?keywords=bugmon&resolution=---)Whiteboard: [bugmon:confirm] → [bugmon:confirmed]

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1656957#c4)• 4 years ago |
|  | |

Bugmon Analysis:
Unable to reproduce bug using the following builds:
> mozilla-central 20200804091327-7cb90fa4f485
> mozilla-central 20200803033015-f6a3b097f8af
Removing bugmon keyword as no further action possible.
Please review the bug and re-add the keyword for further analysis.

|  | [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1656957#c5)• 4 years ago |
|  | |

(In reply to Jason Kratzer [:jkratzer] from [comment #4](/show_bug.cgi?id=1656957#c4 "VERIFIED FIXED - AddressSanitizer: heap-use-after-free /builds/worker/workspace/obj-build/dist/include/nsTArray.h:413:37 in Length"))

> Bugmon Analysis:
>
> Unable to reproduce bug using the following builds:
>
> > mozilla-central 20200804091327-7cb90fa4f485
> >
> > mozilla-central 20200803033015-f6a3b097f8af
> >
> > Removing bugmon keyword as no further action possible.
> >
> > Please review the bug and re-add the keyword for further analysis.

Hm, it's not clear to me what this means. Does it mean that the bug has been fixed in the meantime already?

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1656957#c6)• 4 years ago |
|  | |

No, it still reproduces. Looks like Bugmon is confused here. I'm working on figuring out why. I'll have a bisection here shortly.

Flags: needinfo?(jkratzer)

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1656957#a87825_586683)• 4 years ago |

Whiteboard: [bugmon:confirmed] → [bugmon:],bisected,confirmed

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1656957#c7)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1656957&comment_id=14972150 "2 revisions") |
|  | |

Apologies for the delay. Looks like bugmon was using outdated prefs. The attached testcase requires the `dom.fetchObserver.enabled` pref enabled.

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1656957#c8)• 4 years ago |
|  | |

Bugmon Analysis:
Verified bug as reproducible on mozilla-central 20200804091327-7cb90fa4f485.
Failed to bisect testcase (Start build crashes!):
> Start: e8b7c48d4e7ed1b63aeedff379b51e566ea499d9 (20191107015224)
> End: f6a3b097f8af440a142b02450a2cdaa978fdde9f (20200803033015)
> BuildFlags: BuildFlags(asan=True, tsan=False, debug=False, fuzzing=True, coverage=False, valgrind=False)

|  | [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1656957#c9)• 4 years ago |
|  | |

(In reply to Jason Kratzer [:jkratzer] from [comment #7](/show_bug.cgi?id=1656957#c7 "VERIFIED FIXED - AddressSanitizer: heap-use-after-free /builds/worker/workspace/obj-build/dist/include/nsTArray.h:413:37 in Length"))

> Apologies for the delay. Looks like bugmon was using outdated prefs. The
>
> attached testcase requires the `dom.fetchObserver.enabled` pref enabled.

Ah, that's good to know, I wasn't able to reproduce this locally without the pref.

With the pref set, I can reproduce the crash. If I add the line as suggested in [comment 3](/show_bug.cgi?id=1656957#c3 "VERIFIED FIXED - AddressSanitizer: heap-use-after-free /builds/worker/workspace/obj-build/dist/include/nsTArray.h:413:37 in Length"), it does no longer crash, but it doesn't seem to terminate. There are several `JavaScript error: http://localhost:8000/1656957.html, line 32: TypeError: e2.waitUntil is not a function` outputs.

|  | [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1656957#c10)• 4 years ago |
|  | |

Attached file
[Bug 1656957 - Pin AbortSignalImpl instance while signaling followers. r=baku](attachment.cgi?id=9168158)
— [Details](attachment.cgi?id=9168158&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1656957#a158921_600971)• 4 years ago |

Assignee: nobody → sgieseckeStatus: NEW → ASSIGNED

|  | [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1656957#a257801_486634)• 4 years ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1656957#c11)• 4 years ago |
|  | |

Comment on [attachment 9168158](/attachment.cgi?id=9168158 "Bug 1656957 - Pin AbortSignalImpl instance while signaling followers. r=baku") [[details]](/attachment.cgi?id=9168158&action=edit "Bug 1656957 - Pin AbortSignalImpl instance while signaling followers. r=baku")

[Bug 1656957](/show_bug.cgi?id=1656957 "VERIFIED FIXED - AddressSanitizer: heap-use-after-free /builds/worker/workspace/obj-build/dist/include/nsTArray.h:413:37 in Length") - Pin AbortSignalImpl instance while signaling followers. r=baku

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Unsure, OTOH it is obvious that an abort follower that removes the signal itself could cause a UAF, and I don't see any way to hide this, but I am not sure how easy it is to construct an exploit based on that.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Yes
* **Which older supported branches are affected by this flaw?**: all
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: Unlikely, it only adds a temporary strong reference to the AbortSignalImpl instance.
[Attachment #9168158](/attachment.cgi?id=9168158&action=edit "Bug 1656957 - Pin AbortSignalImpl instance while signaling followers. r=baku") -
Flags: sec-approval?

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1656957#a587619_580382)• 4 years ago |

[status-firefox79](/buglist.cgi?f1=cf_status_firefox79&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=wontfix)
[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=affected)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)
[tracking-firefox80](/buglist.cgi?f1=cf_tracking_firefox80&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox80&o1=equals&v1=%2B)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [80+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=80%2B)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- → [80+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=80%2B)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1656957#c12)• 4 years ago |
|  | |

Comment on [attachment 9168158](/attachment.cgi?id=9168158 "Bug 1656957 - Pin AbortSignalImpl instance while signaling followers. r=baku") [[details]](/attachment.cgi?id=9168158&action=edit "Bug 1656957 - Pin AbortSignalImpl instance while signaling followers. r=baku")

[Bug 1656957](/show_bug.cgi?id=1656957 "VERIFIED FIXED - AddressSanitizer: heap-use-after-free /builds/worker/workspace/obj-build/dist/include/nsTArray.h:413:37 in Length") - Pin AbortSignalImpl instance while signaling followers. r=baku

Approved to land 8/18 and to request uplift to other branches.

[Attachment #9168158](/attachment.cgi?id=9168158&action=edit "Bug 1656957 - Pin AbortSignalImpl instance while signaling followers. r=baku") -
Flags: sec-approval?
[Attachment #9168158](/attachment.cgi?id=9168158&action=edit "Bug 1656957 - Pin AbortSignalImpl instance while signaling followers. r=baku") -
Flags: sec-approval+
[Attachment #9168158](/attachment.cgi?id=9168158&action=edit "Bug 1656957 - Pin AbortSignalImpl instance while signaling followers. r=baku") -
Flags: approval-mozilla-esr78?
[Attachment #9168158](/attachment.cgi?id=9168158&action=edit "Bug 1656957 - Pin AbortSignalImpl instance while signaling followers. r=baku") -
Flags: approval-mozilla-esr68?
[Attachment #9168158](/attachment.cgi?id=9168158&action=edit "Bug 1656957 - Pin AbortSignalImpl instance while signaling followers. r=baku") -
Flags: approval-mozilla-beta?

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1656957#c13)• 4 years ago |
|  | |

8/18 is the day after we build the release candidate for 80, what's the reasoning for that date?

Flags: needinfo?(tom)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1656957#c14)• 4 years ago |
|  | |

I was picking a date two days before the soft freeze as I thought that would be a good timeframe for "Close to release but with a little bit of time to handle unexpected problems". So I guess a better date would be today or tomorrow.

If the RC build date is the marker for "Get everything in befoe this date" it would be helpful to have that on the Release Calendar =)

Flags: needinfo?(tom)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1656957#c15)• 4 years ago |
|  | |

Comment on [attachment 9168158](/attachment.cgi?id=9168158 "Bug 1656957 - Pin AbortSignalImpl instance while signaling followers. r=baku") [[details]](/attachment.cgi?id=9168158&action=edit "Bug 1656957 - Pin AbortSignalImpl instance while signaling followers. r=baku")

[Bug 1656957](/show_bug.cgi?id=1656957 "VERIFIED FIXED - AddressSanitizer: heap-use-after-free /builds/worker/workspace/obj-build/dist/include/nsTArray.h:413:37 in Length") - Pin AbortSignalImpl instance while signaling followers. r=baku

<https://hg.mozilla.org/integration/autoland/rev/c9db7aaa4eda8702b4bf9708a14dc971eb7138c3>

Approved for 80.8b8, 78.2esr, and 68.12esr also.

[Attachment #9168158](/attachment.cgi?id=9168158&action=edit "Bug 1656957 - Pin AbortSignalImpl instance while signaling followers. r=baku") -
Flags: approval-mozilla-esr78?
[Attachment #9168158](/attachment.cgi?id=9168158&action=edit "Bug 1656957 - Pin AbortSignalImpl instance while signaling followers. r=baku") -
Flags: approval-mozilla-esr78+
[Attachment #9168158](/attachment.cgi?id=9168158&action=edit "Bug 1656957 - Pin AbortSignalImpl instance while signaling followers. r=baku") -
Flags: approval-mozilla-esr68?
[Attachment #9168158](/attachment.cgi?id=9168158&action=edit "Bug 1656957 - Pin AbortSignalImpl instance while signaling followers. r=baku") -
Flags: approval-mozilla-esr68+
[Attachment #9168158](/attachment.cgi?id=9168158&action=edit "Bug 1656957 - Pin AbortSignalImpl instance while signaling followers. r=baku") -
Flags: approval-mozilla-beta?
[Attachment #9168158](/attachment.cgi?id=9168158&action=edit "Bug 1656957 - Pin AbortSignalImpl instance while signaling followers. r=baku") -
Flags: approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1656957#c16)• 4 years ago |
| uplift | |

(In reply to Tom Ritter [:tjr] (ni? for response to sec-[advisories/bounties/ratings/cves]) from [comment #14](/show_bug.cgi?id=1656957#c14 "VERIFIED FIXED - AddressSanitizer: heap-use-after-free /builds/worker/workspace/obj-build/dist/include/nsTArray.h:413:37 in Length"))

> If the RC build date is the marker for "Get everything in befoe this date" it would be helpful to have that on the Release Calendar =)

By definition, an RC build is something we create with the intent to release it. I think it's reasonable to assume that changes aren't likely to be taken after that point.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1656957#c17)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/4e3e4d5126a1>

[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1656957#c18)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr78/rev/4258220f507e>

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1656957#c19)• 4 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/c9db7aaa4eda>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 4 years ago
[status-firefox81](/buglist.cgi?f1=cf_status_firefox81&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 81 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1656957#c20)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr68/rev/a7a5967fc505>

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed)

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1656957#a914674_551058)• 4 years ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify+

|  | [Alexandru Trif, Desktop Test Engineering [:atrif]](/user_profile?user_id=631815) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1656957#c21)• 4 years ago |
|  | |

Reproduced the crash with fuzzing mozilla-central rev 84b257d07031 and the attached test case served with HTTP and `dom.fetchObserver.enabled` pref enabled on Ubuntu 18.04.

There are no crashes with 81.0a1(20200813213942), 80.0b8 (20200813191622), 68.12esr (20200813214232) and 78.2.0esr (20200813212801) on Ubuntu 18.04.

Unfortunately, I still see multiple `JavaScript error: http://127.0.0.1/, line 33: TypeError: e2.waitUntil is not a function`/`JavaScript error: http://127.0.0.1/, line 31: ReferenceError: FuzzingFunctions is not defined` errors output when loading the test case. I see that is mentioned in [comment 9](/show_bug.cgi?id=1656957#c9 "VERIFIED FIXED - AddressSanitizer: heap-use-after-free /builds/worker/workspace/obj-build/dist/include/nsTArray.h:413:37 in Length") too but I just want to make sure that this is expected. Thank you!

Flags: needinfo?(sgiesecke)

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1656957#a1170456_551058)• 4 years ago |

QA Whiteboard: [post-critsmash-triage] → [post-critsmash-triage] [qa-triaged]

|  | [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1656957#c22)• 4 years ago |
|  | |

(In reply to Alexandru Trif, QA [:atrif] from [comment #21](/show_bug.cgi?id=1656957#c21 "VERIFIED FIXED - AddressSanitizer: heap-use-after-free /builds/worker/workspace/obj-build/dist/include/nsTArray.h:413:37 in Length"))

> Reproduced the crash with fuzzing mozilla-central rev 84b257d07031 and the attached test case served with HTTP and `dom.fetchObserver.enabled` pref enabled on Ubuntu 18.04.
>
> There are no crashes with 81.0a1(20200813213942), 80.0b8 (20200813191622), 68.12esr (20200813214232) and 78.2.0esr (20200813212801) on Ubuntu 18.04.
>
> Unfortunately, I still see multiple `JavaScript error: http://127.0.0.1/, line 33: TypeError: e2.waitUntil is not a function`/`JavaScript error: http://127.0.0.1/, line 31: ReferenceError: FuzzingFunctions is not defined` errors output when loading the test case. I see that is mentioned in [comment 9](/show_bug.cgi?id=1656957#c9 "VERIFIED FIXED - AddressSanitizer: heap-use-after-free /builds/worker/workspace/obj-build/dist/include/nsTArray.h:413:37 in Length") too but I just want to make sure that this is expected. Thank you!

`JavaScript error: http://127.0.0.1/, line 31: ReferenceError: FuzzingFunctions is not defined` probably means that `fuzzing.enabled` is not set to `true`.

I'm not sure what causes: `JavaScript error: http://127.0.0.1/, line 33: TypeError: e2.waitUntil is not a function`, but that was already happening in the original execution, so that's expected.

Flags: needinfo?(sgiesecke)

|  | [Alexandru Trif, Desktop Test Engineering [:atrif]](/user_profile?user_id=631815) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1656957#c23)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1656957&comment_id=14992267 "1 revision") |
|  | |

(In reply to Simon Giesecke [:sg] [he/him] from [comment #22](/show_bug.cgi?id=1656957#c22 "VERIFIED FIXED - AddressSanitizer: heap-use-after-free /builds/worker/workspace/obj-build/dist/include/nsTArray.h:413:37 in Length"))

> `JavaScript error: http://127.0.0.1/, line 31: ReferenceError: FuzzingFunctions is not defined` probably means that `fuzzing.enabled` is not set to `true`.
>
> I'm not sure what causes: `JavaScript error: http://127.0.0.1/, line 33: TypeError: e2.waitUntil is not a function`, but that was already happening in the original execution, so that's expected.

Thank you, Simon!

Verified again with 81.0a1(20200813213942), 80.0b8 (20200813191622), 68.12esr (20200813214232) and 78.2.0esr (20200813212801) on Ubuntu 18.04 and there are no tab crashes while loading the test case with `dom.fetchObserver.enabled` and `fuzzing.enabled` prefs set on true.

Status: RESOLVED → VERIFIED
[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=verified)
[status-firefox81](/buglist.cgi?f1=cf_status_firefox81&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=verified)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=verified)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=verified)Flags: qe-verify+

|  | [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1656957#c24)• 4 years ago |
|  | |

Ok, great!

It's still interesting that the crash was reproducible with the test case even with `fuzzing.enabled` not being `true`. I still need to add a test case after a while, and will check then again if this can be reproduced even with a non-fuzzing build deterministically.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1656957#a1303486_578488)• 4 years ago |

Whiteboard: [bugmon:],bisected,confirmed → [bugmon:],bisected,confirmed,[adv-main80+r]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1656957#a1303692_578488)• 4 years ago |

Whiteboard: [bugmon:],bisected,confirmed,[adv-main80+r] → [bugmon:],bisected,confirmed,[adv-main80+r][adv-esr68.12+r]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1656957#a1303767_578488)• 4 years ago |

Whiteboard: [bugmon:],bisected,confirmed,[adv-main80+r][adv-esr68.12+r] → [bugmon:],bisected,confirmed,[adv-main80+r][adv-esr68.12+r][adv-esr78.2+r]

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1656957#c25)• 4 years ago |
|  | |

As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.

Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1656957) to reply.

Flags: needinfo?(sgiesecke)Whiteboard: [bugmon:],bisected,confirmed,[adv-main80+r][adv-esr68.12+r][adv-esr78.2+r] → [bugmon:],bisected,confirmed,[adv-main80+r][adv-esr68.12+r][adv-esr78.2+r][sec-survey]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1656957#a1810578_578488)• 4 years ago |

Alias: CVE-2020-15669

|  | [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1656957#a1864623_642231)• 4 years ago |

Blocks: [1660954](/show_bug.cgi?id=1660954 "RESOLVED FIXED - AbortSignal instance must be pinned in AbortSignal::Abort rather than AbortSignalImpl::Abort")

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1656957#c26)• 4 years ago |
|  | |

Hm, I'm having trouble reproducing this.

Given c9db7aaa4eda is the fix and 45e64fba31ca96328a058409a98a6f492fca50fa is its parent, updating to 45e64fba31ca96328a058409a98a6f492fca50fa, doing `./mach build` with a debug-oriented mozconfig, then downloading `testcase.html` into a directory as `abortsignal-testcase.html` then serving its containing directory as `localhost:8080` and then loading the file using `./mach run --setpref dom.fetchObserver.enabled=true --setpref fuzzing.enabled=true http://localhost:8080/abortsignal-testcase.html` doesn't work. What am I missing?

Is my doing a debug build throwing off everything? I also see subresource integrity mismatch warnings in the console -- is something wrong with that? Or something else entirely? (I'm trying to verify the patch for [bug 1660954](/show_bug.cgi?id=1660954 "RESOLVED FIXED - AbortSignal instance must be pinned in AbortSignal::Abort rather than AbortSignalImpl::Abort") doesn't break this, by reproducing the crash with one rev, then backporting that patch to verify it too makes the crash go away.)

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1656957#c27)• 4 years ago |
|  | |

I also see a bunch of errors about `FuzzingFunctions is not defined`, but `about:config` definitely says the two set prefs, are set.

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1656957#c28)• 4 years ago |
|  | |

Oh bah, I need to tack on `--enable-fuzzing` when building, judging from Searchfox. Will comment here if that's not adequate to repro.

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1656957#c29)• 4 years ago |
|  | |

Yeah, never mind, with that in place the one rev crashes, the rev with the patch here and my followup patch in place passes. I'm good now!

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1656957#a11865138_1689)• 4 years ago |

Group: core-security-release

|  | [Simon Giesecke [:sg] [he/him]](/user_profile?user_id=642231)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1656957#a21264249_642231)• 4 years ago |

Flags: needinfo?(simon.giesecke)
You need to [log in](/show_bug.cgi?id=1656957&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_6b20703f_20250119_115843.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-40

## Security Vulnerabilities fixed in Thunderbird 68.12

Announced
August 25, 2020
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 68.12

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2020-15663: Downgrade attack on the Mozilla Maintenance Service could have resulted in escalation of privilege](#CVE-2020-15663)

Reporter
Xiaoyin Liu
Impact
high
##### Description

If Thunderbird is installed to a user-writable directory, the Mozilla Maintenance Service would execute updater.exe from the install location with system privileges. Although the Mozilla Maintenance Service does ensure that updater.exe is signed by Mozilla, the version could have been rolled back to a previous version which would have allowed exploitation of an older bug and arbitrary code execution with System Privileges.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1643199](https://bugzilla.mozilla.org/show_bug.cgi?id=1643199)

#### [#CVE-2020-15664: Attacker-induced prompt for extension installation](#CVE-2020-15664)

Reporter
Kaizer Soze
Impact
high
##### Description

By holding a reference to the `eval()` function from an about:blank window, a malicious webpage could have gained access to the InstallTrigger object which would allow them to prompt the user to install an extension. Combined with user confusion, this could result in an unintended or malicious extension being installed.

##### References

* [Bug 1658214](https://bugzilla.mozilla.org/show_bug.cgi?id=1658214)

#### [#CVE-2020-15669: Use-After-Free when aborting an operation](#CVE-2020-15669)

Reporter
Jason Kratzer
Impact
high
##### Description

When aborting an operation, such as a fetch, an abort signal may be deleted while alerting the objects to be notified. This results in a use-after-free and we presume that with enough effort it could have been exploited to run arbitrary code.

##### References

* [Bug 1656957](https://bugzilla.mozilla.org/show_bug.cgi?id=1656957)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_0373e2f6_20250119_134344.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1658214)
* [XML](/show_bug.cgi?ctype=xml&id=1658214)

Closed
[Bug 1658214](/show_bug.cgi?id=1658214)
(CVE-2020-15664)

Opened 4 years ago
Closed 4 years ago

# InstallTrigger can take the principal from the wrong inner window when initialized

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

InstallTrigger can take the principal from the wrong inner window when initialized

## Categories

### (Toolkit :: Add-ons Manager, defect)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Add-ons%20Manager#Add-ons%20Manager)

Add-ons Manager
▾

Toolkit :: Add-ons Manager
The management and update windows for extensions and themes (add-ons).
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Add-ons%20Manager&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Add-ons%20Manager&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Add-ons%20Manager)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 81

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

81 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | [80+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=80%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed) |
| firefox-esr78 | [80+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=80%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed) |
| firefox79 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=wontfix) |
| firefox80 | [+](/buglist.cgi?f1=cf_tracking_firefox80&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=fixed) |
| firefox81 | [+](/buglist.cgi?f1=cf_tracking_firefox81&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr68 | 80+ | fixed |
| firefox-esr78 | 80+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox79 |  | wontfix |
| firefox80 | + | fixed |
| firefox81 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: kaizersoze915, Assigned: kmag)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=40)  [kmag](/user_profile?user_id=106098)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/7ff58cc3c5d778b476fb1b5f6a2dd923?d=mm&size=40)  [kaizersoze915](/user_profile?user_id=668173)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=40)  [zombie](/user_profile?user_id=445095)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [adv-main80+][adv-esr68.12+][adv-esr78.2+][sec-survey])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-15664

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main80+][adv-esr68.12+][adv-esr78.2+][sec-survey]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a1550263_1689 "4 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [inheritPermissions-testcase-new.html](/attachment.cgi?id=9169064)  [4 years ago](#c0)  [Kaizer Soze](/user_profile?user_id=668173)   983 bytes, text/html |  | [Details](/attachment.cgi?id=9169064&action=edit) |
| --- | --- | --- |
| [Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley](/attachment.cgi?id=9169274)  [4 years ago](#c7)  [Kris Maglione [:kmag]](/user_profile?user_id=106098)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c16 "4 years ago")  RyanVM : [approval-mozilla-esr68+](#c16 "4 years ago")  RyanVM : [approval-mozilla-esr78+](#c16 "4 years ago")  tjr : [sec-approval+](#c14 "4 years ago") | [Details](/attachment.cgi?id=9169274&action=edit) | [Review](/attachment.cgi?id=9169274) |
| [advisory.txt](/attachment.cgi?id=9171197)  [4 years ago](#c20)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   392 bytes, text/plain |  | [Details](/attachment.cgi?id=9171197&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Kaizer Soze](/user_profile?user_id=668173)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1658214#c0)• 4 years ago |
|  | |

Attached file
[inheritPermissions-testcase-new.html](attachment.cgi?id=9169064)
— [Details](attachment.cgi?id=9169064&action=edit)

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:79.0) Gecko/20100101 Firefox/79.0

Steps to reproduce:

I created a form, that first loads about:blank into a full new window. I then used the onsubmit handler to load <https://fpn.firefox.com/> into this window which has the extension install permission, while holding a reference to the eval function for that window. Upon submitting the form I have scripted an install of ghostery.

Actual results:

The secondary prompt still displays, which asks a user for permissions to be allowed. Currently this stops a full install of a webextension, but allows for one to attempt more exploitation by manipulating input into Extensions.jsm.

Expected results:

Holding a reference to the eval function of a window should not allow one to inherit permissions of the window that is loaded. This allows all permissions to be inherited but proper defense in depth stops things like accessing video/microphone streams.

Storage APIs may still be able to be manipulated, as I have not had time to fully test this. This could allow one to pollute the local storage of extensions, and persistent webworker pages.

|  | [Kaizer Soze](/user_profile?user_id=668173)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1658214#c1)• 4 years ago |
|  | |

Hey guys, I haven't had time to fully follow up on the storage API permissions and such yet. I will continue to work on this as a fix is put in place. For any additional info please NI me.

Also, can I get this nominated for a sec-bounty? I know back in the day we would have made this a moderate but things have been changing. The potential for exploiting code in Extensions.jsm is high but my time is low.

I happened to mention a bug to Bobby a couple of days ago, I'll link him here.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a18155_1689)• 4 years ago |

Flags: sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a74139_1689)• 4 years ago |

Group: firefox-core-security → dom-core-securityComponent: Untriaged → DOM: Core & HTMLProduct: Firefox → Core

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1658214#c2)• 4 years ago |
|  | |

Kris, do you have cycles to have a look here?

Flags: needinfo?(kmaglione+bmo)

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1658214#c3)• 4 years ago |
|  | |

I haven't actually debugged the testcase. But the way this is supposed to work is: Synchronously-created windows (iframes, and the return value of window.open) have an initial about:blank document that is same-origin with the creator. Upon navigation, we reuse/persist the global of that about:blank document (and thus globals like eval) of the initial about:blank window if the navigated-to document is same-origin.

So in general, the holdEval trick used in the testcase should just be acquiring the eval of the initial about:blank window, which should be different from fpn.firefox.com, and thus safe from a same-origin-policy perspective. But it could be the case that the permission handling here is out-of-band somehow, and that the inactive inner window is doing permission checks via the active one (via the outer/docshell). If that were the case, that would be bad.

|  | [Kaizer Soze](/user_profile?user_id=668173)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1658214#c4)• 4 years ago |
|  | |

I'll try to save you *some* time with the debugging. InstallTrigger is still only created upon request. Eval allows access to it as if it is the InstallTrigger Object of the about:blank page. InstallTrigger gets the principal it is working with from the window it is created for as it is accessed (lazy initialization). This makes the extension installation case a primary way to show this off.

As for further debugging, other permissions are inherited but only possibly useful case by case. Most seem to have proper defense in depth to prevent similar abuse. This eval trick was only to show off that permissions can get inherited and not meant to be a major point here. I know with so much attention being on webextensions right now, this was a good place to start.

As for further exploitation, I assume all the code in Extensions.jsm isn't supposed to be web facing. I have done practically no work on the storage issues this could lead to, as there's just no time for me to right now.

If I'm interrupting here and you guys want to just roll with this, that's fine with me. My debugging skills definitely aren't as sharp as most.

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1658214#c5)• 4 years ago |
|  | |

Looks like InstallTrigger is JS-implemented WebIDL [1]. Implementing in JS makes it much easier to succumb to inner/outer window confusion, wonder if that's what's happening here.

(To be clear I'm just speculating here since I don't have cycles to actually dig in. Hopefully Kris does.)

[1] <https://searchfox.org/mozilla-central/rev/ab81b8552f4aa9696a2524f97fdfeb59d4dc31c1/dom/webidl/InstallTrigger.webidl#23>

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1658214#c6)• 4 years ago |
|  | |

Yeah, it's a case of inner window confusion. The InstallTrigger's init method takes a window object, and saves the principal from its current document, when it's first initialized. If that happens after the window has navigated, then it winds up taking it from whatever the current document is.

We should probably just forbid initializing any JS-implemented WebIDL globals when their inner window isn't active.

Assignee: nobody → kmaglione+bmoGroup: dom-core-security → firefox-core-securityStatus: UNCONFIRMED → ASSIGNEDComponent: DOM: Core & HTML → Add-ons ManagerEver confirmed: trueFlags: needinfo?(kmaglione+bmo)Product: Core → ToolkitSummary: It's possible to inherit permissions cross domain including the webextension install permission. → InstallTrigger can take the principal from the wrong inner window when initialized

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1658214#c7)• 4 years ago |
|  | |

Attached file
[Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley](attachment.cgi?id=9169274)
— [Details](attachment.cgi?id=9169274&action=edit)

|  | [Kaizer Soze](/user_profile?user_id=668173)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1658214#c8)• 4 years ago |
|  | |

Hey guys, could we get a sec-rating here? Thanks

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1658214#c9)• 4 years ago |
|  | |

This should get a rating before it lands, as that will affect sec-approval. Maybe Dan has some thoughts on a rating.

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1658214#c10)• 4 years ago |
|  | |

As-is the testcase is a super bad spoof: wouldn't be too hard to imagine a "click here to get uBlock Origin from addons.mozilla.org" link, that when clicked opens AMO to the legit uBlock Origin page, and then uses this trick to prompt to install something else with a similar name. Or same name even? not sure the automatic scans require names to be unique. That's not quite sec-high because that powerful spoofing scenario is limited to a single site and action -- but it's a super powerful action!

There are two other objects created using the function that's being patched (that I found -- are there more?). One was the sidebar/add search provider function, but that's a deprecated stub and not useful. The other was the AddonManager. Looking at the IsValidHost logic it ought to be available on AMO but I couldn't get it to work. If you can it would be super powerful. AddonManager.getAddonByID() alone is fantastically useful. You could fingerprint people based on what they have installed. It looks like the "SyncGUID" is a per-install generated thing, if the victim has Sync. If the addon has an icon the URL gives me the full file path to the extension in my profile -- so that gets leaked if someone has a "load known local file" exploit. And if you could make this work and you didn't like adblockers you could have fun with this:

1. Install uBlock Origin if you don't have it already
2. open about:preferences (need it privileged since I couldn't get AMO to work)
3. open the DevTools console
4. execute `(await AddonManager.getAddonByID("uBlock0@raymondhill.net")).disable()`

If you want to play and see what other data is available do `await AddonManager.getAddonByID("uBlock0@raymondhill.net")`

.uninstall() also works (more realistic attack) but harder to undo as a test! change disable() to enable() to get your addon back (or manually in about:addons).

Like I said, I couldn't make that actually work on AMO, but maybe I'm missing something. It's certainly a juicy enough target to be worth playing with.

Testcase works on Firefox ESR-68 (as expected) so we'll need a patch for that, too. The "fpn" site wasn't in the whitelist back then so you have to either manually add the site as an ALLOW exception first, or modify the testcase to use AMO which *was* in the built-in exception list.

[status-firefox79](/buglist.cgi?f1=cf_status_firefox79&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=wontfix)
[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=affected)
[status-firefox81](/buglist.cgi?f1=cf_status_firefox81&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=affected)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)
[tracking-firefox80](/buglist.cgi?f1=cf_tracking_firefox80&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox80&o1=equals&v1=%2B)
[tracking-firefox81](/buglist.cgi?f1=cf_tracking_firefox81&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox81&o1=equals&v1=%2B)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [80+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=80%2B)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- → [80+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=80%2B)Flags: needinfo?(dveditz)Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1658214#c11)• 4 years ago |
|  | |

The AddonManager API isn't vulnerable to this issue. The decision on whether or not to make that available happens in C++ via `AddonManagerWebAPI::IsAPIEnabled`, which isn't susceptible to inner window confusion.

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1658214#c12)• 4 years ago |
|  | |

We should land this soon to make 80. Kris, can you request sec-approval?

Flags: needinfo?(kmaglione+bmo)

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1658214#c13)• 4 years ago |
|  | |

Comment on [attachment 9169274](/attachment.cgi?id=9169274 "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") [[details]](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley")

[Bug 1658214](/show_bug.cgi?id=1658214 "RESOLVED FIXED - InstallTrigger can take the principal from the wrong inner window when initialized"): Only construct JS-implemented objects if inner window is current. r=bholley

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Fairly easily, given the small number of APIs constructed this way, but the actual risk of the exploit is relatively low.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: It should already apply cleanly to all branches.
* **How likely is this patch to cause regressions; how much testing does it need?**: Unlikely. It only affects constructing objects for 3 rarely-used APIs when a window has been navigated away from, which no valid code should be relying on.
Flags: needinfo?(kmaglione+bmo)
[Attachment #9169274](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1658214#c14)• 4 years ago |
|  | |

Comment on [attachment 9169274](/attachment.cgi?id=9169274 "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") [[details]](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley")

[Bug 1658214](/show_bug.cgi?id=1658214 "RESOLVED FIXED - InstallTrigger can take the principal from the wrong inner window when initialized"): Only construct JS-implemented objects if inner window is current. r=bholley

Land it and let's get it uplifted too.

[Attachment #9169274](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") -
Flags: sec-approval? → sec-approval+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1658214#c15)• 4 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/1edd9346c110b011ed87e50eb3d417202ea445fb>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1658214#c16)• 4 years ago |
|  | |

Comment on [attachment 9169274](/attachment.cgi?id=9169274 "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") [[details]](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley")

[Bug 1658214](/show_bug.cgi?id=1658214 "RESOLVED FIXED - InstallTrigger can take the principal from the wrong inner window when initialized"): Only construct JS-implemented objects if inner window is current. r=bholley

Also approved for 80.0rc1, 78.2esr, and 68.12esr.

[Attachment #9169274](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") -
Flags: approval-mozilla-esr78+
[Attachment #9169274](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") -
Flags: approval-mozilla-esr68+
[Attachment #9169274](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") -
Flags: approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1658214#c17)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/6fa858e9b31d>

<https://hg.mozilla.org/releases/mozilla-esr78/rev/bbbd6d1ea0f5>

<https://hg.mozilla.org/releases/mozilla-esr68/rev/4bdb757c65b2>

[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=fixed)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1658214#c18)• 4 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/1edd9346c110>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 4 years ago
[status-firefox81](/buglist.cgi?f1=cf_status_firefox81&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 81 Branch

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a776039_578488)• 4 years ago |

Whiteboard: [adv-main80+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a776242_578488)• 4 years ago |

Whiteboard: [adv-main80+] → [adv-main80+][adv-esr68.12+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a776315_578488)• 4 years ago |

Whiteboard: [adv-main80+][adv-esr68.12+] → [adv-main80+][adv-esr68.12+][adv-esr78.2+]

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1658214#c19)• 4 years ago |
|  | |

As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.

Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1658214) to reply.

Flags: needinfo?(kmaglione+bmo)Whiteboard: [adv-main80+][adv-esr68.12+][adv-esr78.2+] → [adv-main80+][adv-esr68.12+][adv-esr78.2+][sec-survey]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1658214#c20)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9171197)
— [Details](attachment.cgi?id=9171197&action=edit)

Here's an attempt at an advisory, LMK if anyone thinks it can be worded better.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a1282993_578488)• 4 years ago |

Alias: CVE-2020-15664

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a1550263_1689)• 4 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a4494174_106098)• 4 years ago |

Flags: needinfo?(kmaglione+bmo)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a11337674_1689)• 4 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a120086326_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1658214&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Kaizer Soze](/user_profile?user_id=668173)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_d1883d95_20250119_115842.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-37

## Security Vulnerabilities fixed in Firefox ESR 68.12

Announced
August 25, 2020
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 68.12

#### [#CVE-2020-15663: Downgrade attack on the Mozilla Maintenance Service could have resulted in escalation of privilege](#CVE-2020-15663)

Reporter
Xiaoyin Liu
Impact
high
##### Description

If Firefox is installed to a user-writable directory, the Mozilla Maintenance Service would execute updater.exe from the install location with system privileges. Although the Mozilla Maintenance Service does ensure that updater.exe is signed by Mozilla, the version could have been rolled back to a previous version which would have allowed exploitation of an older bug and arbitrary code execution with System Privileges.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1643199](https://bugzilla.mozilla.org/show_bug.cgi?id=1643199)

#### [#CVE-2020-15664: Attacker-induced prompt for extension installation](#CVE-2020-15664)

Reporter
Kaizer Soze
Impact
high
##### Description

By holding a reference to the `eval()` function from an about:blank window, a malicious webpage could have gained access to the InstallTrigger object which would allow them to prompt the user to install an extension. Combined with user confusion, this could result in an unintended or malicious extension being installed.

##### References

* [Bug 1658214](https://bugzilla.mozilla.org/show_bug.cgi?id=1658214)

#### [#CVE-2020-15669: Use-After-Free when aborting an operation](#CVE-2020-15669)

Reporter
Jason Kratzer
Impact
high
##### Description

When aborting an operation, such as a fetch, an abort signal may be deleted while alerting the objects to be notified. This results in a use-after-free and we presume that with enough effort it could have been exploited to run arbitrary code.

##### References

* [Bug 1656957](https://bugzilla.mozilla.org/show_bug.cgi?id=1656957)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_73f8d6fa_20250119_134341.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)


