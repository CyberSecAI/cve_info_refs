=== Content from fex.rus.uni-stuttgart.de_a91fe299_20250119_112955.html ===


![F*EX - Frams' Fast File EXchange](running-fex-camel.gif)
### [ [english](/index.html?locale=english) [deutsch](/index.html?locale=german) [schwäbisch](/index.html?locale=swabian) [français](/index.html?locale=french) [italiano](/index.html?locale=italian) [español](/index.html?locale=spanish) [galego](/index.html?locale=galician) [čeština](/index.html?locale=czech) [magyar](/index.html?locale=hungarian) ]

F\*EX (Frams' Fast File EXchange) is a service to send big (large, huge,
giant, ...) files from a user A to a user B.

The sender uploads the file to the F\*EX server using a
[WWW upload form](/fup) and the recipient
automatically gets a notification e-mail with a download-URL.

You say:
> *Why do I need another service for file transfer?!
>
> I have e-mail, ftp, ssh and even sendfile!*

I say:
> *You still need F\*EX ☺*

For example, you want to send your colleague your last lab data set (1 GB).
You have the following possibilities (and problems):

* ### sending a DVD by postal service

  Out of the question - we live in the year
  56
  after invention of the internet!
  Sending media (hardware) is for grandpas.

  * ### using e-mail

    Most e-mail servers have a limit of 10 MB per e-mail and a
    storage-quota of a few 100 MB per user or even less.

    * ### uucp

      Why not cuneiform writing on stone plates?

      * ### ssh

        You have your communication partners password or you are willing to give him yours
        - just for a file transfer?

        * ### ftp

          + Using which ftp server?+ Using which account, which password?+ You do not mind sending unencrypted passwords and files over the insecure internet?+ Your proxy supports passive-ftp?+ In case of anonymous ftp:
                    - Does it allow 1 GB uploads?- Does it allow to delete the upload afterwards?- Who else can download your file?- Who else can delete your file?- You have to send your friend the download-URL, he has to
                              inform you about the successful download, you have to delete
                              it afterwards.

                              All in all: a pain in the ass.

          * ### http

            + No default upload and user management - must be programmed+ No auto-notification+ No auto-deletion+ Very few http servers can handle files greater than 2 GB

            * ### [sendfile](http://fex.belwue.de/saft/)

              + You run UNIX and have sendfile installed?+ Your recipient runs UNIX and has sendfile installed?+ Neither you nor your recipient has a firewall blocking port 487?

              * ### commercial services like DropLoad, ALLPeers, YouSendIt, etc

                + What limit do they have (most: < 2 GB)?+ What about security and privacy: will your files be save and secure?+ Are they open source based or closed proprietary?+ Are they accessible with any browser or do you need java, active-X, flash or other evil plugins?+ Will they exist longer than a few months?

                          (DropLoad, ALLPeers and drop.io already have terminated their business)

If you have answered only once "no" to the questions above, then you need
F\*EX.

See also [XKCD](http://xkcd.com/949/).

## Main features of F\*EX

* file transfer of virtually unlimited file size* recipient and sender only need an e-mail program and a web browser -
    of any kind, they do not have to install any software
    * RESEND and REGET for resuming after link failures at last sent byte* F\*EX is a HTTP web-service and needs no firewall-tunnels* auto-notification of recipient* auto-deletion after download* auto-deletion after expiration date (default: 10 days)* full-users can create one time upload URLs for foreign users* full-users can create sub-users, who can send only to this full-user* full-users can create groups, an analogy to mailing lists, but for files* admin can allow (internal or external) user self-registration* admin can allow upload to public recipients without authentification* admin can allow upload for LAN users without registration (anonymous upload)* sending to multiple recipients needs storage on the server only once* maintenance-free: no admin interaction necessary besides creating new F\*EX accounts* support for streams, too* optional archive / document / file sharing with versioning* optional GUI and CLI clients* [protocol and source-code free available](https://fex.belwue.de/fex.html)

## Convinced? → [Download server software](https://fex.belwue.de/fex.html)

## Still questions?

See the [full feature list](/features.html),
the [FAQ](/FAQ/) and
the [use cases](/usecases/).

[Comparision with bwSync&Share and DFN GigaMove.
## More software?

Interested in more software? See the UNIX [fstools](http://fex.belwue.de/fstools/).

---

| contact: fexmaster | [Datenschutz](/Datenschutzerklaerung.html) | [Impressum](http://www.uni-stuttgart.de/impressum/) |
| --- | --- | --- |](https://fex.belwue.de/fex-vs-bwsyncshare.html)



=== Content from secfault-security.com_453ba288_20250119_112955.html ===

![](../images/logo.png)

[Home](../index.html)
[Company](../company.html)
[Services](../services.html)
[Trainings](../trainings.html)
[Jobs](../jobs.html)
[Blog](../blog.html)
[Contact](../contact.html)

# RCE in F\*EX

Posted on July 8, 2020
# Background

F\*EX is a Perl-based HTTP file exchange service. Quoting from the vendorâs homepage:

> F\*EX (Framsâ Fast File EXchange) is a service to send big (large, huge, giant, â¦) files from a user A to a user B. The sender uploads the file to the F\*EX server using a WWW upload form and the recipient automatically gets a notification e-mail with a download-URL.

# Issue Description

While reviewing the F\*EX implementation, the function `copy` from `lib/fex.pp` was analyzed:

```
# copy file (and modify) or symlink
# returns chomped file contents or link name
# preserves permissions and time stamps
sub copy {
  my ($from,$to,$mod) = @_;
  my $link;
  local $/;
  local $_;

  $to .= '/'.basename($from) if -d $to;

  if (defined($link = readlink $from)) {
    mksymlink($to,$link);
    return $link;
  } else {
    open $from,'<',$from or return;
    open $to,'>',$to or return;
    $_ = <$from>;
    close $from;
    eval $mod if $mod;
    print {$to} $_;
    close $to or http_die("internal error: $to - $!");
    if (my @s = stat($from)) {
      chmod $s[2],$to;
      utime @s[8,9],$to unless $mod;
    }
    chomp;
    return $_;
  }
}
```

The `eval $mod if $mod` call indicates a potential `eval` injection issue. Identifying the callers reveals that the `copy` function is invoked by `bintar` from `bin/fexsrv`, which is shown below.

```
sub bintar {
  my $tmpdir = "$FEXHOME/tmp";
  my $fs = "$ENV{PROTO}://$ENV{HTTP_HOST}";

  if (chdir "$FEXHOME/bin") {
    fexlog($connect,@log);
    chdir $fstb if $fstb;
    mkdir $tmpdir;
    foreach my $f (@_) {
      copy($f,"$tmpdir/$f","s#fexserver = ''#fexserver = '$fs'#");
      chmod 0755,"$tmpdir/$f";
    }
    chdir $tmpdir or http_die("internal error: $tmpdir - $!");
    my $tar = `tar cf - @_ 2>/dev/null`;
    unlink @_;
    nvt_print(
      'HTTP/1.1 200 OK',
      'Server: fexsrv',
      "Content-Length: ".length($tar),
      "Content-Type: application/x-tar",
      '',
    );
    print $tar;
    exit;
  }
}
```

It can be observed that in this call, the `$mod` argument is indeed passed to `copy`. Parts of the `$mod` argument are based on the `HTTP_HOST` variable, which is user-controlled. Further tracing down callers of `bintar` yields the following code from `bin/fexsrv`, which is part of the HTTP request parsing logic:

```
      # special request for F*EX UNIX clients
      if ($ENV{SCRIPT_NAME} eq 'xx.tar') {
        bintar(qw'fexget fexsend xx zz ezz');
      }
```

It should be noted that no authentication is required in order to trigger this code path. The vulnerability hence is a pre-auth RCE issue.

# Fix

The issue has been [fixed](http://fex.belwue.de/fex.html) in `fex-20160919_2`.

# Credit

Gregor Kopf of [Secfault Security GmbH](https://secfault-security.com/)

# Disclaimer

The information provided is released âas isâ without warranty of any kind. The publisher disclaims all warranties, either express or implied, including all warranties of merchantability. No responsibility is taken for the correctness of this information. In no event shall the publisher be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if the publisher has been advised of the possibility of such damages.

The contents of this advisory are copyright (c) 2020 Secfault Security GmbH and may be distributed freely provided that no fee is charged for this distribution and proper credit is given.

Â© 2016 - 2024 Secfault Security GmbH | [Imprint](../imprint.html)


