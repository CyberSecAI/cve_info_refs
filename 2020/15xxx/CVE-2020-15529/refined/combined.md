=== Content from daniels-it-blog.blogspot.com_b0fb6aff_20250119_130117.html ===

[Skip to main content](#main)

Search

### Search This Blog

# [Another IT Security Blog](http://daniels-it-blog.blogspot.com/)

IT Security, Hacking and More

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[July 02, 2020](http://daniels-it-blog.blogspot.com/2020/07/gog-galaxy-escalation-of-privileges.html "permanent link")

### GOG Galaxy - Escalation of Privileges incl. Code Execution

**Product:** GOG Galaxy Client for Windows**Version:** 2.0.17**Tested on:** Windows 10 Pro 2004 x64**Vendor informed:** Not yet**PoC:** This blog post**CVE:** CVE-2020-15528 / CVE-2020-15529

As mentioned in one of previous posts I like old computer games. During the COVID-19 crisis many companies offered free games. One of these companies is GOG. Because I like old games and they are also for free now I played a few of them. To play these games I used GOG Galaxy; the steam counterpart from GOG but without DRM. After some hours of good old retro gaming I saw the GOG Galaxy client window and decided to do a quick analysis of the client. Let´s take a look at GOG Galaxy version 2.0.17 from a hackers point of view:

GOG uses client software called "GOG Galaxy" sometimes also called "GOG Galaxy 2.0". This software is used to manage games, chat with friends etc. (like Steam, Origin etc). GOG offers several free games, some of them are demo versions some are good old classic games and others are brand new blockbusters. In this post I will describe my findings in the Galaxy client. My findings for GOG DOSbox needs a separate post because it would be too much for only one post.

**GOG Galaxy Client****[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhOxu8ebE1R6863Whvsj3YgoAO8YGHDoRHt38_d4FyZ4VPhEJGSESmvLzf8UisJ2ojENVJaEytbQYtx6DFZ-KK8pfjvxS92cKISOL6iCK4GJdjwUAP7W0hyphenhyphen7WJ61Md-CMKWJ2DQ7VIGM80/w625-h368/2020-07-02+18_39_31-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhOxu8ebE1R6863Whvsj3YgoAO8YGHDoRHt38_d4FyZ4VPhEJGSESmvLzf8UisJ2ojENVJaEytbQYtx6DFZ-KK8pfjvxS92cKISOL6iCK4GJdjwUAP7W0hyphenhyphen7WJ61Md-CMKWJ2DQ7VIGM80/s1602/2020-07-02%2B18_39_31-Window.png)**When GOG Galaxy client (GC) is installed, a service called "GalaxyClientService" is also installed. This service is running as "NT AUTHORITY\SYSTEM"

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgTjnQnfE0VwHD-Osr51SDZiaVVLRp8U9rx3GuGAWSPr6psvP2CiFaoWqalT2qJN6P1GagdtE8_MR2gWAfRmsHJSQs8Y_3AHrIP9xb62HMFaVAgkBWddHYojNW8VGAYAPicyKzbyj9CDJQ/w500-h310/2020-07-02+19_03_34-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgTjnQnfE0VwHD-Osr51SDZiaVVLRp8U9rx3GuGAWSPr6psvP2CiFaoWqalT2qJN6P1GagdtE8_MR2gWAfRmsHJSQs8Y_3AHrIP9xb62HMFaVAgkBWddHYojNW8VGAYAPicyKzbyj9CDJQ/s957/2020-07-02%2B19_03_34-Window.png)

GC (GOG Galaxy Client) interacts with this service to delegate tasks like installation of games, updates etc.
By default GC is installed under "C:\Program Files (x86)\GOG Galaxy". Some files/folders can be modified by regular users, some files/folders not. For example a user can modify the "Games" folder [No.1] but can not modify the plugins folder [No.2]:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhshthpL_CEGhhT3jFbCic0uJIdmeI2t9FFZbV7qk7KtkaQLGfb3c8GU41Xan9lk7ajKv_5fbLF9dOmpOTMOu0yvSUZTWUHTpVYt1dL27YOZ-VzlmvvGRS33vzSZaR8ujVae2_qhz8TX3I/w625-h404/2020-07-02+19_10_54-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhshthpL_CEGhhT3jFbCic0uJIdmeI2t9FFZbV7qk7KtkaQLGfb3c8GU41Xan9lk7ajKv_5fbLF9dOmpOTMOu0yvSUZTWUHTpVYt1dL27YOZ-VzlmvvGRS33vzSZaR8ujVae2_qhz8TX3I/s952/2020-07-02%2B19_10_54-Window.png)
When the user installs a game it will be installed (by default) in the "Games" folder. It makes sense that users can modify this folder because games will generate savegames, config files etc. and are usually not running elevated.
In this example I installed the game "Stargunner" which is free and also has a small installation size
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgKkaB2AK9BMceW7KmPZEJdzgMshRREzHgIWlxtviGeHum_7KXdHQ4PadZ8vrvYkjrKmWm8EcaiWQgO93egjPZqvbLStvrfGbgmblmVKaSsd3FgJE1C5m-EadihAoDh-fD9bLVL4dOymJo/w625-h380/2020-07-02+19_22_48-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgKkaB2AK9BMceW7KmPZEJdzgMshRREzHgIWlxtviGeHum_7KXdHQ4PadZ8vrvYkjrKmWm8EcaiWQgO93egjPZqvbLStvrfGbgmblmVKaSsd3FgJE1C5m-EadihAoDh-fD9bLVL4dOymJo/s1439/2020-07-02%2B19_22_48-Window.png)

During the installation I discovered that also a file called "scriptinterpreter.tmp" was created and executed elevated:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj5X5aQsjg1qkjoAm1q-MAHUefC-Plx25_sj79NWZWSKTZqwMSA74ZRnpVO-LXTkSDM8r6SkSFt12bJ0UBe78ryLAFtHm4d-dqAbmVf4TyJgF8SgOMgX8gvQ769yzoRS51BwM6_FCrxgKY/w625-h358/2020-07-02+19_24_39-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj5X5aQsjg1qkjoAm1q-MAHUefC-Plx25_sj79NWZWSKTZqwMSA74ZRnpVO-LXTkSDM8r6SkSFt12bJ0UBe78ryLAFtHm4d-dqAbmVf4TyJgF8SgOMgX8gvQ769yzoRS51BwM6_FCrxgKY/s932/2020-07-02%2B19_24_39-Window.png)

This file was also placed under "C:\Program Files (x86)\GOG Galaxy\Dependencies\\_\_redist\ISI" and can be modified by the user

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhnbtDtU2ZOhFB9MV4QNCL2BACBOm2hpL3CSAMF_hvB1wzC6o7hOsPoTADqMWB2Ja7dtQcy_kdXpIgTgz1X89eaNgnMwIg-y7vpXpiNE8kEm7SMZZj_LySsBXX_fH_ELifJAjqjjHO1rpo/w625-h351/2020-07-02+19_25_34-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhnbtDtU2ZOhFB9MV4QNCL2BACBOm2hpL3CSAMF_hvB1wzC6o7hOsPoTADqMWB2Ja7dtQcy_kdXpIgTgz1X89eaNgnMwIg-y7vpXpiNE8kEm7SMZZj_LySsBXX_fH_ELifJAjqjjHO1rpo/s988/2020-07-02%2B19_25_34-Window.png)

Now the attacker has different options:
**1. Evil Game:**The attacker replaces the game executable with a malicious one. Because the game folder can be modified this is no challenge. To bypass UAC and run the evil game executable the attacker has to call GC to run the file elevated. This is achieved in the following way:

The attacker replaces the game executable. In the case of "Stargunner" it is DOSBox which has to be replaced because "Stargunner" will not run on modern OS.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiLzlkwHxANFCH75rxfvZGe3I3F9_lfxzjiAV0WmlK0XMj9yhC4DiMznq10Fw2Ey83Vv25-mWR1zgWQuUtOj4XQ3MonBtQdeJ4UxvqqZ5lNBAIHB61v6UmExewOuQV7C2ERCDJru1h4i3k/w625-h381/2020-07-02+19_35_27-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiLzlkwHxANFCH75rxfvZGe3I3F9_lfxzjiAV0WmlK0XMj9yhC4DiMznq10Fw2Ey83Vv25-mWR1zgWQuUtOj4XQ3MonBtQdeJ4UxvqqZ5lNBAIHB61v6UmExewOuQV7C2ERCDJru1h4i3k/s857/2020-07-02%2B19_35_27-Window.png)
Note that the evil version of DOSBox requires administrative (elevated) rights to run. So if running this file directly will result in a suspicious UAC prompt like this:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhcYMbk5uxXy4BM03s-jHSbm0fkGOqvMnP_2aV_9DBYh8kkqBV_Ol72CNQHHUdAeFyKtx30GoCCF00pOxGh1k26wKBX7weBPMgq0Ok9PRoq8sPyX4IAsBA6o_IB9GbPZghvcIif42nHvMk/w500-h376/2020-07-02+19_37_23-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhcYMbk5uxXy4BM03s-jHSbm0fkGOqvMnP_2aV_9DBYh8kkqBV_Ol72CNQHHUdAeFyKtx30GoCCF00pOxGh1k26wKBX7weBPMgq0Ok9PRoq8sPyX4IAsBA6o_IB9GbPZghvcIif42nHvMk/s456/2020-07-02%2B19_37_23-Window.png)

To avoid this the attacker can use a feature of GC which runs games via GC instead of executing the file directly. This happens when the user clicks the "Play" button in GC or opens the shortcut on the desktop:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhHHyH0t8vRsUcMGDISRZcgNM3Znewejf8-KKUz0EmC4OaaQ7_jM4J8MFxyY7_OWiwQc3gAFwpJNqFk9OWtDI0KxiKrqHd5yrWhZC6kwxVkhP-WH-r7r92_kEgZ_vlmw7HoOq9rC78x92A/w625-h288/2020-07-02+19_39_30-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhHHyH0t8vRsUcMGDISRZcgNM3Znewejf8-KKUz0EmC4OaaQ7_jM4J8MFxyY7_OWiwQc3gAFwpJNqFk9OWtDI0KxiKrqHd5yrWhZC6kwxVkhP-WH-r7r92_kEgZ_vlmw7HoOq9rC78x92A/s1430/2020-07-02%2B19_39_30-Window.png)
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj4rgE2rO2e1mpZ59aRv4wyIl7EX-HRWPt6tyOVkw3-adlfYuQlpWHu8Iozze4ftnSl7AljiktQlEIIFJUaOO3_6IG4U4o-diAvvVv80Fc2lXJUGKOpOhmUVotFG_5_Akriq6j-4Oz1v6g/w136-h139/2020-07-02+19_39_54-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj4rgE2rO2e1mpZ59aRv4wyIl7EX-HRWPt6tyOVkw3-adlfYuQlpWHu8Iozze4ftnSl7AljiktQlEIIFJUaOO3_6IG4U4o-diAvvVv80Fc2lXJUGKOpOhmUVotFG_5_Akriq6j-4Oz1v6g/s89/2020-07-02%2B19_39_54-Window.png)

When we check the desktop shortcut we can see that a command is used to start the game via the GOG Galaxy client:

**"C:\Program Files (x86)\GOG Galaxy\GalaxyClient.exe" /command=runGame /gameId=1207659693 /path="C:\Program Files (x86)\GOG Galaxy\Games\Stargunner"**
This command tells GC to start the game with id 1207659693 which is "Stargunner" in this case. This ID can also be found in the file "C:\ProgramData\GOG.com\Galaxy\storage\etags-updater.db" which can be read with tools like SQLite Browser. So all what the attacker now has to do is run the command **"C:\Program Files (x86)\GOG Galaxy\GalaxyClient.exe" /command=runGame /gameId=1207659693"** (path is not needed) to execute the evil version of DOSBox. Running the command instead of hoping that the user clicks "Play" has the advantage that it can be used even if GC is not running. After executing the command GC will start and tell the service to execute evil DOSBox. No UAC prompt is shown and the evil version of DOSBox is executed elevated.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiOvt_jSaFFYC48spDG3s4wL4fGST2HSl0s7bdnnVi72yzz_NBxOXUqa558-R-j260QtjyaClf6ooDUwy1-4JJqBPsMeCs7a5MFghtrYbKjZp6EeAXCm49f7TqujbNpWi1WDcbSkSu4eyQ/w781-h235/2020-07-02+19_51_29-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiOvt_jSaFFYC48spDG3s4wL4fGST2HSl0s7bdnnVi72yzz_NBxOXUqa558-R-j260QtjyaClf6ooDUwy1-4JJqBPsMeCs7a5MFghtrYbKjZp6EeAXCm49f7TqujbNpWi1WDcbSkSu4eyQ/s2219/2020-07-02%2B19_51_29-Window.png)

An attacker can stop here because code has already been executed elevated but the attacker can also modify the registry autostart entry for GC

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjIrbBOxxSuuEZJd7V8uYws1bJjctmfHRaufAlSzPxcf1nraNfhXPkYSCI39iRVkH8xs7nGoCQDW9dp7D0foQdKPaCnys5ctv5YGyDTO7NTNnj5IFoOqSwj71IfW9YpOQflWvNrqk3Ejss/w625-h263/2020-07-02+19_55_36-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjIrbBOxxSuuEZJd7V8uYws1bJjctmfHRaufAlSzPxcf1nraNfhXPkYSCI39iRVkH8xs7nGoCQDW9dp7D0foQdKPaCnys5ctv5YGyDTO7NTNnj5IFoOqSwj71IfW9YpOQflWvNrqk3Ejss/s988/2020-07-02%2B19_55_36-Window.png)
The attacker now modifies this registry key to "C:\Program Files (x86)\GOG Galaxy\GalaxyClient.exe" /command=runGame /gameId=1207659693" to execute evil DOSBox at every user login:
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi4xRYLN1ivPokrV1FNzfRtgshaINAUsyDo_H87bUkh8j1NtGaXIe0Z3TOqXxvWxFhYMNOObYO-JBtD7IWKriZsSKuxghk-rVjCL9dZypdoNFk4gtJQz2xLLn2B90JQMDJwU5d3sQioJPQ/w625-h220/2020-07-02+20_07_42-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi4xRYLN1ivPokrV1FNzfRtgshaINAUsyDo_H87bUkh8j1NtGaXIe0Z3TOqXxvWxFhYMNOObYO-JBtD7IWKriZsSKuxghk-rVjCL9dZypdoNFk4gtJQz2xLLn2B90JQMDJwU5d3sQioJPQ/s1264/2020-07-02%2B20_07_42-Window.png)

**2. Evil Uninstall**This method can also be used to place a malicious uninstaller. An attack can look like this:
The local attacker replaces the uninstaller in a game folder:
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg2GP1YmGhdHE_P9g_PP2mi7Ib9QBhn4C-X5auMBoIwFr1JczwYUuSMcZBf8PL3i92uwgD6ss6CQ_gnkjdeie7ssgEJTCl8X9jTJeMmTpH0Mv0JnE7MhH1MVDb-2RgDWED5e9wmuW1cEUA/w500-h385/2020-07-02+21_54_34-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg2GP1YmGhdHE_P9g_PP2mi7Ib9QBhn4C-X5auMBoIwFr1JczwYUuSMcZBf8PL3i92uwgD6ss6CQ_gnkjdeie7ssgEJTCl8X9jTJeMmTpH0Mv0JnE7MhH1MVDb-2RgDWED5e9wmuW1cEUA/s822/2020-07-02%2B21_54_34-Window.png)

When the user uninstalls the game...

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjl6Jwhy4zsSO9W2daxjTOh4oR4_WAQJAi5NsZHF3wI0hfjEqNUjdrNfi2YbcpDG90VbeHrANJWV4tUgI-d1EETdpSXsXCckQCqghPyEmcwKcsH-ntQWGAKesTtN9gfb_4_Bbys7BYsOa0/w625-h376/2020-07-02+22_02_12-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjl6Jwhy4zsSO9W2daxjTOh4oR4_WAQJAi5NsZHF3wI0hfjEqNUjdrNfi2YbcpDG90VbeHrANJWV4tUgI-d1EETdpSXsXCckQCqghPyEmcwKcsH-ntQWGAKesTtN9gfb_4_Bbys7BYsOa0/s1438/2020-07-02%2B22_02_12-Window.png)

... the malicious uninstaller will be executed elevated without a UAC prompt:
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh5XweSasFnItFo0xFSgIaOPOhYvBRJjfGB_wUUVAZPtZwz1S5kXSnc-eSHRaxVnpk9hHN63N-wAJFxRtuy3Z-Qo2kB1uRs508_RC2LwSU2vHms7OXRzN3DQwySCzCIlVBzAsxZJQyAnVA/w625-h391/2020-07-02+22_03_29-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh5XweSasFnItFo0xFSgIaOPOhYvBRJjfGB_wUUVAZPtZwz1S5kXSnc-eSHRaxVnpk9hHN63N-wAJFxRtuy3Z-Qo2kB1uRs508_RC2LwSU2vHms7OXRzN3DQwySCzCIlVBzAsxZJQyAnVA/s960/2020-07-02%2B22_03_29-Window.png)

**3. Evil Repair**As described at the beginning of this post the file "scriptinterpreter.exe" was created during the installation. This file can be modified by regular users. But it can not just be replaced with a malicious one. When this file is executed via the "GalaxyClientService" service it is downloaded and overwritten every time. However also this can be bypassed to run a malicous version. This has the advantage (compared to "Evil Game") that the game will still run as expected. It can be exploited in the following way:
The attacker damages the game by deleting one (or more) game files. In the case of "Stargunner" I deleted the main executable "STARGUN.EXE" so the game will not work anymore and DOSBox will close directly after one second. The easiest and also most common way of fixing this running the "Verify/Repair" option in GC:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiU7tObk9xRDA3AwGHVz9SfFF6NfFpk5_sg2cC5rVz9_5uDE8RP-FhSTrqg2SEk2u-qWRyAdHM5w-sNzMF1fiKq0Ryuzm-BzynODZNx-J2mGyIrg4S0-63aa7C_eHBn9ftM7ODFa1EfKUw/w625-h345/2020-07-02+20_23_11-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiU7tObk9xRDA3AwGHVz9SfFF6NfFpk5_sg2cC5rVz9_5uDE8RP-FhSTrqg2SEk2u-qWRyAdHM5w-sNzMF1fiKq0Ryuzm-BzynODZNx-J2mGyIrg4S0-63aa7C_eHBn9ftM7ODFa1EfKUw/s1150/2020-07-02%2B20_23_11-Window.png)

As mentioned earlier "scriptinterpreter.exe" is downloaded and recreated every time. So it can not just be replaced and the replaced file will be executed. However with the help of opportunistic locks (oplocks) the attacker can still replace it.
The attacker will set an oplock on "C:\Windows\SysWOW64\winsta.dll". When the user runs the "Verify/Repair" option the oplock will be triggered and the attacker can replace "scriptinterpreter.exe" with a malicious one:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgcXW4oLmhxouoP9VtteBlzQv-9U2_xhD1fy4n5IzJ-mGChMYIsaUCcocvuCLjiWxznHNTRelCxAaomb7cQ9oFXzRG6oyXIOppv9iFYqMGjA7TNfiwFEOLkwzUL6ZflmAQcg_TahZ4qw4k/w625-h291/2020-07-02+21_02_36-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgcXW4oLmhxouoP9VtteBlzQv-9U2_xhD1fy4n5IzJ-mGChMYIsaUCcocvuCLjiWxznHNTRelCxAaomb7cQ9oFXzRG6oyXIOppv9iFYqMGjA7TNfiwFEOLkwzUL6ZflmAQcg_TahZ4qw4k/s1530/2020-07-02%2B21_02_36-Window.png)

Now the attacker releases the lock and "scriptinterpreter.exe" will be executed elevated:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjNwtKhvGixJ8q7klMpdSUWC_uKNE4KFZjvVY5QlqBFbzrOnP1Cl9y868mwBCsdN9q4c8lmdsF0Emsa7NkrgwGwkDlYXgtps2N6kxEnLv-ib0iGC5YzGSrMi2OFVKzypktYoBq7WNum7nA/w625-h385/2020-07-02+21_06_36-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjNwtKhvGixJ8q7klMpdSUWC_uKNE4KFZjvVY5QlqBFbzrOnP1Cl9y868mwBCsdN9q4c8lmdsF0Emsa7NkrgwGwkDlYXgtps2N6kxEnLv-ib0iGC5YzGSrMi2OFVKzypktYoBq7WNum7nA/s1033/2020-07-02%2B21_06_36-Window.png)

**4. Evil Install**The same method can also be used when games are installed: Attacker sets oplock; oplock gets triggered by game installation; once the oplock is triggered "C:\Program Files (x86)\GOG Galaxy\Dependencies\\_\_redist\ISI\scriptinterpreter.exe" will be replaced by a malicious one; once the oplock is released "scriptinterpreter.exe" will be executed elevated.

**5. Evil Service**
Last but not least: A local attacker can use of the methods described to gain elevated rights. After that the attacker replaces the "GalaxyCommunication" service executable ("C:\ProgramData\GOG.com\Galaxy\redists\GalaxyCommunication.exe") with a malicious one:
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi5ysR5J-gsIC14RBxl08nkdikHrZGJ4MWDMjHEKyT40H-xG6PbXedQ2aK-IapXNBWlkQkmIifBInfwTtCIHXrCWlVXjRpWEvIwkbn1kwD7V0XLpNpeOEMHmuzXw3D6NmdtHtWQXk3T85A/w625-h560/2020-07-02+22_26_27-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi5ysR5J-gsIC14RBxl08nkdikHrZGJ4MWDMjHEKyT40H-xG6PbXedQ2aK-IapXNBWlkQkmIifBInfwTtCIHXrCWlVXjRpWEvIwkbn1kwD7V0XLpNpeOEMHmuzXw3D6NmdtHtWQXk3T85A/s706/2020-07-02%2B22_26_27-Window.png)

Now the attacker only needs to start the service and the malicious "C:\ProgramData\GOG.com\Galaxy\redists\GalaxyCommunication.exe" will be executed as NT AUTHORITY\SYSTEM"
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgLZmBD1coXPVaA3XladrYuwNL2uy1hPyKW7w0QGPK5fde6OwnneH9Zroeac_2sZ9SMKT1gnIuzdqViASBwqvfIh7hKuf9t8hLPCE3EC7KloPHbsBRVx8cIssC01xYpRUTTL5B9sH1DUsM/w625-h399/2020-07-02+22_27_28-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgLZmBD1coXPVaA3XladrYuwNL2uy1hPyKW7w0QGPK5fde6OwnneH9Zroeac_2sZ9SMKT1gnIuzdqViASBwqvfIh7hKuf9t8hLPCE3EC7KloPHbsBRVx8cIssC01xYpRUTTL5B9sH1DUsM/s946/2020-07-02%2B22_27_28-Window.png)

**Personal Note:** I really like DRM free games. I also really like GOG (I bought many games at GOG)! I can fully understand that GOG also needs a game client to keep up with steam, origin and so on. But I haven´t found so many vulnerabilities in only one software so far! I really hope that GOG will fix these issues and will provide patches soon. However my experience when reporting vulnerabilities is: Company/Vendor says "there is no vulnerability" or "We are aware of this and don´t see an issue here" or "We will provide a patch if necessary" or they just don´t reply. Also only a few companies have a bug bounty program and if you submit a bug you get "we are aware of this because somebody already reported it" but you will never see a fix for the vulnerability instead they provide new "features". We are living in a crazy world...

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

### Popular Posts

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj0STecxFl9XczUVcqwLC2XB1MqaIJP6NhsLSrwr1QnG-8K2C_b1t8qywi1Q4nMx03gLu_Y1ou8Ocd4rg50c1QgIciMFI7xG4npnOhAzHMGWaBgjyWM_RXUgJTFDJyW4OPrYhyphenhyphen7iMnJ8ck/w625-h319/2020-07-02+13_42_45-Windows+PowerShell.png)](http://daniels-it-blog.blogspot.com/2020/07/steam-arbitrary-code-execution-part-2.html)

[July 02, 2020](http://daniels-it-blog.blogspot.com/2020/07/steam-arbitrary-code-execution-part-2.html "permanent link")

### [Steam - Escalation of Privileges](http://daniels-it-blog.blogspot.com/2020/07/steam-arbitrary-code-execution-part-2.html)

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[Powered by Blogger](https://www.blogger.com)

Theme images by [enot-poloskun](http://www.istockphoto.com/portfolio/enot-poloskun?platform=blogger)

[![My photo](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgeK_SG7N7IIvgs2eb-q-Pc3uN8LN78oNxZfiQPKL-1UMy130NvDDcqkSP30jV1cJZrW-uDPcglrt4RM_sfX9rEzO-909OEtkljjuGpnJLMzvAO9kVfUbLsvJDA0dS8/s113/anonymous.jpg)](https://www.blogger.com/profile/12332761312556315624)
[Daniel Gebert](https://www.blogger.com/profile/12332761312556315624)

[Visit profile](https://www.blogger.com/profile/12332761312556315624)

### Archive

* [2020
  11](http://daniels-it-blog.blogspot.com/2020/)

  + [August
    1](http://daniels-it-blog.blogspot.com/2020/08/)
  + [July
    6](http://daniels-it-blog.blogspot.com/2020/07/)

    - [UAC bypass via dll hijacking and mock directories](http://daniels-it-blog.blogspot.com/2020/07/uac-bypass-via-dll-hijacking-and-mock.html)
    - [IOBit Malware Fighter - Arbitrary Code Execution a...](http://daniels-it-blog.blogspot.com/2020/07/iobit-malware-fighter-arbitrary-code.html)
    - [Arbitrary File Delete via wsreset.exe // Bypass Ad...](http://daniels-it-blog.blogspot.com/2020/07/arbitrary-file-delete-via-wsresetexe.html)
    - [Software in the middle - Abusing legitimate Softwa...](http://daniels-it-blog.blogspot.com/2020/07/software-in-middle-abusing-legitimate.html)
    - [GOG Galaxy - Escalation of Privileges incl. Code E...](http://daniels-it-blog.blogspot.com/2020/07/gog-galaxy-escalation-of-privileges.html)
    - [Steam - Escalation of Privileges](http://daniels-it-blog.blogspot.com/2020/07/steam-arbitrary-code-execution-part-2.html)
  + [June
    3](http://daniels-it-blog.blogspot.com/2020/06/)
  + [May
    1](http://daniels-it-blog.blogspot.com/2020/05/)

### [Report Abuse](https://www.blogger.com/go/report-abuse)


