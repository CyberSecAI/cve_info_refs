Based on the provided information, here's an analysis of CVE-2020-17376:

**Root Cause of Vulnerability:**

The vulnerability stems from a failure in Nova, OpenStack's compute service, to update the persistent domain XML configuration during live migrations. Specifically, when a virtual machine (instance) is live-migrated, Nova doesn't provide the `VIR_MIGRATE_PARAM_PERSIST_XML` parameter to libvirt. This causes libvirt to retain the source host's persistent domain configuration. Consequently, a soft reboot of the migrated instance reverts to using the original, potentially incorrect, XML configuration from the source host.

**Weaknesses/Vulnerabilities Present:**

*   **Incomplete Migration Configuration:** Nova neglects to update the persistent domain XML during live migration, which results in the usage of stale configuration data.
*   **Soft Reboot Behavior:** Nova uses `virDomainShutdown` and `virDomainCreate` for soft reboots, which force libvirt to use the persistent domain configuration.
*   **Incorrect Device Mapping:** The lack of updated XML causes the virtual machine to use device paths (e.g., block device paths like /dev/dm-X) from the source host, which may not map to the same volumes on the destination host, possibly leading to access of a different Cinder volume.

**Impact of Exploitation:**

*   **Data Exfiltration/Corruption:** An attacker could potentially gain read and write access to a Cinder volume that they should not have access to, potentially belonging to another user (tenant). This could lead to data exfiltration or corruption of the other user's data.
*   **Access to Host Resources:** The incorrect mapping could lead to the attacker gaining access to other host resources, such as pass-through PCI devices like NICs or GPUs.
*   **Service Disruption:** Incorrect device mappings or CPU affinity settings may prevent the instance from starting, leading to a denial of service.

**Attack Vectors:**

*   The vulnerability is triggered when a user performs a soft reboot of an instance that has been live-migrated, and the system uses host-based connections for instance root or ephemeral devices (iSCSI or FC block devices presented as raw /dev/sd* devices).

**Required Attacker Capabilities/Position:**

*   The attacker needs access to an instance that has been previously live-migrated.
*   The attacker needs to be able to trigger a soft reboot of the migrated instance.
*   The underlying infrastructure must have configurations with host-based connections for instance volumes.
*   Live migration permissions may or may not be exposed to the user, this can change the attack scenario. If users have permissions to perform live migrations, they would have an easier time exploiting the vulnerability.

**Additional Details:**
*   The vulnerability exists because Nova did not provide the `VIR_MIGRATE_PARAM_PERSIST_XML` parameter during live migration. This parameter was introduced in libvirt v1.3.4.
*   The issue affects deployments using host-based connections for instance volumes, such as iSCSI and FC connected volumes using LVM or multipath, where the host device paths may differ between the source and destination hosts.

**Mitigation:**
*   Disable soft reboots in policy and only allow hard reboots, until the fix can be applied.
*   Perform a hard reboot on affected instances, as this will reset the persistent XML.
*   Operators can review instance action logs to identify instances that have undergone live migrations followed by a soft reboot, and initiate a hard reboot on them.

**Patches:**
Patches have been created to provide the VIR\_MIGRATE\_PARAM\_PERSIST\_XML parameter. They have been backported to multiple branches:
*  Pike: <https://review.opendev.org/747978>
*   Queens: <https://review.opendev.org/747976>
*   Rocky: <https://review.opendev.org/747975>
*   Stein: <https://review.opendev.org/747974>
*   Train: <https://review.opendev.org/747973>
*   Ussuri: <https://review.opendev.org/747972>
*   Victoria: <https://review.opendev.org/747969>