=== Content from wiki.untangle.com_998981b7_20250119_125617.html ===


# Main Page

From Edge Threat Management Wiki - Arista

[Jump to navigation](#column-one)[Jump to search](#searchInput)

| **Getting Started**   * [Deployment](https://edge.arista.com/untangle-ng-firewall/resources/how-to-deploy/) * [Hardware Requirements](/index.php?title=Hardware_Requirements "Hardware Requirements") * [Hardware Setup Guides](/index.php?title=Hardware_Setup_Guides "Hardware Setup Guides") * [Installation](/index.php?title=NG_Firewall_Installation "NG Firewall Installation") * [User Guide](/index.php?title=NG_Firewall_User_Guide "NG Firewall User Guide") * [Network Configuration](/index.php?title=Network_Configuration "Network Configuration")     **ETM Dashboard**   * [Log in / Create account](https://launchpad.edge.arista.com/) * [Documentation](https://support.edge.arista.com/hc/en-us/categories/115000711887)     **Micro Edge**   * [Micro Edge Downloads](https://edge.arista.com/cmd/download/sd-wan-router) * [Micro Edge Documentation](https://support.edge.arista.com/hc/en-us/categories/360001799354)     **Additional Resources**   * [NG Firewall Changelogs](/index.php?title=NG_Firewall_Changelogs "NG Firewall Changelogs") * [NG Firewall Downloads](https://edge.arista.com/cmd/download/ng-firewall) * [NG Firewall Terminology](/index.php?title=Glossary_of_Terms "Glossary of Terms") * [NG Firewall API Documentation](https://apidocs.edge.arista.com/) * [NG Firewall Performance Guide](/index.php?title=NG_Firewall_Performance_Guide "NG Firewall Performance Guide") * [NG Firewall Rule Syntax](/index.php?title=Untangle_Rule_Syntax "Untangle Rule Syntax") * [NG Firewall Subscription FAQ](/index.php?title=Purchasing_%26_Subscription_FAQs "Purchasing & Subscription FAQs") * [Forums](https://forums.edge.arista.com) * [Technical Support](https://support.edge.arista.com/hc/en-us/articles/360008238393-Contact-Us) | **NG Firewall User Guide Quicklinks**   | [Administration](/index.php?title=Administration_Interface "Administration Interface") | [Config](/index.php?title=Config "Config") | [Network](/index.php?title=Network "Network") | | --- | --- | --- | | * [Apps](/index.php?title=Applications "Applications") | * [About](/index.php?title=About "About") | * [Bypass Rules](/index.php?title=Bypass_Rules "Bypass Rules") | | * [Dashboard](/index.php?title=Dashboard "Dashboard") | * [Admin](/index.php?title=Admin "Admin") | * [DHCP Server](/index.php?title=DHCP_Server "DHCP Server") | | * [Devices](/index.php?title=Devices "Devices") | * [Certificates](/index.php?title=Certificates "Certificates") | * [DNS Server](/index.php?title=DNS_Server "DNS Server") | | * [Hosts](/index.php?title=Hosts "Hosts") | * [Events](/index.php?title=Events "Events") | * [Hostname](/index.php?title=Hostname "Hostname") | | * [Sessions](/index.php?title=Sessions "Sessions") | * [Local Directory](/index.php?title=Local_Directory "Local Directory") | * [Interfaces](/index.php?title=Interfaces "Interfaces") | | * [Users](/index.php?title=Users "Users") | * [System](/index.php?title=System "System") | * [NAT Rules](/index.php?title=NAT_Rules "NAT Rules") | |  | * [Upgrade](/index.php?title=Upgrade "Upgrade") | * [Port Forwarding](/index.php?title=Port_Forward_Rules "Port Forward Rules") | |  | * [Email](/index.php?title=Email "Email") | * [Troubleshooting](/index.php?title=Troubleshooting "Troubleshooting") |     **NG Firewall Application Quicklinks**   | Perform | Connect | Manage | | --- | --- | --- | | [Bandwidth Control](/index.php?title=Bandwidth_Control "Bandwidth Control") | [Captive Portal](/index.php?title=Captive_Portal "Captive Portal") | [Directory Connector](/index.php?title=Directory_Connector "Directory Connector") | | [WAN Balancer](/index.php?title=WAN_Balancer "WAN Balancer") | [IPsec VPN](/index.php?title=IPsec_VPN "IPsec VPN") | [Policy Manager](/index.php?title=Policy_Manager "Policy Manager") | | [WAN Failover](/index.php?title=WAN_Failover "WAN Failover") | [OpenVPN](/index.php?title=OpenVPN "OpenVPN") | [Reports](/index.php?title=Reports "Reports") | | [Web Cache](/index.php?title=Web_Cache "Web Cache") | [Tunnel VPN](/index.php?title=Tunnel_VPN "Tunnel VPN") |  | |  | [WireGuard VPN](/index.php?title=WireGuard_VPN "WireGuard VPN") |  | | Filter | Protect | Additional Apps | | [Ad Blocker](/index.php?title=Ad_Blocker "Ad Blocker") | [Firewall](/index.php?title=Firewall "Firewall") | [Branding Manager](/index.php?title=Branding_Manager "Branding Manager") | | [Application Control](/index.php?title=Application_Control "Application Control") | [Intrusion Prevention](/index.php?title=Intrusion_Prevention "Intrusion Prevention") | [Configuration Backup](/index.php?title=Configuration_Backup "Configuration Backup") | | [Application Control Lite](/index.php?title=Application_Control_Lite "Application Control Lite") | [Phish Blocker](/index.php?title=Phish_Blocker "Phish Blocker") | [Live Support](/index.php?title=Live_Support "Live Support") | | [Spam Blocker](/index.php?title=Spam_Blocker "Spam Blocker") | [Threat Prevention](/index.php?title=Threat_Prevention "Threat Prevention") |  | | [Spam Blocker Lite](/index.php?title=Spam_Blocker_Lite "Spam Blocker Lite") | [Virus Blocker](/index.php?title=Virus_Blocker "Virus Blocker") |  | | [SSL Inspector](/index.php?title=SSL_Inspector "SSL Inspector") | [Virus Blocker Lite](/index.php?title=Virus_Blocker_Lite "Virus Blocker Lite") |  | | [Web Filter](/index.php?title=Web_Filter "Web Filter") |  |  | | [Web Monitor](/index.php?title=Web_Monitor "Web Monitor") |  |  | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

Retrieved from "<https://wiki.edge.arista.com/index.php?title=Main_Page&oldid=28718>"

## Navigation menu

### Page actions

* [Main Page](/index.php?title=Main_Page "View the content page [c]")
* [Discussion](/index.php?title=Talk:Main_Page&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")
* [Read](/index.php?title=Main_Page)
* [View source](/index.php?title=Main_Page&action=edit "This page is protected.
  You can view its source [e]")
* [History](/index.php?title=Main_Page&action=history "Past revisions of this page [h]")

### Page actions

* [Main Page](/index.php?title=Main_Page "Main Page")
* [Discussion](/index.php?title=Talk:Main_Page&action=edit&redlink=1 " (page does not exist)")
* [More](#p-cactions)
* [Tools](#p-tb "Tools")

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=Main+Page "You are encouraged to log in; however, it is not mandatory [o]")

### Navigation

* [Main page](/index.php?title=Main_Page "Visit the main page [z]")
* [Recent changes](/index.php?title=Special:RecentChanges "A list of recent changes in the wiki [r]")
* [Random page](/index.php?title=Special:Random "Load a random page [x]")
* [Help about MediaWiki](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Help%3AContents)

### Search

### Tools

* [What links here](/index.php?title=Special:WhatLinksHere/Main_Page "A list of all wiki pages that link here [j]")
* [Related changes](/index.php?title=Special:RecentChangesLinked/Main_Page "Recent changes in pages linked from this page [k]")
* [Special pages](/index.php?title=Special:SpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=Main_Page&oldid=28718 "Permanent link to this revision of this page")
* [Page information](/index.php?title=Main_Page&action=info "More information about this page")

[![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)

* This page was last edited on 15 November 2024, at 20:15.
* [Privacy policy](/index.php?title=Edge_Threat_Management_Wiki_-_Arista:Privacy_policy)
* [About Edge Threat Management Wiki - Arista](/index.php?title=Edge_Threat_Management_Wiki_-_Arista:About)
* [Disclaimers](/index.php?title=Edge_Threat_Management_Wiki_-_Arista:General_disclaimer)



=== Content from pastebin.com_4c13acd8_20250119_125614.html ===


[Pastebin](/)
[API](/doc_api)
[tools](/tools)
[faq](/faq)

[paste](/)

[Login](/login)
[Sign up](/signup)

Advertisement

SHARE
TWEET

![harold_flood](/themes/pastebin/img/guest.png)
# CVE-2020-17494

[harold\_flood](/u/harold_flood)

Nov 10th, 2020
(edited)

5,847
0
Never
[Add comment](/login?return_url=%2Fs7UYG3vX%23add_comment)

**Not a member of Pastebin yet?**
[**Sign Up**](/signup),
it unlocks many cool features!

[text](/archive/text) 2.30 KB
| None
|
[0](/login?return_url=%2Fs7UYG3vX "Like") [0](/login?return_url=%2Fs7UYG3vX "Dislike")
[raw](/raw/s7UYG3vX)
[download](/dl/s7UYG3vX)
[clone](/clone/s7UYG3vX)
[embed](/embed/s7UYG3vX)
[print](/print/s7UYG3vX)
[report](/report/s7UYG3vX)

1. [CVEID]
2. CVE-2020-17494
3. ------------------------------------------
4. [Suggested description] [PROBLEM TYPE]
5. Untangle Firewall NG before 16.0 uses MD5 for passwords.
6. ------------------------------------------
8. [Additional Information] [DESCRIPTION]
9. Untangle Firewall NG stores passwords using the rather outdated and
10. cryptographically insecure MD5 hash algorithm. Untangle Firewall NG
11. default backup procedure is storing the configuration backup on a
12. passwordless zip on a google cloud account, on which the file with the
13. hash is present, allowing attackers who are able to compromise the
14. google cloud account to compromise the firewall through this
15. vulnerability. Furthermore, enabling firewall web control panel and
16. SSH connections even though is not default, is a option and can be
17. found through the internet.
19. ------------------------------------------
21. [VulnerabilityType Other]
22. Untangle Firewall NG stores passwords using the rather outdated and cryptographically insecure MD5 hash algorithm
24. ------------------------------------------
26. [Vendor of Product]
27. Untangle Firewall NG, https://www.untangle.com
29. ------------------------------------------
31. [Affected Product Code Base] [PRODUCT] [VERSION]
32. Untangle Firewall NG - < 16.0
34. ------------------------------------------
36. [Attack Type]
37. Remote
39. ------------------------------------------
41. [CVE Impact Other]
42. Admin access to the firewall web control panel and SSH
44. ------------------------------------------
46. [Attack Vectors]
47. Access to the default configuration backups of the firewall on a google cloud or local access to the hash.
48. https://github.com/untangle/ngfw\_src/blob/1d232efe2c17a8838b59bbbeaf166dafa94676af/uvm/hier/usr/share/untangle/web/auth/index.py
49. https://wiki.untangle.com/index.php/Configuration\_Backup
50. https://www.shodan.io/search?query=src%3D%22%2Fimages%2FBrandingLogo.png%22
51. https://www.untangle.com
53. ------------------------------------------
55. [Reference]
56. https://github.com/untangle/ngfw\_src/blob/1d232efe2c17a8838b59bbbeaf166dafa94676af/uvm/hier/usr/share/untangle/web/auth/index.py#L196-L200
57. https://github.com/untangle/ngfw\_src/search?q=author%3Abmastbergen+committer-date%3A2020-08-10&type=commits
58. https://pastebin.com/s7UYG3vX
60. ------------------------------------------
62. [Discoverer]
63. Harold Luiz Palazzini Cardozo

Advertisement

Add Comment
Please, [**Sign In**](/login?return_url=%2Fs7UYG3vX%23add_comment) to add comment

Advertisement

[Public Pastes](/archive)

* [Brazzers accounts](/04ygnMRV)
  JavaScript |
  1 sec ago
  | 0.09 KB
* [BTC ACCOUNTS HACKED](/tCNEFypt)
  JavaScript |
  1 sec ago
  | 0.09 KB
* [Chaturbate Accounts with Tokens](/QwMxdAU5)
  JavaScript |
  4 sec ago
  | 0.09 KB
* [Amazon Gift cards LEAKED](/YWF7s6Md)
  JavaScript |
  4 sec ago
  | 0.09 KB
* [⭐ get any gift card for FREE⭐ O4](/Lp6J5D8A)
  JavaScript |
  4 sec ago
  | 0.18 KB
* [⭐ FREE giftcards method 3K](/zZf3gLXy)
  JavaScript |
  5 sec ago
  | 0.18 KB
* [⭐ Binance Account hack GZ](/RefNm9B2)
  JavaScript |
  7 sec ago
  | 0.18 KB
* [NETFLIX UHD ACCOUNTS](/jxUvq28x)
  JavaScript |
  7 sec ago
  | 0.09 KB

Advertisement

[create new paste](/)  /
[syntax languages](/languages)  /
[archive](/archive)  /
[faq](/faq)  /
[tools](/tools)  /
[night mode](/night_mode)  /
[api](/doc_api)  /
[scraping api](/doc_scraping_api)  /
[news](/news)  /
[pro](/pro)

[privacy statement](/doc_privacy_statement)  /
[cookies policy](/doc_cookies_policy)  /
[terms of service](/doc_terms_of_service) /
[security disclosure](/doc_security_disclosure)  /
[dmca](/dmca)  /
[report abuse](/report-abuse)  /
[contact](/contact)

By using Pastebin.com you agree to our [cookies policy](/doc_cookies_policy) to enhance your experience.

Site design & logo © 2025 Pastebin

We use cookies for various purposes including analytics. By continuing to use Pastebin, you agree to our use of cookies as described in the [Cookies Policy](/doc_cookies_policy).  OK, I Understand

[![](/themes/pastebin/img/hello.webp)](/signup)

Not a member of Pastebin yet?



=== Content from github.com_0ec9ba1b_20250119_125614.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsearch%3Fq%3Drepo%253Auntangle%252Fngfw_src%2Bauthor%253Abmastbergen%2Bcommitter-date%253A2020-08-10%26type%3Dcommits)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

repo:untangle/ngfw\_src author:bmastbergen committer-date:2020-08-10

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsearch%3Fq%3Drepo%253Auntangle%252Fngfw_src%2Bauthor%253Abmastbergen%2Bcommitter-date%253A2020-08-10%26type%3Dcommits)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fsearch&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

# commits Search Results · repo:untangle/ngfw\_src author:bmastbergen committer-date:2020-08-10

## Filter by

* + [Code... (...)results](https://github.com/search?q=repo%3Auntangle%2Fngfw_src+author%3Abmastbergen+committer-date%3A2020-08-10&type=code)
  + [Issuesresults](https://github.com/search?q=repo%3Auntangle%2Fngfw_src+author%3Abmastbergen+committer-date%3A2020-08-10&type=issues)
  + [Pull requestsresults](https://github.com/search?q=repo%3Auntangle%2Fngfw_src+author%3Abmastbergen+committer-date%3A2020-08-10&type=pullrequests)
  + [Discussionsresults](https://github.com/search?q=repo%3Auntangle%2Fngfw_src+author%3Abmastbergen+committer-date%3A2020-08-10&type=discussions)
  + [Commitsresults](https://github.com/search?q=repo%3Auntangle%2Fngfw_src+author%3Abmastbergen+committer-date%3A2020-08-10&type=commits)
  + [Packagesresults](https://github.com/search?q=repo%3Auntangle%2Fngfw_src+author%3Abmastbergen+committer-date%3A2020-08-10&type=registrypackages)
  + [Wikisresults](https://github.com/search?q=repo%3Auntangle%2Fngfw_src+author%3Abmastbergen+committer-date%3A2020-08-10&type=wikis)
* [Advanced search](https://github.com/search/advanced)
Commits0 (0)0 results  (77 ms)
## 0 results

in[untangle/ngfw\_src (press backspace or delete to remove)](/untangle/ngfw_src)Sort by:  Best matchFilter![Mona looking through a globe hologram for code](/images/modules/search/light.png)
### Your search did not match any commits

Try one of the tips below to find more commits

See DetailsSearch across repositoriesSee DetailsSearch across an organizationSee DetailsSaved searchesYou could try an [advanced search](/search/advanced?q=repo%3Auntangle%2Fngfw_src+author%3Abmastbergen+committer-date%3A2020-08-10).

You can’t perform that action at this time.



=== Content from github.com_cf5d59ad_20250119_125613.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Funtangle%2Fngfw_src%2Fblob%2F1d232efe2c17a8838b59bbbeaf166dafa94676af%2Fuvm%2Fhier%2Fusr%2Fshare%2Funtangle%2Fweb%2Fauth%2Findex.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Funtangle%2Fngfw_src%2Fblob%2F1d232efe2c17a8838b59bbbeaf166dafa94676af%2Fuvm%2Fhier%2Fusr%2Fshare%2Funtangle%2Fweb%2Fauth%2Findex.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=untangle%2Fngfw_src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[untangle](/untangle)
/
**[ngfw\_src](/untangle/ngfw_src)**
Public

* [Notifications](/login?return_to=%2Funtangle%2Fngfw_src) You must be signed in to change notification settings
* [Fork
  22](/login?return_to=%2Funtangle%2Fngfw_src)
* [Star
   23](/login?return_to=%2Funtangle%2Fngfw_src)

* [Code](/untangle/ngfw_src)
* [Issues
  0](/untangle/ngfw_src/issues)
* [Pull requests
  7](/untangle/ngfw_src/pulls)
* [Projects
  0](/untangle/ngfw_src/projects)
* [Security](/untangle/ngfw_src/security)
* [Insights](/untangle/ngfw_src/pulse)

Additional navigation options

* [Code](/untangle/ngfw_src)
* [Issues](/untangle/ngfw_src/issues)
* [Pull requests](/untangle/ngfw_src/pulls)
* [Projects](/untangle/ngfw_src/projects)
* [Security](/untangle/ngfw_src/security)
* [Insights](/untangle/ngfw_src/pulse)

## Files

 1d232ef
## Breadcrumbs

1. [ngfw\_src](/untangle/ngfw_src/tree/1d232efe2c17a8838b59bbbeaf166dafa94676af)
2. /[uvm](/untangle/ngfw_src/tree/1d232efe2c17a8838b59bbbeaf166dafa94676af/uvm)
3. /[hier](/untangle/ngfw_src/tree/1d232efe2c17a8838b59bbbeaf166dafa94676af/uvm/hier)
4. /[usr](/untangle/ngfw_src/tree/1d232efe2c17a8838b59bbbeaf166dafa94676af/uvm/hier/usr)
5. /[share](/untangle/ngfw_src/tree/1d232efe2c17a8838b59bbbeaf166dafa94676af/uvm/hier/usr/share)
6. /[untangle](/untangle/ngfw_src/tree/1d232efe2c17a8838b59bbbeaf166dafa94676af/uvm/hier/usr/share/untangle)
7. /[web](/untangle/ngfw_src/tree/1d232efe2c17a8838b59bbbeaf166dafa94676af/uvm/hier/usr/share/untangle/web)
8. /[auth](/untangle/ngfw_src/tree/1d232efe2c17a8838b59bbbeaf166dafa94676af/uvm/hier/usr/share/untangle/web/auth)
/
# index.py

Copy path Blame  Blame
## Latest commit

## History

[History](/untangle/ngfw_src/commits/1d232efe2c17a8838b59bbbeaf166dafa94676af/uvm/hier/usr/share/untangle/web/auth/index.py)333 lines (284 loc) · 10.6 KB 1d232ef
## Breadcrumbs

1. [ngfw\_src](/untangle/ngfw_src/tree/1d232efe2c17a8838b59bbbeaf166dafa94676af)
2. /[uvm](/untangle/ngfw_src/tree/1d232efe2c17a8838b59bbbeaf166dafa94676af/uvm)
3. /[hier](/untangle/ngfw_src/tree/1d232efe2c17a8838b59bbbeaf166dafa94676af/uvm/hier)
4. /[usr](/untangle/ngfw_src/tree/1d232efe2c17a8838b59bbbeaf166dafa94676af/uvm/hier/usr)
5. /[share](/untangle/ngfw_src/tree/1d232efe2c17a8838b59bbbeaf166dafa94676af/uvm/hier/usr/share)
6. /[untangle](/untangle/ngfw_src/tree/1d232efe2c17a8838b59bbbeaf166dafa94676af/uvm/hier/usr/share/untangle)
7. /[web](/untangle/ngfw_src/tree/1d232efe2c17a8838b59bbbeaf166dafa94676af/uvm/hier/usr/share/untangle/web)
8. /[auth](/untangle/ngfw_src/tree/1d232efe2c17a8838b59bbbeaf166dafa94676af/uvm/hier/usr/share/untangle/web/auth)
/
# index.py

Top
## File metadata and controls

* Code
* Blame

333 lines (284 loc) · 10.6 KB[Raw](https://github.com/untangle/ngfw_src/raw/1d232efe2c17a8838b59bbbeaf166dafa94676af/uvm/hier/usr/share/untangle/web/auth/index.py)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332# $Id$import md5import cgiimport base64import sysimport reimport pycurlimport jsonfrom StringIO import StringIO
from mod\_python import apache, Session, util
if "@PREFIX@" != '': sys.path.insert(0, '@PREFIX@/usr/lib/python2.7/dist-packages')
import uvm\_login
def get\_app\_settings\_item(a,b): return Nonedef get\_uvm\_settings\_item(a,b): return None
try: from uvm.settings\_reader import get\_app\_settings\_item from uvm.settings\_reader import get\_uvm\_settings\_itemexcept ImportError: pass
# pages -----------------------------------------------------------------------
def login(req, url=None, realm='Administrator', token=None): uvm\_login.setup\_gettext()
 options = req.get\_options()
 args = util.parse\_qs(req.args or '')
 error\_msg = None if req.form.has\_key('username') or req.form.has\_key('password'): error\_msg = '%s' % cgi.escape(\_('Error: Username and Password do not match'))
 connection = req.connection (addr, port) = connection.local\_addr is\_local = re.match('127\.', connection.remote\_ip) if connection.remote\_ip == '::1': is\_local = True if port == 80 and not get\_uvm\_settings\_item('system','httpAdministrationAllowed') and not is\_local: write\_error\_page(req, "Permission denied") return
 if token != None and get\_uvm\_settings\_item('system','cloudEnabled'): if \_valid\_token(req, token): sess = Session.Session(req, lock=0) sess.lock() sess.set\_timeout(uvm\_login.SESSION\_TIMEOUT) uvm\_login.save\_session\_user(sess, realm, "token") sess.save() sess.unlock()
 if url == None: return apache.OK else: url = re.sub('[^A-Za-z0-9-\_/.#?=]','',url) # sanitize input if req.form.has\_key('fragment') and req.form['fragment'] != '': url = url + req.form['fragment'] util.redirect(req, url) return
 if req.form.has\_key('username') and req.form.has\_key('password'): username = req.form['username'] password = req.form['password'] # debug # req.log\_error("User:Pass = %s %s" % (username,password))
 if \_valid\_login(req, realm, username, password): sess = Session.Session(req, lock=0) sess.lock() sess.set\_timeout(uvm\_login.SESSION\_TIMEOUT) uvm\_login.save\_session\_user(sess, realm, username) sess.save() sess.unlock()
 if url == None: return apache.OK else: url = re.sub('[^A-Za-z0-9-\_/.#?=]','',url) # sanitize input if req.form.has\_key('fragment') and req.form['fragment'] != '': url = url + req.form['fragment'] util.redirect(req, url) return
 company\_name = uvm\_login.get\_company\_name() title = \_("Administrator Login") # some i18n company\_names cause exception here, so wrap to handle this # revert to "Administrator Login" if exception occurs try: title = cgi.escape(\_("%s Administrator Login") % company\_name) except: pass
 host = cgi.escape(req.hostname)
 \_write\_login\_form(req, title, host, error\_msg)
def logout(req, url=None, realm='Administrator'): sess = Session.Session(req, lock=0) sess.lock() sess.set\_timeout(uvm\_login.SESSION\_TIMEOUT) uvm\_login.delete\_session\_user(sess, realm) sess.save() sess.unlock()
 if url == None: return apache.OK else: url = re.sub('[^A-Za-z0-9-\_/.#?=]','',url) # sanitize input util.redirect(req, url) return
# internal methods ------------------------------------------------------------
def \_valid\_login(req, realm, username, password): if realm == 'Administrator': return \_admin\_valid\_login(req, realm, username, password) elif realm == 'Reports': if \_admin\_valid\_login(req, 'Administrator', username, password, False): return True; else: return \_reports\_valid\_login(req, realm, username, password) else: return False
def \_valid\_token(req, token): try: uid=None with open('/usr/share/untangle/conf/uid', 'r') as uidfile: uid=uidfile.read().replace('\n', '')
 buffer = StringIO() postdata = json.dumps({ "token": token, "resourceId": uid })
 curl = pycurl.Curl() curl.setopt( pycurl.POST, 1 ) curl.setopt( pycurl.POSTFIELDS, postdata ) curl.setopt( pycurl.NOSIGNAL, 1 ) curl.setopt( pycurl.CONNECTTIMEOUT, 30 ) curl.setopt( pycurl.TIMEOUT, 30 ) #curl.setopt( pycurl.URL, "http://54.152.2.165:1337/AuthenticationService/1/CheckTokenAccess") curl.setopt( pycurl.URL, "https://auth.untangle.com/v1/CheckTokenAccess") curl.setopt( pycurl.HTTPHEADER, ["Content-type: application/json", "Accept: application/json", "AuthRequest: 4E6FAB77-B2DF-4DEA-B6BD-2B434A3AE981"]) #curl.setopt( pycurl.VERBOSE, True ) curl.setopt( pycurl.WRITEDATA, buffer )
 curl.perform()
 body = buffer.getvalue() print(body) return (body == "true") except: return False
def \_reports\_valid\_login(req, realm, username, password, log=True): users = get\_app\_settings\_item('reports','reportsUsers') if users == None: return False; if users['list'] == None: return False; for user in users['list']: if user['emailAddress'] != username: continue; pw\_hash\_base64 = user['passwordHashBase64'] pw\_hash = base64.b64decode(pw\_hash\_base64) raw\_pw = pw\_hash[0:len(pw\_hash) - 8] salt = pw\_hash[len(pw\_hash) - 8:] if raw\_pw == md5.new(password + salt).digest(): if log: uvm\_login.log\_login(req, username, True, None) return True else: if log: uvm\_login.log\_login(req, username, False, 'P') return False if log: uvm\_login.log\_login(req, username, False, 'U') return False
def \_admin\_valid\_login(req, realm, username, password, log=True): users = get\_uvm\_settings\_item('admin','users') if users == None: return False; if users['list'] == None: return False; for user in users['list']: if user['username'] != username: continue; pw\_hash\_base64 = user['passwordHashBase64'] pw\_hash = base64.b64decode(pw\_hash\_base64) raw\_pw = pw\_hash[0:len(pw\_hash) - 8] salt = pw\_hash[len(pw\_hash) - 8:] if raw\_pw == md5.new(password + salt).digest(): if log: uvm\_login.log\_login(req, username, True, None) return True else: if log: uvm\_login.log\_login(req, username, False, 'P') return False if log: uvm\_login.log\_login(req, username, False, 'U') return False
def \_write\_login\_form(req, title, host, error\_msg): login\_url = cgi.escape(req.unparsed\_uri) req.content\_type = "text/html; charset=utf-8" req.send\_http\_header()
 if error\_msg == None: error\_msg = ''
 server\_str = cgi.escape(\_("Server:")) username\_str = cgi.escape(\_("Username:")) password\_str = cgi.escape(\_("Password:")) login\_str = cgi.escape(\_("Login"))
 if not type(title) is str: title = cgi.escape(title).encode("utf-8") if not type(host) is str: host = cgi.escape(host).encode("utf-8")
 try: default\_username = get\_uvm\_settings\_item('admin','defaultUsername') if default\_username == None: default\_username = "admin" else: default\_username = str(default\_username) except: default\_username = ""
 focus\_field\_id = "password" if default\_username == "": focus\_field\_id = "username"
 banner\_msg = get\_app\_settings\_item('branding-manager','bannerMessage') if banner\_msg != None and banner\_msg != "": banner\_msg = banner\_msg.replace("\n", "<br/>") banner\_msg = "<p>" + banner\_msg.encode('utf-8') + "</p>" else: banner\_msg = ""
 html = """\<!DOCTYPE html><html><head><meta name="viewport" content="initial-scale=1.0, width=device-width"><meta name="description" content="loginPage"><title>%s</title><script type="text/javascript">if (top.location!=location) top.location.href=document.location.href;</script><style type="text/css">/\* <![CDATA[ \*/@import url(/images/base.css);/\* ]]> \*/</style></head><body>
<header> <img src="/images/BrandingLogo.png" style="max-width: 150px; max-height: 140px;"></header>
<div class="form-login"> <form method="post" action="%s"> <h2>%s</h2> <p class="server">%s</p> <div class="banner">%s</div> <p class="error">%s</p> <input id="fragment" type="hidden" name="fragment" value=""/> <input id="username" type="text" name="username" value="%s" placeholder="%s"/> <input id="password" type="password" name="password" placeholder="%s"/> <button type="submit">%s</button> </form></div>
<script type="text/javascript">document.getElementById('%s').focus();</script><script type="text/javascript">document.getElementById('fragment').value=window.location.hash;</script>
</body></html>""" % (title, login\_url, title, host, banner\_msg, error\_msg, default\_username, username\_str, password\_str, login\_str, focus\_field\_id)
 req.write(html)
def write\_error\_page(req, msg): req.content\_type = "text/html; charset=utf-8" req.send\_http\_header()
 us = \_("Server") try: us = \_("%s Server") % get\_company\_name() except: pass
 if not type(us) is str: us = us.encode("utf-8") if not type(msg) is str: msg = msg.encode("utf-8")
 html = """\<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><title>%s</title><meta http-equiv=\"Content-Type\" content=\"text/html;charset=utf-8\" /><style type=\"text/css\">/\* <![CDATA[ \*/@import url(/images/base.css);/\* ]]> \*/</style></head><body><div id=\"main\" style=\"width:500px;margin:50px auto 0 auto;\"><div class=\"main-top-left\"></div><div class=\"main-top-right\"></div><div class=\"main-mid-left\"><div class=\"main-mid-right\"><div class=\"main-mid\"><center><img alt=\"\" src=\"/images/BrandingLogo.png\" style=\"max-width: 150px; max-height: 140px;\"/><br /><br /><b>%s</b><br /><br /><em>%s</em></center><br /><br /></div></div></div><div class=\"main-bot-left\"></div><div class=\"main-bot-right\"></div></div></body></html>""" % (us, us, cgi.escape(msg))
 req.write(html)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


