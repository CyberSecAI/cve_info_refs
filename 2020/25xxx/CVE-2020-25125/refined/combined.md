=== Content from www.openwall.com_54858181_20250119_122107.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](../../../2020/09/04/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <a0e32c22-02fa-b01a-f26f-ce68563d9f9c@suse.com>
Date: Thu, 3 Sep 2020 19:55:29 +0200
From: Wolfgang Frisch <wolfgang.frisch@...e.com>
To: oss-security@...ts.openwall.com
Subject: CVE-2020-25125: gnupg2: buffer overflow when importing a key with
 AEAD preferences

CVE-2020-25125 was assigned to the following issue in GnuPG:

> Importing an OpenPGP key having a preference list for AEAD algorithms
> will lead to an array overflow and thus often to a crash or other
> undefined behaviour.

> These versions are affected:
>
>  - GnuPG 2.2.21   (released 2020-07-09)
>  - GnuPG 2.2.22   (released 2020-08-27)
>  - Gpg4win 3.1.12 (released 2020-07-24)

<https://lists.gnupg.org/pipermail/gnupg-announce/2020q3/000448.html>

--
Wolfgang Frisch <wolfgang.frisch@...e.com>
Security Engineer
OpenPGP fingerprint: A2E6 B7D4 53E9 544F BC13  D26B D9B3 56BD 4D4A 2D15
SUSE Software Solutions Germany GmbH
Maxfeldstr. 5, 90409 Nuremberg, Germany
(HRB 36809, AG Nürnberg)
Managing Director: Felix Imendörffer

Download attachment "[signature.asc](5/1)" of type "application/pgp-signature" (834 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from dev.gnupg.org_78e7c407_20250119_122109.html ===
Page Menu[Home GnuPG](/)

* SearchConfigure Global Search

[Log In](/auth/start/?next=%2FT5050)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T5050
# AEAD preference list overflow in 2.2Closed, Resolved[Public](/policy/explain/PHID-TASK-4pgdz6el5syfmozeu56r/view/)Actions

* [Edit Task](/maniphest/task/edit/5050/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/edit/form/1/?parent=5050&template=5050&status=open)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-4pgdz6el5syfmozeu56r/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-4pgdz6el5syfmozeu56r/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-4pgdz6el5syfmozeu56r/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-4pgdz6el5syfmozeu56r/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-4pgdz6el5syfmozeu56r/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-4pgdz6el5syfmozeu56r/)
* [Edit Revisions](/search/rel/task.has-revision/PHID-TASK-4pgdz6el5syfmozeu56r/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-4pgdz6el5syfmozeu56r/)
* [Award Token](/token/give/PHID-TASK-4pgdz6el5syfmozeu56r/)

Assigned To

|  | [• werner](/p/werner/) |
| --- | --- |

Authored By

|  | [• werner](/p/werner/) |
| --- | --- |
| Sep 3 2020, 3:21 PM2020-09-03 15:21:12 (UTC+2) |

Tags

* [CVE](/tag/cve/) [(Backlog)](/project/board/116/)
* [gnupg (gpg22)](/tag/gpg22/) [(Backlog)](/project/board/61/)
Subscribers

|  | [• aheinecke](/p/aheinecke/) |
| --- | --- |

|  | [• werner](/p/werner/) |
| --- | --- |

# Description

Importing a key with AEAD preferences with GnuPG 2.2 can lead to an array overflow. This is not trivial to exploit because the attacker can control only each second byte with the first byte being fixed at 0x04. But it can be exploited.

Affected versions are GnuPG 2.2.21 and 2.2.22. GnuPG 2.3 and versions before 2.2.21 are not affected.

# Details

External Link <https://bugzilla.suse.com/show_bug.cgi?id=1176034#c5> Version 2.2.21 2.2.22
# Revisions and Commits

| [rG GnuPG](/source/gnupg/) | | | |
| --- | --- | --- | --- |
|  | rGaeb8272ca8aa [gpg: Fix AEAD preference list overflow](/rGaeb8272ca8aad403a4baac33b8d5673719cfd8f0) |

# Related Objects

* Mentions

Mentioned In [T5045: Release GnuPG 2.2.23](/T5045) Mentioned Here [T5045: Release GnuPG 2.2.23](/T5045)
### Event Timeline

[• werner](/p/werner/) created this task.[Sep 3 2020, 3:21 PM2020-09-03 15:21:12 (UTC+2)](#137251)[• werner](/p/werner/) created this object in space Restricted Space.[• werner](/p/werner/) added a comment.[Sep 3 2020, 5:20 PM2020-09-03 17:20:36 (UTC+2)](#137268)Comment Actions

The fix will be in the 2.2.23 release ([T5045](/T5045)).

[• werner](/p/werner/) added a commit: [rGaeb8272ca8aa: gpg: Fix AEAD preference list overflow](/rGaeb8272ca8aad403a4baac33b8d5673719cfd8f0).[Sep 3 2020, 5:54 PM2020-09-03 17:54:22 (UTC+2)](#137291)[• werner](/p/werner/) shifted this object from the Restricted Space space to the [S1 Public](/S1) space.[Sep 3 2020, 6:44 PM2020-09-03 18:44:12 (UTC+2)](#137292)[• werner](/p/werner/) mentioned this in [T5045: Release GnuPG 2.2.23](/T5045).[Sep 3 2020, 6:47 PM2020-09-03 18:47:57 (UTC+2)](#137297)Comment Actions

2.2.23 has been released and announced.

[• werner](/p/werner/) added a comment.[Sep 3 2020, 9:56 PM2020-09-03 21:56:52 (UTC+2)](#137302)Comment Actions

This has CVE-2020-25125

[• werner](/p/werner/) added a comment.[Sep 4 2020, 9:06 AM2020-09-04 09:06:23 (UTC+2)](#137307)Comment Actions

Small correction: The fixed byte I talked about may have the values 1, 2, 3, or 4.

[• werner](/p/werner/) closed this task as Resolved.[Sep 4 2020, 5:23 PM2020-09-04 17:23:02 (UTC+2)](#137313)Comment Actions

Gpg4win 3.113 has also been released. Thus closing this issue.

<https://lists.wald.intevation.org/pipermail/gpg4win-announce/2020-September/000089.html>

[Log In to Comment](/login/?next=)

=== Content from lists.gnupg.org_da49f2f7_20250119_140022.html ===

# [Announce] [security fix] GnuPG 2.2.23 released

**Werner Koch**
wk at gnupg.org

*Thu Sep 3 18:44:35 CEST 2020*

* Previous message (by thread): [[Announce] GnuPG 2.2.22 released](000447.html)
* **Messages sorted by:**
  [[ date ]](date.html#448)
  [[ thread ]](thread.html#448)
  [[ subject ]](subject.html#448)
  [[ author ]](author.html#448)

---

```
Hello!

We are pleased to announce the availability of a new GnuPG release:
version 2.2.23.  This version fixes a *critical security bug* in
versions 2.2.21 and 2.2.22.

Impact
======

These versions are affected:

 - GnuPG 2.2.21   (released 2020-07-09)
 - GnuPG 2.2.22   (released 2020-08-27)
 - Gpg4win 3.1.12 (released 2020-07-24)

All other versions are not affected.

Importing an OpenPGP key having a preference list for AEAD algorithms
will lead to an array overflow and thus often to a crash or other
undefined behaviour.

Importing an arbitrary key can often easily be triggered by an attacker
and thus triggering this bug.  Exploiting the bug aside from crashes is
not trivial but likely possible for a dedicated attacker.  The major
hurdle for an attacker is that only every second byte is under their
control with every first byte having a fixed value of 0x04.

Software distribution verification should not be affected by this bug
because such a system uses a curated list of keys.

A CVE-id has not yet been assigned.  We track this bug at
<https://dev.gnupg.org/T5050>

Solution
========

If GnuPG version 2.2.21 or 2.2.22 is in use please update ASAP to
version 2.2.23.

If you are using an older version or a beta of version 2.3 no immediate
action is required.

If you are using Gpg4win 3.1.12 or GnuPG VS-Desktop 3.1.12 you may
either wait for a fixed release which we will provide very soon or
install GnuPG version 2.2.23 on top.

If installation of a new version is not possible, applying the patch
<https://dev.gnupg.org/rGaeb8272ca8aad403a4baac33b8d5673719cfd8f0>
is also sufficient.

About GnuPG
===========

The GNU Privacy Guard (GnuPG, GPG) is a complete and free implementation
of the OpenPGP and S/MIME standards.

GnuPG allows to encrypt and sign data and communication, features a
versatile key management system as well as access modules for public key
directories.  GnuPG itself is a command line tool with features for easy
integration with other applications.  The separate library GPGME provides
a uniform API to use the GnuPG engine by software written in common
programming languages.  A wealth of frontend applications and libraries
making use of GnuPG are available.  As an universal crypto engine GnuPG
provides support for S/MIME and Secure Shell in addition to OpenPGP.

GnuPG is Free Software (meaning that it respects your freedom).  It can
be freely used, modified and distributed under the terms of the GNU
General Public License.

Noteworthy changes in version 2.2.23
====================================

  * gpg: Fix AEAD preference list overflow.  [#5050]

  * gpg: Fix a possible segv in the key cleaning code.

  * gpgsm: Fix a minor RFC2253 parser bug.  [#5037]

  * scdaemon: Fix a PIN verify failure on certain OpenPGP card
    implementations.  Regression in 2.2.22.  [#5039]

  * po: Fix bug in the Hungarian translation.  Updates for the Czech,
    Polish, and Ukrainian translations.

  Release-info: <https://dev.gnupg.org/T5045>

Getting the Software
====================

Please follow the instructions found at <<https://gnupg.org/download/>> or
read on:

GnuPG 2.2.23 may be downloaded from one of the GnuPG mirror sites or
direct from its primary FTP server.  The list of mirrors can be found at
<<https://gnupg.org/download/mirrors.html>>.  Note that GnuPG is not
available at ftp.gnu.org.

The GnuPG source code compressed using BZIP2 and its OpenPGP signature
are available here:

 <https://gnupg.org/ftp/gcrypt/gnupg/gnupg-2.2.23.tar.bz2> (6933k)
 <https://gnupg.org/ftp/gcrypt/gnupg/gnupg-2.2.23.tar.bz2.sig>

An installer for Windows without any graphical frontend except for a
very minimal Pinentry tool is available here:

 <https://gnupg.org/ftp/gcrypt/binary/gnupg-w32-2.2.23_20200903.exe> (4187k)
 <https://gnupg.org/ftp/gcrypt/binary/gnupg-w32-2.2.23_20200903.exe.sig>

The source used to build the Windows installer can be found in the same
directory with a ".tar.xz" suffix.

A new version of the GnuPG Desktop for Windows (aka Gpg4win) featuring
this version of GnuPG will be released shortly.

Checking the Integrity
======================

In order to check that the version of GnuPG which you are going to
install is an original and unmodified one, you can do it in one of
the following ways:

 * If you already have a version of GnuPG installed, you can simply
   verify the supplied signature.  For example to verify the signature
   of the file gnupg-2.2.23.tar.bz2 you would use this command:

     gpg --verify gnupg-2.2.23.tar.bz2.sig gnupg-2.2.23.tar.bz2

   This checks whether the signature file matches the source file.
   You should see a message indicating that the signature is good and
   made by one or more of the release signing keys.  Make sure that
   this is a valid key, either by matching the shown fingerprint
   against a trustworthy list of valid release signing keys or by
   checking that the key has been signed by trustworthy other keys.
   See the end of this mail for information on the signing keys.

 * If you are not able to use an existing version of GnuPG, you have
   to verify the SHA-1 checksum.  On Unix systems the command to do
   this is either "sha1sum" or "shasum".  Assuming you downloaded the
   file gnupg-2.2.23.tar.bz2, you run the command like this:

     sha1sum gnupg-2.2.23.tar.bz2

   and check that the output matches the next line:

bd949b4af7426e4afc13667d678503063c6aa4b5  gnupg-2.2.23.tar.bz2
c4435707bef33a612d54114f53837b19fcea38f5  gnupg-w32-2.2.23_20200903.tar.xz
489bc6de0a078248086f3214ca298dd6145ec497  gnupg-w32-2.2.23_20200903.exe

Internationalization
====================

This version of GnuPG has support for 26 languages with Chinese
(traditional and simplified), Czech, French, German, Japanese,
Norwegian, Polish, Russian, and Ukrainian being almost completely
translated.

Documentation and Support
=========================

If you used GnuPG in the past you should read the description of
changes and new features at doc/whats-new-in-2.1.txt or online at

  <https://gnupg.org/faq/whats-new-in-2.1.html>

The file gnupg.info has the complete reference manual of the system.
Separate man pages are included as well but they miss some of the
details available only in thee manual.  The manual is also available
online at

  <https://gnupg.org/documentation/manuals/gnupg/>

or can be downloaded as PDF at

  <https://gnupg.org/documentation/manuals/gnupg.pdf> .

You may also want to search the GnuPG mailing list archives or ask on
the gnupg-users mailing list for advise on how to solve problems.  Most
of the new features are around for several years and thus enough public
experience is available.  <https://wiki.gnupg.org> has user contributed
information around GnuPG and relate software.

In case of build problems specific to this release please first check
<https://dev.gnupg.org/T5045> for updated information.

Please consult the archive of the gnupg-users mailing list before
reporting a bug: <<https://gnupg.org/documentation/mailing-lists.html>>.
We suggest to send bug reports for a new release to this list in favor
of filing a bug at <<https://bugs.gnupg.org>>.  If you need commercial
support go to <<https://gnupg.com>> or <<https://gnupg.org/service.html>>.

If you are a developer and you need a certain feature for your project,
please do not hesitate to bring it to the gnupg-devel mailing list for
discussion.

Thanks
======

Since 2001 maintenance and development of GnuPG is done by g10 Code GmbH
and currently mostly financed by donations.  Two full-time employed
developers as well as two contractor exclusively work on GnuPG and
closely related software like Libgcrypt, GPGME and Gpg4win.

We like to thank all the nice people who are helping the GnuPG project,
be it testing, coding, translating, suggesting, auditing, administering
the servers, spreading the word, or answering questions on the mailing
lists.

Many thanks to our numerous financial supporters, both corporate and
individuals.  Without you it would not be possible to keep GnuPG in a
good and secure shape and to address all the small and larger requests
made by our users.  Thanks.

Special thanks to Andreas Stieger for reporting a bug and providing
detailed information for us to track this down.

Happy hacking,

   Your GnuPG hackers

p.s.
This is an announcement only mailing list.  Please send replies only to
the gnupg-users'at'gnupg.org mailing list.

p.p.s
List of Release Signing Keys:
To guarantee that a downloaded GnuPG version has not been tampered by
malicious entities we provide signature files for all tarballs and
binary versions.  The keys are also signed by the long term keys of
their respective owners.  Current releases are signed by one or more
of these four keys:

  rsa2048 2011-01-12 [expires: 2021-12-31]
  Key fingerprint = D869 2123 C406 5DEA 5E0F  3AB5 249B 39D2 4F25 E3B6
  Werner Koch (dist sig)

  rsa2048 2014-10-29 [expires: 2020-10-30]
  Key fingerprint = 031E C253 6E58 0D8E A286  A9F2 2071 B08A 33BD 3F06
  NIIBE Yutaka (GnuPG Release Key) <gniibe 'at' fsij.org>

  rsa3072 2017-03-17 [expires: 2027-03-15]
  Key fingerprint = 5B80 C575 4298 F0CB 55D8  ED6A BCEF 7E29 4B09 2E28
  Andre Heinecke (Release Signing Key)

  ed25519 2020-08-24 [expires: 2030-06-30]
  Key fingerprint = 6DAA 6E64 A76D 2840 571B  4902 5288 97B8 2640 3ADA
  Werner Koch (dist signing 2020)

The keys are available at <<https://gnupg.org/signature_key.html>> and
in any recently released GnuPG tarball in the file g10/distsigkey.gpg .
Note that this mail has been signed by a different key.

--
#  Please read:  Daniel Ellsberg - The Doomsday Machine  #
Die Gedanken sind frei.  Ausnahmen regelt ein Bundesgesetz.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 227 bytes
Desc: not available
URL: <<https://lists.gnupg.org/pipermail/gnupg-announce/attachments/20200903/b94811ad/attachment.sig>>

```

---

* Previous message (by thread): [[Announce] GnuPG 2.2.22 released](000447.html)
* **Messages sorted by:**
  [[ date ]](date.html#448)
  [[ thread ]](thread.html#448)
  [[ subject ]](subject.html#448)
  [[ author ]](author.html#448)

---

[More information about the Gnupg-announce
mailing list](http://lists.gnupg.org/mailman/listinfo/gnupg-announce)



=== Content from idp-portal.suse.com_6b95d262_20250119_140022.html ===

## UCS

# Welcome to Univention Corporate Server

## JavaScript required

A browser with JavaScript enabled is required in order to use this service.

When using Internet Explorer, please check your security settings and add this address to your trusted sites.



=== Content from bugzilla.opensuse.org_5994cbbb_20250119_122108.html ===


| Bugzilla – Bug 1176034 | VUL-0: CVE-2020-25125: gpg2: AEAD preference list overflow | Last modified: 2023-12-20 11:40:23 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi?classification=openSUSE)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [openSUSE\_IDP Log In](/saml2_login.cgi?idp=openSUSE_IDP&target=show_bug.cgi%3Fid%3D1176034)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 1176034**](show_bug.cgi?id=1176034)
(CVE-2020-25125)
- VUL-0: CVE-2020-25125: gpg2: AEAD preference list overflow

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: CVE-2020-25125: gpg2: AEAD preference list overflow

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2020-25125 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | openSUSE Tumbleweed | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | openSUSE | | [Component:](describecomponents.cgi?product=openSUSE Tumbleweed "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Security ([show other bugs](buglist.cgi?component=Security&product=openSUSE%20Tumbleweed&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | Current | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P1 - Urgent **Severity**: Critical ([vote](page.cgi?id=voting/user.html&bug_id=1176034#vote_1176034)) | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Pedro Monreal Gonzalez | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2020-09-01 21:38 UTC by Andreas Stieger | | --- | --- | | Modified: | 2023-12-20 11:40 UTC ([History](show_activity.cgi?id=1176034)) | | CC List: | 5 users (show)  meissner pmonrealgonzalez security-team wk wolfgang.frisch | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=1176034) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=1176034&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=1176034&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1176034#c0)  Andreas Stieger   2020-09-01 21:38:45 UTC  ``` Unable to import ed25519 key. It is partially imported but it's certificate/WOT is not verified. With the key in the keyring, verifying a signature made with this key fails.  An empty profile:  $ gpg --version -v gpg (GnuPG) 2.2.21 libgcrypt 1.8.6 Copyright (C) 2020 Free Software Foundation, Inc. License GPLv3+: GNU GPL version 3 or later <<https://gnu.org/licenses/gpl.html>> This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law.  Home: /home/[...]/.gnupg Supported algorithms: Pubkey: RSA, ELG, DSA, ECDH, ECDSA, EDDSA Cipher: IDEA, 3DES, CAST5, BLOWFISH, AES, AES192, AES256, TWOFISH,         CAMELLIA128, CAMELLIA192, CAMELLIA256 Hash: SHA1, RIPEMD160, SHA256, SHA384, SHA512, SHA224 Compression: Uncompressed, ZIP, ZLIB, BZIP2   From <https://www.gnupg.org/signature_key.html> fetch this key:  > pub   ed25519 2020-08-24 [expires: 2030-06-30] >       Key fingerprint = 6DAA 6E64 A76D 2840 571B  4902 5288 97B8 2640 3ADA > uid   Werner Koch (dist signing 2020)  $ gpg --import *.keyring gpg: /home/[...]/.gnupg/trustdb.gpg: trustdb created gpg: key 249B39D24F25E3B6: public key "Werner Koch (dist sig)" imported gpg: key 2071B08A33BD3F06: public key "NIIBE Yutaka (GnuPG Release Key) <gniibe@fsij.org>" imported gpg: key BCEF7E294B092E28: public key "Andre Heinecke (Release Signing Key)" imported free(): invalid pointer Aborted (core dumped)  Unable to list:  $ gpg --list-keys free(): invalid pointer Aborted (core dumped)  However it is locally stored:  $ gpg --armor --export 6DAA6E64A76D2840571B4902528897B826403ADA  -----BEGIN PGP PUBLIC KEY BLOCK-----  mDMEX0PliRYJKwYBBAHaRw8BAQdAz75Hlekc16JhhfI0MKdEVxLdkxhcMCO0ZG6W MBAmNpe0H1dlcm5lciBLb2NoIChkaXN0IHNpZ25pbmcgMjAyMCmImgQTFgoAQhYh BG2qbmSnbShAVxtJAlKIl7gmQDraBQJfQ+w1AhsDBQkShccRBQsJCAcCAyICAQYV CgkICwIEFgIDAQIeBwIXgAAKCRBSiJe4JkA62nmuAP9uL/HOdB0gvwWrH+FpURJL s4bnaZaPIk9ARrU0EXRgJgD/YCGfHQXpIPT0ZaXuwJexK04Z+qMFR/bM1q1Leo5C jgY= =ukul -----END PGP PUBLIC KEY BLOCK-----   $ gpg --armor --export 6DAA6E64A76D2840571B4902528897B826403ADA > gpg2.keyring $ osc service localrun source_validator gpg: assuming signed data in '/home/[...]/gpg2/gnupg-2.2.22.tar.bz2' gpg: Signature made Thu 27 Aug 2020 02:44:50 PM CEST gpg:                using EDDSA key 6DAA6E64A76D2840571B4902528897B826403ADA free(): invalid pointer /usr/lib/obs/service/source_validators/20-files-present-and-referenced: line 169: 11415 Aborted                 (core dumped) gpg $GPG_OPTIONS --verify "$i" (E) signature /home/[...]/gpg2/gnupg-2.2.22.tar.bz2.sig does not validate ``` [Comment 1](show_bug.cgi?id=1176034#c1)  Andreas Stieger   2020-09-01 22:53:07 UTC  ``` Base:System/gpg2 r247 2.2.20 good  Base:System/gpg2 r248 2.2.20 good  Base:System/gpg2 r250 2.2.21 bad <https://build.opensuse.org/request/show/819712> ``` [Comment 2](show_bug.cgi?id=1176034#c2)  Pedro Monreal Gonzalez   2020-09-02 10:30:04 UTC  ``` I don't get the crash but I can see an invalid read of size 1 with valgrind. I'll check its non of our patches before reporting upstream. ``` [Comment 3](show_bug.cgi?id=1176034#c3)  Pedro Monreal Gonzalez   2020-09-02 15:22:02 UTC  ``` Upstream confirmed. They will land a fix soon. ``` [Comment 4](show_bug.cgi?id=1176034#c4)  Pedro Monreal Gonzalez   2020-09-02 16:13:10 UTC  ``` Upstream fix: <https://dev.gnupg.org/rG8ec9573e57866dda5efb4677d4454161517484bc> ``` [Comment 5](show_bug.cgi?id=1176034#c5)  Andreas Stieger   2020-09-02 20:21:50 UTC  ``` Thank you for raising with upstream. I took the upstream commit and the issue remains in my form (comment #). I understand that you were unable to reproduce. We may be speaking about different issues.  adding some info below  openat(AT_FDCWD, "/home/[...]/.gnupg/pubring.kbx", O_RDONLY) = 5 lseek(5, 0, SEEK_CUR)                   = 0 fstat(5, {st_mode=S_IFREG|0644, st_size=3543, ...}) = 0 read(5, "\0\0\0 \1\1\0\2KBXf\0\0\0\0_O\374&_O\374&\0\0\0\0\0\0\0\0"..., 4096) = 3543 lseek(5, 0, SEEK_CUR)                   = 3543 lseek(5, 0, SEEK_CUR)                   = 3543 lseek(5, 0, SEEK_CUR)                   = 3543 lseek(5, 0, SEEK_CUR)                   = 3543 lseek(5, 0, SEEK_CUR)                   = 3543 writev(2, [{iov_base="free(): invalid pointer", iov_len=23}, {iov_base="\n", iov_len=1}], 2free(): invalid pointer ) = 24 mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fbff17ce000 rt_sigprocmask(SIG_UNBLOCK, [ABRT], NULL, 8) = 0 rt_sigprocmask(SIG_BLOCK, ~[RTMIN RT_1], [], 8) = 0 getpid()                                = 10090 gettid()                                = 10090 tgkill(10090, 10090, SIGABRT)           = 0 rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0 --- SIGABRT {si_signo=SIGABRT, si_code=SI_TKILL, si_pid=10090, si_uid=1000} --- +++ killed by SIGABRT (core dumped) +++ Aborted (core dumped)     $ gdb --quiet --args gpg --import *.keyring Reading symbols from gpg... Reading symbols from /usr/lib/debug/usr/bin/gpg2-2.2.22-269.1.x86_64.debug... (gdb) r Starting program: /usr/bin/gpg --import gpg2.keyring [Thread debugging using libthread_db enabled] Using host libthread_db library "/lib64/libthread_db.so.1". gpg: key 249B39D24F25E3B6: "Werner Koch (dist sig)" not changed gpg: key 2071B08A33BD3F06: "NIIBE Yutaka (GnuPG Release Key) <gniibe@fsij.org>" not changed gpg: key BCEF7E294B092E28: "Andre Heinecke (Release Signing Key)" not changed free(): invalid pointer  Program received signal SIGABRT, Aborted. __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:50 50	  return ret;     #0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:50 #1  0x00007ffff7acd539 in __GI_abort () at abort.c:79 #2  0x00007ffff7b27827 in __libc_message (action=action@entry=do_abort, fmt=fmt@entry=0x7ffff7c36e2d "%s\n")     at ../sysdeps/posix/libc_fatal.c:155 #3  0x00007ffff7b2eb2c in malloc_printerr (str=str@entry=0x7ffff7c3505c "free(): invalid pointer") at malloc.c:5347 #4  0x00007ffff7b30d76 in free_check (mem=0x55555566f360, caller=<optimized out>) at hooks.c:255 #5  0x00007ffff7d10f95 in ?? () from /usr/lib64/libgcrypt.so.20 #6  0x0000555555582ad3 in free_user_id (uid=0x55555566f160) at free-packet.c:326 #7  free_user_id (uid=0x55555566f160) at free-packet.c:316 #8  0x00005555555832d8 in free_packet (pkt=0x55555566d780, parsectx=0x0) at free-packet.c:468 #9  0x000055555558f87a in free_packet (parsectx=0x0, pkt=<optimized out>) at free-packet.c:416 #10 release_kbnode (n=0x55555566d7e0) at kbnode.c:120 #11 0x00005555555891bc in get_pubkey_byfprint (ctrl=ctrl@entry=0x555555667820, pk=pk@entry=0x0,      r_keyblock=r_keyblock@entry=0x0,      fprint=fprint@entry=0x7fffffffcd10 "m\252nd\247m(@W\033I\002R\210\227\270&@:\332\377\177",      fprint_len=fprint_len@entry=20) at getkey.c:1796 #12 0x00005555555893a7 in get_pubkey_byfprint (fprint_len=20,      fprint=0x7fffffffcd10 "m\252nd\247m(@W\033I\002R\210\227\270&@:\332\377\177", r_keyblock=0x0, pk=0x0,      ctrl=0x555555667820) at getkey.c:1767 #13 get_user_id_byfpr (ctrl=0x555555667820, fpr=0x7fffffffcd10 "m\252nd\247m(@W\033I\002R\210\227\270&@:\332\377\177",      rn=rn@entry=0x7fffffffcba0) at getkey.c:4085 #14 0x000055555558940f in get_user_id_byfpr_native (ctrl=<optimized out>, fpr=<optimized out>) at getkey.c:4098 #15 0x00005555555bdacb in import_one_real (ctrl=ctrl@entry=0x555555667820, keyblock=<optimized out>,      keyblock@entry=0x55555566d710, stats=stats@entry=0x5555556678a0, fpr=fpr@entry=0x0, fpr_len=fpr_len@entry=0x0,      options=options@entry=2048, from_sk=<optimized out>, silent=<optimized out>, screener=<optimized out>,      screener_arg=<optimized out>, origin=<optimized out>, url=<optimized out>, r_valid=<optimized out>) at import.c:2258 #16 0x00005555555bdfa9 in import_one (ctrl=ctrl@entry=0x555555667820, keyblock=0x55555566d710,      stats=stats@entry=0x5555556678a0, fpr=fpr@entry=0x0, fpr_len=fpr_len@entry=0x0, options=options@entry=2048, from_sk=0,      silent=0, screener=0x0, screener_arg=0x0, origin=0, url=0x0, r_valid=0x0) at import.c:2336 #17 0x00005555555bf76b in import (ctrl=ctrl@entry=0x555555667820, inp=inp@entry=0x555555667930,      fname=fname@entry=0x7fffffffe33b "gpg2.keyring", stats=stats@entry=0x5555556678a0, fpr=fpr@entry=0x0,      fpr_len=fpr_len@entry=0x0, options=<optimized out>, screener=<optimized out>, screener_arg=<optimized out>,      origin=<optimized out>, url=<optimized out>) at import.c:643 #18 0x00005555555c0e32 in import_keys_internal (ctrl=0x555555667820, inp=<optimized out>, fnames=0x7fffffffdec8,      nnames=<optimized out>, stats_handle=0x0, fpr=0x0, fpr_len=0x0, options=2048, screener=0x0, screener_arg=0x0, origin=0,      url=0x0) at import.c:539 #19 0x000055555556b955 in import_keys (stats_handle=0x0, url=<optimized out>, origin=<optimized out>,      options=<optimized out>, nnames=<optimized out>, fnames=<optimized out>, ctrl=0x555555667820) at import.c:575 #20 main (argc=<optimized out>, argv=<optimized out>) at gpg.c:4646 ``` [Comment 6](show_bug.cgi?id=1176034#c6)  Werner Koch   2020-09-03 14:16:58 UTC  ``` Thanks for the new info.  I am able to replicate the bug and preparing a new release. ``` [Comment 7](show_bug.cgi?id=1176034#c7)  Werner Koch   2020-09-03 17:15:19 UTC  ``` A new release is available.  See  <https://lists.gnupg.org/pipermail/gnupg-announce/2020q3/000448.html>  Our upstream bug is <https://dev.gnupg.org/T5050>  Thanks to everyone here for tracking down this brown paper bag bug of mine. ``` [Comment 8](show_bug.cgi?id=1176034#c8)  Andreas Stieger   2020-09-03 17:23:07 UTC  ``` From <https://dev.gnupg.org/T5050>  Importing a key with AEAD preferences with GnuPG 2.2 can lead to an array  overflow. This is not trivial to exploit because the attacker can control only  each second byte with the first byte being fixed at 0x04. But it can be  exploited.  Affected versions are GnuPG 2.2.21 and 2.2.22. GnuPG 2.3 and versions before  2.2.21 are not affected.  From <https://lists.gnupg.org/pipermail/gnupg-announce/2020q3/000448.html>  This version fixes a *critical security bug* in versions 2.2.21 and 2.2.22.  Importing an OpenPGP key having a preference list for AEAD algorithms will lead to an array overflow and thus often to a crash or other undefined behaviour.  Importing an arbitrary key can often easily be triggered by an attacker and thus triggering this bug.  Exploiting the bug aside from crashes is not trivial but likely possible for a dedicated attacker.  The major hurdle for an attacker is that only every second byte is under their control with every first byte having a fixed value of 0x04.  References: <https://dev.gnupg.org/T5050> <https://dev.gnupg.org/rGaeb8272ca8aad403a4baac33b8d5673719cfd8f0> ``` [Comment 9](show_bug.cgi?id=1176034#c9)  Andreas Stieger   2020-09-03 17:30:10 UTC  ``` <https://build.opensuse.org/request/show/831935> ``` [Comment 10](show_bug.cgi?id=1176034#c10)  OBSbugzilla Bot   2020-09-03 18:50:06 UTC  ``` This is an autogenerated message for OBS integration: This bug (1176034) was mentioned in <https://build.opensuse.org/request/show/831939> Factory / gpg2 ``` [Comment 11](show_bug.cgi?id=1176034#c11)  Andreas Stieger   2020-09-06 09:44:06 UTC  ``` will be in next snapshot ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=1176034)
* - [XML](show_bug.cgi?ctype=xml&id=1176034)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=1176034)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?classification=openSUSE)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [openSUSE\_IDP Log In](/saml2_login.cgi?idp=openSUSE_IDP&target=show_bug.cgi%3Fid%3D1176034)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from www.openwall.com_3ec8e589_20250119_122106.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20200903180936.GB16543@suse.de>
Date: Thu, 3 Sep 2020 20:09:36 +0200
From: Marcus Meissner <meissner@...e.de>
To: OSS Security List <oss-security@...ts.openwall.com>
Subject: GNUPG released with AEAD sec fix CVE-2020-25125

Hi,

gnupg just released a security fix update.

CVE-2020-25125

<https://lists.gnupg.org/pipermail/gnupg-announce/2020q3/000448.html>

...
Importing an OpenPGP key having a preference list for AEAD algorithms
will lead to an array overflow and thus often to a crash or other
undefined behaviour.

Importing an arbitrary key can often easily be triggered by an attacker
and thus triggering this bug.  Exploiting the bug aside from crashes is
not trivial but likely possible for a dedicated attacker.  The major
hurdle for an attacker is that only every second byte is under their
control with every first byte having a fixed value of 0x04.

Software distribution verification should not be affected by this bug
because such a system uses a curated list of keys.

A CVE-id has not yet been assigned.  We track this bug at
<https://dev.gnupg.org/T5050>
...

Ciao, Marcus

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from dev.gnupg.org_11657cc8_20250119_122109.html ===
[Home GnuPG](/)

* SearchConfigure Global Search

[Log In](/auth/start/?next=%2FrG8ec9573e57866dda5efb4677d4454161517484bc)

| Paths  * Table of Contentst  * Hide Panelf * Keyboard Reference? |  | [Diffusion](/diffusion/)  [GnuPG](/source/gnupg/repository/master/)  8ec9573e5786 gpg: Fix segv importing certain keys.[8ec9573e5786](/rG8ec9573e57866dda5efb4677d4454161517484bc)Actions  * [Edit Commit](/diffusion/commit/edit/59684/) * [Download Raw Diff](/rG8ec9573e57866dda5efb4677d4454161517484bc?diff=1) * Edit Related Objects... * [Edit Revisions](/search/rel/commit.has-revision/PHID-CMIT-hjccpzyjf6vwzxwu4fyx/) * [Edit Tasks](/search/rel/commit.has-task/PHID-CMIT-hjccpzyjf6vwzxwu4fyx/) * Subscribe * [Mute Notifications](/subscriptions/mute/PHID-CMIT-hjccpzyjf6vwzxwu4fyx/) * [Award Token](/token/give/PHID-CMIT-hjccpzyjf6vwzxwu4fyx/)  Tags*None*SubscribersNoneDescription gpg: Fix segv importing certain keys.  ``` * g10/key-check.c (key_check_all_keysigs): Initialize issuer. ```  from 2017   * Fixes-commit: [404fa8211b6188a0abe83ef43a4b44d528c0b035](/rG404fa8211b6188a0abe83ef43a4b44d528c0b035) * Signed-off-by: Werner Koch <wk@gnupg.org> DetailsProvenance   | [• werner](/p/werner/) | Authored on Sep 2 2020, 3:30 PM | | --- | --- |  Parents [rG497db0b5bcd6: keyboxd: Restructure client access code.](/rG497db0b5bcd688c4e2144ba167bd2ac485069d1b) Branches Unknown Tags Unknown Tasks [T5030: Release GnuPG 2.2.22](/T5030)  Event Timeline[• werner](/p/werner/) committed [rG8ec9573e5786: gpg: Fix segv importing certain keys.](/rG8ec9573e57866dda5efb4677d4454161517484bc) (authored by [• werner](/p/werner/)).[Sep 2 2020, 3:30 PM2020-09-02 15:30:44 (UTC+2)](#64496)[• werner](/p/werner/) added a comment.[Sep 2 2020, 4:10 PM2020-09-02 16:10:44 (UTC+2)](#64499)Comment Actions See <https://bugzilla.opensuse.org/show_bug.cgi?id=1176034> for the original bug report. I was not able to replicate the crash but the bad reads. The error is pretty obvious: The code expects that all fields are zeroed out. [• werner](/p/werner/) added a task: [T5030: Release GnuPG 2.2.22](/T5030) .[Sep 2 2020, 4:14 PM2020-09-02 16:14:02 (UTC+2)](#64503)[• werner](/p/werner/) mentioned this in [T5030: Release GnuPG 2.2.22](/T5030) .[Sep 2 2020, 4:16 PM2020-09-02 16:16:27 (UTC+2)](#64504)Changes (1)  |  | Path | Size | | --- | --- | --- | |  | |  | g10/ | | --- | --- | |  | |  | |  | [key-check.c](#change-WnF6g5ph7yNi) | | --- | --- | |  |  rG8ec9573e5786View Optionsg10/key-check.cLoading...[Log In to Comment](/login/?next=) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |


