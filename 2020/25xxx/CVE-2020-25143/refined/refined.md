```
{
  "vulnerability": {
    "root_cause": "The application is vulnerable to SQL Injection because it's possible to inject malicious SQL statements using malformed parameter types. Specifically, sending a parameter with the type 'Array' bypasses core SQL injection sanitization mechanisms.",
    "weaknesses": [
      "Improper input validation",
      "Insufficient sanitization of user-supplied input",
       "Use of a vulnerable SQL query"
    ],
    "impact": "Successful exploitation can lead to full database leaks, potentially including sensitive data such as authentication keys that could be used to bypass login processes without requiring usernames and clear text passwords.",
    "attack_vectors": "A remote authenticated attacker can send crafted HTTP GET requests with a malformed 'device_id[]' parameter.",
     "required_attacker_capabilities": "The attacker needs to be an authenticated user of the application. No specific system or network access is needed beyond being able to make HTTP requests to the webserver."
  },
  "additional_information": {
       "affected_components": "Ajax/device_entities",
       "affected_versions": "Professional, Enterprise & Community 20.8.10631",
        "vulnerability_type": "Union Based SQL Injection",
    "poc_details": "The vulnerability can be demonstrated by sending a GET request to '/ajax/device_entities.php' with a crafted array-type parameter 'device_id[]' that contains a SQL injection payload, such as:\n\n`GET /ajax/device_entities.php?entity_type=netscalervsvr&device_id[]=-1+union+select+version(),2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18 HTTP/1.1`",
       "relevant_code": "The vulnerable code is located in /var/opt/observium/html/ajax/device_entities.php:\n\n```php\n41 case \"netscalervsvr\":\n42 foreach (dbFetch(\"SELECT * FROM `netscaler_vservers` WHERE `device_id` = ?\", array($_GET['device_id'])) as $entity)\n43 {\n44 $string = addslashes($entity['vsvr_label']);\n45 echo(\"obj.options[obj.options.length] = new Option('\"".$string.\"','\"".$entity['vsvr_id'].\"');\\n\");\n46 }\n47 break;\n```\n\nSpecifically, the parameter $_GET['device_id'] is directly used in an SQL query without proper sanitization when sent as an array."
  },
    "references": [
    "https://www.owasp.org/index.php/OWASP_Proactive_Controls#2:_Parameterize_Queries",
    "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md",
    "https://www.owasp.org/index.php/Testing_for_SQL_Injection_(OTG-INPVAL-005)",
    "https://www.owasp.org/index.php/Testing_for_Command_Injection_(OTG-INPVAL-013)",
    "https://www.owasp.org/index.php/Testing_for_ORM_Injection_(OTG-INPVAL-007)",
    "https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Injection_Prevention_Cheat_Sheet.md",
     "https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.md",
     "https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Injection_Prevention_Cheat_Sheet_in_Java.md",
     "https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Query_Parameterization_Cheat_Sheet.md"
  ]
}
```