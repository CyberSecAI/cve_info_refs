This document describes multiple vulnerabilities, including CVE-2020-25095.

**CVE-2020-25095: Cross-Site WebSocket Hijacking (CSWH)**

*   **Root cause of vulnerability**: The LogRhythm Web Console does not validate the "Origin" header in cross-domain WebSocket initiation requests and lacks other CSRF protections (like unique CSRF tokens).
*   **Weaknesses/vulnerabilities present**:
    *   Lack of "Origin" header validation during WebSocket handshake.
    *   Missing CSRF protection mechanisms (e.g., CSRF tokens).
*  **Impact of exploitation**:
    *   An attacker can use a malicious website to initiate a WebSocket connection to the vulnerable LogRhythm Web Console through the victim's browser. This can bypass network segmentation as the victim's browser acts as a "pivot" into the otherwise protected network.
    *   This vulnerability can be chained with other vulnerabilities (CVE-2020-25094 and CVE-2020-25096) to achieve arbitrary remote code execution on all systems connected to the LogRhythm solution.
*   **Attack vectors**:
    *   A user logged into the vulnerable LogRhythm web console visits a malicious website.
    *   The malicious website sends a cross-domain request to initiate a WebSocket connection to the LogRhythm Web Console.
*   **Required attacker capabilities/position**:
    *   The attacker needs to host a malicious website.
    *   A legitimate user of the vulnerable LogRhythm Web Console must visit the malicious website while logged into the Web Console.

**Additional context from the document regarding related vulnerabilities**

*   **CVE-2020-25094: Command Injection**
    *   **Root cause**: LogRhythm uses PowerShell commands sent via WebSockets to execute SmartResponse actions on back-end agents, and these commands can be manipulated.
    *   **Weaknesses**: Lack of sanitization or proper validation of the commands sent to back-end agents via WebSockets, allowing injection of arbitrary code.
    *   **Impact**:  Remote code execution on the back-end server, but is limited to what the currently logged in user has access to.
    *   **Attack Vectors**: Intercept and manipulate WebSocket traffic to inject malicious PowerShell commands.
    *   **Attacker Capabilities**: A LogRhythm user with the ability to run SmartResponse commands.

*   **CVE-2020-25096: Incorrect Access Control**
    *   **Root cause**: Access controls are not enforced on WebSocket traffic.
    *   **Weaknesses**: Lack of proper authentication tokens in WebSocket requests, allowing access bypass.
    *   **Impact**: Any LogRhythm user can execute commands on any back-end agent, regardless of their assigned permissions.
    *   **Attack Vectors**: Altering a 4-digit parameter in WebSocket requests to target any agent.
    *   **Attacker Capabilities**: A LogRhythm user with minimal access.

*   **Insecure Default Configuration**:
    *   LogRhythm Smart Response agents by default run as "NT AUTHORITY\SYSTEM", the highest privileged Windows account, further increasing the impact of successful remote code execution.

The document details how the chaining of these vulnerabilities, including the Cross-Site WebSocket Hijacking (CSWH) vulnerability (CVE-2020-25095), allows an attacker to pivot from a malicious website through a legitimate user's browser, bypass network segmentation and gain arbitrary remote code execution with system privileges on all connected agent hosts.