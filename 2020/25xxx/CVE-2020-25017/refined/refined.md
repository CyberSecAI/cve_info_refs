```
{
  "CVE-2020-25017": {
    "description": "Envoy through 1.15.0 only considers the first value when multiple header values are present for some HTTP headers. Envoy’s setCopy() header map API does not replace all existing occurrences of a non-inline header.",
    "root_cause": "Envoy's HeaderMapImpl has two classes of headers, *inline* and *non-inline*. Inline headers treat headers with multiple inline values as a comma-delimited string. Non-inline headers have ordered multi-map semantics. Components that use the `get()` method only observe the first header value. Additionally, the `setCopy()` API in the header map implementation did not replace all occurrences of a header, only the first value, when used on non-inline headers.",
    "vulnerabilities": [
      "Incorrect handling of duplicate HTTP headers",
      "Inconsistency in header handling between Envoy's internal view and the view forwarded to upstreams",
	  "Incomplete replacement of headers using `setCopy()`"
    ],
    "impact": "An attacker can send requests with multiple values for a non-inline header. Envoy will only consider the first value for matching, filtering, and authorization decisions while forwarding all the provided values to the upstream server. This inconsistency could lead to bypassing security checks or misinterpreting the request at the upstream server.",
    "attack_vectors": "Attacker includes multiple values of \"reference\" headers (i.e. headers that Envoy has not explicitly listed as “inline”), e.g. `x-foo: bar` and `x-foo: baz`.",
    "attacker_capabilities": "Attacker can manipulate HTTP headers.",
    "affected_components": [
        "Request routing via header matching",
        "Access log filtering via header matching",
        "RBAC",
        "CEL matching",
        "ext_authz filter",
        "Header to metadata filter",
        "JWT filter",
        "Lua filter"
     ]
  }
}
```