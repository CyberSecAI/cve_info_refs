=== Content from github.com_94347cd5_20250119_114252.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frefi64%2FCVE-2020-25265-25266)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frefi64%2FCVE-2020-25265-25266)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=refi64%2FCVE-2020-25265-25266)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[refi64](/refi64)
/
**[CVE-2020-25265-25266](/refi64/CVE-2020-25265-25266)**
Public

* [Notifications](/login?return_to=%2Frefi64%2FCVE-2020-25265-25266) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2Frefi64%2FCVE-2020-25265-25266)
* [Star
   1](/login?return_to=%2Frefi64%2FCVE-2020-25265-25266)

[1
star](/refi64/CVE-2020-25265-25266/stargazers) [1
fork](/refi64/CVE-2020-25265-25266/forks) [Branches](/refi64/CVE-2020-25265-25266/branches) [Tags](/refi64/CVE-2020-25265-25266/tags) [Activity](/refi64/CVE-2020-25265-25266/activity)
 [Star](/login?return_to=%2Frefi64%2FCVE-2020-25265-25266)

 [Notifications](/login?return_to=%2Frefi64%2FCVE-2020-25265-25266) You must be signed in to change notification settings

* [Code](/refi64/CVE-2020-25265-25266)
* [Issues
  0](/refi64/CVE-2020-25265-25266/issues)
* [Pull requests
  0](/refi64/CVE-2020-25265-25266/pulls)
* [Actions](/refi64/CVE-2020-25265-25266/actions)
* [Projects
  0](/refi64/CVE-2020-25265-25266/projects)
* [Security](/refi64/CVE-2020-25265-25266/security)
* [Insights](/refi64/CVE-2020-25265-25266/pulse)

Additional navigation options

* [Code](/refi64/CVE-2020-25265-25266)
* [Issues](/refi64/CVE-2020-25265-25266/issues)
* [Pull requests](/refi64/CVE-2020-25265-25266/pulls)
* [Actions](/refi64/CVE-2020-25265-25266/actions)
* [Projects](/refi64/CVE-2020-25265-25266/projects)
* [Security](/refi64/CVE-2020-25265-25266/security)
* [Insights](/refi64/CVE-2020-25265-25266/pulse)

# refi64/CVE-2020-25265-25266

    main[Branches](/refi64/CVE-2020-25265-25266/branches)[Tags](/refi64/CVE-2020-25265-25266/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[3 Commits](/refi64/CVE-2020-25265-25266/commits/main/) | | |
| [.gitignore](/refi64/CVE-2020-25265-25266/blob/main/.gitignore ".gitignore") | | [.gitignore](/refi64/CVE-2020-25265-25266/blob/main/.gitignore ".gitignore") |  |  |
| [README.md](/refi64/CVE-2020-25265-25266/blob/main/README.md "README.md") | | [README.md](/refi64/CVE-2020-25265-25266/blob/main/README.md "README.md") |  |  |
| [nautilus.desktop](/refi64/CVE-2020-25265-25266/blob/main/nautilus.desktop "nautilus.desktop") | | [nautilus.desktop](/refi64/CVE-2020-25265-25266/blob/main/nautilus.desktop "nautilus.desktop") |  |  |
| [nautilus.svg](/refi64/CVE-2020-25265-25266/blob/main/nautilus.svg "nautilus.svg") | | [nautilus.svg](/refi64/CVE-2020-25265-25266/blob/main/nautilus.svg "nautilus.svg") |  |  |
| [payload.pas](/refi64/CVE-2020-25265-25266/blob/main/payload.pas "payload.pas") | | [payload.pas](/refi64/CVE-2020-25265-25266/blob/main/payload.pas "payload.pas") |  |  |
| [write\_mp3.dart](/refi64/CVE-2020-25265-25266/blob/main/write_mp3.dart "write_mp3.dart") | | [write\_mp3.dart](/refi64/CVE-2020-25265-25266/blob/main/write_mp3.dart "write_mp3.dart") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE-2020-25265 / CVE-2020-25266

* [CVE-2020-25265](https://nvd.nist.gov/vuln/detail/CVE-2020-25265)
* [CVE-2020-25266](https://nvd.nist.gov/vuln/detail/CVE-2020-25266)

This is a PoC exploit of libappimage and appimaged.

Using a combination of the two CVEs, one cancreate a file that does not appear to be an appimage
that is both implicitly picked up by appimaged and installed, overriding a system installed version
of the same application.

In this case, an MP3 file was used as the payload, and Nautilus was the application overridden.

## Affected versions

This affects all versions of appimaged and all libappimage versions older than 1.0.3.

## What happens

* The MP3 codec does not have a file header, thus media software must scan through the file looking for a frame header.
  This means that we can place the ELF and AppImage type 2 headers at the front of the file, and the MP3 will still be playable. This makes MP3 a prime target to use for this PoC.
* An MP3 file is modified to contain a payload binary after the playing media, with a Dart script being used to place the
  MP3 data in between the payload executable and the ELF header. (Note that I did not adjust the locations of symbols in
  the symbol table, as that would have taken more effort and was not needed for this PoC.) The payload binary is
  less than 1mb, thus it does not cause a noticeable increase in file size. At the very end of the file, a squashfs
  filesystem is appended, containing the fake Nautilus desktop file and icon.

  Note that, although adding the MP3 to the end of the squashfs would have technically worked, it has a higher chance of
  confusing media players due to appearing so late in the file, whereas right after the ELF header is only a few
  dozen bytes into the file.
* appimaged scans all files in all tracked directories, regardless of the file extension. When it picks up the MP3, it
  detects the ELF and AppImage headers, and proceeds to extract the desktop file within.
* The rogue desktop file is now written and points to the malicious MP3. When the user next runs Files, it will start the
  MP3's embedded ELF executable instead of the system installation.
* Normally, the desktop file would be named as "appimagekit\_...desktop", thus it would not be able to entirely override
  any system applications. However, Integrator.cpp in libappimage would grab the Name field without validation or
  escaping, thus we can add this to the rogue desktop file:

  ```
  Name=/../org.gnome.Nautilus
  Name[en]=Files
  ```

  and the file will be written to ~/.local/share/applications/org.gnome.Nautilus.desktop, thus masking the system-installed
  Nautilus.

## Mitigation

Make sure your installed libappimage version is at least 1.0.3, which fixes the `Name` field validation.
Notably, this does *not* include Debian's libappimage at this time, which is quite out of date.

All versions of appimaged are vulnerable, and [the project has been deprecated](https://github.com/AppImage/appimaged/commit/eeb739ef5ca05aa5faf6eec544d85c2df92e73e3).
[go-appimage](https://github.com/probonopd/go-appimage) avoids the filename issue by only picking up appimages named
`*.AppImage`. [AppImageLauncher](https://github.com/TheAssassin/AppImageLauncher) avoids the filename issue by
asking the user for permission to install before installation takes place.

## Testing

Place a random audio file in `audio.mp3` and run `dart bin/write_mp3.dart` to build the payload and write the
modified MP3 file. You need the Dart SDK and FreePascal installed for this to work.

## Implementation notes

Pascal was used for te binary because it produced the smallest statically linked ones of the other
languages tested (C statically linked using musl, Go) when using subprocess functionality.

In testing, `world.execute(me)` was used as the audio file, because it seemed fitting.

## About

No description, website, or topics provided.
### Resources

[Readme](#readme-ov-file)

[Activity](/refi64/CVE-2020-25265-25266/activity)
### Stars

[**1**
star](/refi64/CVE-2020-25265-25266/stargazers)
### Watchers

[**4**
watching](/refi64/CVE-2020-25265-25266/watchers)
### Forks

[**1**
fork](/refi64/CVE-2020-25265-25266/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Frefi64%2FCVE-2020-25265-25266&report=refi64+%28user%29)

## [Releases](/refi64/CVE-2020-25265-25266/releases)

No releases published

## [Packages 0](/users/refi64/packages?repo_name=CVE-2020-25265-25266)

No packages published

## Languages

* [Dart
  93.5%](/refi64/CVE-2020-25265-25266/search?l=dart)
* [Pascal
  6.5%](/refi64/CVE-2020-25265-25266/search?l=pascal)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


