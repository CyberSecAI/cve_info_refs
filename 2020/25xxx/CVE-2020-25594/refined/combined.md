=== Content from discuss.hashicorp.com_64b13d7e_20250119_115322.html ===


[HashiCorp Discuss](/)

# [HCSEC-2021-03 - Vault API Endpoint Allowed Enumeration of Secrets Engine Mount Paths Without Authentication](/t/hcsec-2021-03-vault-api-endpoint-allowed-enumeration-of-secrets-engine-mount-paths-without-authentication/20336)

[Security](/c/security/52)

[security-vault](https://discuss.hashicorp.com/tag/security-vault)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

January 29, 2021, 10:27pm

1

**Bulletin ID:** HCSEC-2021-03

**Affected Products / Versions:** Vault and Vault Enterprise, all prior versions; fixed in 1.6.2 & 1.5.7.

**Publication Date:** 29 January, 2021

**Summary**

Vault and Vault Enterprise (“Vault”) allowed the enumeration of Secrets Engine mount paths via unauthenticated HTTP requests. This vulnerability, CVE-2020-25594, was fixed in Vault 1.6.2 & 1.5.7.

**Background**

Vault operators are able to mount [Secrets Engines](https://www.vaultproject.io/docs/secrets) at customizable paths. Secrets engines are components which store, generate, or encrypt data.

**Details**

An external party reported that they were able to enumerate legitimate Secrets Engines mount paths by brute forcing Vault’s API with unauthenticated HTTP requests.

Note that knowledge of the existence of a Secrets Engine mount is not critical to the Vault security model, but this is considered unnecessary information disclosure.

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Vault or Vault Enterprise 1.6.2, 1.5.7 or newer. Please refer to [Upgrading Vault](https://www.vaultproject.io/docs/upgrading) for general guidance and version-specific upgrade notes.

**Acknowledgement**

This issue was identified by Toyota Connected who reported it to HashiCorp.

*We deeply appreciate any effort to discover and disclose security vulnerabilities responsibly. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [How can I list Secrets Engine through API](https://discuss.hashicorp.com/t/how-can-i-list-secrets-engine-through-api/39603)  [Vault](/c/vault/30) | 15 | 1622 | June 1, 2022 |
| [HCSEC-2021-33 - Vault’s KV Secrets Engine With Integrated Storage Exposed to Authenticated Denial of Service](https://discuss.hashicorp.com/t/hcsec-2021-33-vault-s-kv-secrets-engine-with-integrated-storage-exposed-to-authenticated-denial-of-service/33157)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7061 | December 14, 2021 |
| [HCSEC-2020-07 - Vault Enterprise Prefixed Mount Policies May Result In Unauthorized Namespace Access](https://discuss.hashicorp.com/t/hcsec-2020-07-vault-enterprise-prefixed-mount-policies-may-result-in-unauthorized-namespace-access/18090)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 4117 | November 25, 2020 |
| [HCSEC-2023-11 - Vault’s PKI Issuer Endpoint Did Not Correctly Authorize Access to Issuer Metadata](https://discuss.hashicorp.com/t/hcsec-2023-11-vault-s-pki-issuer-endpoint-did-not-correctly-authorize-access-to-issuer-metadata/52079)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 6250 | March 30, 2023 |
| [Capability to enable secret engine](https://discuss.hashicorp.com/t/capability-to-enable-secret-engine/19488)  [Vault](/c/vault/30) | 3 | 1057 | December 16, 2021 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled



=== Content from www.vaultproject.io_e32b4758_20250119_133859.html ===
[HashiTalks 2025 Learn about unique use cases, homelab setups, and best practices at scale at our 24-hour virtual knowledge sharing event. Register](https://hashi.co/hashitalks-2025)Dismiss alert

* Infrastructure Lifecycle Management
  + [TerraformManage infrastructure as code](/terraform)
  + [PackerBuild machine images](/packer)
  + [NomadOrchestrate workloads](/nomad)
  + [WaypointStandardize application patterns](/waypoint)
  + [VagrantBuild developer environments](/vagrant)
* Security Lifecycle Management
  + [VaultCentrally manage secrets](/vault)
  + [BoundarySecure remote access](/boundary)
  + [HCP Vault SecretsManage secrets as a service](/hcp/docs/vault-secrets)
  + [ConsulSecure network services](/consul)
  + [HCP Vault RadarScan for embedded secrets](/hcp/docs/vault-radar)
HashiCorp Cloud PlatformGet started in minutes with our cloud products[All HCP Products](/hcp)Learn

* [CertificationsGet HashiCorp certified](/certifications)
* [TutorialsLearn HashiCorp products](/tutorials)
* [Well-Architected FrameworkAdopt HashiCorp best practices](/well-architected-framework)
[Vault](/vault)

* [Install](/vault/install)
* [Tutorials](/vault/tutorials)
* [Documentation](/vault/docs)
* [API](/vault/api-docs)
* [Integrations](/vault/integrations)
* [Try Cloud](https://portal.cloud.hashicorp.com/sign-up)(opens in new tab)
SearchCommand or control keyK key

* Sign in
* [Sign up](/sign-up)
* ---
* Theme
[Vault Home](/vault)
## Documentation

* [Documentation](/vault/docs)
* [What is Vault?](/vault/docs/what-is-vault)
* [Use Cases](/vault/docs/use-cases)
* Get Started
* ---
* [Browser Support](/vault/docs/browser-support)
* Install Vault
* [Run Vault as a service](/vault/docs/run-as-service)
* Internals
* Concepts
* Configuration
* Vault CLI
* Vault GUI
* Vault tools: Agent and Proxy
* ---
* Secrets Engines
  + [Overview](/vault/docs/secrets)
  + Active Directory
  + [AliCloud](/vault/docs/secrets/alicloud)
  + [AWS](/vault/docs/secrets/aws)
  + [Azure](/vault/docs/secrets/azure)
  + [Consul](/vault/docs/secrets/consul)
  + [Cubbyhole](/vault/docs/secrets/cubbyhole)
  + Databases
  + [Google Cloud](/vault/docs/secrets/gcp)
  + [Google Cloud KMS](/vault/docs/secrets/gcpkms)
  + Identity
  + Key ManagementENTENT
  + Key/Value
  + [KMIPENTENT](/vault/docs/secrets/kmip)
  + [Kubernetes](/vault/docs/secrets/kubernetes)
  + [MongoDB Atlas](/vault/docs/secrets/mongodbatlas)
  + [Nomad](/vault/docs/secrets/nomad)
  + [LDAP](/vault/docs/secrets/ldap)
  + PKI (Certificates)
  + [RabbitMQ](/vault/docs/secrets/rabbitmq)
  + SSH
  + [HCP Terraform](/vault/docs/secrets/terraform)
  + [TOTP](/vault/docs/secrets/totp)
  + TransformENTENT
  + Transit
  + [Venafi (Certificates)](/vault/docs/secrets/venafi)
* Secrets SyncENTENT
* Secrets ImportENTENT
* Auth Methods
* Audit Devices
* Plugins
* [Vault Integration Program](/vault/docs/partnerships)
* [Vault interoperability matrix](/vault/docs/interoperability-matrix)
* Troubleshoot Vault
* ---
* Platforms
* ---
* Upgrade Guides
* ---
* Release Notes
* ---
* [Deprecation notices](/vault/docs/deprecation)
* ---
* FAQ
* ---
* [Glossary](/vault/docs/glossary)
* ---
* Vault Enterprise

---

* ### Resources
* [Tutorial Library](/tutorials/library?product=vault)
* [Certifications](/certifications/security-automation)
* [Community Forum](https://discuss.hashicorp.com/c/vault/30)(opens in new tab)
* [Support](https://www.hashicorp.com/customer-success)(opens in new tab)
* [GitHub](https://github.com/hashicorp/vault)(opens in new tab)

1. [Developer](/)
2. [Vault](/vault)
3. [Documentation](/vault/docs)
4. Secrets Engines
v1.18.x (latest)

* Vault
* [v1.17.x](/vault/docs/v1.17.x/secrets)
* [v1.16.x](/vault/docs/v1.16.x/secrets)
* [v1.15.x](/vault/docs/v1.15.x/secrets)
* [v1.14.x](/vault/docs/v1.14.x/secrets)
* [v1.13.x](/vault/docs/v1.13.x/secrets)
* [v1.12.x](/vault/docs/v1.12.x/secrets)
* [v1.11.x](/vault/docs/v1.11.x/secrets)
* [v1.10.x](/vault/docs/v1.10.x/secrets)
* [v1.9.x](/vault/docs/v1.9.x/secrets)
* [v1.8.x](/vault/docs/v1.8.x/secrets)
* [v1.7.x](/vault/docs/v1.7.x/secrets)
* [v1.6.x](/vault/docs/v1.6.x/secrets)
* [v1.5.x](/vault/docs/v1.5.x/secrets)
* [v1.4.x](/vault/docs/v1.4.x/secrets)
# Secrets engines

Secrets engines are components which store, generate, or encrypt data. Secrets
engines are incredibly flexible, so it is easiest to think about them in terms
of their function. Secrets engines are provided some set of data, they take some
action on that data, and they return a result.

Some secrets engines simply store and read data - like encrypted
Redis/Memcached. Other secrets engines connect to other services and generate
dynamic credentials on demand. Other secrets engines provide encryption as a
service, totp generation, certificates, and much more.

Secrets engines are enabled at a **path** in Vault. When a request comes to
Vault, the router automatically routes anything with the route prefix to the
secrets engine. In this way, each secrets engine defines its own paths and
properties. To the user, secrets engines behave similar to a virtual filesystem,
supporting operations like read, write, and delete.

## Secrets engines lifecycle

Most secrets engines can be enabled, disabled, tuned, and moved via the CLI or
API.

* [Enable](/vault/docs/commands/secrets/enable) - This enables a secrets engine at
  a given path. With a few exceptions, secrets engines can be enabled at multiple
  paths. Each secrets engine is isolated to its path. By default, they are
  enabled at their "type" (e.g. "aws" enables at `aws/`).

  **Case-sensitive:** The path where you enable secrets engines is case-sensitive. For
  example, the KV secrets engine enabled at `kv/` and `KV/` are treated as two
  distinct instances of KV secrets engine.
* [Disable](/vault/docs/commands/secrets/disable) - This disables an existing
  secrets engine. When a secrets engine is disabled, all of its secrets are
  revoked (if they support it), and all the data stored for that engine in
  the physical storage layer is deleted.
* [Move](/vault/docs/commands/secrets/move) - This moves the path for an existing
  secrets engine. This process revokes all secrets, since secret leases are tied
  to the path where they were created. The configuration data stored for the engine
  persists through the move.
* [Tune](/vault/docs/commands/secrets/tune) - This tunes global configuration for
  the secrets engine such as the TTLs.

Once a secrets engine is enabled, you can interact with it directly at its path
according to its own API. Use `vault path-help` to determine the paths it
responds to.

Note that mount points cannot conflict with each other in Vault. There are
two broad implications of this fact. The first is that you cannot have
a mount which is prefixed with an existing mount. The second is that you
cannot create a mount point that is named as a prefix of an existing mount.
As an example, the mounts `foo/bar` and `foo/baz` can peacefully coexist
with each other whereas `foo` and `foo/baz` cannot

## Barrier view

Secrets engines receive a *barrier view* to the configured Vault physical
storage. This is a lot like a [chroot](https://en.wikipedia.org/wiki/Chroot).

When a secrets engine is enabled, a random UUID is generated. This becomes the
data root for that engine. Whenever that engine writes to the physical storage
layer, it is prefixed with that UUID folder. Since the Vault storage layer
doesn't support relative access (such as `../`), this makes it impossible for an
enabled secrets engine to access other data.

This is an important security feature in Vault - even a malicious engine
cannot access the data from any other engine.

[Edit this page on GitHub](https://github.com/hashicorp/vault/blob/main/website/content/docs/secrets/index.mdx)

On this page:

1. [Secrets engines](/vault/docs/secrets#secrets-engines)
2. [Secrets engines lifecycle](/vault/docs/secrets#secrets-engines-lifecycle)
3. [Barrier view](/vault/docs/secrets#barrier-view)
Theme

* [Certifications](/certifications)
* [System Status](https://status.hashicorp.com)
* Cookie Manager
* [Terms of Use](https://www.hashicorp.com/terms-of-service)
* [Security](https://www.hashicorp.com/trust/security)
* [Privacy](https://www.hashicorp.com/privacy)
* [Trademark Policy](https://www.hashicorp.com/trademark-policy)
* [Trade Controls](https://www.hashicorp.com/trade-controls)
* [Accessibility](https://www.hashicorp.com/trust/accessibility)
* [Give Feedback](https://forms.gle/fnHLuNahLEhjuKvE6)(opens in new tab)


=== Content from security.gentoo.org_58090d82_20250119_115322.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# HashiCorp Vault: Multiple Vulnerabilities — GLSA **202207-01**

Multiple vulnerabilities have been discovered in HashiCorp Vault, the worst of which could result in denial of service.

### Affected packages

| Package | **app-admin/vault** on all architectures |
| --- | --- |
| Affected versions | < **1.10.3** |
| Unaffected versions | >= **1.10.3** |

### Background

HashiCorp Vault is a tool for managing secrets.

### Description

Multiple vulnerabilities have been discovered in HashiCorp Vault. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All HashiCorp Vault users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-admin/vault-1.10.3"

```
### References

* [CVE-2020-25594](https://nvd.nist.gov/vuln/detail/CVE-2020-25594)
* [CVE-2021-27668](https://nvd.nist.gov/vuln/detail/CVE-2021-27668)
* [CVE-2021-3024](https://nvd.nist.gov/vuln/detail/CVE-2021-3024)
* [CVE-2021-3282](https://nvd.nist.gov/vuln/detail/CVE-2021-3282)
* [CVE-2021-32923](https://nvd.nist.gov/vuln/detail/CVE-2021-32923)
* [CVE-2021-37219](https://nvd.nist.gov/vuln/detail/CVE-2021-37219)
* [CVE-2021-38553](https://nvd.nist.gov/vuln/detail/CVE-2021-38553)
* [CVE-2021-38554](https://nvd.nist.gov/vuln/detail/CVE-2021-38554)
* [CVE-2021-41802](https://nvd.nist.gov/vuln/detail/CVE-2021-41802)
* [CVE-2021-43998](https://nvd.nist.gov/vuln/detail/CVE-2021-43998)
* [CVE-2021-45042](https://nvd.nist.gov/vuln/detail/CVE-2021-45042)
* [CVE-2022-25243](https://nvd.nist.gov/vuln/detail/CVE-2022-25243)
* [CVE-2022-30689](https://nvd.nist.gov/vuln/detail/CVE-2022-30689)

**Release date**

July 29, 2022

**Latest revision**

July 29, 2022: 1

**Severity**

low

**Exploitable**

remote

**Bugzilla entries**

* [768312](https://bugs.gentoo.org/show_bug.cgi?id=768312)
* [797244](https://bugs.gentoo.org/show_bug.cgi?id=797244)
* [808093](https://bugs.gentoo.org/show_bug.cgi?id=808093)
* [817269](https://bugs.gentoo.org/show_bug.cgi?id=817269)
* [827945](https://bugs.gentoo.org/show_bug.cgi?id=827945)
* [829493](https://bugs.gentoo.org/show_bug.cgi?id=829493)
* [835070](https://bugs.gentoo.org/show_bug.cgi?id=835070)
* [845405](https://bugs.gentoo.org/show_bug.cgi?id=845405)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


