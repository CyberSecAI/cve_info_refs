=== Content from www.samba.org_cf18bc5e_20250119_141647.html ===

## CVE-2020-25717.html:

```

===========================================================
== Subject:     A user in an AD Domain could become root on
==              domain members
==
== CVE ID#:     CVE-2020-25717
==
== Versions:    All Samba versions since Samba 3.0
==
== Summary:     Samba may map domain users to local users
==              in an undesired way.
===========================================================

===========
Description
===========

Windows Active Directory (AD) domains have by default a feature to
allow users to create computer accounts, controlled by
ms-DS-MachineAccountQuota.

In addition some (presumably trusted) users have the right to create
new users or computers in both Samba and Windows Active Directory
Domains.

These features can be quite dangerous in the wrong hands, as the user
who creates such accounts has broad privileges to not just create them
and set their passwords, but to rename them at a later time with the
only contraint being they may not match an existing samAccountName in
AD.

When Samba as an AD Domain member accepts a Kerberos ticket, it must
map the information found therein to a local UNIX user-id (uid). This
is currently done via the account name in the Active Directory
generated Kerberos Privileged Attribute Certificate (PAC), or the
account name in the ticket (if there is no PAC).

For example, Samba will attempt to find a user "DOMAIN\user" before
falling back to trying to find the user "user".

If the DOMAIN\user lookup can be made to fail, then a privilege
escalation is possible.

The easiest example to illustrate this is if an attacker creates an
account named root (by renaming a MachineAccountQuota based machine
account), and asks for a login without a Kerberos PAC. Between
obtaining the ticket and presenting it to a server, the attacker
renames the user account to a different name. Samba attempts to look
up "DOMAIN\root", which fails (as this no longer exists) and then
falls back to looking up user "root", which will map to the privileged
UNIX uid of 0.

This patch changes Samba to require a PAC (in all scenarios related to
active directory domains) and use the SID and account name
values of the PAC, which means the combination represents the same point
in time. The processing is now similar to as with NTLM based logins.
The SID is unique and non-repeating and so can't be confused with another user.

Additionally, a new parameter has been added "min domain uid" (default
1000), and no matter how we obtain the UNIX uid to use in the process
token (we may eventually read /etc/passwd or similar), by default no
UNIX uid below this value will be accepted.

The patch also removes the fallback from 'DOMAIN\user' to just 'user',
as it dangerous and not needed when nss_winbind is used (even when
'winbind use default domain = yes' is set).

However there are setups which are joined to an active directory
domain just for authentication, but the authorization is handled
without nss_winbind by mapping the domain account to a local user
provided by nss_file, nss_ldap or something similar.

[Obsoleted 2021-11-16]
    NOTE: These setups won't work anymore without explicitly mapping the users!

    For these setups administrators need to use the 'username map' or
    'username map script' option in order to map domain users explicitly
    to local users, e.g.

      user = DOMAIN\user

    Please consult 'man 5 smb.conf' for further details on 'username
    map' or 'username map script'. Also note that in the above example '\'
    refers to the default value of the 'winbind separator' option.

[Added 2021-11-11]
  There's sadly a regression that "allow trusted domains = no"
  prevents winbindd from starting, fixes are available at
  https://bugzilla.samba.org/show_bug.cgi?id=14899

[Updated 2021-11-16]

  Please also notice the additional fix that obsoletes
  the above 'username map [script]' based fallback from
  'DOMAIN\user' to 'user'. See
  https://bugzilla.samba.org/show_bug.cgi?id=14901 and
  https://gitlab.com/samba-team/samba/-/merge_requests/2253

  It's possible have setups make use of 'idmap_nss' in order
  to provide a mapping from the domain account to a local user,
  often even without 'nss_winbindd'. Such setups should work again
  as before with the patches from bug 14901.
  But note the 'min domain uid' setting may still be required.

[Added 2021-12-08]
  There was also a regression for standalone setups, which
  accept authentication from an MIT Kerberos Realm.
  Fixes are available at https://bugzilla.samba.org/show_bug.cgi?id=14922

============
Beyond Samba
============

Samba is almost unique in the Linux/Unix landscape in that it can read
the PAC and make authorisation choices based on the SIDs in the PAC.

Administrators and those responsible for the deployment of other
applications that use Kerberos, and which can only rely on the "cname"
(client name) in the Kerberos ticket should take care not to map these
into the same namespace as system users.

NFS-Ganesha has a mode to map AD domain users via Samba's winbindd.
Use of this mode is encouraged, and (for all NFS servers in AD
domains) the default idmapd.conf "Method = nsswitch" is discouraged.

Likewise special care should be taken in the general configuration of
"auth_to_local" in a krb5.conf as might be used by other services.

==================
Patch Availability
==================

Patches addressing both these issues have been posted to:

    https://www.samba.org/samba/security/

Additionally, Samba 4.15.2, 4.14.10 and 4.13.14 have been issued
as security releases to correct the defect.  Samba administrators are
advised to upgrade to these releases or apply the patch as soon
as possible.

==================
CVSSv3 calculation
==================

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N (8.1)

==========
Workaround
==========

Setting "gensec:require_pac=true" in the smb.conf makes the
DOMAIN\user lookup succeed, due to a cache prime in winbind, provided
nss_winbind is in use and no error paths are hit.

It would be prudent to pre-create disabled users in Active Directory
matching on all privileged names not held in Active Directory, eg

 samba-tool user add root -H ldap://$SERVER -U$USERNAME%$PASSWORD --random-password
 samba-tool user add ubuntu -H ldap://$SERVER -U$USERNAME%$PASSWORD --random-password
 ...

(repeat for eg all system users under 1000 in /etc/passwd or special
 to any other AD-connected services, eg perhaps "admin" for a web-app)

Setting ms-DS-MachineAccountQuota to 0, in the Active Directory domain
is also advised, if possible.

The following settings might be additional mitigations (but they have
not been explicitly verified yet):

1. The use of the 'invalid users' option, note this needs to be
   specified in the [global] section, as well as every share with an
   existing 'invalid users' option, e.g.:

   invalid users = root, ubuntu

2. The usage of the "obey pam restrictions = yes" together with
   something like 'account required pam_succeed_if.so quiet uid >=
   1000' in the pam configuration for "samba", please consult 'man 8
   pam_succeed_if'.

=======
Credits
=======

Originally reported by Andrew Bartlett of Catalyst and the Samba Team.

Patches provided by:
 * Stefan Metzmacher of SerNet and the Samba Team
 * Samuel Cabrero of SuSE and the Samba Team
 * Joseph Sutton of Catalyst and the Samba Team
 * Alexander Bokovoy of Red Hat and the Samba Team
 * Ralph Boehme of SerNet and the Samba Team

Andrew wishes to give much thanks to NetSPI for the blog
"MachineAccountQuota is USEFUL Sometimes: Exploiting One of Active
Directory's Oddest Settings" by Kevin Robertson[1], on which the full
horror of MachineAccountQuota became clear.

[1] https://www.netspi.com/blog/technical/network-penetration-testing/machineaccountquota-is-useful-sometimes/

==========================================================
== Our Code, Our Bugs, Our Responsibility.
== The Samba Team
==========================================================

```



=== Content from access.redhat.com_e7ce22d2_20250119_141647.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from security.gentoo.org_d0636a05_20250119_124433.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Samba: Multiple Vulnerabilities — GLSA **202309-06**

Multiple vulnerabilities have been discovered in Samba, the worst of which could result in root remote code execution.

### Affected packages

| Package | **net-fs/samba** on all architectures |
| --- | --- |
| Affected versions | < **4.18.4** |
| Unaffected versions | >= **4.18.4** |

### Background

Samba is a suite of SMB and CIFS client/server programs.

### Description

Multiple vulnerabilities have been discovered in Samba. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Samba users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-fs/samba-4.18.4"

```
### References

* [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)
* [CVE-2016-2124](https://nvd.nist.gov/vuln/detail/CVE-2016-2124)
* [CVE-2020-17049](https://nvd.nist.gov/vuln/detail/CVE-2020-17049)
* [CVE-2020-25717](https://nvd.nist.gov/vuln/detail/CVE-2020-25717)
* [CVE-2020-25718](https://nvd.nist.gov/vuln/detail/CVE-2020-25718)
* [CVE-2020-25719](https://nvd.nist.gov/vuln/detail/CVE-2020-25719)
* [CVE-2020-25721](https://nvd.nist.gov/vuln/detail/CVE-2020-25721)
* [CVE-2020-25722](https://nvd.nist.gov/vuln/detail/CVE-2020-25722)
* [CVE-2021-3670](https://nvd.nist.gov/vuln/detail/CVE-2021-3670)
* [CVE-2021-3738](https://nvd.nist.gov/vuln/detail/CVE-2021-3738)
* [CVE-2021-20251](https://nvd.nist.gov/vuln/detail/CVE-2021-20251)
* [CVE-2021-20316](https://nvd.nist.gov/vuln/detail/CVE-2021-20316)
* [CVE-2021-23192](https://nvd.nist.gov/vuln/detail/CVE-2021-23192)
* [CVE-2021-44141](https://nvd.nist.gov/vuln/detail/CVE-2021-44141)
* [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)
* [CVE-2022-0336](https://nvd.nist.gov/vuln/detail/CVE-2022-0336)
* [CVE-2022-1615](https://nvd.nist.gov/vuln/detail/CVE-2022-1615)
* [CVE-2022-2031](https://nvd.nist.gov/vuln/detail/CVE-2022-2031)
* [CVE-2022-3437](https://nvd.nist.gov/vuln/detail/CVE-2022-3437)
* [CVE-2022-3592](https://nvd.nist.gov/vuln/detail/CVE-2022-3592)
* [CVE-2022-32742](https://nvd.nist.gov/vuln/detail/CVE-2022-32742)
* [CVE-2022-32743](https://nvd.nist.gov/vuln/detail/CVE-2022-32743)
* [CVE-2022-32744](https://nvd.nist.gov/vuln/detail/CVE-2022-32744)
* [CVE-2022-32745](https://nvd.nist.gov/vuln/detail/CVE-2022-32745)
* [CVE-2022-32746](https://nvd.nist.gov/vuln/detail/CVE-2022-32746)
* [CVE-2022-37966](https://nvd.nist.gov/vuln/detail/CVE-2022-37966)
* [CVE-2022-37967](https://nvd.nist.gov/vuln/detail/CVE-2022-37967)
* [CVE-2022-38023](https://nvd.nist.gov/vuln/detail/CVE-2022-38023)
* [CVE-2022-42898](https://nvd.nist.gov/vuln/detail/CVE-2022-42898)
* [CVE-2022-45141](https://nvd.nist.gov/vuln/detail/CVE-2022-45141)
* [CVE-2023-0225](https://nvd.nist.gov/vuln/detail/CVE-2023-0225)
* [CVE-2023-0614](https://nvd.nist.gov/vuln/detail/CVE-2023-0614)
* [CVE-2023-0922](https://nvd.nist.gov/vuln/detail/CVE-2023-0922)

**Release date**

September 17, 2023

**Latest revision**

September 17, 2023: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [820566](https://bugs.gentoo.org/show_bug.cgi?id=820566)
* [821688](https://bugs.gentoo.org/show_bug.cgi?id=821688)
* [830983](https://bugs.gentoo.org/show_bug.cgi?id=830983)
* [832433](https://bugs.gentoo.org/show_bug.cgi?id=832433)
* [861512](https://bugs.gentoo.org/show_bug.cgi?id=861512)
* [866225](https://bugs.gentoo.org/show_bug.cgi?id=866225)
* [869122](https://bugs.gentoo.org/show_bug.cgi?id=869122)
* [878273](https://bugs.gentoo.org/show_bug.cgi?id=878273)
* [880437](https://bugs.gentoo.org/show_bug.cgi?id=880437)
* [886153](https://bugs.gentoo.org/show_bug.cgi?id=886153)
* [903621](https://bugs.gentoo.org/show_bug.cgi?id=903621)
* [905320](https://bugs.gentoo.org/show_bug.cgi?id=905320)
* [910334](https://bugs.gentoo.org/show_bug.cgi?id=910334)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugzilla.redhat.com_3b567a0f_20250119_124433.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D2019672)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D2019672)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D2019672)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 2019672

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 2019672**](show_bug.cgi?id=2019672)
(CVE-2020-25717)
- [CVE-2020-25717](https://access.redhat.com/security/cve/CVE-2020-25717) samba: Active Directory (AD) domain user could become root on domain members

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2020-25717 samba: Active Directory (AD) domain user could become root on ...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2020-25717 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | high | | [Severity:](page.cgi?id=fields.html#bug_severity) | high | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [2019673](show_bug.cgi?id=2019673) [2019674](show_bug.cgi?id=2019674) [2019675](show_bug.cgi?id=2019675) [2020165](show_bug.cgi?id=2020165) [2021168](show_bug.cgi?id=2021168) [2021169](show_bug.cgi?id=2021169) [2021171](show_bug.cgi?id=2021171) [2021716](show_bug.cgi?id=2021716 "CLOSED ERRATA - CVE-2020-25717 samba: A user in an AD Domain could become root on domain members [fedora-all]") [2021720](show_bug.cgi?id=2021720 "CLOSED ERRATA - CVE-2020-25719 freeipa: samba: Samba AD DC did not always rely on the SID and PAC in Kerberos tickets [fedora-all]") [2021783](show_bug.cgi?id=2021783) [2021784](show_bug.cgi?id=2021784) [2027186](show_bug.cgi?id=2027186 "CLOSED DUPLICATE - CVE-2020-25717 freeipa: samba: A user in an AD Domain could become root on domain members [fedora-all]") [2048285](show_bug.cgi?id=2048285) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1976705](show_bug.cgi?id=1976705) [2022016](show_bug.cgi?id=2022016) | | TreeView+ | [depends on](buglist.cgi?bug_id=2019672&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=2019672&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2021-11-03 04:21 UTC by Huzaifa S. Sidhpurwala | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2022-05-17 09:59 UTC ([History](show_activity.cgi?id=2019672)) | | [CC List:](page.cgi?id=fields.html#cclist) | 31 users (show)  abokovoy anoopcs asn cn dkarpele ftrivino gdeschner hvyas iboukris ipa-maint jarrpa jcholast jhrozek jstephen lmohanty madam mhjacks michal.skrivanek mperina mvanderw nobody pfilipen puebele pvoborni rcritten rhs-smb sbonazzo sbose security-response-team ssorce twoerner | | Fixed In Version: | samba 4.15.2, samba 4.14.10, samba 4.13.14 | | | Doc Type: | If docs needed, set a value | | | Doc Text: | A flaw was found in the way Samba maps domain users to local users. An authenticated attacker could use this flaw to cause possible privilege escalation. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2021-11-29 13:09:43 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHBA-2022:0018](https://access.redhat.com/errata/RHBA-2022%3A0018) | 0 | None | None | None | 2022-01-05 10:32:50 UTC | | Red Hat Product Errata | [RHBA-2022:0019](https://access.redhat.com/errata/RHBA-2022%3A0019) | 0 | None | None | None | 2022-01-05 10:15:36 UTC | | Red Hat Product Errata | [RHBA-2022:0147](https://access.redhat.com/errata/RHBA-2022%3A0147) | 0 | None | None | None | 2022-01-17 14:11:20 UTC | | Red Hat Product Errata | [RHSA-2021:4843](https://access.redhat.com/errata/RHSA-2021%3A4843) | 0 | None | None | None | 2021-11-29 12:36:22 UTC | | Red Hat Product Errata | [RHSA-2021:4844](https://access.redhat.com/errata/RHSA-2021%3A4844) | 0 | None | None | None | 2021-11-29 12:36:12 UTC | | Red Hat Product Errata | [RHSA-2021:5082](https://access.redhat.com/errata/RHSA-2021%3A5082) | 0 | None | None | None | 2021-12-13 08:45:29 UTC | | Red Hat Product Errata | [RHSA-2021:5192](https://access.redhat.com/errata/RHSA-2021%3A5192) | 0 | None | None | None | 2021-12-16 17:12:06 UTC | | Red Hat Product Errata | [RHSA-2022:0008](https://access.redhat.com/errata/RHSA-2022%3A0008) | 0 | None | None | None | 2022-01-04 08:21:56 UTC | | Red Hat Product Errata | [RHSA-2022:0074](https://access.redhat.com/errata/RHSA-2022%3A0074) | 0 | None | None | None | 2022-01-11 16:27:38 UTC | | Red Hat Product Errata | [RHSA-2022:0133](https://access.redhat.com/errata/RHSA-2022%3A0133) | 0 | None | None | None | 2022-01-12 14:38:16 UTC | | Red Hat Product Errata | [RHSA-2022:0443](https://access.redhat.com/errata/RHSA-2022%3A0443) | 0 | None | None | None | 2022-02-07 10:46:23 UTC | | Samba Project | [14556](https://bugzilla.samba.org/show_bug.cgi?id=14556) | 0 | None | None | None | 2021-11-03 14:55:58 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=2019672#c0)  Huzaifa S. Sidhpurwala    2021-11-03 04:21:43 UTC  ``` As per upstream advisory:  Windows Active Directory domains have, but default, a feature to allow users to create computer accounts, controlled by ms-DS-MachineAccountQuota.  Likewise, some (presumably trusted) users have the right to create new users or computers in Active Directory Domains, both Samba and Windows based.  When Samba, as an AD Domain member accepts a Kerberos ticket, it must map the information found therein to a local user.  This is done via the name in the Kerberos PAC, or the name in the ticket (if there is no PAC).  Samba will attempt to find a user "DOMAIN\user" before falling back to just "user".  If the DOMAIN\user lookup can be made to fail, then a privilege escallation is possible.   ```  [Comment 4](show_bug.cgi?id=2019672#c4)  Huzaifa S. Sidhpurwala    2021-11-10 02:51:55 UTC  ``` Created samba tracking bugs for this issue:  Affects: fedora-all [[bug 2021716](show_bug.cgi?id=2021716 "CLOSED ERRATA - CVE-2020-25717 samba: A user in an AD Domain could become root on domain members [fedora-all]")]   ```  [Comment 7](show_bug.cgi?id=2019672#c7)  Huzaifa S. Sidhpurwala    2021-11-29 04:40:08 UTC  ``` Created freeipa tracking bugs for this issue:  Affects: fedora-all [[bug 2027186](show_bug.cgi?id=2027186 "CLOSED DUPLICATE - CVE-2020-25717 freeipa: samba: A user in an AD Domain could become root on domain members [fedora-all]")]   ```  [Comment 9](show_bug.cgi?id=2019672#c9)  errata-xmlrpc    2021-11-29 12:36:11 UTC  ``` This issue has been addressed in the following products:    Red Hat Gluster Storage 3.5 for RHEL 7  Via RHSA-2021:4844 [https://access.redhat.com/errata/RHSA-2021:4844](https://access.redhat.com/errata/RHSA-2021%3A4844)   ```  [Comment 10](show_bug.cgi?id=2019672#c10)  errata-xmlrpc    2021-11-29 12:36:20 UTC  ``` This issue has been addressed in the following products:    Red Hat Gluster Storage 3.5 for RHEL 8  Via RHSA-2021:4843 [https://access.redhat.com/errata/RHSA-2021:4843](https://access.redhat.com/errata/RHSA-2021%3A4843)   ```  [Comment 11](show_bug.cgi?id=2019672#c11)  Product Security DevOps Team    2021-11-29 13:09:41 UTC  ``` This bug is now closed. Further updates for individual products will be reflected on the CVE page(s):  <https://access.redhat.com/security/cve/cve-2020-25717>   ```  [Comment 13](show_bug.cgi?id=2019672#c13)  Tomas Hoger    2021-12-01 18:29:28 UTC  ``` Upstream advisory: <https://www.samba.org/samba/security/CVE-2020-25717.html>   ```  [Comment 14](show_bug.cgi?id=2019672#c14)  errata-xmlrpc    2021-12-13 08:45:28 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 8  Via RHSA-2021:5082 [https://access.redhat.com/errata/RHSA-2021:5082](https://access.redhat.com/errata/RHSA-2021%3A5082)   ```  [Comment 15](show_bug.cgi?id=2019672#c15)  errata-xmlrpc    2021-12-16 17:12:04 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 7  Via RHSA-2021:5192 [https://access.redhat.com/errata/RHSA-2021:5192](https://access.redhat.com/errata/RHSA-2021%3A5192)   ```  [Comment 16](show_bug.cgi?id=2019672#c16)  errata-xmlrpc    2022-01-04 08:21:54 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 8.4 Extended Update Support  Via RHSA-2022:0008 [https://access.redhat.com/errata/RHSA-2022:0008](https://access.redhat.com/errata/RHSA-2022%3A0008)   ```  [Comment 17](show_bug.cgi?id=2019672#c17)  errata-xmlrpc    2022-01-11 16:27:35 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 8.2 Extended Update Support  Via RHSA-2022:0074 [https://access.redhat.com/errata/RHSA-2022:0074](https://access.redhat.com/errata/RHSA-2022%3A0074)   ```  [Comment 18](show_bug.cgi?id=2019672#c18)  errata-xmlrpc    2022-01-12 14:38:14 UTC  ``` This issue has been addressed in the following products:    Red Hat Virtualization 4 for Red Hat Enterprise Linux 8  Via RHSA-2022:0133 [https://access.redhat.com/errata/RHSA-2022:0133](https://access.redhat.com/errata/RHSA-2022%3A0133)   ```  [Comment 20](show_bug.cgi?id=2019672#c20)  errata-xmlrpc    2022-02-07 10:46:20 UTC  ``` This issue has been addressed in the following products:    Red Hat Virtualization 4 for Red Hat Enterprise Linux 7  Via RHSA-2022:0443 [https://access.redhat.com/errata/RHSA-2022:0443](https://access.redhat.com/errata/RHSA-2022%3A0443)   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=2019672&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)


