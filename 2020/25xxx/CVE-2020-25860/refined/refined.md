```
{
  "CVE-2020-25860": {
    "description": "A time-of-check-time-of-use vulnerability exists in the code that checks and installs a firmware bundle. If the attacker is able to replace the bundle file between the signature verification and mounting steps, RAUC will mount and install the modified bundle. Also, if the attacker is able to modify the bundle file after mounting, they can modify the payload to be installed or cause arbitrary hooks to be executed during the installation.",
    "vulnerability_details": {
      "root_cause": "Time-of-check-time-of-use (TOCTOU) vulnerability. The RAUC framework verifies the signature of a firmware bundle, closes the file, and then reopens it later to mount it. An attacker can replace the bundle file after the verification but before the mount.",
      "weaknesses": [
        "TOCTOU vulnerability",
        "Insecure file handling during firmware installation"
      ],
      "impact": "An attacker can bypass signature verification and install a malicious firmware, gaining control of the system. This can lead to arbitrary code execution, data corruption, or denial of service.",
       "attack_vectors": [
          "Local privilege escalation by replacing the bundle file on disk between the check_bundle() and mount_bundle() functions, if the rauc command is exposed to a lower privileged user.",
           "Remote attack by exploiting insecure endpoints that allow file uploads and triggering installation.",
           "Modification of the mounted bundle file to modify the payload to be installed or cause arbitrary hooks to be executed"
       ],
       "attacker_capabilities": "The attacker needs the ability to modify the bundle file on disk after signature verification and before the install process completes, or modify the file after it has been mounted."
    },
    "affected_products": [
      "RAUC versions before 1.5"
    ],
      "additional_details": "The vulnerability can be triggered by running `rauc install bundle.raucb` or using the Install/InstallBundle D-Bus methods.  The vulnerability is fixed by opening the bundle file only once, protecting it against modification during installation using Linux kernel lease mechanism (fcntl with F_SETLEASE), and introducing a new bundle format based on dm-verity."
  }
}
```