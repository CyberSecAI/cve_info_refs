```json
{
  "cveId": "CVE-2020-25223",
  "description": "A remote code execution vulnerability exists in the WebAdmin of Sophos SG UTM before v9.705 MR5, v9.607 MR7, and v9.511 MR11",
  "vulnerabilityDetails": [
    {
      "source": "www.scaprepo.com_705170d8_20250119_134020.html",
      "rootCause": "The vulnerability is due to improper handling of user-supplied input in the 'SID' parameter within the WebAdmin interface. Specifically, the 'open()' function in Perl is used with the user-supplied 'SID' without proper sanitization, leading to command injection.",
      "weaknesses": [
        "CWE-78",
        "Command Injection"
      ],
      "impact": "Remote code execution as root user.",
      "attackVector": "Network",
      "attackerCapabilities": "An unauthenticated attacker can send a crafted HTTP POST request to a vulnerable Sophos UTM device.",
      "additionalDetails": "The vulnerable code is present in the `webadmin.plx` (actually `asg.plx`) file and its associated Perl modules, specifically in how it handles the 'SID' parameter.\n\nThe exploit involves sending a specially crafted HTTP POST request to the `/var` endpoint, which is rewritten to `/webadmin.plx` internally but bypasses a regular expression filter that sanitizes the 'SID' parameter if sent directly to `/webadmin.plx`. The user-supplied `SID` is then passed unsanitized into a Perl `open()` function leading to the command injection.",
        "remediation":"The vulnerability was fixed in SG UTM v9.705 MR5, v9.607 MR7, and v9.511 MR11 released on September 17, 2020. Users of older versions of SG UTM are required to upgrade to receive the fix. As a workaround, Sophos recommends that SG UTM customers ensure their WebAdmin is not exposed to WAN."
    },
        {
      "source": "www.atredis.com_251fc1c1_20250119_134021.html",
      "rootCause": "The vulnerability lies in the improper handling of the Session ID (SID) parameter within HTTP POST requests to the Sophos UTM's web interface. Specifically, the `open()` function in Perl, when used with unsanitized user-supplied data for the file path, allows for command injection.",
       "weaknesses": [
        "CWE-78",
        "Command Injection"
      ],
      "impact": "Unauthenticated Remote Code Execution (RCE) as root user.",
      "attackVector": "Network",
      "attackerCapabilities": "An unauthenticated attacker can send a crafted HTTP POST request to a vulnerable Sophos UTM device. The attacker needs to identify a URL that is not subject to input sanitization.",
       "additionalDetails": "The vulnerability is located in the `webadmin.plx` file, which is a Perl executable. The `SID` parameter from an HTTP POST request is passed through several subroutines to a `open()` function in Perl, which interprets pipe characters (`|`) in the SID as a command to be executed. An Apache configuration directive attempts to sanitize the `SID` parameter using `InputSed` to replace the user-supplied SID, this can be bypassed by sending a request to `/var`, which is then rewritten to `/webadmin.plx` but without the `InputSed` filter, thus allowing the attacker to execute commands. The attacker leverages this command injection to execute arbitrary code by including shell commands in the 'SID' parameter of a crafted HTTP POST request."

    },
    {
     "source": "www.secpod.com_3bc2fc47_20250119_115505.html",
      "rootCause": "The root cause of this vulnerability lies in the web admin interface of Sophos SG UTM where a Perl file (webadmin.plx) handles incoming web traffic. When a HTTP POST request with a SID parameter is received, this SID is sent to the backend service `confd` for validation. The `confd` service, in an attempt to read the session information from its directory using a user supplied value, eventually passes this value to the Perl's `open()` function, which is vulnerable to command injection if not sanitized correctly.",
      "weaknesses": [
        "CWE-78",
        "Command Injection",
      "Inadequate Input Validation"
      ],
     "impact": "Unauthenticated Remote Code Execution (RCE) as root user. Attackers can execute arbitrary commands as root via a crafted HTTP request.",
       "attackVector": "Network",
     "attackerCapabilities": "An unauthenticated attacker can send a crafted HTTP POST request to a vulnerable Sophos UTM device. The attacker needs to identify a URL that is not subject to input sanitization. Requires the ability to craft and send HTTP POST requests.",
      "additionalDetails": "This vulnerability is triggered by sending an HTTP POST request with a specially crafted SID parameter. The vulnerability is located in the webadmin.plx, the backend service confd and the Perl `open()` function in the associated modules. The vulnerability allows unauthenticated remote code execution with root privileges.  The vulnerability involves exploiting the open() function in Perl by passing user controlled data as the filename, which leads to command injection.  To bypass a regex check, the request needs to be sent to the `/var` endpoint as it is rewritten to /webadmin.plx. The user-controlled commands are included in the SID parameter as the second argument to the `open()` function, allowing for the execution of arbitrary commands on the system."

    }
  ]
}
```