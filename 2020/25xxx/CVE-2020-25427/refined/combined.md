=== Content from github.com_ff933fc5_20250119_114357.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgpac%2Fgpac%2Fcommit%2F8e585e623b1d666b4ef736ed609264639cb27701)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgpac%2Fgpac%2Fcommit%2F8e585e623b1d666b4ef736ed609264639cb27701)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=gpac%2Fgpac)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[gpac](/gpac)
/
**[gpac](/gpac/gpac)**
Public

* [Notifications](/login?return_to=%2Fgpac%2Fgpac) You must be signed in to change notification settings
* [Fork
  539](/login?return_to=%2Fgpac%2Fgpac)
* [Star
   2.9k](/login?return_to=%2Fgpac%2Fgpac)

* [Code](/gpac/gpac)
* [Issues
  75](/gpac/gpac/issues)
* [Pull requests
  12](/gpac/gpac/pulls)
* [Actions](/gpac/gpac/actions)
* [Wiki](/gpac/gpac/wiki)
* [Security](/gpac/gpac/security)
* [Insights](/gpac/gpac/pulse)

Additional navigation options

* [Code](/gpac/gpac)
* [Issues](/gpac/gpac/issues)
* [Pull requests](/gpac/gpac/pulls)
* [Actions](/gpac/gpac/actions)
* [Wiki](/gpac/gpac/wiki)
* [Security](/gpac/gpac/security)
* [Insights](/gpac/gpac/pulse)

## Commit

[Permalink](/gpac/gpac/commit/8e585e623b1d666b4ef736ed609264639cb27701)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fixed potential crash - cf [#1406](https://github.com/gpac/gpac/issues/1406)

[Browse files](/gpac/gpac/tree/8e585e623b1d666b4ef736ed609264639cb27701)
Browse the repository at this point in the history

* Loading branch information

[![@jeanlf](https://avatars.githubusercontent.com/u/7303785?s=40&v=4)](/jeanlf)

[jeanlf](/gpac/gpac/commits?author=jeanlf "View all commits by jeanlf")
committed
Jun 11, 2020

1 parent
[e90526f](/gpac/gpac/commit/e90526f3d2ec0dee4cddc5244eb115668f10341f)

commit 8e585e6

Showing
**1 changed file**
with
**5 additions**
and
**11 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

16 changes: 5 additions & 11 deletions

16
[src/isomedia/box\_funcs.c](#diff-458e23ce24d4c576be1be723051974354fae5245dbbe54599db999d209c9abba "src/isomedia/box_funcs.c")

Show comments

[View file](/gpac/gpac/blob/8e585e623b1d666b4ef736ed609264639cb27701/src/isomedia/box_funcs.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -205,17 +205,11 @@ GF\_Err gf\_isom\_box\_parse\_ex(GF\_Box \*\*outBox, GF\_BitStream \*bs, u32 parent\_type, |
|  |  |  |
|  |  | newBox->size = size - hdr\_size; |
|  |  |  |
|  |  | if (newBox->size) { |
|  |  | e = gf\_isom\_full\_box\_read(newBox, bs); |
|  |  | if (!e) e = gf\_isom\_box\_read(newBox, bs); |
|  |  | newBox->size = size; |
|  |  | end = gf\_bs\_get\_position(bs); |
|  |  | } else { |
|  |  | newBox->size = size; |
|  |  | //empty box |
|  |  | e = GF\_OK; |
|  |  | end = gf\_bs\_get\_position(bs); |
|  |  | } |
|  |  | //parse even if size is 0 - this makes sure that we perform box parsing (usually in box->read) |
|  |  | e = gf\_isom\_full\_box\_read(newBox, bs); |
|  |  | if (!e) e = gf\_isom\_box\_read(newBox, bs); |
|  |  | newBox->size = size; |
|  |  | end = gf\_bs\_get\_position(bs); |
|  |  |  |
|  |  | if (e && (e != GF\_ISOM\_INCOMPLETE\_FILE)) { |
|  |  | gf\_isom\_box\_del(newBox); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8e585e6`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgpac%2Fgpac%2Fcommit%2F8e585e623b1d666b4ef736ed609264639cb27701) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_230db5b1_20250119_114358.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgpac%2Fgpac%2Fissues%2F1406)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgpac%2Fgpac%2Fissues%2F1406)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=gpac%2Fgpac)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[gpac](/gpac)
/
**[gpac](/gpac/gpac)**
Public

* [Notifications](/login?return_to=%2Fgpac%2Fgpac) You must be signed in to change notification settings
* [Fork
  539](/login?return_to=%2Fgpac%2Fgpac)
* [Star
   2.9k](/login?return_to=%2Fgpac%2Fgpac)

* [Code](/gpac/gpac)
* [Issues
  75](/gpac/gpac/issues)
* [Pull requests
  12](/gpac/gpac/pulls)
* [Actions](/gpac/gpac/actions)
* [Wiki](/gpac/gpac/wiki)
* [Security](/gpac/gpac/security)
* [Insights](/gpac/gpac/pulse)

Additional navigation options

* [Code](/gpac/gpac)
* [Issues](/gpac/gpac/issues)
* [Pull requests](/gpac/gpac/pulls)
* [Actions](/gpac/gpac/actions)
* [Wiki](/gpac/gpac/wiki)
* [Security](/gpac/gpac/security)
* [Insights](/gpac/gpac/pulse)

# Null pointer dereference in function gf\_isom\_get\_track\_id() #1406

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Null pointer dereference in function gf\_isom\_get\_track\_id()](#top)#1406Copy link![@mannuJoshi](https://avatars.githubusercontent.com/u/35680845?u=b2c5e61978f2582648a92a7dddeb2e20e8ad0a07&v=4&size=80)
## Description

![@mannuJoshi](https://avatars.githubusercontent.com/u/35680845?u=b2c5e61978f2582648a92a7dddeb2e20e8ad0a07&v=4&size=48)[mannuJoshi](https://github.com/mannuJoshi)opened [on Feb 8, 2020](https://github.com/gpac/gpac/issues/1406#issue-562020033)

Command-: MP4Box -crypt test.xml $POC -out test.mp4

Version-: MP4Box - GPAC version 0.8.0-rev177-g51a8ef874-master

Reproducer file-: [Reproducer](https://github.com/mannuJoshi/POCs/blob/master/POC)

GDB-:

```
IsoMedia import id:000034,sig:11,src:000003,op:flip4,pos:8995 - track ID 1 - media type "sdsm:mp4s"
[BS] Attempt to write 128 bits, when max is 32

Program received signal SIGSEGV, Segmentation fault.
[ Legend: Modified register | Code | Heap | Stack | String ]
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── registers ────
$rax   : 0x0
$rbx   : 0x0
$rcx   : 0x0
$rdx   : 0x1
$rsp   : 0x00007fffffff8fc0  →  0x0000000100000000
$rbp   : 0x2153
$rsi   : 0x1
$rdi   : 0x00005555555bff20  →  0x0000000000000000
$rip   : 0x00007ffff7b0e625  →  <gf_media_update_bitrate+389> mov DWORD PTR [rax+0x14], ecx
$r8    : 0x2
$r9    : 0x1
$r10   : 0x0
$r11   : 0x00005555555c37c0  →  0x0000000000000001
$r12   : 0x2153
$r13   : 0x00005555555bff20  →  0x0000000000000000
$r14   : 0x1
$r15   : 0x00005555555c4460  →  0x0000000000010003
$eflags: [zero carry PARITY adjust sign trap INTERRUPT direction overflow RESUME virtualx86 identification]
$cs: 0x0033 $ss: 0x002b $ds: 0x0000 $es: 0x0000 $fs: 0x0000 $gs: 0x0000
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
0x00007fffffff8fc0│+0x0000: 0x0000000100000000	 ← $rsp
0x00007fffffff8fc8│+0x0008: 0x0000000000000000
0x00007fffffff8fd0│+0x0010: 0x0000000000002153 ("S!"?)
0x00007fffffff8fd8│+0x0018: 0x00000000000003e8
0x00007fffffff8fe0│+0x0020: 0x00007fffffff9000  →  0x0000000000000000
0x00007fffffff8fe8│+0x0028: 0x00005555555c4460  →  0x0000000000010003
0x00007fffffff8ff0│+0x0030: 0x0000000000000000
0x00007fffffff8ff8│+0x0038: 0x0000000000000000
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── code:x86:64 ────
   0x7ffff7b0e618 <gf_media_update_bitrate+376> sbb    BYTE PTR [r9+r9*4-0x11], r9b
   0x7ffff7b0e61d <gf_media_update_bitrate+381> mov    edx, 0x1
   0x7ffff7b0e622 <gf_media_update_bitrate+386> mov    esi, r14d
 → 0x7ffff7b0e625 <gf_media_update_bitrate+389> mov    DWORD PTR [rax+0x14], ecx
   0x7ffff7b0e628 <gf_media_update_bitrate+392> mov    rax, QWORD PTR [r15+0x18]
   0x7ffff7b0e62c <gf_media_update_bitrate+396> mov    rcx, r15
   0x7ffff7b0e62f <gf_media_update_bitrate+399> mov    DWORD PTR [rax+0x10], ebx
   0x7ffff7b0e632 <gf_media_update_bitrate+402> mov    rax, QWORD PTR [r15+0x18]
   0x7ffff7b0e636 <gf_media_update_bitrate+406> mov    DWORD PTR [rax+0xc], ebp
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
[#0] Id 1, Name: "MP4Box", stopped, reason: SIGSEGV
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
[#0] 0x7ffff7b0e625 → gf_media_update_bitrate()
[#1] 0x7ffff7b13cd6 → gf_import_isomedia()
[#2] 0x7ffff7b211d5 → gf_media_import()
[#3] 0x55555556df0a → mp4boxMain()
[#4] 0x7ffff74b5b97 → __libc_start_main(main=0x5555555631e0 <main>, argc=0x6, argv=0x7fffffffdfe8, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffffffdfd8)
[#5] 0x55555556321a → _start()
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
0x00007ffff7b0e625 in gf_media_update_bitrate () from /usr/local/lib/libgpac.so.8

gef➤  bt
#0  0x00007ffff79d18fd in gf_isom_get_track_id () from /usr/local/lib/libgpac.so.8
#1  0x00007ffff7b45ef1 in gf_crypt_file () from /usr/local/lib/libgpac.so.8
#2  0x0000555555577575 in mp4boxMain (argc=0x6, argv=0x7fffffffdfb8) at main.c:5474
#3  0x00005555555796a3 in main (argc=0x6, argv=0x7fffffffdfb8) at main.c:5985

gef➤  i r
rax            0x0	0x0
rbx            0x0	0x0
rcx            0x20	0x20
rdx            0x0	0x0
rsi            0x0	0x0
rdi            0x5555555d0650	0x5555555d0650
rbp            0x7ffffffbd660	0x7ffffffbd660
rsp            0x7ffffffbd640	0x7ffffffbd640
r8             0x0	0x0
r9             0x0	0x0
r10            0x19	0x19
r11            0x7ffff79d18b5	0x7ffff79d18b5
r12            0x555555562470	0x555555562470
r13            0x7fffffffdfb0	0x7fffffffdfb0
r14            0x0	0x0
r15            0x0	0x0
rip            0x7ffff79d18fd	0x7ffff79d18fd <gf_isom_get_track_id+72>
eflags         0x10202	[ IF RF ]
cs             0x33	0x33
ss             0x2b	0x2b
ds             0x0	0x0
es             0x0	0x0
fs             0x0	0x0
gs             0x0	0x0

gef➤  exploitable
Description: Access violation near NULL on source operand
Short description: SourceAvNearNull (16/22)
Hash: a5cc92255fba44e928c1a0bb49438db1.a5cc92255fba44e928c1a0bb49438db1
Exploitability Classification: PROBABLY_NOT_EXPLOITABLE
Explanation: The target crashed on an access violation at an address matching the source operand of the current instruction. This likely indicates a read access violation, which may mean the application crashed on a simple NULL dereference to data structure that has no immediate effect on control of the processor.
Other tags: AccessViolation (21/22)

```
## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


