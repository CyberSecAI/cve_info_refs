The provided content is related to CVE-2020-25094.

**Root Cause of Vulnerability:**
The root cause is the lack of proper sanitization of user-supplied input when constructing PowerShell commands that are sent to back-end agents via WebSockets.

**Weaknesses/Vulnerabilities Present:**
*   **Command Injection:** The primary vulnerability is command injection where an attacker can modify the PowerShell commands sent via WebSockets to execute arbitrary code.
*   **Lack of WebSocket Authentication:** The WebSocket connection does not validate user credentials after the initial HTTP handshake, meaning that access controls applied to HTTP traffic are not enforced on WebSockets.

**Impact of Exploitation:**
*   **Arbitrary Remote Code Execution (RCE):** An attacker can execute arbitrary code on the targeted back-end hosts.
*   **Privilege Escalation:** The agent runs with "NT AUTHORITY\SYSTEM" privileges, the highest level on a Windows system, leading to a complete compromise of the system.
*   **Bypass Access Controls:** By exploiting the lack of WebSocket authentication, any user on the LogRhythm Web Console, even those with low privileges, can execute code on any agent regardless of their configured access rights.
*   **Network Pivot:**  Due to a Cross-Site WebSocket Hijacking (CSWH) vulnerability (CVE-2020-25095), an attacker can exploit a user's browser session on an internal network to gain a foothold on the otherwise protected network.

**Attack Vectors:**
*   The attack is performed by intercepting and manipulating WebSocket traffic containing SmartResponse commands.
*   Specifically, the attacker modifies the PowerShell commands sent over the WebSocket connection.

**Required Attacker Capabilities/Position:**
*   The attacker needs to have access to a legitimate user account on the LogRhythm Web Console.
*   The attacker needs to be able to intercept and manipulate the WebSocket connection.
*   The attacker also needs to be able to entice a legitimate user to visit a malicious website to perform a CSWH attack, allowing for a "pivot" into the otherwise protected network where the Web Console resides.