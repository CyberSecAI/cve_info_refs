### Analysis of CVE-2020-25516
The provided content is related to CVE-2020-25516.

**Root cause of vulnerability:**
The vulnerability is a Stored Cross-Site Scripting (XSS) issue. The root cause is the lack of sanitization of the 'message' parameter when adding comments to tasks in the BPMN explorer of WSO2 Enterprise Integrator. User-provided input is stored unsafely and later embedded into the application's responses.

**Weaknesses/vulnerabilities present:**
- Stored Cross-Site Scripting (XSS): Malicious JavaScript code can be injected via the 'message' parameter. This code gets stored and executed when a user loads the task.

**Impact of exploitation:**
- An attacker can inject malicious JavaScript code, which executes within the browser of any user who views the affected content.
- The injected code can perform actions such as:
    - Redirecting users to malicious websites.
    - Modifying the UI of the web page.
    - Retrieving information from the browser.
    - Potentially causing other harm.
- Session hijacking is not possible since session cookies are set with the `httpOnly` flag.

**Attack vectors:**
- An attacker crafts a malicious XSS payload and injects it into the 'message' parameter when adding a comment to a task within the BPMN explorer.

**Required attacker capabilities/position:**
- An attacker needs to have access to the BPMN explorer application.
- The attacker should be able to send a POST request to add a comment and intercept the request to inject the XSS payload.
- No special privileges are needed to exploit this vulnerability other than the ability to comment on a task.

**Technical Details:**
- The vulnerability is present in the `components/bpmn/bpmn-explorer-web/src/web/template/taskView.jag` file, where the 'message' parameter is not sanitized.
- The XSS payload is stored and executed each time a user loads the task details.
- The provided Proof of Concept (PoC) includes the steps needed to reproduce the issue.

**Mitigation:**
The provided content recommends two layers of defense:
1. Input validation: Strictly validate user input on arrival, based on the expected content. Input that fails validation should be rejected, not sanitized.
2. Output encoding: HTML-encode user input at any point it is copied into the application's responses. Replace all HTML metacharacters with corresponding HTML entities.