- **Root cause of vulnerability:** The chapter title in the book module was not properly escaped, allowing JavaScript to be included in the title. This vulnerability was present on the "Add new chapter" page when forceclean was enabled.
- **Weaknesses/vulnerabilities present:** Cross-site scripting (XSS) due to lack of sanitization.
- **Impact of exploitation:** An attacker could inject malicious JavaScript code into a book's chapter title which could be executed in a user's browser, potentially leading to various attacks including session hijacking, defacement, or redirection to malicious sites.
- **Attack vectors:** The attacker would need to include the malicious Javascript code in a book's chapter title.
- **Required attacker capabilities/position:** The attacker would need to be a trusted user (e.g., teacher) with the permission to create or edit book chapters.