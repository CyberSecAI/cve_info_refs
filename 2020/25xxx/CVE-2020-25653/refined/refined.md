```
{
  "cve": "CVE-2020-25653",
  "affected_product": "spice-vdagent",
  "vulnerability_details": {
    "root_cause": "Race condition in handling of UNIX domain socket peer PIDs.",
    "weaknesses": [
      "The `spice-vdagentd` daemon uses the `SO_PEERCRED` socket option to retrieve the PID of a connecting client. This retrieved PID is then used to determine the session the client belongs to using systemd. A race condition exists between the time a client establishes a connection (connect()) and the time the daemon retrieves the PID, during which the PID can be re-assigned to a different process.",
        "The daemon does not properly validate that the UID of the client matches the UID of the session to which the PID belongs."
    ],
    "impact": "An unprivileged local attacker can potentially impersonate an active user, gaining access to the host's clipboard data or sending malicious clipboard data to the host, initiate file transfers from the host, and send invalid screen resolution information. This can lead to information disclosure, and denial of service.",
    "attack_vectors": {
      "vector_description": "Local attacker within the VM exploiting the race condition in `spice-vdagentd`",
      "required_capabilities": "The attacker requires local access to the virtual machine and be able to create a connection to the spice-vdagentd UNIX domain socket.",
       "attacker_position":"An attacker with unprivileged access to the VM."
    }
  },
  "affected_versions": [
    "Versions prior to 0.21.0"
   ],
  "fixes": [
    "Patches implemented to verify the UID of the connecting process and match with the session associated to the connection."
  ],
  "references": [
    "https://bugzilla.redhat.com/show_bug.cgi?id=1886372",
    "https://www.openwall.com/lists/oss-security/2020/11/04/1",
      "https://access.redhat.com/security/cve/CVE-2020-25653",
    "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/OIWJ2EIQXWEA2VDBODEATHAT37X4CREP/",
     "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/GQT56LATVTB2DJOVVJOKQVMVUXYCT2VB/",
      "https://lists.debian.org/debian-lts-announce/2021/01/msg00012.html"
  ]
}
```