=== Content from pyaefromucsp.blogspot.com_3a53f10b_20250119_142651.html ===

[Skip to main content](#main)

# [hack4u](https://pyaefromucsp.blogspot.com/)

Search

### Search This Blog

### eG Manager v7.1.2:Improper Access Control lead to Remote Code Execution (CVE-2020-8591)

[February 03, 2020](https://pyaefromucsp.blogspot.com/2020/02/eg-manager-v712improper-access-control_3.html "permanent link")

## Improper Access Control to Remote Code Execution (CVE-2020-8591)

I will show how I hacked a whole system by exploiting improper access control vulnerability in the popular java-based MaaS software "eG Manager" and how I can escalated it to execute code remotely.
### Impact

The Improper Access Control weakness describes a case where software fails to restrict access to an object properly. A malicious user can compromise security of the software and perform certain unauthorized actions by gaining elevated privileges, reading otherwise restricted information, executing commands, bypassing implemented security mechanisms, etc.
### Technical Analysis

"eG Manager" has direct admin panel access feature and then it was missing session management control, e.g. if users may not want to login via the login interface provided by eG Enterprise. For instance, they can use access key to directly connect to the eG management console from the portal. "eG Manager" used predefined access key for authentication. An attacker can exploit this feature by using single access key. Since, eG Manager is used for internal network monitoring process, I could accessed their internal network via remote code execution.
### Exploiting Improper access control to Remote Code Execution

While I pen-testing "eG Manager", I read their documentation and found some interesting. If a user is already logged into a web portal, he/she may not want to login again to gain access to the eG user interface; instead, they may want to directly connect to the eG management console. they can use access key.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgD_xJM7U3i02LpdX66p3pLi27k2nK9ge8uCo3vcTo5fqccrDALbMnzv1vTi81MnshGKu8qf08IAHOAqmKNFmqNUtmZ1Hf-MMEdDG3dd_2uquyNvtdyMkTOHWYDPAHFTXQB2EWNY4ZbpXzI/s1600/Ege1.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgD_xJM7U3i02LpdX66p3pLi27k2nK9ge8uCo3vcTo5fqccrDALbMnzv1vTi81MnshGKu8qf08IAHOAqmKNFmqNUtmZ1Hf-MMEdDG3dd_2uquyNvtdyMkTOHWYDPAHFTXQB2EWNY4ZbpXzI/s1600/Ege1.png)I thought, Can I access their admin panel without entering any password, even I have never logged before? We can be easily found access key in their documentation. So I tried to access admin panel by using the following URL:
https://<eGmanagerIP>:<eGmanagerport>/final/servlet/com.egurkha.EgLoginServlet?uname=admin&upass=&accessKey=eGm0n1t0r[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjdObHSciB9r8Jp9rq9viBWtyRVYPS-RIOzIIO42RqRFRh5_jpmrboMX88cHLHChUwMBM8LkTQnPveqHs9B8QbIEEQBTtTeTD0iJ1MVYAhptJVc08IJ-HmagOVPgobrjQNE5GVW1OD5satY/s1600/Ege2.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjdObHSciB9r8Jp9rq9viBWtyRVYPS-RIOzIIO42RqRFRh5_jpmrboMX88cHLHChUwMBM8LkTQnPveqHs9B8QbIEEQBTtTeTD0iJ1MVYAhptJVc08IJ-HmagOVPgobrjQNE5GVW1OD5satY/s1600/Ege2.png)
Yeah!!! I have successfully logged into their admin panel because the eG Enterprise system will automatically pick the password that corresponds to the specified uname from the database. There was command execution function in Admin>Settings>Manager.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiIRIg9AGiUvg2ziVqloWxzAjCIBGFqUvOhM885zj17Wqjgw0_vOkQ2aZ4m78pmiz1D72xQV9PdtR0XKuFHmatAHiZ7TSjfdLywj1VELRelNEbRTgfAz9jBb2mXj2OVawBw3GazMoAmh3_r/s1600/Ege3.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiIRIg9AGiUvg2ziVqloWxzAjCIBGFqUvOhM885zj17Wqjgw0_vOkQ2aZ4m78pmiz1D72xQV9PdtR0XKuFHmatAHiZ7TSjfdLywj1VELRelNEbRTgfAz9jBb2mXj2OVawBw3GazMoAmh3_r/s1600/Ege3.png)
The option was enabled. Any commands can be executed in Admin> Agents> Agent Status> Remote Control.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhhCqOD_hLy-eIhCl08U2HNLPv4SsQkq4Qvo46RU0U6hIUkTLYNUfTLd6wRLVGeZZspASyx8VlGZBJam9FenmlMe2NYTbIqZkJmJPd-cO0N9-SqcgN8y3hwT45e-AABytdaRme0p8mnhOvh/s1600/Ege5.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhhCqOD_hLy-eIhCl08U2HNLPv4SsQkq4Qvo46RU0U6hIUkTLYNUfTLd6wRLVGeZZspASyx8VlGZBJam9FenmlMe2NYTbIqZkJmJPd-cO0N9-SqcgN8y3hwT45e-AABytdaRme0p8mnhOvh/s1600/Ege5.png)
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgFTAXKx2lw6r5fYKyjnWebN8eTP5DQCNKBzKNJuSqB0Z1uxp0QAka5VKy9mxlL2M0Tsc8raK7YnJVnSskGNErJCLx-CquqYr79uo0IMJrTQfLMzjqey6x0KkaXN0TuqCrbavEEgM3uNF8J/s1600/Ege4.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgFTAXKx2lw6r5fYKyjnWebN8eTP5DQCNKBzKNJuSqB0Z1uxp0QAka5VKy9mxlL2M0Tsc8raK7YnJVnSskGNErJCLx-CquqYr79uo0IMJrTQfLMzjqey6x0KkaXN0TuqCrbavEEgM3uNF8J/s1600/Ege4.png)
That is means I can control any company internal network which are using eG Manager.
### Time Line

**Date           What**
2020/01/30 Vulnerability reported to eG Innovations, Inc.
2020/01/30 Vendor addressed issue in < 7.1.2
2020/01/31 Vendor fixed and notify their customers.
### Summary

In this post I analyzed improper access control vulnerability in "eG Manager v7.1.2" which can be triggered through a single access key. I found that it is possible to leverage the issue into Remote Code Execution if the "eG Manager" instance relies on the command execution function. I would like to thank the "eG Innovations, Inc" security team for the professional communication and for the very fast resolution of the issue.

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

### Comments

1. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Rakesh](https://www.blogger.com/profile/10992180270037849788)[April 27, 2020 at 7:29 AM](https://pyaefromucsp.blogspot.com/2020/02/eg-manager-v712improper-access-control_3.html?showComment=1587997774307#c5522533047962833009)

   Wow it is really wonderful and awesome thus it is very much useful for me to understand many concepts and helped me a lot. it is really explainable very well and i got more information from your blog
   [Access Control](https://timeaccessworld.com/products/accesscontrol)

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=1995664292443105922&postID=5522533047962833009)Replies
   Reply
2. ![](//www.blogger.com/img/blogger_logo_round_35.png)[oxycodone for sale](https://www.blogger.com/profile/01062647425497906843)[August 31, 2020 at 1:01 AM](https://pyaefromucsp.blogspot.com/2020/02/eg-manager-v712improper-access-control_3.html?showComment=1598860886587#c5856430253551553113)

    Nursing Care services at home means, a lot of travelling, traffic struggles and long waiting lines. More Information Call Now: +91-845-911-1920

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=1995664292443105922&postID=5856430253551553113)Replies
   Reply
3. ![](//www.blogger.com/img/blogger_logo_round_35.png)[oxycodone for sale](https://www.blogger.com/profile/01062647425497906843)[August 31, 2020 at 1:33 AM](https://pyaefromucsp.blogspot.com/2020/02/eg-manager-v712improper-access-control_3.html?showComment=1598862795472#c3659963534259901377)

   Orthopaedic Physiotherapists in ghaziabad More Information Call Now: +91-845-911-1920

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=1995664292443105922&postID=3659963534259901377)Replies
   Reply
4. ![](//www.blogger.com/img/blogger_logo_round_35.png)[oxycodone for sale](https://www.blogger.com/profile/01062647425497906843)[August 31, 2020 at 2:08 AM](https://pyaefromucsp.blogspot.com/2020/02/eg-manager-v712improper-access-control_3.html?showComment=1598864895696#c1016646408924722248)

   health care services in Delhi business employs individuals that are dedicated towards their respective roles and put in a lot of effort to achieve the common vision and larger goals of the company. In the near future, this business aims to expand its line of products and services and cater to a larger client base. More Information Call Now: +91-845-911-1920

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=1995664292443105922&postID=1016646408924722248)Replies
   Reply
5. ![](//www.blogger.com/img/blogger_logo_round_35.png)[oxycodone for sale](https://www.blogger.com/profile/01062647425497906843)[August 31, 2020 at 2:18 AM](https://pyaefromucsp.blogspot.com/2020/02/eg-manager-v712improper-access-control_3.html?showComment=1598865507128#c8702701612397320067)

   attendant services in delhi attendant at home is quite an affordable option and we assist our patients in their daily needs and requirement in the comfort of their own home. Our caretakers are responsible and experienced in taking care of patient's day-to-day work including the physical, mental and social activities. Whether it’s personal hygiene, mobilization, bathing, feeding or involving patient into some activities for mental care, caregivers help them with everything! More Information Call Now: +91-845-911-1920

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=1995664292443105922&postID=8702701612397320067)Replies
   Reply
6. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Babit](https://www.blogger.com/profile/11935160537174846115)[September 14, 2020 at 9:54 PM](https://pyaefromucsp.blogspot.com/2020/02/eg-manager-v712improper-access-control_3.html?showComment=1600145666168#c6734524052069775477)

   A is a very extensive and vast knowledgeable platform that has been given by this blog. Thanks for sharing this helpful blog.
   [Access Control](https://timeaccessworld.com/products/accesscontrol)

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=1995664292443105922&postID=6734524052069775477)Replies
   Reply

Add commentLoad more...

#### Post a Comment

### Popular posts from this blog

### [eG Manager v7.1.2: SQL Injection lead to Remote Code Execution (CVE-2020-8592)](https://pyaefromucsp.blogspot.com/2020/02/eg-manager-v712-sql-injection-lead-to_56.html)

[February 03, 2020](https://pyaefromucsp.blogspot.com/2020/02/eg-manager-v712-sql-injection-lead-to_56.html "permanent link")

SQL Injection lead to Remote Code Execution (CVE-2020-8592) In this blog post I will show how to exploit a SQL injection vulnerability in the popular java-based MaaS software "eG Manager" and how I can escalated it to execute code remotely. Impact The SQL injection vulnerability can be exploited as an unauthenticated attacker via forgot password function. An attacker is able to execute stacked SQL queries which means it is possible to manipulate arbitrary database entries and even execute shell commands. Technical Analysis eG Manager has a forgot password feature and then there was missing input validation function, e.g. If the Username specified is valid, then the password will be emailed to the user with the given Username. If not so, server shows 'username does not exist'. An attacker can exploit this feature by injecting stacked queries SQL syntax. Exploiting SQL Injection to Remote Code Execution In "Forgot Password" area, there is an inp...

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[21 comments](https://pyaefromucsp.blogspot.com/2020/02/eg-manager-v712-sql-injection-lead-to_56.html#comments)

[Read more](https://pyaefromucsp.blogspot.com/2020/02/eg-manager-v712-sql-injection-lead-to_56.html "eG Manager v7.1.2: SQL Injection lead to Remote Code Execution (CVE-2020-8592)")

### About Me

[Pyae Phyo Thu](https://www.blogger.com/profile/09462209373130926805)

Pyae Phyo Thu is a Junior Cyber Security Specialist at RITZ Cyber Intelligence Services Co.,Ltd and is passionate about finding all types of security bugs, not only in web applications but also in Android apps and other systems. He has finished his graduation from the University of Computer Studies, Pathein (UCSP) and he also studied cyber security at UCSP and collected experience as a penetration tester.

[Visit profile](https://www.blogger.com/profile/09462209373130926805)

### Archive

* [February 20202](https://pyaefromucsp.blogspot.com/2020/02/)

### [Report Abuse](https://www.blogger.com/go/report-abuse)

[Powered by Blogger](https://www.blogger.com)



=== Content from pyaefromucsp.blogspot.com_2d8b5f0d_20250119_142652.html ===

[Skip to main content](#main)

# hack4u

Search

### Search This Blog

## Posts

### [eG Manager v7.1.2:Improper Access Control lead to Remote Code Execution (CVE-2020-8591)](https://pyaefromucsp.blogspot.com/2020/02/eg-manager-v712improper-access-control_3.html)

[February 03, 2020](https://pyaefromucsp.blogspot.com/2020/02/eg-manager-v712improper-access-control_3.html "permanent link")

Improper Access Control to Remote Code Execution (CVE-2020-8591) I will show how I hacked a whole system by exploiting improper access control vulnerability in the popular java-based MaaS software "eG Manager" and how I can escalated it to execute code remotely. Impact The Improper Access Control weakness describes a case where software fails to restrict access to an object properly. A malicious user can compromise security of the software and perform certain unauthorized actions by gaining elevated privileges, reading otherwise restricted information, executing commands, bypassing implemented security mechanisms, etc.  Technical Analysis "eG Manager" has direct admin panel access feature and then it was missing session management control, e.g. if users may not want to login via the login interface provided by eG Enterprise. For instance, they can use access key to directly connect to the eG management console from the portal. "eG Manager" use...

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[6 comments](https://pyaefromucsp.blogspot.com/2020/02/eg-manager-v712improper-access-control_3.html#comments)

[Read more](https://pyaefromucsp.blogspot.com/2020/02/eg-manager-v712improper-access-control_3.html "eG Manager v7.1.2:Improper Access Control lead to Remote Code Execution (CVE-2020-8591)")

Recent posts

### [eG Manager v7.1.2: SQL Injection lead to Remote Code Execution (CVE-2020-8592)](https://pyaefromucsp.blogspot.com/2020/02/eg-manager-v712-sql-injection-lead-to_56.html)

[February 03, 2020](https://pyaefromucsp.blogspot.com/2020/02/eg-manager-v712-sql-injection-lead-to_56.html "permanent link")

SQL Injection lead to Remote Code Execution (CVE-2020-8592) In this blog post I will show how to exploit a SQL injection vulnerability in the popular java-based MaaS software "eG Manager" and how I can escalated it to execute code remotely. Impact The SQL injection vulnerability can be exploited as an unauthenticated attacker via forgot password function. An attacker is able to execute stacked SQL queries which means it is possible to manipulate arbitrary database entries and even execute shell commands. Technical Analysis eG Manager has a forgot password feature and then there was missing input validation function, e.g. If the Username specified is valid, then the password will be emailed to the user with the given Username. If not so, server shows 'username does not exist'. An attacker can exploit this feature by injecting stacked queries SQL syntax. Exploiting SQL Injection to Remote Code Execution In "Forgot Password" area, there is an inp...

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[21 comments](https://pyaefromucsp.blogspot.com/2020/02/eg-manager-v712-sql-injection-lead-to_56.html#comments)

[Read more](https://pyaefromucsp.blogspot.com/2020/02/eg-manager-v712-sql-injection-lead-to_56.html "eG Manager v7.1.2: SQL Injection lead to Remote Code Execution (CVE-2020-8592)")

### About Me

[Pyae Phyo Thu](https://www.blogger.com/profile/09462209373130926805)

Pyae Phyo Thu is a Junior Cyber Security Specialist at RITZ Cyber Intelligence Services Co.,Ltd and is passionate about finding all types of security bugs, not only in web applications but also in Android apps and other systems. He has finished his graduation from the University of Computer Studies, Pathein (UCSP) and he also studied cyber security at UCSP and collected experience as a penetration tester.

[Visit profile](https://www.blogger.com/profile/09462209373130926805)

### Archive

* [February 20202](https://pyaefromucsp.blogspot.com/2020/02/)

### [Report Abuse](https://www.blogger.com/go/report-abuse)

[Powered by Blogger](https://www.blogger.com)


