=== Content from www.webarxsecurity.com_d7dabb8e_20250119_123753.html ===


[Skip to main content](#main)
[![](https://patchstack.com/wp-content/uploads/2021/11/logo.svg)](/)

JavaScript is disabled in your browser. Please enable JavaScript for a better experience.

* [Pricing](/pricing/)
* Solutions
  + [WordPress security](https://patchstack.com/wordpress-security/)
  + [Enterprise API](https://patchstack.com/for-hosts/)
  + [Managed VDP](https://patchstack.com/for-plugins/)
  + [Bug Bounty](https://patchstack.com/bug-bounty/)
  + [Plugin auditing](https://patchstack.com/auditing/)
  + [Vulnerability database](https://patchstack.com/database/)
* [Login](https://app.patchstack.com/login)

* ![]()

  + ![]()

    - ![]()

[Start trial](https://app.patchstack.com/register)

# Critical Vulnerability In InfiniteWP Client And WP Time Capsule

[Security advisories](https://patchstack.com/category/security-advisories/)
[Critical Vulnerability](https://patchstack.com/tag/critical-vulnerability/)
Published 14 January 2020Updated 12 July 2023![](https://secure.gravatar.com/avatar/7f009046884a335084f86ff1a1acadce?s=200&d=mm&r=g)[Dave Jong](https://patchstack.com/author/davetheawesome/)CTO at PatchstackTable of Contents

[#### WordPress InfiniteWP Client Plugin <= 1.9.4.4

Bypass Vulnerability](https://patchstack.com/database/vulnerability/iwp-client/wordpress-infinitewp-client-plugin-1-9-4-4-authentication-bypass-vulnerability)
[#### WordPress Backup and Staging by WP Time Capsule Plugin <= 1.21.15

Bypass Vulnerability](https://patchstack.com/database/vulnerability/wp-time-capsule/wordpress-backup-and-staging-by-wp-time-capsule-plugin-1-21-15-authentication-bypass-vulnerability)

Not too long ago an [authentication bypass vulnerability in the Ultimate Addons](https://www.webarxsecurity.com/critical-vulnerability-in-ultimate-add-ons-elementor/) was found for Elementor and Beaver Builder plugins.

As we routinely monitor the code of popular plugins our customers use, we found that the [InfiniteWP Client](https://wordpress.org/plugins/iwp-client/) and [WP Time Capsule](https://wordpress.org/plugins/wp-time-capsule/) plugins also contain logical issues in the code that allows you to login into an administrator account without a password.

The developer was very fast to react and released the patches on the very next day after our initial report. It’s always great to see developers who are taking action quickly and letting their customers know about the issues to help people update to a more secure version as soon as possible.

## Firewalls may fail to protect

Because authentication bypass vulnerabilities are often logical mistakes in the code and don’t actually involve a suspicious-looking payload, it can be hard to find and determine where these issues come from.

In this case, it’s hard to block this vulnerability with general firewall rules because the payload is encoded and a malicious payload would not look much different compared to a legitimate-looking payload of both plugins.

We added a new module in the Patchstack firewall just to be able to block this vulnerability as both plugins did not hook into the WordPress core as expected. We have seen other WordPress security companies follow the same method. In the future, we can expand upon this new feature to block similar issues.

Because of the nature of the vulnerability, cloud-based firewalls might not be able to make a difference between malicious or legitimate traffic and therefore may fail to provide effective protection against this vulnerability.

Anyone who uses a firewall by another company should ask them whether or not these particular vulnerabilities are blocked by their firewall.

## InfiniteWP Client < 1.9.4.5

In order for the request to even get to the vulnerable part of the code, we first must encode the payload with JSON, then Base64, then send it raw to the site in a POST request.

All we need to know is the username of an administrator on the site. After the request has been sent, you will automatically be logged in as the user.

![infinitewp](https://sp-ao.shortpixel.ai/client/to_auto,q_glossy,ret_img/https://www.webarxsecurity.com/wp-content/uploads/2020/01/Screenshot-2020-01-09-at-10.32.46.png)

The issue resides in the function iwp\_mmb\_set\_request which is located in the init.php file. This function checks if the request\_params variable of the class IWP\_MMB\_Core is not empty, which is only populated when the payload meets certain conditions.

In this case, the condition is that the iwp\_action parameter of the payload must equal readd\_site or add\_site as they are the only actions that do not have an authorization check in place. The missing authorization check is the reason why this issue exists.

Once the payload meets this condition, the username parameter that is supplied will be used to log in the requester as that user without performing any further authentication as shown below.

![infinitewp](https://i.imgur.com/9SwQsA4.png)

As you can see, the only change they have made is that the add\_site and readd\_site actions will no longer populate the request\_params variable but return early in the function.

![infinitewp](https://i.imgur.com/rJs5d73.png)

Based on the WordPress plugin library, the InfiniteWP Client plugin is active on 300,000+ websites. The InfiniteWP site claims they have 513,520 sites active.

## WP Time Capsule < 1.21.16

The WP Time Capsule plugin does not require a more complex payload but only needs to contain a certain string in the body of the raw POST request.

![wp time capsule](https://sp-ao.shortpixel.ai/client/to_auto,q_glossy,ret_img/https://www.webarxsecurity.com/wp-content/uploads/2020/01/Screenshot-2020-01-09-at-10.35.29.png)

The issue is located in wptc-cron-functions.php line 12 where it parses the request. The parse\_request function calls the function decode\_server\_request\_wptc which check if the raw POST payload contains the string “IWP\_JSON\_PREFIX”.

If it contains this string, it calls wptc\_login\_as\_admin (which grabs all available administrator accounts and uses the first account in the list) and you’ll be logged in as an administrator as shown below.

![](https://i.imgur.com/29uHqJv.png)

They removed several calls to the wptc\_login\_as\_admin function and made a change so the authenticity of the payload is verified before it’s further processed.

Based on the WordPress plugins library, the WP Time Capsule plugin is active on 20,000+ websites.

## Timeline

07 January, 2020Reported the vulnerabilities to the developer of both plugins.

07 January, 2020Released protection module to all Patchstack (formerly WebARX) customers.

08 January, 2020Developer of the plugin released a new version for both plugins.

14 January, 2020Security advisory publicly released.

Found this useful? Share on

* ![](https://patchstack.com/wp-content/uploads/2024/06/twitter-x-line.svg)
* ![](https://patchstack.com/wp-content/uploads/2024/03/facebook-fill.svg)
* ![](https://patchstack.com/wp-content/uploads/2024/03/linkedin-fill.svg)

Protect your websites against WordPress vulnerabilities[Get started](/pricing/)
### Monthly security advice

Get the latest WordPress security intelligence delivered to your inbox.**NEW**: Get started with 5 bite-sized security lessons.
Email SignupEmailSubscribe
### The latest in Security advisories

[See all](https://patchstack.com/category/security-advisories/)[![](https://patchstack.com/wp-content/uploads/2025/01/Critical-Vulnerability-Patched-in-GiveWP-Plugin-main.png)10 January, 2025
#### Critical Vulnerability Patched in GiveWP Plugin

Critical Vulnerability
php object injection
Zeroday bounties
zeroday
givewp](https://patchstack.com/articles/critical-vulnerability-patched-in-givewp-plugin/)[![](https://patchstack.com/wp-content/uploads/2025/01/Critical-Vulnerabilities-Found-in-Fancy-Product-Designer-Plugin-main.png)8 January, 2025
#### Critical Vulnerabilities Found in Fancy Product Designer Plugin

Critical Vulnerability
arbitrary file upload
SQL Injection
ENVATO](https://patchstack.com/articles/critical-vulnerabilities-found-in-fancy-product-designer-plugin/)[![](https://patchstack.com/wp-content/uploads/2024/12/Multiple-Critical-Vulnerabilities-Patched-in-WPLMS-and-VibeBP-Plugins-main.png)23 December, 2024
#### Multiple Critical Vulnerabilities Patched in WPLMS and VibeBP Plugins

theme
SQL Injection
ENVATO
Critical Vulnerability
privilege escalation
arbitrary file upload](https://patchstack.com/articles/multiple-critical-vulnerabilities-patched-in-wplms-and-vibebp-plugins/)

### Website security

[Pricing](https://patchstack.com/pricing/)[For WordPress](https://patchstack.com/wordpress-security/)[For WooCommerce](https://patchstack.com/woocommerce-security)[For agencies](https://patchstack.com/for-agencies/)[API for hosts](https://patchstack.com/for-hosts/)[Documentation](https://docs.patchstack.com/)[Log in](https://app.patchstack.com/login)
### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)[Log in](https://vdp.patchstack.com/vdp/login)[Active programs](https://patchstack.com/database/vdp/)[Security auditing](https://patchstack.com/auditing/)
### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)[Log in](https://vdp.patchstack.com/researchers/login)[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)[Learn](https://patchstack.com/academy)[Discord](https://discord.gg/rkE8yxtNmS)
### Resources

[Vulnerability database](https://patchstack.com/database/)[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024/)[Vulnerability statistics](https://patchstack.com/database/statistics/wordpress)[Case studies](https://patchstack.com/category/case-studies/)[Articles](https://patchstack.com/articles/)
### Patchstack

[About](https://patchstack.com/about/)[Careers](https://patchstack.com/about/#careers)[Merch store](https://store.patchstack.com)[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)
### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)[Facebook](https://www.facebook.com/patchstackapp)[X](https://twitter.com/patchstackapp)[![Patchstack logo](https://patchstack.com/wp-content/uploads/2024/01/logo-opt-300x32.webp)](/)© 2025 Patchstack[DPA](https://patchstack.com/data-processing-agreement-dpa/)[Privacy Policy](https://patchstack.com/privacy-policy/)[Terms & Conditions](https://patchstack.com/terms-and-conditions/)![Co-funded by EU logo](https://patchstack.com/wp-content/uploads/2024/01/EIC-logo-CoFundedBy-opt.webp)
[![](https://patchstack.com/wp-content/uploads/2021/01/logo.png)](/)
### Website security

[Pricing](https://patchstack.com/pricing/)[For WordPress](https://patchstack.com/wordpress-security/)[For WooCommerce](https://patchstack.com/woocommerce-security)[For agencies](https://patchstack.com/for-agencies/)[API for hosts](https://patchstack.com/for-hosts/)[Documentation](https://docs.patchstack.com/)[Log in](https://app.patchstack.com/login)
### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)[Log in](https://vdp.patchstack.com/vdp/login)[Active programs](https://patchstack.com/database/vdp/)[Security auditing](https://patchstack.com/auditing/)
### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)[Log in](https://vdp.patchstack.com/researchers/login)[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)[Learn](https://patchstack.com/academy)[Discord](https://discord.gg/rkE8yxtNmS)
### Resources

[Vulnerability database](https://patchstack.com/database/)[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024/)[Vulnerability statistics](https://patchstack.com/database/statistics/wordpress)[Case studies](https://patchstack.com/category/case-studies/)[Articles](https://patchstack.com/articles/)
### Patchstack

[About](https://patchstack.com/about/)[Careers](https://patchstack.com/about/#careers)[Merch store](https://store.patchstack.com)[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)
### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)[Facebook](https://www.facebook.com/patchstackapp)[X](https://twitter.com/patchstackapp)© 2025 Patchstack[DPA](https://patchstack.com/data-processing-agreement-dpa/)[Privacy Policy](https://patchstack.com/privacy-policy/)[Terms & Conditions](https://patchstack.com/terms-and-conditions/)

Looks like your browser is blocking our support chat widget. Turn off adblockers and reload the page.Reload page

xml version="1.0"?closechevron-downchainbarsangle-rightangle-upxml version="1.0"?crossmenu


