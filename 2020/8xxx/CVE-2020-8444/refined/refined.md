```
{
  "vulnerability": {
    "root_cause": "The `OS_ReadMSG` function in `ossec-analysisd` calls `OS_CleanMSG` to process incoming messages. For ossec-alert messages, the `OSSECAlert_Decoder_Exec` function, after processing, frees the `lf->full_log` pointer, and replaces it with a new pointer. However, the `OS_ReadMSG` function continues to process the message using `lf->generated_rule` set by the decoder prior to the free, potentially accessing `lf->hostname` and `lf->program_name` which are substrings of the freed `lf->full_log`. This results in a use-after-free vulnerability.",
    "weaknesses": [
      "CWE-416 Use After Free"
    ],
    "impact": "A use-after-free vulnerability allows reading from a freed heap chunk. If the area pointed to after the free isn't null-terminated, it can become an out-of-bounds read.",
    "attack_vectors": "An authenticated OSSEC client can send a specially crafted ossec-alert message via `ossec-remoted`. This message must have its `program_name` or `hostname` set during `OS_CleanMSG` processing on the server.",
     "required_attacker_capabilities": "The attacker must be an authenticated OSSEC client, meaning the client's key is known to the server, or have gained the ability to send messages via ossec-remoted."
  }
}
```