The provided content is related to CVE-2020-8904.

**Root cause of vulnerability:**
The vulnerability stems from a lack of proper range checking on the `output_len` parameter in the `ecall_restore` function within the Asylo SGX primitives. Specifically, the code did not verify if the `output_len` pointer pointed to trusted memory before using it.

**Weaknesses/vulnerabilities present:**
- Missing input validation: The `ecall_restore` function failed to check if the `output_len` pointer was within the untrusted memory region. This allows a malicious caller to provide a pointer to trusted memory.
- Memory corruption: By providing a malicious pointer, an attacker could potentially cause `ecall_restore` to write the size of the output buffer to an arbitrary address within the enclave, leading to memory corruption and other potential security issues.

**Impact of exploitation:**
- Memory corruption: The primary impact is the potential for memory corruption within the enclave's trusted memory. This can lead to unpredictable behavior, including crashes, and could potentially allow an attacker to gain further control or leak information.

**Attack vectors:**
- Calling the `ecall_restore` function with a malicious value for the `output_len` pointer.

**Required attacker capabilities/position:**
- The attacker must be able to call the `ecall_restore` function and have the ability to manipulate its input parameters, especially the `output_len` pointer.