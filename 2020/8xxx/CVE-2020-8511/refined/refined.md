- **Root cause of vulnerability:** The vulnerability stems from a flawed protection mechanism implemented by the vendor in Pandora FMS to prevent the execution of uploaded PHP files. Although the system attempts to serve the content of PHP files instead of executing them, the files are stored in a publicly accessible directory.
- **Weaknesses/vulnerabilities present:**
    - **Unrestricted File Upload:** The system allows the upload of PHP files, which can contain malicious code.
    - **Inadequate File Access Control:** Files uploaded to the file repository are stored in a directory that is accessible without authentication.
    - **Bypass of Execution Prevention:** Although the system tries to prevent PHP execution through `get_file.php`, the attacker can still directly access the uploaded PHP files in the public directory.
- **Impact of exploitation:** An attacker can upload malicious PHP files and execute arbitrary code on the server by directly accessing them. This can lead to complete system compromise, including data theft, modification, and denial of service.
- **Attack vectors:**
    - The attacker uploads a PHP file through the File Repository within the Pandora FMS web interface.
    - The attacker then accesses the uploaded file directly via its URL in the `/pandora_console/attachment/file_repo/` directory, bypassing the intended protection and executing the PHP code.
- **Required attacker capabilities/position:** The attacker requires a Web Admin account in Pandora FMS to access the File Repository upload feature.