=== Content from www.hooperlabs.xyz_ebd68f2a_20250119_114503.html ===

![](/img/logo.png)

# Hooper Labs

[Home](/index.php)
Boot to Root

[Nightfall](/b2r/nightfall.php)
[Weakness](/b2r/weakness.php)
[Stapler 1](/b2r/stapler1.php)
[My Tomcat Host](/b2r/mytomcathost.php)
[Inclusiveness](/b2r/inclusiveness.php)

[Cheat Sheets](/cheatsheets.php)
Mobile

[OWASP Uncrackable 1](/mobile/uncrackable1.php)

[About](/about.php)
[Links](/links.php)
[Recipes](/recipes.php)

## Local Privilege Escalation in Wing FTP Server (v6.2.3)

2020-03-04

### Description

From the official website: Wing FTP Server is an easy-to-use, secure, and reliable FTP server software for Windows, Linux, Mac OS, and Solaris. It supports multiple file transfer protocols, including FTP, FTPS, HTTP, HTTPS, and SFTP, giving your clients flexibility in how they connect to the server. And it provides admins with a web-based interface to administrate the server from anywhere. You can also monitor server performance and online sessions and even receive email notifications about various events taking place on the server.

Download Link: [Wing FTP Server Software Downloads](https://www.wftpserver.com/download.htm)

#### Vulnerabilities - Unsafe UMask Set (CVE-2020-8634) and Unsafe Permissions on System Files (CVE-2020-8635)

A number of weaknesses in Wing FTP Server allow any local user to escalate privileges to root on Linux, MacOS, and Solaris. Three weaknesses were discovered in the software which make exploitation possible.

#### Issues:

1. Wing FTP Server follows symbolic links by default.
2. Wing FTP Server sets an unsafe umask (permissions) for all files modified within the web interface.
3. By default, the server sets unsafe permissions on system files, compromising the integrity of system settings and confidentiality of user password hashes.

### Background

To install the server, download the archive from the Wing FTP website and extract. Within the directory, run the wftpserver binary. During installation, the software prompts the user to create an administrative user, an administrative password, choose which port the administrative HTTP interface should use (default 5466), then asks whether Wing FTP Server should start. The installation directory hereon will be referred to as **$WINGFTP\_DIR**.

Ports will not open until the server is further configured. Once a domain is created within the administrative interface (http://localhost:5466), Wing FTP server opens services on TCP ports 21 (FTP), 990 (FTPS), 80 (HTTP), 443 (HTTPS), 22 (SSH). If a service is already running on one of those ports, Wing FTP does not override that service. The server will also open these services once a "domain" folder is created within **$WINGFTP\_DIR** with a valid portlistener.xml file inside. This may only be done if the user has full write privileges to **$WINGFTP\_DIR**.

For the following attack scenarios, consider a Wing FTP Server installation on a Linux (Ubuntu 18.04) host. A low-privilege Linux user (lowleveluser) with terminal access also has a Wing FTP account and access to their home directory (/home/lowleveluser). After examining a few attack scenarios, it will become clear that the only prerequisite for escalation of privilege is command execution on the server as *any user*.

### Attack Scenario: Issue 1

#### Unsafe interpretation of symbolic links

Wing FTP server does not appear to check permissions while conducting file operations. The program runs as a superuser and therefore may access any directory or file as a superuser. In addition, the software follows symbolic links by default for all users. If a user creates a symbolic link to the filesystem root (ln -s / filesystem), a low-privilege user with read-only permissions to specific directories in Wing FTP may gain privileges to read the entire filesystem, including sensitive system files only accessible by root. Any Wing FTP user utilizing the HTTP interface may access any file in their path with permissions of the root user. If the user has read, write, and delete privileges within the application, they will also gain privileges to write or delete any file on the filesystem.

#### Exploitation

Any user may create a symbolic link within a folder for which they have write privileges.
![](/img/wftpflow1a.PNG)

### Attack Scenario: Issue 2

### CVE-2020-8634

#### Unsafe permissions set when modifying files

By default, Wing FTP Server appears to utilize the umask=111 when modifying files. The umask is able to be set in the administrator interface (http://localhost:5466).
However, within this interface, the default permissions are "644" for modified or created files. Though this is indeed the case via FTP, files modified via the HTTP(S) interface are saved as world-readable and world-writable files ("666").
This appears to be a bug in Wing FTP Server. Thus, if a higher-privilege Wing FTP user modifies a file on the filesystem, the owner and group will be changed to root and the permissions will be changed to "666".
In addition, the permissions of the file will be changed to 666 (world readable and world writable). This means that any modifications of sensitive files result in full read/write privileges being granted to all users on the system.
If this situation occurs, any non-superusers gain access to those files. The modification of a particularly sensitive file (/etc/passwd, /etc/shadow, /etc/sudoers, etc.) may allow these users to escalate to a root.

#### Exploitation

The screenshot below shows a user accessing a sensitive file via the Wing FTP Server HTTP(S) interface, then clicking the “Save” button to perform a file modify operation.
![](/img/wftpflow2a.PNG)
With command line access, we see that the permissions of /etc/shadow were changed to 666 (world-writable).
![](/img/wftpflow2b.PNG)

### Attack Scenario: Issue 3

### CVE-2020-8635

#### Unsafe default permissions on sensitive Wing FTP configuration files

Once a domain is created and user accounts are added via the administrative interface (http://localhost:5466), they are saved to **$WINGFTP\_DIR**/Data/<domain>/users/<username>.xml, where <domain> and <username> are the names of the domain and users, respectively.
The files "<username>.xml" are created with world-readable permissions, allowing any user on the system to view existing users and the md5 hash of their passwords.
In addition, these files are also *world-writable*, allowing any user to forge their own Wing FTP user information to increase privileges within the application or change other user’s password hashes (account takeover).
To make matters worse, the folder **$WINGFTP\_DIR**/Data/<domain>/users, by default, is created with full global permissions (777).
This allows any user on the system to write to it. Combined, these insecure permissions allow any user to forge entire Wing FTP user accounts.

#### Exploitation

First, an administrative user should log into the administrative interface (http://localhost:5466) to view the existing user accounts. This is to view existing users within the system for a given domain.
In this example, two user accounts exist: "adminuser" and "lowleveluser".
![](/img/wftpflow3a.PNG)
Using a crafted XML file similar to those in <username>.xml files created by Wing FTP Server, an attacker may forge a user by copying the XML file into the users directory located at **$WINGFTP\_DIR**/Data/<domain>/users/ (see screenshot below).
In the screenshot below, we forge a user account "h00p" with a password of "h00p" with full permissions in the filesystem root ("/").
![](/img/wftpflow3b.PNG)
Again within the administrative interface, if an administrative user refreshes the page, they observe a new user "h00p" created within the application.
![](/img/wftpflow3c.PNG)
Last, a curl to the login URL demonstrates that the user "h00p" may successfully log in to the application. Observe in the HTTPS response that the "Set-Cookie" HTTP header is returned with a valid "UID" cookie granting access.
![](/img/wftpflow3d.PNG)
In this way, a user with terminal access or command execution on the server may forge a user account.

#### Putting it Together:

At this point, the path to privilege escalation should be pretty clear. But just for clarity, I've included the steps below.

1. Have terminal access or code execution on the server as any user.
2. Forge a user account with (at a minimum) read, write, and delete privileges.
3. Within the HTTP(S) interface, modify a sensitive system file. This will make the file world-writable.
4. Either from the web interface or terminal, modify the sensitive system file to increase privileges on the system (i.e. removing the root password reference within /etc/passwd or changing the root password hash in /etc/shadow.
5. Profit.

#### Exploit

To facilitate exploitation, I've created an exploit for this bug, provided a user has SSH access already to the system.
The exploit, written with Python's paramiko, will log in, forge a Wing FTP user account, log in via the HTTP(S) interface, and modify the root password hash within the /etc/shadow file. Then, SSH in and su to root. Obviously each of these steps can be done manually as well. Enjoy!

[Link to Exploit](/disclosures/cve-2020-8635.py)
[(Updated) Exploit-DB](https://www.exploit-db.com/exploits/48160)
![](/img/wftpsploit.PNG)

#### Further Research

Update (3/4/2020). Another vulnerability was identified in Wing FTP Server after the initial patch. The writeup is contained in the following article: [CVE-2020-9470](cve-2020-9470.php).

#### Operating Systems Verified:

* Kali Linux 4
* Ubuntu 18.04.1 LTS
* MacOS Catalina
* Oracle Solaris 11.4 x86

### Vulnerability Disclosure Policy

Hooper Labs takes security issues seriously. We believe in working with relevant stakeholders to achieve coordinated disclosure within a reasonable period of time.
We also adhere to the industry-standard 90-day disclosure deadline, where vendors are notified of vulnerabilities immediately, with details shared to the public after
90 days (or sooner if the issues are resolved earlier).

Common Vulnerabilities and Exposures (CVEs) are an industry standard for identifying vulnerabilities [(link)](https://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures). This system is a method for reference and tracking of publicly-known exposures. A CVE is a way to uniquely reference vulnerabilities across systems and Mitre
Corporation is the primary CVE Numbering Authority (CNA) for the program. We believe that users have a right to know their exposures in order to make informed risk decisions.

Hooper Labs does not participate in bug bounty programs, but instead relies on responsible disclosure [(link)](https://en.wikipedia.org/wiki/Responsible_disclosure).
Effectively communicating vulnerabilities and risks to the vendor, users, and public ensure that risk can be documented, calculated, and mitigated. We hope that through this
process the Information Domain may be marginally safer.



=== Content from www.wftpserver.com_a869c2a5_20250119_133145.html ===

[![](images/logo-light.png)Wing FTP Server](/)

* Products
  ![dropdown](images/dropdown.png)
  [FTP Server Software](wftpserver.htm)
  [FTP Client Software](ftprush.htm)
  [FTP Server Clusters](gateway.htm)
* Download
  ![dropdown](images/dropdown.png)
  [Wing FTP Server](download.htm)
  [Wing Gateway](download.htm#gateway)
  [FTP Rush](download.htm#ftprush)
* Purchase
  ![dropdown](images/dropdown.png)
  [Wing FTP Server](order.htm)
  [Wing Gateway](ordergateway.htm)
* Support
  ![dropdown](images/dropdown.png)
  [Get Support](/support.htm)
  [Contact Us](/contacts.htm)
  [Forum](https://bbs.wftpserver.com)
  [Blog](/blog/)
* ![](images/search.png)

  Search
* ![](images/globe.png)

  ![English](images/flag_us.gif) English
  [![Deutsch](images/flag_de.gif) Deutsch](de/)
  [![ç®ä½ä¸­æ](images/flag_zh.gif) ç®ä½ä¸­æ](zh/)
* ![](images/twitter.png)

## FTP Software Downloads

Wing FTP Server is distributed under the shareware license, and you can download and evaluate a fully functional trial version for 30 days. After 30 days, you can continue using it as a **Free edition** for non-commercial use. If you need more features available in Standard/Secure/Corporate edition, please purchase a license and register it. And if you are not sure which version is right for you, please [see the edition difference here.](comparison.htm)
## Wing FTP Server Wing FTP Server

| Wing FTP Server **v7.4.1** for Windows   [[Release Notes]](serverhistory.htm)   [[Quickstart Guide]](/help/ftpserver/aoe.htm) | (13.3 MB) | [Download](download/WingFtpServer.exe) |
| --- | --- | --- |
| Wing FTP Server **v7.4.1** for Linux   [[Release Notes]](serverhistory.htm)   [[Installation Guide]](https://bbs.wftpserver.com/viewtopic.php?f=2&t=49) | (18.4 MB) | [Download](download/wftpserver-linux-64bit.tar.gz) |
| Wing FTP Server **v7.4.1** for Mac OS   [[Release Notes]](serverhistory.htm)   [[Installation Guide]](https://bbs.wftpserver.com/viewtopic.php?f=2&t=62) | (16.0 MB) | [Download](download/wftpserver-mac-i386.tar.gz) |

##### How to upgrade?

* Download the latest version first.
* [Optional] Backup the entire folder "/Data" which under WingFTP's installation folder.
* Stop the Wing FTP Server service.
* Install the new version of WingFTP in the same directory.

##### System Requirements:

* 64-bit Windows OS: Windows 11/10/8/7, Windows Server 2022/2019/2016/2012.
* 64-bit Linux OS: Ubuntu 12+, CentOS 7.0+, Red Hat RHEL 7.0+...

### Wing Gateway Wing Gateway

| Wing Gateway **v1.1.2** for Windows   [[Help Manual]](/help/gateway/index.htm) | (3.2 MB) | [Download](download/WingGateway_Setup.exe) |
| --- | --- | --- |
| Wing Gateway **v1.1.2** for 64-bit Linux | (3.0 MB) | [Download](download/WingGateway-linux-64bit.tar.gz) |
| Wing Gateway **v1.1.2** for 32-bit Linux | (2.7 MB) | [Download](download/WingGateway-linux-32bit.tar.gz) |

##### System Requirements:

* Wing FTP Server needs to be installed on same LAN
* CPU: 2 Cores x86 CPU

### FTP Rush v3 FTP Rush v3

| FTP Rush **v3.5.8** for Windows (requires .NET Framework 4.5+) Freeware   [[Release Notes]](releasenotes.htm) | (3.7 MB) | [Download](download/FTPRush-Setup.exe) |
| --- | --- | --- |
| FTP Rush **v3.5.8** for Windows (portable version) Freeware   [[Release Notes]](releasenotes.htm) | (4.0 MB) | [Download](download/FTPRush.zip) |
| FTP Rush **v3.5.8** for Linux Freeware | (15.5 MB) | [Download](download/FTPRush_linux.tar.bz2) |
| FTP Rush **v3.5.8** for Mac OS Freeware [App Store](https://apps.apple.com/us/app/id1611675603) | (12.4 MB) | [Download](download/FTPRush_mac.tar.bz2) |

### FTP Rush App FTP Rush App

Android/iOS version of FTP Rush. Freeware

| Download it from App Store: [App Store](https://apps.apple.com/us/app/id1462600368) | Download it from Google Play: [Google Play](https://play.google.com/store/apps/details?id=com.wftpserver.ftprush) |
| --- | --- |
| Scan QR code to download: QR code | Or download the [APK file](https://www.wftpserver.com/download/com.wftpserver.ftprush.apk) for Android directly |

### [Wing FTP Server](/)

* [Download](download.htm)
* [Quick Start](/help/ftpserver/index.htm?aoe.htm)
* [Purchase](orderserver.htm)
* [Release Notes](serverhistory.htm)

### [Wing Gateway](gateway.htm)

* [Download](download.htm#gateway)
* [Help Manual](/help/gateway/)
* [Purchase](ordergateway.htm)

### [FTP Rush](ftprush.htm)

* [Download](download.htm#ftprush)
* [Help Manual](/help/ftprush/)
* [Release Notes](releasenotes.htm)

### [Blog Posts](/blog/)

* [Accelerate file transfer](/blog/how-to-accelerate-long-distance-file-transfer/)
* [FTP server load balancing](/blog/ftp-server-load-balancing/)
* [Two-factor authentication](/blog/two-factor-authentication-in-wing-ftp-server/)

Copyright Â© 2003 - 2025 wftpserver.com All Rights Reserved   |  [Privacy policy](privacy.htm)


