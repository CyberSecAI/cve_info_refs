Based on the provided information, here's an analysis of CVE-2020-8818:

**Root Cause of Vulnerability:**

*   The vulnerability stems from a **lack of origin authentication** in the IPN (Instant Payment Notification) callback processing function within the CardGate payment gateway module for Magento 2. Specifically, the `cgp_sitesetup` function within the callback controller is vulnerable.

**Weaknesses/Vulnerabilities Present:**

*   **Missing Origin Verification:** The callback processing function does not properly verify the origin of the requests. This allows an attacker to send unauthorized requests.
*   **Remote Configuration Manipulation:** An attacker can remotely overwrite critical plugin settings, such as the merchant ID, API keys, and secret keys, by sending a specifically crafted request to the callback URL. This is done by utilizing the `cgp_sitesetup` parameter and a `token` obtained through the CardGate merchant interface.

**Impact of Exploitation:**

*   **Payment Hijacking:** By replacing the legitimate merchant settings with their own, the attacker can redirect all subsequent payments to their own account.
*   **Order Status Spoofing:** The attacker can manipulate order statuses by sending crafted IPN callbacks with valid signatures but without any actual payment, allowing them to mark orders as paid without making a purchase.
*   **Full Control of Plugin Settings:** An attacker gains the ability to modify the payment gateway's settings, potentially enabling other malicious actions.
*  **Bypassing Fraud Protection:** By providing a valid currency and total amount, an attacker can bypass built-in fraud protection measures.

**Attack Vectors:**

*   **Remote HTTP Requests:** The attacker sends specially crafted HTTP GET requests to the vulnerable callback URL.
*   **IPN Callback URL:** The vulnerability is present in the callback URL, which is intended to receive payment notifications from the gateway.

**Required Attacker Capabilities/Position:**

*   **Publicly Accessible Target:** The attacker needs access to a publicly accessible Magento 2 store using a vulnerable version of the CardGate payment module.
*   **CardGate Merchant Account:** The attacker must have a merchant account on the CardGate platform in order to obtain a valid token that can be used to manipulate the settings of the vulnerable shop.
*   **Network Access:** The attacker needs to be able to send HTTP requests to the target server.

**Technical Details:**

*   The vulnerable code is located in `magento2/Controller/Payment/Callback.php`, specifically lines 88 to 107 which handle the `cgp_sitesetup` parameter and `token`
*   The code uses the `pullConfig` function to obtain configuration data based on the provided token and then overwrites the local configuration settings with the data obtained from the attacker's merchant account.
*   The vulnerability is present because the callback processing function does not authenticate the request's origin, assuming all requests with a valid token are legitimate.

**Additional Notes:**

* The provided Proof-of-Concept code demonstrates how an attacker can exploit the vulnerability. It includes steps to obtain a token and then send a request to the callback URL, manipulating the merchant settings of the target shop and spoofing order status.
*   The vulnerability was fixed in PR #53 and affects versions up to 2.0.30.

**More detail than CVE Description:**
Yes, the provided content offers more detail than a typical CVE description by including the exact location of the vulnerable code, a proof-of-concept exploit, and specific details on how the attack can be performed.

**Content from packetstormsecurity.com**
This content is not related to the CVE

**Content from avatars.githubusercontent.com**
This content is not related to the CVE