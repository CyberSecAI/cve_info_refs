```
{
  "CVE-2020-8165": {
    "description": "Potentially unintended unmarshalling of user-provided objects in MemCacheStore and RedisCacheStore. There is potentially unexpected behaviour in the MemCacheStore and RedisCacheStore where, when untrusted user input is written to the cache store using the `raw: true` parameter, re-reading the result from the cache can evaluate the user input as a Marshalled object instead of plain text.  Unmarshalling of untrusted user input can have impact up to and including RCE. At a minimum, this vulnerability allows an attacker to inject untrusted Ruby objects into a web application.",
    "root_cause": "The vulnerability stems from the MemCacheStore and RedisCacheStore's behavior of potentially unmarshalling user-provided objects when the `raw: true` option is used. If untrusted data is stored in the cache with `raw: true`, it might be interpreted as a Marshalled object upon retrieval, rather than as plain text.",
    "weaknesses": [
      "Deserialization of untrusted data",
      "Improper handling of user input"
    ],
    "impact": "Remote Code Execution (RCE) or injection of untrusted Ruby objects into a web application.",
    "attack_vectors": [
      "Writing untrusted user input to the cache with the `raw: true` parameter",
       "Reading from the cache, where the data is then treated as a Marshalled object"
    ],
    "required_capabilities": "The attacker needs to be able to inject arbitrary content into the cache when the `raw: true` option is set.",
    "additional_details": "Developers should ensure that the `raw` parameter is used consistently when reading and writing to the cache. This is especially critical in the case of RedisCacheStore, which did not detect if data was serialized using the raw option prior to the fix."
  }
}
```