```
{
  "cveId": "CVE-2020-8448",
  "description": "In OSSEC-HIDS 2.7 through 3.5.0, the server component responsible for log analysis (ossec-analysisd) is vulnerable to a denial of service (NULL pointer dereference) via crafted messages written directly to the analysisd UNIX domain socket by a local user.",
  "vulnerabilityDetails": {
    "rootCause": "The `OS_CleanMSG` function in `src/analysisd/cleanevent.c` does not properly handle malformed messages lacking a `->` after a `(` in the location string. Specifically, the nested `strstr` and `strchr` calls can result in a NULL pointer dereference.",
    "weaknesses": [
      "NULL pointer dereference due to improper handling of message format.",
      "Lack of validation/sanitization of the location string before processing"
    ],
    "impact": "A crafted message sent to the analysisd UNIX domain socket can cause a denial of service due to a NULL pointer dereference in `OS_CleanMSG`, resulting in a crash of the `ossec-analysisd` process.",
    "attackVectors": {
      "vector": "Direct write access to the `ossec-analysisd`'s UNIX domain socket.",
      "attackerCapabilities": "A local user with the ability to write directly to the `ossec-analysisd` UNIX domain socket."
    },
       "affectedVersions": "OSSEC-HIDS versions 2.7 through 3.5.0."
  },
  "additionalInformation": {
    "details": "The vulnerability occurs in `src/analysisd/cleanevent.c` within the `OS_CleanMSG` function. When processing messages with a location string that begins with `(` (indicating it originated from a remote agent) the code attempts to extract the location part of the message. It searches for `->` and then for `:` using nested `strstr` and `strchr` functions. If the `->` is missing, the `strstr` call returns `NULL`, and the subsequent `strchr` call with `NULL` as the first argument results in a null pointer dereference causing a crash. The vulnerability was introduced in commit `95cd0c9` on Nov 13, 2013 and affects OSSEC 2.7 and later until the fix was released.",
    "fix": "The fix was implemented by validating the result of `strstr` before calling `strchr`, returning an error (`FORMAT_ERROR`) if the `strstr` returns `NULL`."
  }
}
```