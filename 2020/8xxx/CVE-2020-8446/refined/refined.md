```text
{
  "vulnerability": {
    "root_cause": "The `ossec-analysisd`'s syscheck decoder (`src/analysisd/decoders/syscheck.c`) performs unsafe path handling using the received agent name when trying to get the agent file. The `DB_File` function uses the agent name unsanitized when building a file name to be used with `fopen`.",
    "weaknesses": [
      "Path traversal vulnerability due to unsanitized agent name being used in file path creation."
    ],
    "impact": "A local attacker with write access to the `ossec-analysisd` UNIX domain socket can write crafted syscheck messages. This allows the attacker to create the syscheck DB file in an attacker-controlled location within the chroot.",
    "attack_vectors": [
      "Local access to the ossec-analysisd UNIX domain socket",
       "Crafted syscheck messages with malicious paths"
    ],
    "required_attacker_capabilities": "Local user with write access to the ossec-analysisd UNIX domain socket.",
    "additional_information": "The vulnerability is in the `ossec-analysisd` component, specifically in the syscheck decoder. The agent name is used without sanitization when constructing the file path for the syscheck database.  The vulnerability is exploitable by local users who can directly write to the ossec queue. Remote attackers cannot fully control the path, but local attackers can via direct writes to the ossec queue."
  }
}
```