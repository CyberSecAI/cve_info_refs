The provided content relates to CVE-2020-8027.

**Root cause of vulnerability:**
The `openldap_update_modules_path.sh` script in the openldap2 package had several critical issues:
1. It unconditionally starts the `slapd` daemon during updates, even if it wasn't running or enabled previously.
2. It uses fixed paths in `/tmp` (specifically `/tmp/ldap_conf_tmp.ldif` and `/tmp/slapd.d`) without checking for existing files or directories, potentially overwriting system files.
3. The script doesn't use `set -o errexit`, which means that failures during directory creation are not caught which can lead to further problems.

**Weaknesses/vulnerabilities present:**
1.  **Unconditional service start:** Starting the slapd service regardless of its previous state can cause unexpected behavior, especially during offline upgrades.
2.  **Insecure temporary file handling:** Using fixed paths in `/tmp` without checking for existing files or directories allows an attacker to overwrite existing files/directories or create symlinks to arbitrary locations.
3. **Lack of error handling:** Failures to create directories are not handled which allows the script to proceed even with errors.
4.  **Configuration overwrite**: The script copies the configuration directory to /tmp, which exposes the configuration to a wider range of users.
5.  **Configuration replacement**: The script replaces the existing configuration with one extracted to /tmp, which could be attacker controlled.

**Impact of exploitation:**
1.  **Denial of Service (DoS):** An attacker can cause a DoS by creating symlinks to important system files via the insecure /tmp file handling.
2.  **Arbitrary file overwrite**: An attacker can overwrite any file on the system by creating a symlink in the configuration directory.
3.  **Service Compromise:** By exploiting the insecure temporary file handling an attacker could replace the slapd configuration leading to full service compromise.
4.  **Information Disclosure:** An attacker may be able to read configuration files which are normally not accessible to the user.

**Attack vectors:**
1.  An attacker can create files or directories in `/tmp` using the fixed paths used by the script.
2. An attacker can place symlinks in the configuration directory `/etc/openldap/slapd.d/` that will be followed during script execution.

**Required attacker capabilities/position:**
1.  The attacker needs local access to the system.
2.  The attacker needs to have write access to `/tmp`.
3.  The attacker needs to be able to create files/directories in `/etc/openldap/slapd.d/` if the symlink attack vector is used.

**Additional Details:**
The vulnerability was fixed by replacing the vulnerable script with a new set of scripts, addressing the temporary file handling and the service startup issues.
The issues were fixed in the following SUSE/openSUSE products:
- SUSE Linux Enterprise Module for Legacy Software 15-SP2, 15-SP1.
- SUSE Linux Enterprise Module for Development Tools 15-SP2, 15-SP1.
- SUSE Linux Enterprise Module for Basesystem 15-SP2, 15-SP1.
- openSUSE Leap 15.1, 15.2.
- SUSE Linux Enterprise Server for SAP 15, 15-LTSS.
- SUSE Linux Enterprise High Performance Computing 15-LTSS, 15-ESPOS.