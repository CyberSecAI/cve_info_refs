```
{
  "cve": "CVE-2020-8286",
  "description": "An attacker may provide a fraudulent OCSP response that would appear valid",
  "related_content": [
    {
      "source": "support.apple.com_0e1a1213_20250119_120554.html",
      "text": "curl\n\nAvailable for: macOS Catalina\n\nImpact: An attacker may provide a fraudulent OCSP response that would appear valid\n\nDescription: This issue was addressed with improved checks.\n\nCVE-2020-8286: an anonymous researcher"
    },
    {
      "source": "seclists.org_cbb88041_20250119_120547.html",
      "text": "curl\nAvailable for: macOS Big Sur\nImpact: An attacker may provide a fraudulent OCSP response that would\nappear valid\nDescription: This issue was addressed with improved checks.\nCVE-2020-8286: an anonymous researcher"
    },
    {
      "source": "curl.se_b46c6b74_20250119_134914.html",
      "text": "## CVE-2020-8286\n\n# Inferior OCSP verification\n\nProject curl Security Advisory, December 9th 2020 - [Permalink](https://curl.se/docs/CVE-2020-8286.html)\n\n## VULNERABILITY\n\nlibcurl offers \"OCSP stapling\" via the\n`[CURLOPT_SSL_VERIFYSTATUS](https://curl.se/libcurl/c/CURLOPT_SSL_VERIFYSTATUS.html)` option. When set, libcurl verifies\nthe OCSP response that a server responds with as part of the TLS\nhandshake. It then aborts the TLS negotiation if something is wrong with\nthe response. The same feature can be enabled with\n`--cert-status` using the curl tool.\n\nAs part of the OCSP response verification, a client should verify\nthat the response is indeed set out for the correct certificate. This\nstep was not performed by libcurl when built or told to use OpenSSL as\nTLS backend.\n\nThis flaw would allow an attacker, who perhaps could have breached a\nTLS server, to provide a fraudulent OCSP response that would appear\nfine, instead of the real one. Like if the original certificate actually\nhas been revoked.\n\n## INFO\n\nThe vulnerability is present only if OpenSSL is the designated TLS\nbackend. OCSP stapling is not enabled by default by libcurl, it needs to\nbe explicitly enabled by the application to get used.\n\nOCSP Stapling can be used with any of the TLS based protocols curl\nsupports, including HTTPS, FTPS, SMTPS, POP3S, IMAPS, HTTPS-proxy and\nmore.\n\nThe Common Vulnerabilities and Exposures (CVE) project has assigned\nthe name CVE-2020-8286 to this issue.\n\nCWE-299: Improper Check for Certificate Revocation\n\nSeverity: Medium\n\n## AFFECTED VERSIONS\n\n* Affected versions: libcurl [7.41.0](vuln-7.41.0.html) to and including [7.73.0](vuln-7.73.0.html)\n* Not affected versions: libcurl < [7.41.0](vuln-7.41.0.html) and libcurl >=\n  [7.74.0](vuln-7.74.0.html)\n* Introduced-in: <https://github.com/curl/curl/commit/d1cf5d570663d>\n\nAlso note that libcurl is used by many applications, and not always\nadvertised as such.\n\n## SOLUTION\n\nThe OCSP response checker function now also verifies that the\ncertificate id is the correct one.\n\n* Fixed-in: <https://github.com/curl/curl/commit/d9d01672785b>\n\n## RECOMMENDATIONS\n\nWe suggest you take one of the following actions immediately, in\norder of preference:\n\nA - Upgrade libcurl to version [7.74.0](vuln-7.74.0.html)\n\nB - Do not rely on OCSP\n\n## TIMELINE\n\nThis issue was first reported to the curl project on December 2,\n2020.\n\nThis advisory was posted on December 9th 2020.\n\n## CREDITS\n\n* Reported-by: Ospoco\n* Patched-by: Daniel Stenberg\n\nThis issue was identified and patched by an *Ospoco* customer\nwho wishes to remain anonymous.\n\nThanks a lot!"
    },
    {
      "source": "support.apple.com_1d24c7b9_20250119_120553.html",
      "text": "curl\n\nAvailable for: macOS Big Sur\n\nImpact: An attacker may provide a fraudulent OCSP response that would appear valid\n\nDescription: This issue was addressed with improved checks.\n\nCVE-2020-8286: an anonymous researcher"
    },
      {
      "source": "support.apple.com_a6b55781_20250119_120555.html",
      "text": "curl\n\nAvailable for: macOS Mojave\n\nImpact: An attacker may provide a fraudulent OCSP response that would appear valid\n\nDescription: This issue was addressed with improved checks.\n\nCVE-2020-8286: an anonymous researcher"
    },
       {
      "source": "seclists.org_f4fd3609_20250119_120548.html",
      "text": "curl\nAvailable for: macOS Catalina\nImpact: An attacker may provide a fraudulent OCSP response that would\nappear valid\nDescription: This issue was addressed with improved checks.\nCVE-2020-8286: an anonymous researcher"
    },
     {
      "source": "lists.debian.org_597b3d72_20250119_120550.html",
      "text": "CVE-2020-8286\n\n    It was reported that libcurl didn't verify that an OCSP response\n    actually matches the certificate it is intended to.\n\n    The OCSP response checker function now also verifies that the\n    certificate id is the correct one."
    },
     {
      "source": "security.gentoo.org_d92bc106_20250119_120551.html",
      "text": "### References\n\n* [CVE-2020-8286](https://nvd.nist.gov/vuln/detail/CVE-2020-8286)"
    },
     {
      "source": "www.oracle.com_0b164f06_20250119_120557.html",
      "text": "CVE-2020-8286\n\n   The libcurl library versions 7.41.0 to and including 7.73.0 are\n   vulnerable to an improper check for certiﬁcate revocation due to\n   insufﬁcient veriﬁcation of the OCSP response. This vulnerability could\n   allow an attacker to pass a revoked certiﬁcate as valid."
    },
    {
      "source": "curl.se_053dc417_20250119_134901.html",
        "text": "## Description\n\nPass a long as parameter set to 1 to enable or 0 to disable.\n\nThis option determines whether libcurl verifies the status of the server cert using the \"Certificate Status Request\" TLS extension (aka. OCSP stapling).\n\nNote that if this option is enabled but the server does not support the TLS extension, the verification fails."
    },
    {
      "source": "lists.fedoraproject.org_abb947f6_20250119_120551.html",
      "text": "- curl: Inferior OCSP verification (CVE-2020-8286) - libcurl: FTP wildcard stack\noverflow (CVE-2020-8285) - curl: trusting FTP PASV responses (CVE-2020-8284)"
    },
    {
      "source": "bugs.gentoo.org_0a0abf2a_20250119_134916.html",
      "text": ""
    },
      {
      "source": "seclists.org_f4fd3609_20250119_120548.html",
      "text": "curl\nAvailable for: macOS Mojave\nImpact: An attacker may provide a fraudulent OCSP response that would\nappear valid\nDescription: This issue was addressed with improved checks.\nCVE-2020-8286: an anonymous researcher"
    },
    {
      "source": "security.netapp.com_6dd57dfa_20250119_120552.html",
      "text": "CVEs: CVE-2020-8284, CVE-2020-8285, CVE-2020-8286\n\nMultiple NetApp products incorporate curl/libcurl. Libcurl versions prior to 7.74.0 are susceptible to vulnerabilities which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).\n\nSuccessful exploitation of these vulnerabilities could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).\n\nClustered Data ONTAP is affected only by CVE-2020-8284 and CVE-2020-8286.\n\n| **CVE** | **Score** | **Vector** |\n| --- | --- | --- |\n| [CVE-2020-8286](https://nvd.nist.gov/vuln/detail/CVE-2020-8286) | 7.5 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N |\n\n*   <https://curl.se/docs/CVE-2020-8284.html>\n*   <https://curl.se/docs/CVE-2020-8285.html>\n*   <https://curl.se/docs/CVE-2020-8286.html>"
    },
     {
      "source": "lists.fedoraproject.org_41753249_20250119_120551.html",
      "text": "- curl: Inferior OCSP verification (CVE-2020-8286) - libcurl: FTP wildcard stack\noverflow (CVE-2020-8285) - curl: trusting FTP PASV responses (CVE-2020-8284)"
    },
     {
      "source": "lists.debian.org_597b3d72_20250119_120550.html",
      "text": "CVE ID         : CVE-2020-8284 CVE-2020-8285 CVE-2020-8286\n\nCVE-2020-8286\n\n    It was reported that libcurl didn't verify that an OCSP response\n    actually matches the certificate it is intended to."
    }
  ],
  "vulnerability_details": {
    "root_cause": "The libcurl library, when built with OpenSSL, did not verify that the OCSP response received during TLS handshake was for the correct certificate.",
    "weaknesses": [
      "Improper Check for Certificate Revocation",
      "Insufficient verification of OCSP response",
      "Missing validation of certificate id in OCSP response"
    ],
    "impact": "An attacker could provide a fraudulent OCSP response which would bypass revocation checks. If the targeted client relies solely on OCSP, it would consider a revoked certificate as valid.",
    "attack_vectors": [
      "Man-in-the-middle attack (if attacker is able to intercept and modify traffic)",
      "Compromised server (if attacker has control over the server)"
    ],
    "attacker_capabilities": "An attacker needs to be in a position to intercept or modify the network traffic between the client and the server, or compromise the server to be able to present a fraudulent OCSP response.",
    "affected_components": [
      "libcurl when built with OpenSSL",
      "OCSP stapling functionality",
	  "CURLOPT_SSL_VERIFYSTATUS option",
      "curl command-line tool using the --cert-status option"
    ]
  }
}
```