```
{
  "CVE-2020-8834": {
    "Description": "KVM in the Linux kernel on Power8 processors has a conflicting use of HSTATE_HOST_R1 to store r1 state in kvmppc_hv_entry plus in kvmppc_{save,restore}_tm, leading to a stack corruption. Because of this, an attacker with the ability run code in kernel space of a guest VM can cause the host kernel to panic. There were two commits that, according to the reporter, introduced the vulnerability: f024ee098476 ('KVM: PPC: Book3S HV: Pull out TM state save/restore into separate procedures') 87a11bb6a7f7 ('KVM: PPC: Book3S HV: Work around XER[SO] bug in fake suspend mode')",
    "Root cause of vulnerability": "Conflicting use of the HSTATE_HOST_R1 register in the KVM implementation for PowerPC processors when saving and restoring the TM (Transactional Memory) state of a guest. Specifically, the register is used both within `kvmppc_hv_entry` and `kvmppc_{save,restore}_tm` without proper isolation, leading to a stack corruption.",
    "Weaknesses/vulnerabilities present": "Stack corruption due to conflicting usage of a register. The vulnerability occurs due to improper state handling in the KVM code when entering or leaving the guest in a suspended state.",
    "Impact of exploitation": "An attacker with the ability to run code within a guest VM kernel space can cause a denial of service on the host system (host kernel panic).",
    "Attack vectors": "The attack vector is a local attacker executing malicious code within a KVM guest on a Power8 host, which triggers the vulnerability through a specific hypercall while the CPU is in a Transactional Memory (TM) suspended mode.",
    "Required attacker capabilities/position": "The attacker needs to have the ability to execute code in the kernel space of a guest VM, and the Transactional Memory facility needs to be enabled in the guest. The attacker exploits this by executing a hypercall (e.g., H_PUT_TERM_CHAR) when the CPU is in TM suspended mode."
  }
}
```