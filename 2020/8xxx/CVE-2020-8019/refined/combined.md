=== Content from bugzilla.suse.com_cff54cc9_20250119_115300.html ===


| Bugzilla – Bug 1169385 | VUL-0: CVE-2020-8019: syslog-ng: Local privilege escalation from new to root in %post | Last modified: 2020-06-29 09:38:29 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1169385)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 1169385**](show_bug.cgi?id=1169385)
(CVE-2020-8019)
- VUL-0: CVE-2020-8019: syslog-ng: Local privilege escalation from new to root in %post

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: CVE-2020-8019: syslog-ng: Local privilege escalation from new to root ...

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2020-8019 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Incidents ([show other bugs](buglist.cgi?component=Incidents&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P3 - Medium **Severity**: Normal | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Security Team bot | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <https://smash.suse.de/issue/257020/> | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2020-04-14 08:13 UTC by Johannes Segitz | | --- | --- | | Modified: | 2020-06-29 09:38 UTC ([History](show_activity.cgi?id=1169385)) | | CC List: | 6 users (show)  jsegitz meissner mli peter thomas.blume wolfgang.frisch | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=1169385) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**diff of syslog-ng.spec**](attachment.cgi?id=835793 "View the content of the attachment") (1.39 KB, text/plain)  [2020-04-15 08:55 UTC](#attach_835793 "Go to the comment associated with the attachment"), Thomas Blume | [Details](attachment.cgi?id=835793&action=edit) | | [View All](attachment.cgi?bugid=1169385&action=viewall)  [Add an attachment](attachment.cgi?bugid=1169385&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=1169385&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1169385#c0)  Johannes Segitz   2020-04-14 08:13:05 UTC  ``` POC:  sh-4.4$ id uid=453(news) gid=450(news) groups=450(news) context=unconfined_u:unconfined_r:unconfined_t:s0 sh-4.4$ cd /var/log/news/ sh-4.4$ rm news.err sh-4.4$ ln -s /etc/shadow news.err  As root force reinstall of syslog-ng zypper in -f syslog-ng  After that: sh-4.4$ ls -lah /etc/shadow -rw-r-----. 1 news news 1.2K Apr 14 10:03 /etc/shadow   The issue is this section in %post 364 mkdir -p -m 0750 var/log/news 365 chown news:news  var/log/news 366 touch var/log/news/news.crit;   chmod 640 var/log/news/news.crit 367 chown news:news var/log/news/news.crit 368 touch var/log/news/news.err;    chmod 640 var/log/news/news.err 369 chown news:news var/log/news/news.err 370 touch var/log/news/news.notice; chmod 640 var/log/news/news.notice 371 chown news:news var/log/news/news.notice  As /var/log/news is owned by news it's dangerous to operate as root in this directory. SLE 12 and Factory are affected. I would just remove this construct and let rpm create the files ``` [Comment 1](show_bug.cgi?id=1169385#c1)  Johannes Segitz   2020-04-14 08:16:07 UTC  ``` This issue will be handled according to our disclosure policy outlined in [https://en.opensuse.org/openSUSE:Security_disclosure_policy](https://en.opensuse.org/openSUSE%3ASecurity_disclosure_policy)  The information listed here is not public. Please - do not talk to other people about this unless they're involved in fixing the issue - do not make this bug public - do not submit this into OBS (e.g. fix Leap) until this is public  In accordance with our policy we will make this issue public latest at Internal CRD: 2020-07-13 or earlier This is the latest possible date and we prefer to make it public earlier if the situation allows it. In that case we'll post a comment here setting the new date.  This is an internal finding, so we can make it public at any time we chose, but please coordinate with us.  In doubt please talk to us on IRC (#security) or send us a mail (security@suse.de). ``` [Comment 2](show_bug.cgi?id=1169385#c2)  Thomas Blume   2020-04-14 08:36:48 UTC  ``` Hm, AFAIK, syslog-ng is not shipped anymore with the currently supported SLES version. According to <https://www.suse.com/releasenotes/x86_64/SUSE-SLES/12/> it is part of the Legacy Module for which support seems to have expired too. So, I'm not sure for which codestreams I will have to provide the fix.  Anyone who knows? ``` [Comment 3](show_bug.cgi?id=1169385#c3)  Johannes Segitz   2020-04-14 09:21:45 UTC  ``` (In reply to Thomas Blume from [comment #2](show_bug.cgi?id=1169385#c2)) According to is_maintained:  SLE-DEBUGINFO_11-SP1-TERADATA           SUSE:SLE-11-SP1:Update SLE-SERVER_11-SP1-TERADATA              SUSE:SLE-11-SP1:Update SLE-DEBUGINFO_11-SP3-TERADATA           SUSE:SLE-11-SP1:Update SLE-SERVER_11-SP3-TERADATA              SUSE:SLE-11-SP1:Update SLE-Module-Legacy_12                    SUSE:SLE-12:Update SLE-SAP_12-SP1                          SUSE:SLE-12:Update  So SLE-11-SP1 and SLE-12 please. CCing peter@czanik.hu for openSUSE ``` [Comment 4](show_bug.cgi?id=1169385#c4)  peter czanik   2020-04-15 07:26:48 UTC  ``` Could you share the proposed fix for SLES? I'll test it on openSUSE on a local build.  Note: current Base:System:syslog-ng is not yet accepted to Factory. Someone submitted an update to the latest version and some cleanup, which I accepted there, but it needs some changes before it can go to Factory. As I see a June date for CVE publication, I fix it independent of this. So, once this bug is public, we can go the regular Base:System:syslog-ng -> Factory easily. ``` [Comment 5](show_bug.cgi?id=1169385#c5)  Thomas Blume   2020-04-15 08:55:34 UTC  ``` Created [attachment 835793](attachment.cgi?id=835793 "diff of syslog-ng.spec") [[details]](attachment.cgi?id=835793&action=edit "diff of syslog-ng.spec") diff of syslog-ng.spec  Here is a diff of the specfile. Johannes, does that match your proposal? ``` [Comment 6](show_bug.cgi?id=1169385#c6)  Johannes Segitz   2020-04-15 11:37:25 UTC  ``` looks good, thanks ``` [Comment 9](show_bug.cgi?id=1169385#c9)  ming li   2020-04-21 07:34:37 UTC  ``` I'm testing the update. I found a problem. When I upgrade the program to a new version(3.6.4-12.6.1), the contents of the files in the previous news directory will be cleared, and this problem will also be triggered during the forced or upgraded installation of the same version of software. The tested old version of the package does not have these problems(3.6.4-12.3.1), and the log will be kept intact.  reproducer: s12sp3:~ # rpm -qa|grep syslog-ng syslog-ng-3.6.4-12.3.1.x86_64  s12sp3:~ # su news  news@s12sp3:/root> cd /var/log/news  news@s12sp3:/var/log/news> echo "abcdefghijk" > news.err  news@s12sp3:/var/log/news> cat news.err abcdefghijk  news@s12sp3:/var/log/news> ll total 4 -rw-r----- 1 news news  0 Apr 21 15:23 news.crit -rw-r----- 1 news news 12 Apr 21 15:23 news.err -rw-r----- 1 news news  0 Apr 21 15:23 news.notice  s12sp3:~ # zypper ar -f [http://download.suse.de/ibs/SUSE:/Maintenance:/14729/SUSE_Updates_SLE-Module-Legacy_12_x86_64/](http://download.suse.de/ibs/SUSE%3A/Maintenance%3A/14729/SUSE_Updates_SLE-Module-Legacy_12_x86_64/) test  s12sp3:~ # zypper up syslog-ng  s12sp3:~ # rpm -qa|grep syslog-ng syslog-ng-3.6.4-12.6.1.x86_64  s12sp3:~ # cat /var/log/news/news.err  s12sp3:~ # ll /var/log/news/ total 0 -rw-r----- 1 news news 0 Apr 16 15:44 news.crit -rw-r----- 1 news news 0 Apr 16 15:44 news.err -rw-r----- 1 news news 0 Apr 16 15:44 news.notice   The contents of the files will also be emptied during the forced or upgraded installation of the same version of software:  s12sp3:~ # zypper ar -f [http://download.suse.de/ibs/SUSE:/Maintenance:/14729/SUSE_Updates_SLE-Module-Legacy_12_x86_64/](http://download.suse.de/ibs/SUSE%3A/Maintenance%3A/14729/SUSE_Updates_SLE-Module-Legacy_12_x86_64/) test  s12sp3:~ # zypper in -f syslog-ng  s12sp3:~ # rpm -qa|grep syslog-ng syslog-ng-3.6.4-12.6.1.x86_64  s12sp3:~ # su news  news@s12sp3:/root> cd /var/log/news  news@s12sp3:/var/log/news> echo "abcdefghijk" > news.err  news@s12sp3:/var/log/news> cat news.err abcdefghijk  news@s12sp3:/var/log/news> ll total 4 -rw-r----- 1 news news  0 Apr 16 15:44 news.crit -rw-r----- 1 news news 12 Apr 21 15:04 news.err -rw-r----- 1 news news  0 Apr 16 15:44 news.notice  s12sp3:~ # zypper in -f syslog-ng Loading repository data... Reading installed packages... Forcing installation of 'syslog-ng-3.6.4-12.6.1.x86_64' from repository 'test'. Resolving package dependencies...  The following package is going to be reinstalled:   syslog-ng  1 package to reinstall. Overall download size: 475.9 KiB. Already cached: 0 B. No additional space will be used or freed after the operation. Continue? [y/n/...? shows all options] (y):  Retrieving package syslog-ng-3.6.4-12.6.1.x86_64                                                                                      (1/1), 475.9 KiB (  1.8 MiB unpacked) Retrieving: syslog-ng-3.6.4-12.6.1.x86_64.rpm .........................................................................................................[done (207.4 KiB/s)]  Checking for file conflicts: ........................................................................................................................................[done] (1/1) Installing: syslog-ng-3.6.4-12.6.1.x86_64 .....................................................................................................................[done] Additional rpm output: Updating /etc/sysconfig/syslog...  s12sp3:~ # ll /var/log/news total 0 -rw-r----- 1 news news 0 Apr 16 15:44 news.crit -rw-r----- 1 news news 0 Apr 16 15:44 news.err -rw-r----- 1 news news 0 Apr 16 15:44 news.notice  s12sp3:~ # cat /var/log/news/news.err ``` [Comment 10](show_bug.cgi?id=1169385#c10)  Marcus Meissner   2020-04-21 07:55:02 UTC  ``` this means it destroys the /var/log/news content during update, which is not so good.  perhaps using something like %ghost files might help. ``` [Comment 11](show_bug.cgi?id=1169385#c11)  ming li   2020-04-21 08:06:59 UTC  ``` It also removes the entire news directory during the downgrade:  reproducer: s12sp3:~ # rpm -qa|grep syslog-ng syslog-ng-3.6.4-12.6.1.x86_64  s12sp3:~ # su news  news@s12sp3:/root> cd /var/log/news/  news@s12sp3:/var/log/news> echo "abcdefghijk" > news.err  news@s12sp3:/var/log/news>  cat news.err abcdefghijk  news@s12sp3:/var/log/news> ll total 4 -rw-r----- 1 news news  0 Apr 16 15:44 news.crit -rw-r----- 1 news news 12 Apr 21 15:51 news.err -rw-r----- 1 news news  0 Apr 16 15:44 news.notice  s12sp3:~ # zypper in -f --oldpackage syslog-ng-3.6.4-12.3.1  s12sp3:~ # rpm -qa|grep syslog-ng syslog-ng-3.6.4-12.3.1.x86_64  s12sp3:~ # ls /var/log/news ls: cannot access '/var/log/news': No such file or directory  I think it's a regression. ``` [Comment 12](show_bug.cgi?id=1169385#c12)  Johannes Segitz   2020-04-21 08:39:33 UTC  ``` I'm not sure if %ghost would work as that IIRC wouldn't create the file and set the permissions as needed. Maybe marking it as %config could be abused, but that feels pretty dirty ``` [Comment 13](show_bug.cgi?id=1169385#c13)  Thomas Blume   2020-04-21 11:06:58 UTC  ``` (In reply to Johannes Segitz from [comment #12](show_bug.cgi?id=1169385#c12)) > I'm not sure if %ghost would work as that IIRC wouldn't create the file and > set the permissions as needed. Maybe marking it as %config could be abused, > but that feels pretty dirty  So, the only chance I see is to move the old news directory away in a %pre script, and cat the content of the old news files in the freshly created files in a %post script. Would that be ok? ``` [Comment 14](show_bug.cgi?id=1169385#c14)  Johannes Segitz   2020-04-21 13:45:57 UTC  ``` (In reply to Thomas Blume from [comment #13](show_bug.cgi?id=1169385#c13)) no that doesn't work as this would mean that root operates in a user controlled directory. That is really hard to do right and almost impossible in bash.   Since %ghost doesn't work please give %config(noreplace) at try. Maybe someone with more packaging knowledge has a better idea ``` [Comment 15](show_bug.cgi?id=1169385#c15)  peter czanik   2020-04-22 06:50:59 UTC  ``` First of all a stupid question: is there still anything using these log files? I did a quick search on Leap packages, so I might have overlooked something, but I could not find anything news related.  Also, I did not have time yet for testing, so I might ask something stupid:  - how is it solved in rsyslog packaging? - even if we remove news related stuff from %post, it remains a user owned directory where the user still can delete files, create symlinks, etc. So, is this really a solution? - syslog-ng can create files and even directories on demand with proper user and permissions, see: create-dirs(), dir-* at <https://www.syslog-ng.com/technical-documents/doc/syslog-ng-open-source-edition/3.16/administration-guide/31#TOPIC-956501>  Obviously #2 and #3 contradict each other, but with #3 news related directory and file are only created if there is incoming log for news.  Another workaround idea: make the /var/log/news directory owned by root. That way the news user can't do anything ugly and syslog-ng can still create log files owned by news.  If all goes well, I can spend more time on it in the coming days.  CzP from syslog-ng upstream ``` [Comment 16](show_bug.cgi?id=1169385#c16)  Thomas Blume   2020-04-22 07:37:57 UTC  ``` (In reply to peter czanik from [comment #15](show_bug.cgi?id=1169385#c15)) > First of all a stupid question: is there still anything using these log > files? I did a quick search on Leap packages, so I might have overlooked > something, but I could not find anything news related. >  > Also, I did not have time yet for testing, so I might ask something stupid: >  > - how is it solved in rsyslog packaging? > - even if we remove news related stuff from %post, it remains a user owned > directory where the user still can delete files, create symlinks, etc. So, > is this really a solution? > - syslog-ng can create files and even directories on demand with proper user > and permissions, see: create-dirs(), dir-* at > <https://www.syslog-ng.com/technical-documents/doc/syslog-ng-open-source>- > edition/3.16/administration-guide/31#TOPIC-956501 >  > Obviously #2 and #3 contradict each other, but with #3 news related > directory and file are only created if there is incoming log for news. >  > Another workaround idea: make the /var/log/news directory owned by root. > That way the news user can't do anything ugly and syslog-ng can still create > log files owned by news.  I guess for Leap another question would be, is syslog-ng still used by anyone? ;)  For SLES, I'm afraid we cannot go the way of syslog-ng autocreation of the news files, since they were there in previous packages. syslog-ng in SLES is already far into LTSS and changing the presence of files in a package at this stage of the lifecycle is pretty problematic. We have to be as less intrusive as possible for such legacy packages. ``` [Comment 17](show_bug.cgi?id=1169385#c17)  Johannes Segitz   2020-04-22 15:16:08 UTC  ``` (In reply to peter czanik from [comment #15](show_bug.cgi?id=1169385#c15)) > First of all a stupid question: is there still anything using these log files?                                                                                                                can't answer this, but usually there's at least one person using every oh so arcane thing  > Also, I did not have time yet for testing, so I might ask something stupid: > > - how is it solved in rsyslog packaging?  rsyslog doesn't package any files in /var/log in openSUSE  > - even if we remove news related stuff from %post, it remains a user owned directory where the user still can delete files, create symlinks, etc. So, is this really a solution?  yes because that isn't the problem. The issue here it the ability to escalate your privileges to root. Of course it would be better if the log files belonged to root, but I assume that they need to belong to news so that this user can write into these files  > - syslog-ng can create files and even directories on demand with proper user and permissions, see: create-dirs(), dir-* at <https://www.syslog-ng.com/technical-documents/doc/syslog-ng-open-source-edition/3.16/administration-guide/31#TOPIC-956501>  If we can configure syslog-ng to create the files when needed than this would be the best solution if this is done in a secure way (either /var/log/news belonging to root, see below, or syslog-ng being really careful when operating in a non-root owned directory)  > Another workaround idea: make the /var/log/news directory owned by root. That way the news user can't do anything ugly and syslog-ng can still create log files owned by news.  That would work if syslog-ng is careful in how it does that. If you have a config for that that I can test I can check if this is done in a secure way  > If all goes well, I can spend more time on it in the coming days.  Great to hear :) ``` [Comment 18](show_bug.cgi?id=1169385#c18)  peter czanik   2020-04-23 09:39:43 UTC  ``` Yes, syslog-ng is still in use by SLES and Leap users. As all error messages direct people to syslog-ng websites, most questions and bug reports land by us upstream. Many use my unofficial syslog-ng packages from OBS as well, both SLES and Leap. Even on some less common architectures, like POWER and Aarch64 :)  If log files need to be created by the time of installation, then the only possible workaround I see is to do some tests. Does something like this work from RPM?  if [[ -L var/log/news/news.err ]]; then echo "oops, var/log/news/news.err is a symlink, skipping it"; else touch var/log/news/news.err; chmod 640 var/log/news/news.err ; fi  I'll post a syslog-ng configuration in the afternoon for creating news directory and files on demand with proper rights. Practically it's adding the following setting to all destinations within the news directory:  create-dirs(yes) dir-group("news") dir-owner("news") dir-perm(750)  I did not test it yet. ``` [Comment 19](show_bug.cgi?id=1169385#c19)  peter czanik   2020-04-23 10:26:09 UTC  ``` Relevant part of the syslog-ng configuration for automagical directory creation:  " # # News-messages in separate files: # destination newscrit   { file("/var/log/news/news.crit"     create-dirs(yes) dir-group("news") dir-owner("news") dir-perm(0750) suppress(30) owner(news) group(news)); }; log { source(src); source(chroots); filter(f_newscrit); destination(newscrit); };  destination newserr    { file("/var/log/news/news.err"     create-dirs(yes) dir-group("news") dir-owner("news") dir-perm(0750) suppress(30) owner(news) group(news)); }; log { source(src); source(chroots); filter(f_newserr); destination(newserr); };  destination newsnotice { file("/var/log/news/news.notice"     create-dirs(yes) dir-group("news") dir-owner("news") dir-perm(0750) suppress(30) owner(news) group(news)); }; log { source(src); source(chroots); filter(f_newsnotice); destination(newsnotice); }; "  It seems to work fine. For the Tumbleweed / Leap route I'd go this direction and remove the log file creation part completely, not just for news.  What do you think? ``` [Comment 20](show_bug.cgi?id=1169385#c20)  Johannes Segitz   2020-04-24 07:38:47 UTC  ``` (In reply to peter czanik from [comment #18](show_bug.cgi?id=1169385#c18)) > if [[ -L var/log/news/news.err ]]; then echo "oops, var/log/news/news.err is a symlink, skipping it"; else touch var/log/news/news.err; chmod 640 var/log/news/news.err ; fi  This is a TOCTOU vulnerabilty (<https://en.wikipedia.org/wiki/Time-of-check_to_time-of-use>). If you check first and then act on this I can come in between the check and the action.  You could package the var/log/news directory with the proper permissions (that shouldn't cause issues with overwriting existing files and then use setpriv to create the files as the news use if they don't exits. In this case the TOCTOU issue isn't a problem since the news user can't gain additional privileges.  Thanks for the syslog-ng snipped, I'll have a look if this is secure ``` [Comment 21](show_bug.cgi?id=1169385#c21)  Thomas Blume   2020-04-30 04:56:44 UTC  ``` (In reply to Johannes Segitz from [comment #14](show_bug.cgi?id=1169385#c14)) > (In reply to Thomas Blume from [comment #13](show_bug.cgi?id=1169385#c13)) > no that doesn't work as this would mean that root operates in a user > controlled directory. That is really hard to do right and almost impossible > in bash.  >  > Since %ghost doesn't work please give %config(noreplace) at try. Maybe > someone with more packaging knowledge has a better idea  My tests confirm that this works. If there are no objections, I will submit that for the SLES LTSS versions. For openSUSE we can find a better approach but for LTSS, I guess it's the best we can do. ``` [Comment 22](show_bug.cgi?id=1169385#c22)  Johannes Segitz   2020-04-30 07:46:00 UTC  ``` (In reply to Thomas Blume from [comment #21](show_bug.cgi?id=1169385#c21)) okay lets do that. In the meantime I had a look at the configuration example you provided. First testing showed it to be secure, so that would be the way forward in my opinion. I didn't have time for an in depth look though, maybe at a later time ``` [Comment 25](show_bug.cgi?id=1169385#c25)  Swamp Workflow Management   2020-05-07 19:28:17 UTC  ``` SUSE-SU-2020:1221-1: An update that fixes one vulnerability is now available.  Category: security (moderate) Bug References: 1169385 CVE References: CVE-2020-8019 Sources used: SUSE Linux Enterprise Server for SAP 12-SP1 (src):    syslog-ng-3.6.4-12.8.1 SUSE Linux Enterprise Module for Legacy Software 12 (src):    syslog-ng-3.6.4-12.8.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 26](show_bug.cgi?id=1169385#c26)  peter czanik   2020-05-08 06:35:05 UTC  ``` What was the final solution for SLES?  For the openSUSE package I definitely plan to remove this part:  364 mkdir -p -m 0750 var/log/news 365 chown news:news  var/log/news 366 touch var/log/news/news.crit;   chmod 640 var/log/news/news.crit 367 chown news:news var/log/news/news.crit 368 touch var/log/news/news.err;    chmod 640 var/log/news/news.err 369 chown news:news var/log/news/news.err 370 touch var/log/news/news.notice; chmod 640 var/log/news/news.notice 371 chown news:news var/log/news/news.notice  For the configuration part I plan to implement the changes I suggested:  " # # News-messages in separate files: # destination newscrit   { file("/var/log/news/news.crit"     create-dirs(yes) dir-group("news") dir-owner("news") dir-perm(0750) suppress(30) owner(news) group(news)); } / log { source(src); source(chroots); filter(f_newscrit); destination(newscrit); } /  destination newserr    { file("/var/log/news/news.err"     create-dirs(yes) dir-group("news") dir-owner("news") dir-perm(0750) suppress(30) owner(news) group(news)); } / log { source(src); source(chroots); filter(f_newserr); destination(newserr); } /  destination newsnotice { file("/var/log/news/news.notice"     create-dirs(yes) dir-group("news") dir-owner("news") dir-perm(0750) suppress(30) owner(news) group(news)); } / log { source(src); source(chroots); filter(f_newsnotice); destination(newsnotice); } / "  On the other hand might change it to comment it out. If there is anyone still using news (I highly doubt, there are no news related applications in Leap or Factory), one would need to enable it by hand. I happy to answer any related bugzilla reports :) ``` [Comment 27](show_bug.cgi?id=1169385#c27)  Thomas Blume   2020-05-08 07:27:31 UTC  ``` (In reply to peter czanik from [comment #26](show_bug.cgi?id=1169385#c26)) > What was the final solution for SLES?  This was actually the patch from [comment#5](show_bug.cgi?id=1169385#c5) plus %config(noreplace) that Johannes suggested in [comment#14](show_bug.cgi?id=1169385#c14). This is because syslog-ng is only available in legacy SLES versions where we attempt to minimize changes caused by updates. ``` [Comment 28](show_bug.cgi?id=1169385#c28)  peter czanik   2020-05-12 08:38:21 UTC  ``` Finally I could login again to Bugzilla...  openSUSE: now that the bug is public, I did test packages for openSUSE. First tested in my unofficial syslog-ng git snapshot repo: [https://build.opensuse.org/project/show/home:czanik:syslog-ng-githead](https://build.opensuse.org/project/show/home%3Aczanik%3Asyslog-ng-githead) and it worked fine.  Then branched Base:System/syslog-ng and did the same changes: [https://build.opensuse.org/package/rdiff/home:czanik:branches:Base:System/syslog-ng?linkrev=base&rev=2](https://build.opensuse.org/package/rdiff/home%3Aczanik%3Abranches%3ABase%3ASystem/syslog-ng?linkrev=base&rev=2)  Please review my changes and let me know if it's OK. If yes, I'll push it to Base:System/syslog-ng and to Tumbleweed.  I'd appreciate if someone could push the fix to openSUSE Leap 15.1! This part of the spec file and configuration did not change for over a decade, so porting it from the above URL should be trivial.  And how should we proceed for Leap 15.2? ``` [Comment 29](show_bug.cgi?id=1169385#c29)  Thomas Blume   2020-05-12 14:39:35 UTC  ``` Peter, what info do you need from me? The changes look ok to me, but I'm not in the reviewers team for syslog-ng on openSUSE. ``` [Comment 30](show_bug.cgi?id=1169385#c30)  Swamp Workflow Management   2020-05-14 16:15:44 UTC  ``` SUSE-SU-2020:14369-1: An update that fixes one vulnerability is now available.  Category: security (moderate) Bug References: 1169385 CVE References: CVE-2020-8019 Sources used: SUSE Linux Enterprise Server 11-SP4-LTSS (src):    syslog-ng-2.0.9-27.34.40.5.1 SUSE Linux Enterprise Point of Sale 11-SP3 (src):    syslog-ng-2.0.9-27.34.40.5.1 SUSE Linux Enterprise Debuginfo 11-SP4 (src):    syslog-ng-2.0.9-27.34.40.5.1 SUSE Linux Enterprise Debuginfo 11-SP3 (src):    syslog-ng-2.0.9-27.34.40.5.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 31](show_bug.cgi?id=1169385#c31)  peter czanik   2020-05-15 11:06:46 UTC  ``` (In reply to Thomas Blume from [comment #29](show_bug.cgi?id=1169385#c29)) > Peter, what info do you need from me? > The changes look ok to me, but I'm not in the reviewers team for syslog-ng > on openSUSE.  This is the main information I need. As in this case I can go ahead and and submit it to Base:System and Tumbleweed.  My other concern is, who could submit the fix to openSUSE Leap 15.1? I could not find a workflow for it in the wiki, and probably it is easier for someone, who did it a few times anyway.  (sorry for the late answer, since Monday I have troubles logging in) ``` [Comment 32](show_bug.cgi?id=1169385#c32)  Thomas Blume   2020-05-15 12:12:52 UTC  ``` (In reply to peter czanik from [comment #31](show_bug.cgi?id=1169385#c31)) > (In reply to Thomas Blume from [comment #29](show_bug.cgi?id=1169385#c29)) > > Peter, what info do you need from me? > > The changes look ok to me, but I'm not in the reviewers team for syslog-ng > > on openSUSE. >  > This is the main information I need. As in this case I can go ahead and and > submit it to Base:System and Tumbleweed. >  > My other concern is, who could submit the fix to openSUSE Leap 15.1? I could > not find a workflow for it in the wiki, and probably it is easier for > someone, who did it a few times anyway.  I can take care of this when the Tumbleweed request has been accepted.  > (sorry for the late answer, since Monday I have troubles logging in)  np. I wasn't sure whether you could see my comment, since it was initially set to private. ``` [Comment 33](show_bug.cgi?id=1169385#c33)  peter czanik   2020-05-16 07:39:29 UTC  ``` Thanks! It is now accepted: <https://build.opensuse.org/request/show/805818> ``` [Comment 34](show_bug.cgi?id=1169385#c34)  OBSbugzilla Bot   2020-05-20 08:10:08 UTC  ``` This is an autogenerated message for OBS integration: This bug (1169385) was mentioned in <https://build.opensuse.org/request/show/807465> 15.1 / syslog-ng ``` [Comment 35](show_bug.cgi?id=1169385#c35)  Swamp Workflow Management   2020-05-23 16:12:43 UTC  ``` openSUSE-RU-2020:0700-1: An update that has one recommended fix can now be installed.  Category: recommended (moderate) Bug References: 1169385 CVE References:  Sources used: openSUSE Leap 15.1 (src):    syslog-ng-3.19.1-lp151.3.6.1 ``` [Comment 36](show_bug.cgi?id=1169385#c36)  Swamp Workflow Management   2020-06-03 13:14:33 UTC  ``` openSUSE-RU-2020:0761-1: An update that has one recommended fix can now be installed.  Category: recommended (moderate) Bug References: 1169385 CVE References:  Sources used: openSUSE Backports SLE-15-SP1 (src):    syslog-ng-3.19.1-bp151.4.6.1 ``` [Comment 37](show_bug.cgi?id=1169385#c37)  Wolfgang Frisch   2020-06-03 13:58:41 UTC  ``` Released. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=1169385)
* - [XML](show_bug.cgi?ctype=xml&id=1169385)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=1169385)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1169385)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from idp-portal.suse.com_6b95d262_20250119_133843.html ===

## UCS

# Welcome to Univention Corporate Server

## JavaScript required

A browser with JavaScript enabled is required in order to use this service.

When using Internet Explorer, please check your security settings and add this address to your trusted sites.


