=== Content from github.com_5abccdbd_20250119_131725.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-pmgv-89j7-83pm)

**CVE-2020-8815**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-pmgv-89j7-83pm)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2020-8815](/advisories/GHSA-pmgv-89j7-83pm)

## Improper connection handling in the base connection...

High severity

Unreviewed

Published
May 24, 2022
to the GitHub Advisory Database
•
Updated Apr 4, 2024

## Package

No package listed—
[Suggest a package](/advisories/GHSA-pmgv-89j7-83pm/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

Improper connection handling in the base connection handler in IKTeam BearFTP before v0.3.1 allows a remote attacker to achieve denial of service via a Slowloris approach by sending a large volume of small packets.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2020-8815>
* [kolya5544/BearFTP@17a6ead](https://github.com/kolya5544/BearFTP/commit/17a6ead72d4a25cbfcef5e27613aa0a5f88a4b26)
* [kolya5544/BearFTP@66dc9d9](https://github.com/kolya5544/BearFTP/commit/66dc9d95e58bca133f265457d32007cdf38b66ad)
* <https://github.com/kolya5544/BearFTP>
* <https://github.com/kolya5544/BearFTP/blob/f5a8047587c1a96456d4f291c12b038b9ab0d0c5/BearFTP/Program.cs#L503-L525>
* <https://github.com/kolya5544/BearFTP/releases/tag/0.4.0>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2020-8815)
Feb 12, 2020

Published to the GitHub Advisory Database
May 24, 2022

Last updated
Apr 4, 2024

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

0.832%
 (82nd percentile)

### Weaknesses

[CWE-20](/advisories?query=cwe%3A20)

### CVE ID

CVE-2020-8815

### GHSA ID

GHSA-pmgv-89j7-83pm

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-pmgv-89j7-83pm/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f63ae583_20250119_112457.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkolya5544%2FBearFTP%2Fcommit%2F17a6ead72d4a25cbfcef5e27613aa0a5f88a4b26)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkolya5544%2FBearFTP%2Fcommit%2F17a6ead72d4a25cbfcef5e27613aa0a5f88a4b26)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=kolya5544%2FBearFTP)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Nov 1, 2023. It is now read-only.

[kolya5544](/kolya5544)
/
**[BearFTP](/kolya5544/BearFTP)**
Public archive

* [Notifications](/login?return_to=%2Fkolya5544%2FBearFTP) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Fkolya5544%2FBearFTP)
* [Star
   13](/login?return_to=%2Fkolya5544%2FBearFTP)

* [Code](/kolya5544/BearFTP)
* [Issues
  2](/kolya5544/BearFTP/issues)
* [Pull requests
  1](/kolya5544/BearFTP/pulls)
* [Actions](/kolya5544/BearFTP/actions)
* [Projects
  0](/kolya5544/BearFTP/projects)
* [Security](/kolya5544/BearFTP/security)
* [Insights](/kolya5544/BearFTP/pulse)

Additional navigation options

* [Code](/kolya5544/BearFTP)
* [Issues](/kolya5544/BearFTP/issues)
* [Pull requests](/kolya5544/BearFTP/pulls)
* [Actions](/kolya5544/BearFTP/actions)
* [Projects](/kolya5544/BearFTP/projects)
* [Security](/kolya5544/BearFTP/security)
* [Insights](/kolya5544/BearFTP/pulse)

## Commit

[Permalink](/kolya5544/BearFTP/commit/17a6ead72d4a25cbfcef5e27613aa0a5f88a4b26)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Anonymous configuration fix, base thread vulnerability fix. v0.3.1

[Browse files](/kolya5544/BearFTP/tree/17a6ead72d4a25cbfcef5e27613aa0a5f88a4b26)
Browse the repository at this point in the history

* Loading branch information

kolya5544
committed
Feb 9, 2020

1 parent
[9295f42](/kolya5544/BearFTP/commit/9295f4232823e94d5e89e2695e862aafd220ce05)

commit 17a6ead

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**14 additions**
and
**44 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* BearFTP

  + BearFTP/Program.cs
    [Program.cs](#diff-df98bfd7d282724b4e2b8c2dd527aa2821e10091c01acf088bf2eefabab05494)
* CHANGELOG.txt
  [CHANGELOG.txt](#diff-ff905774288e5cd43c5adcde46191c8990ae3fc1472fe5315344493aa946aade)

## There are no files selected for viewing

44 changes: 10 additions & 34 deletions

44
[BearFTP/Program.cs](#diff-df98bfd7d282724b4e2b8c2dd527aa2821e10091c01acf088bf2eefabab05494 "BearFTP/Program.cs")

Show comments

[View file](/kolya5544/BearFTP/blob/17a6ead72d4a25cbfcef5e27613aa0a5f88a4b26/BearFTP/Program.cs)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -495,36 +495,12 @@ static void Main(string[] args) |
|  |  | while (client.Connected) |
|  |  | { |
|  |  | Thread.Sleep(100); |
|  |  | //Receiving handler START |
|  |  | string answ = ""; |
|  |  | bool flag = true; |
|  |  | bool upper = true; |
|  |  |  |
|  |  | while (flag) |
|  |  | { |
|  |  | int a = sr.Read(); |
|  |  | if (upper) |
|  |  | { |
|  |  | answ += char.ToUpper((char)a); |
|  |  | } else |
|  |  | { |
|  |  | answ += (char)a; |
|  |  | } |
|  |  | if (a == 13) |
|  |  | { |
|  |  | flag = false; |
|  |  | } |
|  |  | if (a == 0x20) |
|  |  | { |
|  |  | upper = false; |
|  |  | } |
|  |  | if (answ.Length > 128) |
|  |  | { |
|  |  | client.Close(); |
|  |  | } |
|  |  | } |
|  |  | answ = answ.Trim(); |
|  |  | //Receiving handler END |
|  |  |  |
|  |  | string answ = sr.ReadLine(); //Who'd think this ACTUALLY works. BUT: It's doesnt work on Linux? (Needs testing) |
|  |  | //Tested on Ubuntu 16.04 client and 18.04 server. Seems to work! |
|  |  |  |
|  |  | string upperfix = answ.Split(' ')[0].ToUpper(); |
|  |  | answ.Replace(answ.Split(' ')[0], upperfix); //Fixing the lowercase commands an easy way |
|  |  |  |
|  |  | //Command processing. |
|  |  | if (answ.Length >= 3) //We dont want dummies to spam/DDoS. |
| Expand Down  Expand Up | | @@ -558,7 +534,7 @@ static void Main(string[] args) |
|  |  | { |
|  |  | string temp = answ.Substring(5).Trim(); |
|  |  | Regex r = new Regex("^[a-zA-Z0-9]\*$"); |
|  |  | if (r.IsMatch(temp) && temp.Length < 32 && temp.Length > 1 && (temp != "anonymous" && !AllowAnonymous)) |
|  |  | if (r.IsMatch(temp) && temp.Length < 32 && temp.Length > 1 && (temp != "anonymous" || AllowAnonymous)) |
|  |  | { |
|  |  | username = temp; |
|  |  | LogWrite("331 This user is protected with password\r\n", sw, hostname, perip); |
| Expand Down  Expand Up | | @@ -644,16 +620,16 @@ static void Main(string[] args) |
|  |  | LogWrite("150 Ok to send data.\r\n", sw, hostname, perip); |
|  |  | Thread.Sleep(100); |
|  |  | List<byte> filess = new List<byte>(); |
|  |  | var bytes = default(byte[]); |
|  |  | var bytess = default(byte[]); |
|  |  | using (var memstream = new MemoryStream()) |
|  |  | { |
|  |  | var buffer = new byte[512]; |
|  |  | var bytesRead = default(int); |
|  |  | while ((bytesRead = connn.sr.BaseStream.Read(buffer, 0, buffer.Length)) > 0) |
|  |  | memstream.Write(buffer, 0, bytesRead); |
|  |  | bytes = memstream.ToArray(); |
|  |  | bytess = memstream.ToArray(); |
|  |  | } |
|  |  | System.IO.File.WriteAllBytes("dumps/dump\_i" + rnd.Next(1, 2000000000).ToString() + ".txt", bytes); |
|  |  | System.IO.File.WriteAllBytes("dumps/dump\_i" + rnd.Next(1, 2000000000).ToString() + ".txt", bytess); |
|  |  | Thread.Sleep(200); |
|  |  | LogWrite("226 Transfer complete!\r\n", sw, hostname, perip); |
|  |  |  |
| Expand Down | |  |

14 changes: 4 additions & 10 deletions

14
[CHANGELOG.txt](#diff-ff905774288e5cd43c5adcde46191c8990ae3fc1472fe5315344493aa946aade "CHANGELOG.txt")

Show comments

[View file](/kolya5544/BearFTP/blob/17a6ead72d4a25cbfcef5e27613aa0a5f88a4b26/CHANGELOG.txt)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,12 +1,6 @@ |
|  |  | --> IT ONLY CONTAINS THE MOST RECENT CHANGES! |
|  |  |  |
|  |  | v0.3.0: |
|  |  | - Toggleable anonymous logins |
|  |  | - Per-IP logs (create "iplogs" folder) |
|  |  | - Max connections per second and max active connections are now changeable |
|  |  | - Buffer size can now be changed (def.8192) |
|  |  | - Fixed lower-case command handling |
|  |  | - Final attempt to fix an encoding bug related to outputting control characters |
|  |  | - Changeable bantime |
|  |  | - Toggleable ban on big amount of errors (a.k.a some sort of service probe) |
|  |  | - Moved default config to Resources |
|  |  | v0.3.1: |
|  |  | - Fixed AllowAnonymous handling (oops) |
|  |  | - One more attempt to fix encoding break on some characters (only affects console) |
|  |  | - Fixed improper handling of incoming data on base socket (a.k.a base socket thread overuse fix) |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `17a6ead`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkolya5544%2FBearFTP%2Fcommit%2F17a6ead72d4a25cbfcef5e27613aa0a5f88a4b26) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_58cbf510_20250119_112458.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkolya5544%2FBearFTP%2Freleases%2Ftag%2F0.4.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkolya5544%2FBearFTP%2Freleases%2Ftag%2F0.4.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=kolya5544%2FBearFTP)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Nov 1, 2023. It is now read-only.

[kolya5544](/kolya5544)
/
**[BearFTP](/kolya5544/BearFTP)**
Public archive

* [Notifications](/login?return_to=%2Fkolya5544%2FBearFTP) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Fkolya5544%2FBearFTP)
* [Star
   13](/login?return_to=%2Fkolya5544%2FBearFTP)

* [Code](/kolya5544/BearFTP/tree/0.4.0)
* [Issues
  2](/kolya5544/BearFTP/issues)
* [Pull requests
  1](/kolya5544/BearFTP/pulls)
* [Actions](/kolya5544/BearFTP/actions)
* [Projects
  0](/kolya5544/BearFTP/projects)
* [Security](/kolya5544/BearFTP/security)
* [Insights](/kolya5544/BearFTP/pulse)

Additional navigation options

* [Code](/kolya5544/BearFTP/tree/0.4.0)
* [Issues](/kolya5544/BearFTP/issues)
* [Pull requests](/kolya5544/BearFTP/pulls)
* [Actions](/kolya5544/BearFTP/actions)
* [Projects](/kolya5544/BearFTP/projects)
* [Security](/kolya5544/BearFTP/security)
* [Insights](/kolya5544/BearFTP/pulse)

1. [Releases](/kolya5544/BearFTP/releases)
2. [0.4.0](/kolya5544/BearFTP/releases/tag/0.4.0)

# v0.4.0 -> Active mode, local CMD handler, cool stuff

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/kolya5544/BearFTP/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...0.4.0)

 Loading

[View all tags](/kolya5544/BearFTP/tags)

![@kolya5544](https://avatars.githubusercontent.com/u/20096248?s=40&v=4)
[kolya5544](/kolya5544)
released this
11 Feb 18:11

·
[7 commits](/kolya5544/BearFTP/compare/0.4.0...master)
to master
since this release

[0.4.0](/kolya5544/BearFTP/tree/0.4.0)

[`4b4d2e3`](/kolya5544/BearFTP/commit/4b4d2e364ecb0948921901c03f036649db115662)

* Proper mitigation of slow loris base attack by implementing configurable amount of maximal allowed threads to be spawned (def. 50 a.k.a somewhere about 20 clients or 10 bots) ([CVE-2020-8815](https://github.com/advisories/GHSA-pmgv-89j7-83pm "CVE-2020-8815"))
* Anonymous private version usage statistics implemented (toggleable)
* Active mode implement
* Local command handler to edit config on-the-fly (see COMMANDS.md)
* Config option for disabling outputting to console
* Fix of metasploit exploit not working properly due to temp.limitations
* Fix of incorrect date in LIST (was broken in some clients)
* Removal of file dumping function (will be re-added back after some code cleanup)

 Assets
3

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f6aceb59_20250119_112458.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkolya5544%2FBearFTP%2Fcommit%2F66dc9d95e58bca133f265457d32007cdf38b66ad)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkolya5544%2FBearFTP%2Fcommit%2F66dc9d95e58bca133f265457d32007cdf38b66ad)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=kolya5544%2FBearFTP)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Nov 1, 2023. It is now read-only.

[kolya5544](/kolya5544)
/
**[BearFTP](/kolya5544/BearFTP)**
Public archive

* [Notifications](/login?return_to=%2Fkolya5544%2FBearFTP) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Fkolya5544%2FBearFTP)
* [Star
   13](/login?return_to=%2Fkolya5544%2FBearFTP)

* [Code](/kolya5544/BearFTP)
* [Issues
  2](/kolya5544/BearFTP/issues)
* [Pull requests
  1](/kolya5544/BearFTP/pulls)
* [Actions](/kolya5544/BearFTP/actions)
* [Projects
  0](/kolya5544/BearFTP/projects)
* [Security](/kolya5544/BearFTP/security)
* [Insights](/kolya5544/BearFTP/pulse)

Additional navigation options

* [Code](/kolya5544/BearFTP)
* [Issues](/kolya5544/BearFTP/issues)
* [Pull requests](/kolya5544/BearFTP/pulls)
* [Actions](/kolya5544/BearFTP/actions)
* [Projects](/kolya5544/BearFTP/projects)
* [Security](/kolya5544/BearFTP/security)
* [Insights](/kolya5544/BearFTP/pulse)

## Commit

[Permalink](/kolya5544/BearFTP/commit/66dc9d95e58bca133f265457d32007cdf38b66ad)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Implemented maxthreads, added another entry to TODO

[Browse files](/kolya5544/BearFTP/tree/66dc9d95e58bca133f265457d32007cdf38b66ad)
Browse the repository at this point in the history

* Loading branch information

kolya5544
committed
Feb 10, 2020

1 parent
[0f2b52b](/kolya5544/BearFTP/commit/0f2b52b3903db1cf3cbc37b3ce5e83bd1a69922d)

commit 66dc9d9

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**391 additions**
and
**363 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* BearFTP

  + BearFTP/Config.cs
    [Config.cs](#diff-01cbc1a59597207d1c70f14584c9202e5962fde59f3aa5a2158527435bca17df)
  + BearFTP/Program.cs
    [Program.cs](#diff-df98bfd7d282724b4e2b8c2dd527aa2821e10091c01acf088bf2eefabab05494)
  + Resources

    - BearFTP/Resources/ConfigFile.txt
      [ConfigFile.txt](#diff-b00b7e8a02bb0a73916ed21d502ffe1c80218740c00eef07c85a97b56e9d7675)
  + example\_config

    - BearFTP/example\_config/config.json
      [config.json](#diff-b5c6227591902e3cd7ef85d1fe5fb55e3e9387e7e04e331d01ee4274d21161ba)
* CHANGELOG.txt
  [CHANGELOG.txt](#diff-ff905774288e5cd43c5adcde46191c8990ae3fc1472fe5315344493aa946aade)

## There are no files selected for viewing

3 changes: 3 additions & 0 deletions

3
[BearFTP/Config.cs](#diff-01cbc1a59597207d1c70f14584c9202e5962fde59f3aa5a2158527435bca17df "BearFTP/Config.cs")

Show comments

[View file](/kolya5544/BearFTP/blob/66dc9d95e58bca133f265457d32007cdf38b66ad/BearFTP/Config.cs)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -24,6 +24,7 @@ class Config |
|  |  | public int BanLength = 3600; |
|  |  | public int MaxErrors = 6; |
|  |  | public int BufferSize = 8192; |
|  |  | public int MaxThreads = 50; |
|  |  |  |
|  |  |  |
|  |  |  |
| Expand Down  Expand Up | | @@ -61,6 +62,7 @@ public Config(string name) |
|  |  | MaxErrors = json.MaxErrors; |
|  |  | BufferSize = json.BufferSize; |
|  |  | PerIPLogs = json.PerIPLogs; |
|  |  | MaxThreads = json.MaxThreads; |
|  |  |  |
|  |  |  |
|  |  |  |
| Expand Down  Expand Up | | @@ -101,6 +103,7 @@ public class CJSON |
|  |  | public int BanLength { get; set; } |
|  |  | public int MaxErrors { get; set; } |
|  |  | public int BufferSize { get; set; } |
|  |  | public int MaxThreads { get; set; } |
|  |  | public List<CJSON\_FILE> Files { get; set; } |
|  |  | } |
|  |  | } |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `66dc9d9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkolya5544%2FBearFTP%2Fcommit%2F66dc9d95e58bca133f265457d32007cdf38b66ad) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a22f9d7b_20250119_112456.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkolya5544%2FBearFTP%2Fblob%2Ff5a8047587c1a96456d4f291c12b038b9ab0d0c5%2FBearFTP%2FProgram.cs)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkolya5544%2FBearFTP%2Fblob%2Ff5a8047587c1a96456d4f291c12b038b9ab0d0c5%2FBearFTP%2FProgram.cs)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=kolya5544%2FBearFTP)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Nov 1, 2023. It is now read-only.

[kolya5544](/kolya5544)
/
**[BearFTP](/kolya5544/BearFTP)**
Public archive

* [Notifications](/login?return_to=%2Fkolya5544%2FBearFTP) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Fkolya5544%2FBearFTP)
* [Star
   13](/login?return_to=%2Fkolya5544%2FBearFTP)

* [Code](/kolya5544/BearFTP)
* [Issues
  2](/kolya5544/BearFTP/issues)
* [Pull requests
  1](/kolya5544/BearFTP/pulls)
* [Actions](/kolya5544/BearFTP/actions)
* [Projects
  0](/kolya5544/BearFTP/projects)
* [Security](/kolya5544/BearFTP/security)
* [Insights](/kolya5544/BearFTP/pulse)

Additional navigation options

* [Code](/kolya5544/BearFTP)
* [Issues](/kolya5544/BearFTP/issues)
* [Pull requests](/kolya5544/BearFTP/pulls)
* [Actions](/kolya5544/BearFTP/actions)
* [Projects](/kolya5544/BearFTP/projects)
* [Security](/kolya5544/BearFTP/security)
* [Insights](/kolya5544/BearFTP/pulse)

## Files

 f5a8047
## Breadcrumbs

1. [BearFTP](/kolya5544/BearFTP/tree/f5a8047587c1a96456d4f291c12b038b9ab0d0c5)
2. /[BearFTP](/kolya5544/BearFTP/tree/f5a8047587c1a96456d4f291c12b038b9ab0d0c5/BearFTP)
/
# Program.cs

Copy path Blame  Blame
## Latest commit

## History

[History](/kolya5544/BearFTP/commits/f5a8047587c1a96456d4f291c12b038b9ab0d0c5/BearFTP/Program.cs)1097 lines (997 loc) · 48.1 KB f5a8047
## Breadcrumbs

1. [BearFTP](/kolya5544/BearFTP/tree/f5a8047587c1a96456d4f291c12b038b9ab0d0c5)
2. /[BearFTP](/kolya5544/BearFTP/tree/f5a8047587c1a96456d4f291c12b038b9ab0d0c5/BearFTP)
/
# Program.cs

Top
## File metadata and controls

* Code
* Blame

1097 lines (997 loc) · 48.1 KB[Raw](https://github.com/kolya5544/BearFTP/raw/f5a8047587c1a96456d4f291c12b038b9ab0d0c5/BearFTP/Program.cs)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000﻿using System;using System.Net.Sockets;using System.Threading;using System.Text.RegularExpressions;using System.Net;using System.Collections.Generic;using System.Security.Cryptography;using System.Text;using System.Diagnostics;using System.IO;using System.Net.Http;using System.Net.Http.Headers;using System.Linq;
namespace BearFTP{ class Program { //CONFIG public static int PortDef = 21; public static int PortPasv = 1222; public static string Hostname = "127.0.0.1"; public static string Token = ""; public static string Banner = "Welcome to FTP!";
 public static bool Report = true; public static bool Ban = true; public static bool PunishScans = true; public static bool AllowAnonymous = false; public static bool PerIPLogs = false;
 public static int Max\_PerSecond = 5; public static int Max\_Total = 6; public static int BanLength = 3600; public static int MaxErrors = 6; public static int BufferSize = 8192;
 //IP TempBan list (hostname:seconds) public static List<Ban> bans = new List<Ban>();
 //An instance of config to extract values public static Config config;
 //Used because everybody likes random numbers. public static Random rnd = new Random(); public static readonly HttpClient client = new HttpClient(); //List of all connected (to main port) clients public static List<Client> connected = new List<Client>();
 //Default directory. TODO: Implement directories public static Directory root = new Directory();
 //Current version public static string \_VERSION = "v0.3.0 BETA";
 //Default log. public static StreamWriter logfile = new StreamWriter("log.txt", true);
 //Per-IP logs public static List<StreamWriter> perips = new List<StreamWriter>();
 //Dictionary of passvie clients (clients with PASV mode. Used to communicate directly later.) public static Dictionary<Client, Connectivity> passives = new Dictionary<Client, Connectivity>();
 //List of connections per second from hostname public static List<Active> per\_second = new List<Active>(); //List of overall connections from hostname public static List<Active> actives = new List<Active>();
 //List of overall connections to PASV public static List<Active> pasv\_actives = new List<Active>();
 /// <summary> /// Reports an IP /// </summary> /// <param name="hostname">IP to report</param> /// <param name="comment">Logs or comments regarding report</param> /// <param name="hacking">Is accused in hacking?</param> /// <param name="brute">Is accused in bruting?</param> /// <param name="webapp\_h">Is accused in webapp hacking?</param> /// <param name="scanning">Is accused in portscanning?</param> /// <param name="ddos">Is accused in DDoS</param> /// <returns>A task to execute</returns> public static async System.Threading.Tasks.Task ReportAsync(string hostname, string comment, bool hacking, bool brute, bool webapp\_h, bool scanning, bool ddos) {
 string bad = ""; if (hacking) { bad += "15,"; } if (brute) { bad += "18,5,"; } if (webapp\_h) { bad += "21,"; } if (scanning) { bad += "14,"; } if (ddos) { bad += "4,"; } bad = bad.Substring(0, bad.Length - 1); if (Report) { try { using (var httpClient = new HttpClient()) { using (var request = new HttpRequestMessage(new HttpMethod("POST"), "https://api.abuseipdb.com/api/v2/report")) { request.Headers.TryAddWithoutValidation("Key", Token); request.Headers.TryAddWithoutValidation("Accept", "application/json");
 var contentList = new List<string>(); contentList.Add($"ip={Uri.EscapeDataString(hostname)}"); contentList.Add("categories=" + bad); contentList.Add($"comment={Uri.EscapeDataString(comment)}"); request.Content = new StringContent(string.Join("&", contentList)); request.Content.Headers.ContentType = new MediaTypeHeaderValue("application/x-www-form-urlencoded"); Console.WriteLine("=== REPORTING IP.... " + hostname); var response = await httpClient.SendAsync(request); if (response.StatusCode == HttpStatusCode.OK) { Console.WriteLine("=== REPORTED IP " + hostname); } else { Console.WriteLine("=== ERROR WHILE REPORTING: " + response.StatusCode.ToString()); Console.WriteLine("=== " + response.Content.ToString()); } } } } catch (Exception e) { Console.WriteLine(e.StackTrace); } }  } /// <summary> /// Hashes a string using md5 /// </summary> /// <param name="input">String to hash</param> /// <returns>Hashed string</returns> public static string md5(string input) { MD5 md5 = MD5.Create(); byte[] inputBytes = System.Text.Encoding.ASCII.GetBytes(input); byte[] hash = md5.ComputeHash(inputBytes); StringBuilder sb = new StringBuilder(); for (int i = 0; i < hash.Length; i++) { sb.Append(hash[i].ToString("x2")); } return sb.ToString(); } public static List<File> files = new List<File>();
 /// <summary> /// Writes to the StreamWriter as well as logging actions /// </summary> /// <param name="text">String to send over socket</param> /// <param name="sw">StreamWriter of a TCPClient</param> /// <param name="IP">Hostname of receiver</param> /// <param name="perip">PerIP StreamWriter</param> public static void LogWrite(string text, StreamWriter sw, string IP, StreamWriter perip = null) { Log(text.Trim().Replace("\r", String.Empty).Replace("\n", String.Empty).Trim(), "out", true, IP, perip); sw.Write(text); }
 /// <summary> /// Used to calculate and format the string for PASV mode /// </summary> /// <param name="port">Port of PASV</param> /// <param name="host">Hostname (IP ONLY!)</param> /// <returns>Formatted string</returns> public static string PasvInit(int port, string host) { string actual\_host = host.Replace('.', ','); string actual\_port = ""; int p1 = 0; int p2 = 0; for (int i = 0; i < 255; i++) { if (port - (256 \* i) < 256) { p1 = i; break; } } p2 = port - (256 \* p1);
 actual\_port = p1 + "," + p2;
 return "(" + actual\_host + "," + actual\_port + ")"; }
 /// <summary> /// Checks using pastebin if a new version is out. Replace with your own URL /// </summary> /// <returns></returns> public static bool CheckVersion() { using (var client = new WebClient()) { try { var responseString = client.DownloadString("https://pastebin.com/raw/9dCZvME9"); if (responseString.Trim() != \_VERSION) { return false; } return true; } catch { return false; }  } }
 /// <summary> /// Logs text and prints it to console /// </summary> /// <param name="text">Text of a message</param> /// <param name="dir">Either "in" for << or "out" for >></param> /// <param name="date">Include date in format [MM/dd/yyyy HH:mm:ss] or not</param> /// <param name="IP">IP Address to include before date (you can't have this true and date set to false)</param> /// <param name="sw">PerIP StreamWriter handler</param> public static void Log(string text, string dir, bool date = true, string IP = null, StreamWriter sw = null) { string Builder = ""; if (date) { if (IP == null) { Builder += "[" + DateTime.Now.ToString("MM/dd/yyyy HH:mm:ss") + "] "; } else { Builder += "[" + IP + " " + DateTime.Now.ToString("MM/dd/yyyy HH:mm:ss") + "] "; } } if (dir == "in") { Builder += "<< "; } else { Builder += ">> "; }  Builder += text;
 Builder = Regex.Replace(Builder, @"[^\u0020-\u007E]", " ");
 if (sw != null && PerIPLogs) { try { sw.WriteLine(Builder); } catch {
 } }
 logfile.WriteLine(Builder); Console.WriteLine(Builder); }
 static void Main(string[] args) { Console.OutputEncoding = Encoding.Unicode; logfile.AutoFlush = true; Log("Initialized server! >>", "in"); config = new Config("config.json"); PortDef = config.PortDef; PortPasv = config.PortPasv; Hostname = config.Hostname; Token = config.Token; Banner = config.Banner; Report = config.Report; Ban = config.Ban; PunishScans = config.PunishScans; AllowAnonymous = config.AllowAnonymous; Max\_PerSecond = config.Max\_PerSecond; Max\_Total = config.Max\_Total; BanLength = config.BanLength; MaxErrors = config.MaxErrors; BufferSize = config.BufferSize; PerIPLogs = config.PerIPLogs;
 if (PortDef == PortPasv) { Console.ForegroundColor = ConsoleColor.Red; Console.WriteLine("-> You are probably running a default/incorrect config! Please, edit it before starting the server"); Console.ResetColor(); Environment.Exit(1); }

 //Yes, it starts.. Console.WriteLine("- BearFTP OpenSource HoneyPot Server " + \_VERSION + " -"); Console.WriteLine("- By IKTeam -> https://github.com/kolya5544/BearFTP -"); Console.WriteLine("Checking for updates..."); if (!CheckVersion()) { Console.ForegroundColor = ConsoleColor.Red; Console.WriteLine("----> You are \*probably\* running an outdated version of our software!"); Console.ResetColor(); } else { Console.WriteLine("You are running the latest version!"); } Console.WriteLine("Running on " + Hostname + ":" + PortDef.ToString()); Console.WriteLine("PASV params: " + PasvInit(PortPasv, Hostname)); root.path = "/"; InitializeFiles(); TcpListener ftp = new TcpListener(PortDef); TcpListener pasv = new TcpListener(PortPasv); //Ban expiration handling. new Thread(new ThreadStart(() => { Thread.CurrentThread.IsBackground = true;
 while (true) { Thread.Sleep(2000); for (int i = 0; i<bans.Count; i++) {  bans[i].time -= 2; if (bans[i].time <= 0) { bans.Remove(bans[i]); i--; } } } })).Start(); //Connections per seconds (antibot) handling new Thread(new ThreadStart(() => { Thread.CurrentThread.IsBackground = true;
 while (true) { Thread.Sleep(1000); for (int i = 0; i < per\_second.Count; i++) { if (per\_second[i].connected > 0) { per\_second[i].connected -= 1; } } // Console.WriteLine("[DBG] Iterated per\_second!"); } })).Start(); ftp.Start(); pasv.Start(); new Thread(() => { Thread.CurrentThread.IsBackground = true; while (true) { TcpClient client = ftp.AcceptTcpClient();
 NetworkStream ns = client.GetStream(); ns.ReadTimeout = 3000; ns.WriteTimeout = 3000; StreamReader sr = new StreamReader(ns); StreamWriter sw = new StreamWriter(ns);
 StreamWriter perip = null;
 sw.AutoFlush = true; string hostname = ((IPEndPoint)client.Client.RemoteEndPoint).Address.ToString(); if (System.IO.Directory.Exists("iplogs") && PerIPLogs) { try { if (!perips.Any(logs => ((FileStream)(logs.BaseStream)).Name.Contains(hostname))) { perip = new StreamWriter("iplogs/" + hostname + ".txt", true); perip.AutoFlush = true;  perips.Add(perip); } else { foreach (StreamWriter ip in perips) { if (((FileStream)(ip.BaseStream)).Name.Contains(hostname)) { perip = ip; break; } } } } catch {
 } } if (Active.CheckExists(hostname, actives)) { if (Active.GetConnections(hostname, actives) >= Max\_Total) { client.Close(); if (Ban) { var aaa = new Ban(); aaa.hostname = hostname; aaa.time = BanLength; bans.Add(aaa); } } else { Active.SetConnections(hostname, actives, Active.GetConnections(hostname, actives) + 1); } } else { actives.Add(new Active(hostname, 1)); }
 if (Active.CheckExists(hostname, per\_second)) { if (Active.GetConnections(hostname, per\_second) >= Max\_PerSecond) { client.Close(); if (Ban) { var aaa = new Ban(); aaa.hostname = hostname; aaa.time = BanLength; bans.Add(aaa); } } else { Active.SetConnections(hostname, per\_second, Active.GetConnections(hostname, per\_second) + 1); } } else { per\_second.Add(new Active(hostname, 1));  } try { if (bans.Any(ban => ban.hostname == hostname)) { client.Close(); } } catch {
 }
 new Thread(new ThreadStart(() => { Thread.CurrentThread.IsBackground = true;
 bool triggered = false; bool trigger2 = false; Client c = new Client("null", "null", "null"); string username = ""; string password = ""; string directory = "/"; bool Authed = false; bool passive = false; int error = MaxErrors;
 //AbuseDBIP.com API bool hacking = false; bool bruteforce = false; bool webapp = false; string comment = "";
 bool banned = false;

 try { Thread.Sleep(100); Log("Connected - " + hostname, "in", true, hostname, perip); LogWrite("220 " + Banner.Replace("%host%", Hostname) + "\r\n", sw, hostname, perip);
 while (client.Connected) { Thread.Sleep(100); //Receiving handler START string answ = ""; bool flag = true; bool upper = true;
 while (flag) { int a = sr.Read(); if (upper) { answ += char.ToUpper((char)a); } else { answ += (char)a; } if (a == 13) { flag = false; } if (a == 0x20) { upper = false; } if (answ.Length > 128) { client.Close(); } } answ = answ.Trim(); //Receiving handler END
 //Command processing. if (answ.Length >= 3) //We dont want dummies to spam/DDoS. { Log(answ, "in", true, hostname, perip); } if (answ.StartsWith("CONNECT") || answ.StartsWith("GET http")) { if (Ban) { var aaa = new Ban(); aaa.hostname = hostname; aaa.time = BanLength; bans.Add(aaa); client.Close(); } var a = ReportAsync(hostname, "[" + DateTime.Now.ToString("MM/dd/yyyy HH:mm:ss") + "] " + "System scanning (Proxy judging) using CONNECT or GET requests", false, false, true, true, false); a.Start();
 } if (answ.Length > 128) { client.Close(); } if (answ.StartsWith("OPTS")) { LogWrite("200 Encoding successfully changed!\r\n", sw, hostname, perip); } else if (answ.StartsWith("USER") && username.Length < 3 && !Authed) { string temp = answ.Substring(5).Trim(); Regex r = new Regex("^[a-zA-Z0-9]\*$"); if (r.IsMatch(temp) && temp.Length < 32 && temp.Length > 1 && (temp != "anonymous" && !AllowAnonymous)) { username = temp; LogWrite("331 This user is protected with password\r\n", sw, hostname, perip);
 } else { LogWrite("530 Wrong username or/and password.\r\n", sw, hostname, perip); if (temp.Length > 128) { client.Close(); } } } else if (answ.StartsWith("PASS") && password.Length < 3 && !Authed) { string temp = answ.Substring(5).Trim(); if (temp.Length < 32 && temp.Length > 1) { password = temp; if (password == "IEUser@" && PunishScans) { if (Ban) { var aaa = new Ban(); aaa.hostname = hostname; aaa.time = BanLength; bans.Add(aaa); client.Close(); } var a = ReportAsync(hostname, "[" + DateTime.Now.ToString("MM/dd/yyyy HH:mm:ss") + "] " + "System scanning (port scanning) using NMAP", false, false, false, true, false); a.Start();
 } LogWrite("230 Successful login.\r\n", sw, hostname, perip); ns.ReadTimeout = 60000; Authed = true; c = new Client(username, password, hostname);
 connected.Add(c); } else { LogWrite("530 Wrong username or/and password.\r\n", sw, hostname, perip); if (temp.Length > 128) { client.Close(); } } } else if (answ.Trim() == "SYST") { LogWrite("215 UNIX Type: L8\r\n", sw, hostname, perip); } else if (answ.Trim() == "FEAT") { LogWrite("502 Command unavailable.\r\n", sw, hostname, perip); } else if (answ.Trim() == "PWD") { LogWrite("257 \"" + directory + "\" is the current working directory\r\n", sw, hostname, perip); } else if (answ.Trim() == "PORT") { LogWrite("502 Command unavailable.\r\n", sw, hostname, perip); } else if (answ.Trim().StartsWith("TYPE")) { LogWrite("200 OK!\r\n", sw, hostname, perip); } else if (answ.Trim().StartsWith("STOR") && Authed) { Thread.Sleep(2000); if (passives.ContainsKey(c)) { Connectivity connn; passives.TryGetValue(c, out connn); if (connn.tcp.Connected) { Thread.Sleep(1000); LogWrite("150 Ok to send data.\r\n", sw, hostname, perip); Thread.Sleep(100); List<byte> filess = new List<byte>(); var bytes = default(byte[]); using (var memstream = new MemoryStream()) { var buffer = new byte[512]; var bytesRead = default(int); while ((bytesRead = connn.sr.BaseStream.Read(buffer, 0, buffer.Length)) > 0) memstream.Write(buffer, 0, bytesRead); bytes = memstream.ToArray(); } System.IO.File.WriteAllBytes("dumps/dump\_i" + rnd.Next(1, 2000000000).ToString() + ".txt", bytes); Thread.Sleep(200); LogWrite("226 Transfer complete!\r\n", sw, hostname, perip);
 if (Ban) { var aaa = new Ban(); aaa.hostname = hostname; aaa.time = BanLength; bans.Add(aaa); client.Close(); } var a = ReportAsync(hostname, "[" + DateTime.Now.ToString("MM/dd/yyyy HH:mm:ss") + "] " + "Unauthorized system access using FTP", true, false, false, false, false); a.Start();
 } else { client.Close(); c.Connected = false; } } } else if (answ.StartsWith("RETR") && Authed) { Thread.Sleep(2000); string filename = answ.Substring(5).Trim().Replace("/", ""); File aaaa = null; foreach (File aa in files) { if (aa.name == filename) { aaaa = aa; } } if (passives.ContainsKey(c) && aaaa != null) { Connectivity connn; passives.TryGetValue(c, out connn); if (connn.tcp.Connected) { Thread.Sleep(1000); LogWrite("150 Ok to send data.\r\n", sw, hostname, perip); Thread.Sleep(100); // byte[] file = aaaa.content; //Encoding.ASCII.GetChars(file); // connn.sw.Write(chars, 0, file.Length); // connn.tcp.Close(); SendFile(aaaa, connn.sw); connn.tcp.Close(); Thread.Sleep(200); LogWrite("226 Transfer complete!\r\n", sw, hostname, perip);
 if (Ban) { var aaa = new Ban(); aaa.hostname = hostname; aaa.time = BanLength; bans.Add(aaa); client.Close(); } var a = ReportAsync(hostname, "[" + DateTime.Now.ToString("MM/dd/yyyy HH:mm:ss") + "] " + "Unauthorized system access using FTP", true, false, false, false, false); a.Start(); } else { client.Close(); c.Connected = false; } }
 } else if (answ.Trim() == "PASV" && Authed) { if (Authed && !passive) { LogWrite("227 Entering Passive Mode " + PasvInit(PortPasv, Hostname) + "\r\n", sw, hostname, perip); c.passive = true; } } else if (answ.Trim().StartsWith("SIZE") && Authed) { string filename = answ.Substring(5).Trim().Replace("/", ""); File aaaa = null; foreach (File aa in files) { if (aa.name == filename) { aaaa = aa; } } if (aaaa != null) { LogWrite("213 " + aaaa.size.ToString(), sw, hostname, perip); } }
 else if (answ.Trim().StartsWith("LIST") && Authed) { Thread.Sleep(1500); if (passives.ContainsKey(c)) { Connectivity connn; passives.TryGetValue(c, out connn); if (connn.tcp.Connected) { string Builder = ""; Builder += "drwxrwxrwx 5 root root 12288 Dec 1 16:51 .\r\n"; Builder += "drwxrwxrwx 5 root root 12288 Dec 1 16:51 ..\r\n"; int length = 5; foreach (File file in files) { if (file.size.ToString().Length > length) { length = file.size.ToString().Length; } } foreach (File file in files) { Builder += file.chmod; Builder += " " + rnd.Next(1, 9) + " "; Builder += "root root "; Builder += new string(' ', length - file.size.ToString().Length) + file.size.ToString(); Builder += " " + file.creation; Builder += " " + file.name + "\r\n"; } LogWrite("150 Here comes the directory listing.\r\n", sw, hostname, perip); Thread.Sleep(100); connn.sw.Write(Builder); connn.tcp.Close(); Thread.Sleep(100); LogWrite("226 Directory send OK\r\n", sw, hostname, perip);
 } else { client.Close(); c.Connected = false; } } } else if (answ.StartsWith("CWD")) { LogWrite("200 OK!\r\n", sw, hostname, perip); } else if (answ.StartsWith("CPFR")) { //Fun part: tricking random exploiters. Very "hackers" triggered = true; //First level trigger LogWrite("350 Need more information.\r\n", sw, hostname, perip); } else if (answ.Trim().StartsWith("CPTO") && triggered) { LogWrite("250 Need more information.\r\n", sw, hostname, perip);
 } else if (answ.Trim().StartsWith("AUTH")) { LogWrite("502 Please use plain FTP.\r\n", sw, hostname, perip); // We dont want them to use security. } else if (Authed && username == "admin" && md5(password) == "") { //Todo: admin cmds } else if (answ.Trim().StartsWith("CLNT")) { LogWrite("200 OK!\r\n", sw, hostname, perip); } else if (Authed && answ.Trim().StartsWith("NOOP")) { LogWrite("200 OK!\r\n", sw, hostname, perip); } else if (Authed && answ.Trim().StartsWith("REST")) { LogWrite("502 There is no such command.\r\n", sw, hostname, perip); } else { if (answ.Length >= 3) { error--; if (error <= 0) { client.Close(); }
 } } if (answ.Contains("php") && triggered) { trigger2 = true; //Second level trigger } if (trigger2) { LogWrite("110 Illegal activity was detected.\r\n", sw, hostname, perip); LogWrite("110 Please, log off now.\r\n", sw, hostname, perip); if (Ban) { var aaa = new Ban(); aaa.hostname = hostname; aaa.time = BanLength; bans.Add(aaa); client.Close(); } var a = ReportAsync(hostname, "[" + DateTime.Now.ToString("MM/dd/yyyy HH:mm:ss") + "] " + "RCE Attempt at 21 port using ProFTPd exploit", true, false, false, false, false); a.Start();
 }
 }
 } catch (Exception e) { client.Close(); c.Connected = false; } Active.SetConnections(hostname, actives, Active.GetConnections(hostname, actives) - 1); if (PerIPLogs) { try { perips.Remove(perip); perip.Close(); } catch {
 } } } )).Start(); } }).Start(); new Thread(() => {
 //THIS IS A TOTAL MESS. DON'T TOUCH IT UNLESS YOU REALLY WANT TO EDIT PASV MODE ANYHOW. //Shortly how it works: //1. Client connects to main port. //2. Initiates PASV mode //3. He is then set as "passive" //4. He connects to THIS one. //5. He is then assigned a Connectivity based of his hostname and either or not he is still connected. //6. This basically creates a link between Main socket and Pasv socket, allowing Main to access Pasv using a Dictionary. Thread.CurrentThread.IsBackground = true;
 Client cll = new Client(null, null, null); while (true) { TcpClient client = pasv.AcceptTcpClient(); NetworkStream ns = client.GetStream(); ns.ReadTimeout = 3000; ns.WriteTimeout = 3000; StreamReader sr = new StreamReader(ns); StreamWriter sw = new StreamWriter(ns);
 sw.AutoFlush = true; string hostname = ((IPEndPoint)client.Client.RemoteEndPoint).Address.ToString();
 try { if (bans.Any(ban => ban.hostname == hostname)) { client.Close(); } } catch {
 }
 if (Active.CheckExists(hostname, pasv\_actives)) { if (Active.GetConnections(hostname, pasv\_actives) >= Max\_Total) { client.Close(); if (Ban) { var aaa = new Ban(); aaa.hostname = hostname; aaa.time = BanLength; bans.Add(aaa); } } else { Active.SetConnections(hostname, pasv\_actives, Active.GetConnections(hostname, pasv\_actives) + 1); } } else { pasv\_actives.Add(new Active(hostname, 1)); } Thread user = new Thread(new ThreadStart(() => { Thread.CurrentThread.IsBackground = true;
 Client c = new Client("1", "2", "3");

 try { bool ispresent = false; foreach (Client cl in connected) { if (cl.hostname == hostname && cl.Connected) { c = cl; ispresent = true; } } if (!ispresent) { client.Close();
 } else { Connectivity ca = new Connectivity(); ca.sr = sr; ca.sw = sw; ca.tcp = client; passives.Add(c, ca); /\* while (client.Connected) { Thread.Sleep(3000); }\*/ for (int i = 0; client.Connected; i++) { Thread.Sleep(1000); if (i >= 120) { client.Close(); passives.Remove(c); } } client.Close(); passives.Remove(c); } } catch (Exception e) {[View remainder of file in raw view](https://github.com/kolya5544/BearFTP/raw/f5a8047587c1a96456d4f291c12b038b9ab0d0c5/BearFTP/Program.cs)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_94a67a4a_20250119_112452.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkolya5544%2FBearFTP)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkolya5544%2FBearFTP)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=kolya5544%2FBearFTP)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Nov 1, 2023. It is now read-only.

[kolya5544](/kolya5544)
/
**[BearFTP](/kolya5544/BearFTP)**
Public archive

* [Notifications](/login?return_to=%2Fkolya5544%2FBearFTP) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Fkolya5544%2FBearFTP)
* [Star
   13](/login?return_to=%2Fkolya5544%2FBearFTP)

Honeypot FTP server written in .NET Core (C#) for both Linux and Windows.

[13
stars](/kolya5544/BearFTP/stargazers) [4
forks](/kolya5544/BearFTP/forks) [Branches](/kolya5544/BearFTP/branches) [Tags](/kolya5544/BearFTP/tags) [Activity](/kolya5544/BearFTP/activity)
 [Star](/login?return_to=%2Fkolya5544%2FBearFTP)

 [Notifications](/login?return_to=%2Fkolya5544%2FBearFTP) You must be signed in to change notification settings

* [Code](/kolya5544/BearFTP)
* [Issues
  2](/kolya5544/BearFTP/issues)
* [Pull requests
  1](/kolya5544/BearFTP/pulls)
* [Actions](/kolya5544/BearFTP/actions)
* [Projects
  0](/kolya5544/BearFTP/projects)
* [Security](/kolya5544/BearFTP/security)
* [Insights](/kolya5544/BearFTP/pulse)

Additional navigation options

* [Code](/kolya5544/BearFTP)
* [Issues](/kolya5544/BearFTP/issues)
* [Pull requests](/kolya5544/BearFTP/pulls)
* [Actions](/kolya5544/BearFTP/actions)
* [Projects](/kolya5544/BearFTP/projects)
* [Security](/kolya5544/BearFTP/security)
* [Insights](/kolya5544/BearFTP/pulse)

# kolya5544/BearFTP

    master[Branches](/kolya5544/BearFTP/branches)[Tags](/kolya5544/BearFTP/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[39 Commits](/kolya5544/BearFTP/commits/master/) | | |
| [.github/ISSUE\_TEMPLATE](/kolya5544/BearFTP/tree/master/.github/ISSUE_TEMPLATE "This path skips through empty directories") | | [.github/ISSUE\_TEMPLATE](/kolya5544/BearFTP/tree/master/.github/ISSUE_TEMPLATE "This path skips through empty directories") |  |  |
| [BearFTP](/kolya5544/BearFTP/tree/master/BearFTP "BearFTP") | | [BearFTP](/kolya5544/BearFTP/tree/master/BearFTP "BearFTP") |  |  |
| [.gitignore](/kolya5544/BearFTP/blob/master/.gitignore ".gitignore") | | [.gitignore](/kolya5544/BearFTP/blob/master/.gitignore ".gitignore") |  |  |
| [BearFTP.sln](/kolya5544/BearFTP/blob/master/BearFTP.sln "BearFTP.sln") | | [BearFTP.sln](/kolya5544/BearFTP/blob/master/BearFTP.sln "BearFTP.sln") |  |  |
| [CHANGELOG.txt](/kolya5544/BearFTP/blob/master/CHANGELOG.txt "CHANGELOG.txt") | | [CHANGELOG.txt](/kolya5544/BearFTP/blob/master/CHANGELOG.txt "CHANGELOG.txt") |  |  |
| [COMMANDS.md](/kolya5544/BearFTP/blob/master/COMMANDS.md "COMMANDS.md") | | [COMMANDS.md](/kolya5544/BearFTP/blob/master/COMMANDS.md "COMMANDS.md") |  |  |
| [README.md](/kolya5544/BearFTP/blob/master/README.md "README.md") | | [README.md](/kolya5544/BearFTP/blob/master/README.md "README.md") |  |  |
| [SECURITY.md](/kolya5544/BearFTP/blob/master/SECURITY.md "SECURITY.md") | | [SECURITY.md](/kolya5544/BearFTP/blob/master/SECURITY.md "SECURITY.md") |  |  |
| View all files | | |

## Repository files navigation

* README
* Security
# BearFTP

#### Dare to hack a bear?

BearFTP is a honeypot FTP server, designed to log hackers' attempts and report them to public IP blacklist databases.

## Featuring:

* Configuration support (no need to recompile)
* Edit files and content of files located on server
* Tested on FileZilla and WinSCP.
* AntiNmap, AntiMetasploit, Report even those ones, who try to download **your** files!
* Works on both Windows and Linux
* Pure TCPClients, expect good performance!
* PASV mode support (only PASV, for now...)

This software was tested and runs perfectly on:

* Windows 10 x64 (.NET CORE 3.1)
* Linux Ubuntu 18.04

### Technologies

We use several projects as dependencies to run smoothly:

* [<https://www.newtonsoft.com/json>] - JSON converter!
* [<https://www.abuseipdb.com/>] - Public IP blacklist database

### Installation

BearFTP requires .NET Core 3.1 or higher.

Download binaries from Release tab or compile it yourself.

If you are on Windows, run

```
C:/BearFTP/BearFTP/bin/Release/netcoreapp3.1> ./BearFTP.exe
```

For Linux, run

```
$ dotnet BearFTP.dll
```

The program should exit with an error. Proceed to editing the **config.json**

```
{
  "PortDef": 21,
  "PortPasv": 21,
  "Hostname": "127.0.0.1",
  "Banner": "My very own FTP server located at %host%",
  "Token": "",
  "Report": true,
  "Ban": true,
  "PunishScans": true,
  "AllowAnonymous": false,
  "PerIPLogs": false,
  "AnonStat": true,
  "ConsoleLogging": true,
  "ActiveMode": true,
  "Max_PerSecond": 5,
  "Max_Total": 6,
  "BanLength": 3600,
  "MaxErrors": 6,
  "BufferSize": 8192,
  "MaxThreads": 50,
  "Files": [
  {
    "Name": "readme.txt",
    "Content": "Hello!"
  }]
}
```

| Key | Value |
| --- | --- |
| PortDef | Replace with port you want to use for new connections (21 by default) |
| PortPasv | Replace with port for PASV mode (1222 by default) |
| Hostname | Replace with an actual public IPv4 of your PC/server. Used to initiate PASV connections. Please use IPv4, we dont support domains |
| Banner | Banner sent right after TCP handshake. %host% will be replaced with current hostname |
| Token | AbuseIPDB token to report bad ones |
| Report | Should we report suspicious actions? |
| Ban | Should we ban users on suspicious actions? (Ban is 1 hour long to prevent people from being double-reported) |
| PunishScans | Should we ban/report nmap scanners? |
| AllowAnonymous | Should we allow users to login with "anonymous" username? |
| PerIPLogs | Create logs for individual IPs. Requires "iplogs" folder |
| AnonStat | Do you want to send anonymous statistics on version usage? (We only see BearFTP version you use. No private info) |
| ConsoleLogging | Should we log attempts to the console? |
| ActiveMode | Should we allow Active mode usage? (PORT command) |
| Max\_PerSecond | Max. amount of connections per second from an IP. Only applies to base socket |
| Max\_Total | Max. amount of active connections from an IP. Applies to both base and PASV |
| BanLength | Length (in seconds) of a ban. 3600 seconds = 1 hour. |
| MaxErrors | Max.amount of attempts to execute an invalid FTP command. |
| BufferSize | Buffer size on RETR for files. Somewhere around 2048-8192 is fine. Determines the speed of a download. |
| MaxThreads | Maximal amount of threads, controlled by clients, that can be spawned by BearFTP |
| Files[] | Array of files. |
| Files[Name] | Filename |
| Files[Content] | Contents of files (string). Start with --- to make it load from a file (example: "---file.exe") |

To make it work, you should change PortPasv to any other value, so PortPasv is not equal to PortDef. Other options are optional.
**We highly dont recommend using files with size of more than 4 MB! You should not use honeypot as a real FTP server to share files!**

### Development

Want to contribute? Great!

We use VS2019 and .NET core 3.1 for development.

Here's our CURRENT todo list:

* Administrator commands (adding files right through FTP!)
* Implement directories
* Add more features (more advanced ban system, reports to other IP blacklists)

## License

MIT

## About

Honeypot FTP server written in .NET Core (C#) for both Linux and Windows.

### Topics

[linux](/topics/linux "Topic: linux")
[ftp](/topics/ftp "Topic: ftp")
[honeypot](/topics/honeypot "Topic: honeypot")
[hacktoberfest](/topics/hacktoberfest "Topic: hacktoberfest")
[pasv](/topics/pasv "Topic: pasv")
[honeypot-ftp-server](/topics/honeypot-ftp-server "Topic: honeypot-ftp-server")
[ip-blacklists](/topics/ip-blacklists "Topic: ip-blacklists")

### Resources

[Readme](#readme-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/kolya5544/BearFTP/activity)
### Stars

[**13**
stars](/kolya5544/BearFTP/stargazers)
### Watchers

[**2**
watching](/kolya5544/BearFTP/watchers)
### Forks

[**4**
forks](/kolya5544/BearFTP/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fkolya5544%2FBearFTP&report=kolya5544+%28user%29)

## [Releases 8](/kolya5544/BearFTP/releases)

[Ban DoS fix
Latest

Feb 20, 2020](/kolya5544/BearFTP/releases/tag/0.4.1)
[+ 7 releases](/kolya5544/BearFTP/releases)

## [Packages 0](/users/kolya5544/packages?repo_name=BearFTP)

No packages published

## Languages

* [C#
  100.0%](/kolya5544/BearFTP/search?l=c%23)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


