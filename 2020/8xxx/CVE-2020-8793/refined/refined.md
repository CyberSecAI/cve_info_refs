```text
{
  "CVE-2020-8793": {
    "Description": "An unprivileged local attacker can read the first line of an arbitrary file (for example, root's password hash in /etc/master.passwd) or the entire contents of another user's file (if this file and /var/spool/smtpd/ are on the same filesystem).",
    "Root cause of vulnerability": "The vulnerability stems from a combination of factors: a local privilege escalation vulnerability in smtpctl, and time-of-check to time-of-use (TOCTOU) race conditions within OpenSMTPD's offline message handling. The offline directory is used to store messages that couldn't be delivered immediately. OpenSMTPD's previous mitigations against hardlink attacks were not sufficient.",
    "Weaknesses/vulnerabilities present": [
      "Local Privilege Escalation: By exploiting the way `smtpctl` handles the `-bi` command-line argument and manipulating the PATH environment variable, an attacker can execute `makemap` with the privileges of the `_smtpq` group (or root in Fedora's case).",
      "TOCTOU Race Conditions: OpenSMTPD performs checks on files in the offline directory at different points in time (offline_scan vs offline_enqueue). This allows an attacker to manipulate the files after the initial check and before they are processed.",
        "Hardlink Check Bypass: The hardlink check in `offline_enqueue` is vulnerable to a race condition, where the attacker can create a hardlink before `open()` and delete it before `fstat()`, making the check ineffective."
    ],
    "Impact of exploitation": "An unprivileged local attacker can read the first line of an arbitrary file (e.g., root's password hash) or the entire contents of another user's file. On Fedora, due to a misconfiguration, this could lead to full root privileges.",
    "Attack vectors": "Local access is required. The attacker needs to create files in the world-writable `/var/spool/smtpd/offline` directory.",
    "Required attacker capabilities/position": "The attacker must be a local, unprivileged user able to create hardlinks and files. The attacker also needs to be able to run commands and manipulate signals."
  }
}
```