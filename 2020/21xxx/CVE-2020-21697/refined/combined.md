=== Content from trac.ffmpeg.org_b1b281d0_20250119_123543.html ===


[![FFmpeg](/ffmpeg-logo.png)](https://ffmpeg.org)

Search:

* [Login](/login)
* [Preferences](/prefs)
* [Help/Guide](/wiki/TracGuide)
* [About Trac](/about)
* [Register](/register)
* [Forgot your password?](/reset_password)

* [Wiki](/wiki)
* [Timeline](/timeline)
* [View Tickets](/report)
* [Search](/search)
* [Tags](/tags)

## Context Navigation

* ![Up-vote](/chrome/vote/aupgray.png)+0![Down-vote](/chrome/vote/adowngray.png)
* ‚Üê [Previous Ticket](/ticket/8187 "Ticket #8187")
* [Next Ticket](/ticket/8189 "Ticket #8189") ‚Üí

---

Opened [5 years ago](/timeline?from=2019-09-20T16%3A25%3A56Z&precision=second "See timeline at Sep 20, 2019, 4:25:56 PM")

Closed [4 years ago](/timeline?from=2021-02-19T07%3A33%3A30Z&precision=second "See timeline at Feb 19, 2021, 7:33:30 AM")

Last modified [4 years ago](/timeline?from=2021-02-19T21%3A06%3A04Z&precision=second "See timeline at Feb 19, 2021, 9:06:04 PM")

## [#8188](/ticket/8188) [closed](/query?status=closed) [defect](/query?status=!closed&type=defect) ([fixed](/query?resolution=fixed&status=closed))

# heap-use-after-free from libavformat/mpegenc.c in mpeg\_mux\_write\_packet

| Reported by: | [Suhwan](/query?reporter=Suhwan&status=!closed) | Owned by: |  |
| --- | --- | --- | --- |
| Priority: | [important](/query?priority=important&status=!closed) | Component: | [avformat](/query?component=avformat&status=!closed) |
| Version: | [git-master](/query?status=!closed&version=git-master) | Keywords: | [mpegps](/query?keywords=~mpegps&status=!closed) [asan](/query?keywords=~asan&status=!closed) |
| Cc: |  | Blocked By: |  |
| Blocking: |  | Reproduced by developer: | [no](/query?reproduced=0&status=!closed) |
| Analyzed by developer: | [no](/query?analyzed=0&status=!closed) |  |  |

## Description

Summary of the bug:

There is a heap-use-after-free from libavformat/mpegenc.c in mpeg\_mux\_write\_packet.

```
SUMMARY: AddressSanitizer: heap-use-after-free ffmpeg/libavformat/mpegenc.c:1187:30 in mpeg_mux_write_packet

```

How to reproduce:

```
% ./ffmpeg_g -stream_loop 14 -y -r 115 -i Event20120111133101017.avi -loglevel 0 -map 0 -c copy -disposition:s:19 alias_pix tmp.mpeg

ffmpeg version N-94982-gea673a0edb Copyright (c) 2000-2019 the FFmpeg developers
  built with clang version 6.0.0-1ubuntu2 (tags/RELEASE_600/final)
  configuration: --cc=clang --cxx=clang++ --ld=clang --enable-debug --toolchain=clang-asan

```

### Attachments (2)

[Event20120111133101017.avi](/attachment/ticket/8188/Event20120111133101017.avi "View attachment")[‚Äã](/raw-attachment/ticket/8188/Event20120111133101017.avi "Download")
(544.9 KB
) - added by Suhwan [5 years ago](/timeline?from=2019-09-20T16%3A26%3A57Z&precision=second "See timeline at Sep 20, 2019, 4:26:57 PM").
poc
[ASAN-UAF-mpeg\_mux](/attachment/ticket/8188/ASAN-UAF-mpeg_mux "View attachment")[‚Äã](/raw-attachment/ticket/8188/ASAN-UAF-mpeg_mux "Download")
(3.1 KB
) - added by Suhwan [5 years ago](/timeline?from=2019-09-20T16%3A27%3A26Z&precision=second "See timeline at Sep 20, 2019, 4:27:26 PM").

Download all attachments as:
[.zip](/zip-attachment/ticket/8188/)

Oldest first

Newest first

Threaded

Show comments

Show property changes

### Change History (4)

### by Suhwan, [5 years ago](/timeline?from=2019-09-20T16%3A26%3A57Z&precision=second "See timeline at Sep 20, 2019, 4:26:57 PM")

| Attachment: | [*Event20120111133101017.avi*](/attachment/ticket/8188/Event20120111133101017.avi)[‚Äã](/raw-attachment/ticket/8188/Event20120111133101017.avi "Download") added |
| --- | --- |

poc

### by Suhwan, [5 years ago](/timeline?from=2019-09-20T16%3A27%3A26Z&precision=second "See timeline at Sep 20, 2019, 4:27:26 PM")

| Attachment: | [*ASAN-UAF-mpeg\_mux*](/attachment/ticket/8188/ASAN-UAF-mpeg_mux)[‚Äã](/raw-attachment/ticket/8188/ASAN-UAF-mpeg_mux "Download") added |
| --- | --- |

### [comment:1](#comment:1) by mkver, [4 years ago](/timeline?from=2021-02-19T07%3A33%3A30Z&precision=second "See timeline at Feb 19, 2021, 7:33:30 AM")

| Component: | undetermined ‚Üí avformat |
| --- | --- |
| Resolution: | ‚Üí fixed |
| Status: | new ‚Üí closed |

Fixed in [cfce16449cb815132f829d5a07beb138dfb2cba6](/changeset/cfce16449cb815132f829d5a07beb138dfb2cba6/ffmpeg "avformat/mpegenc: Ensure packet queue stays valid

The MPEG-PS muxer ...").

### [comment:2](#comment:2) by Carl Eugen Hoyos, [4 years ago](/timeline?from=2021-02-19T21%3A06%3A04Z&precision=second "See timeline at Feb 19, 2021, 9:06:04 PM")

| Keywords: | mpegps added |
| --- | --- |

**Note:**
See [TracTickets](/wiki/TracTickets)
for help on using tickets.

### Download in other formats:

* [RSS Feed](/ticket/8188?format=rss)
* [Comma-delimited Text](/ticket/8188?format=csv)
* [Tab-delimited Text](/ticket/8188?format=tab)

---

[![Trac Powered](/chrome/common/trac_logo_mini.png)](https://trac.edgewall.org/)

Powered by [**Trac 1.6**](/about)

By [Edgewall Software](http://www.edgewall.org/)
.

Visit the Trac open source project at
<http://trac.edgewall.org/>



=== Content from www.debian.org_36b99aba_20250119_123544.html ===


---

[[Date Prev](msg00182.html)][[Date Next](msg00184.html)]
[[Thread Prev](msg00182.html)][[Thread Next](msg00184.html)]
[[Date Index](maillist.html#00183)]
[[Thread Index](threads.html#00183)]

# [SECURITY] [DSA 4998-1] ffmpeg security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4998-1] ffmpeg security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Sun, 31 Oct 2021 16:40:22 +0000
* *Message-id*: <[[üîé]](/msgid-search/20211031164022.GA9637%40seger.debian.org)¬†[20211031164022.GA9637@seger.debian.org](msg00183.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4998-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
October 31, 2021                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : ffmpeg
CVE ID         : CVE-2020-20446 CVE-2020-20450 CVE-2020-20453 CVE-2020-22037
                 CVE-2020-22042 CVE-2021-38114 CVE-2021-38171 CVE-2021-38291
                 CVE-2020-21697 CVE-2020-21688 CVE-2020-20445

Several vulnerabilities have been discovered in the FFmpeg multimedia
framework, which could result in denial of service or potentially the
execution of arbitrary code if malformed files/streams are processed.

For the stable distribution (bullseye), these problems have been fixed in
version 7:4.3.3-0+deb11u1.

We recommend that you upgrade your ffmpeg packages.

For the detailed security status of ffmpeg please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/ffmpeg>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmF+xfUACgkQEMKTtsN8
TjY1Bw//YNL74vqBdoTiiNfHPW7S5zcKB+YkWMRT+t9gyITOkASzZ5k3MvRJUgOr
U1+QK507XvyGeKvRcRaT5P0se9KtmTWPGB9zn7yfv+1RWbtv6ffpwLspLMzAITLr
aXffbCuqF/E0J6THgJBWYMaIti4FNVdcQ/WdaS0Lz4bGkkS6f3wvJV1QbivLA0JI
QXKxB6JSET6sLSyVsKA1r9/w4QeIZ5GNfxxdDIaZUOIwpUkyfFJLBLeXLmnqJ1Cw
yiz/tCF4TPuH68tDEZqmmEZIKPCyJPBuXWbqGOIYB8ld1EDXuy3eXLSxhOz/kAoO
uWFph4VKpkfDXLWBAE7M+Ots2ZM7sT5KTwWz5T/K9RL9hFA6V0AWiVCfhLw/Yz+A
4H3rB/B2G93ea4Y9CTLR75xKKIapK3dJ9TY8SgyN9owaTfqWcoH3AJvnlGSWVihc
GTBp+zMFCrpdrAKrdJydre5hdji/07j2owWvjuMZPbjQMzQuIihu4MTUPxKudn9X
4JR73c9brxibIBPegIJiY4kdXquXO/yuQ6UNKDJCbszjOytHavCtC/tS2l39vol7
zuujpZROXIx6obfHjGi25E2IlSOHHDua7QP1SlOYXSwIZ6DDWAvGgi9di0FGo/Hu
MA6OHY7GeEju63y7A3dFkcmLPUVdDCH5GDXtjKwosVzhdIkrC70=
=Lr1c
-----END PGP SIGNATURE-----

```

---


