The provided content describes a CSRF protection bypass vulnerability in IPFire version 2, which can be exploited via XSS.

- **Root Cause:** The IPFire application employs a referrer header check as a CSRF mitigation technique. However, the application is vulnerable to XSS in the `mail server address` field within the mail service settings.
- **Vulnerability:**
  - CSRF protection bypass
  - Reflected XSS in `cgi-bin/mail.cgi`
- **Attack Vector:** An attacker can inject malicious JavaScript code into the `mail server address` field (XSS). This XSS vulnerability can then be used to craft a POST request to a different page which is vulnerable to CSRF, bypassing the referrer check. Specifically, the "wake on lan" page is mentioned as a potential CSRF target.
- **Impact:** By exploiting the XSS vulnerability, an attacker can bypass the CSRF protection and perform unauthorized actions on behalf of the user, such as modifying settings or triggering actions via the "wake on lan" functionality.
- **Affected Component:** `cgi-bin/mail.cgi` in IPFire version 2.
- **Mitigation:** The issue was supposedly fixed in IPFire Core Update 139.