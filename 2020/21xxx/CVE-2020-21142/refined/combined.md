=== Content from bugzilla.ipfire.org_54163d5e_20250119_124858.html ===


Bugzilla – Bug 12226
CSRF protection bypass with XSS
Last modified: 2024-11-21 14:39:52 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=12226&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=12226&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 12226**](show_bug.cgi?id=12226)
- CSRF protection bypass with XSS

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CSRF protection bypass with XSS

| | [Status](page.cgi?id=fields.html#bug_status): | CLOSED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | IPFire | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=IPFire "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | --- ([show other bugs](buglist.cgi?component=---&product=IPFire&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 2 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | all Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | - Unknown - Security | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Michael Tremer | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [https://192.168.56.5:444/cgi-bin/mail...](https://192.168.56.5:444/cgi-bin/mail.cgi) | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2019-10-30 09:28 UTC by Pisher Honda | | --- | --- | | Modified: | 2024-11-21 14:39 UTC ([History](show_activity.cgi?id=12226)) | | CC List: | 3 users (show)  michael.tremer peter.mueller pisher24 | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**using xss to craft a csrf request**](attachment.cgi?id=718 "View the content of the attachment") (107.96 KB, image/png)  [2019-10-30 09:28 UTC](#attach_718 "Go to the comment associated with the attachment"), Pisher Honda | [Details](attachment.cgi?id=718&action=edit) | | [**poc for csrf**](attachment.cgi?id=719 "View the content of the attachment") (96.43 KB, image/png)  [2019-10-30 09:31 UTC](#attach_719 "Go to the comment associated with the attachment"), Pisher Honda | [Details](attachment.cgi?id=719&action=edit) | | [**attachment-868675-0.html**](attachment.cgi?id=1614 "View the content of the attachment") (2.93 KB, text/html)  [2024-11-21 06:02 UTC](#attach_1614 "Go to the comment associated with the attachment"), Pisher Honda | [Details](attachment.cgi?id=1614&action=edit) | | [**attachment-899617-0.html**](attachment.cgi?id=1615 "View the content of the attachment") (1.32 KB, text/html)  [2024-11-21 14:39 UTC](#attach_1615 "Go to the comment associated with the attachment"), Pisher Honda | [Details](attachment.cgi?id=1615&action=edit) | | [View All](attachment.cgi?bugid=12226&action=viewall)  [Add an attachment](attachment.cgi?bugid=12226&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=12226&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=12226#c0)  Pisher Honda    2019-10-30 09:28:29 UTC  ``` Created [attachment 718](attachment.cgi?id=718 "using xss to craft a csrf request") [[details]](attachment.cgi?id=718&action=edit "using xss to craft a csrf request") using xss to craft a csrf request  As the CSRF mitigation technique ipfire employed reffer header check technique but as the application is already vulnerable to xss i was able to bypass the refer check, here is how i did it  - Navigate to mail service under the system menu and enable it   - fill in the input fields in the field mail server address which is vulnerable      to XSS(CSRF-1) , Now using this XSS vulnerability craft a post request to a page which is vulnerable to csrf(wake on lan)  Vulnerable Files :: ==================  cgi-bin/mail.cgi   is vulnerable for reflected XSS ```  [Comment 1](show_bug.cgi?id=12226#c1)  Pisher Honda    2019-10-30 09:31:40 UTC  ``` Created [attachment 719](attachment.cgi?id=719 "poc for csrf") [[details]](attachment.cgi?id=719&action=edit "poc for csrf") poc for csrf ```  [Comment 2](show_bug.cgi?id=12226#c2)  Michael Tremer    2019-10-30 11:00:33 UTC  ``` Thank you for reporting this.  Could you please verify for me that this patch fixes the problem?  > <https://patchwork.ipfire.org/patch/2561/> ```  [Comment 3](show_bug.cgi?id=12226#c3)  Pisher Honda    2019-10-30 14:18:05 UTC  ``` Hey there,  This would patch the issue. I would like to know, if we can go ahead and request CVE for this issue? or else is there a procedure from your end to apply for a CVE? ```  [Comment 4](show_bug.cgi?id=12226#c4)  Michael Tremer    2019-10-30 14:28:15 UTC  ``` (In reply to Pisher Honda from [comment #3](show_bug.cgi?id=12226#c3)) > This would patch the issue.  Did you just review the patch or did you test it, too?  > I would like to know, if we can go ahead and > request CVE for this issue? or else is there a procedure from your end to > apply for a CVE?  You can go ahead and request a CVE. We do not have a procedure for this as it is normally done by the researcher before the issue is being reported to us. ```  [Comment 5](show_bug.cgi?id=12226#c5)  Pisher Honda    2019-10-30 15:49:17 UTC  ``` *> Did you just review the patch or did you test it, too?*  ijust reviewed the patch code. i didn't had much time to test it with DAST approach will test it tommorrow once i go to work space, Please send me the complete modified mail.cgi file(includes patch as well) so that i can quickly test it using DAST approach and get back to you   FYI version used for testing is *IPFire 2.23 - Core Update 136* ```  [Comment 6](show_bug.cgi?id=12226#c6)  Pisher Honda    2019-10-30 15:54:00 UTC  ``` (In reply to Michael Tremer from [comment #4](show_bug.cgi?id=12226#c4)) > (In reply to Pisher Honda from [comment #3](show_bug.cgi?id=12226#c3))  > it is normally done by the researcher before the issue is being reported to > us.  This should not be the case, cve requests should be donee the vulnerability is patched ```  [Comment 7](show_bug.cgi?id=12226#c7)  Peter Müller    2019-12-16 16:35:41 UTC  ``` <https://git.ipfire.org/?p=ipfire-2.x.git;a=commit;h=095bf494074994c5a2cd867f3b00603de95ed207> ```  [Comment 8](show_bug.cgi?id=12226#c8)  Peter Müller    2019-12-16 16:37:53 UTC  ``` <https://blog.ipfire.org/post/ipfire-2-23-core-update-138-released>  Why didn't the release note of Core Update 138 mention this? ```  [Comment 9](show_bug.cgi?id=12226#c9)  Michael Tremer    2019-12-16 17:31:50 UTC  ``` (In reply to Peter Müller from [comment #8](show_bug.cgi?id=12226#c8)) > <https://blog.ipfire.org/post/ipfire-2-23-core-update-138-released> >  > Why didn't the release note of Core Update 138 mention this?  Because it was not released in c138. It was supposed to be, but then everything was moved to 139 and an emergency update was inserted for the Intel vulnerabilities:  > <https://git.ipfire.org/?p=ipfire-2.x.git;a=shortlog;h=refs/heads/core138>  This is now scheduled to be released in c139. ```  [Comment 10](show_bug.cgi?id=12226#c10)  Peter Müller    2019-12-17 20:58:08 UTC  ``` Hi,  if this vulnerability is about to be fixed in C139, this bug should be classified as ON_QA, shouldn't it?  Thanks, and best regards, Peter Müller ```  [Comment 11](show_bug.cgi?id=12226#c11)  Peter Müller    2020-01-22 21:08:27 UTC  ``` <https://blog.ipfire.org/post/ipfire-2-23-core-update-139-released> ```  [Comment 12](show_bug.cgi?id=12226#c12)  Pisher Honda    2024-11-21 06:02:52 UTC  ``` Created [attachment 1614](attachment.cgi?id=1614 "attachment-868675-0.html") [[details]](attachment.cgi?id=1614&action=edit "attachment-868675-0.html") attachment-868675-0.html  HI Mike i have reported a bug back in 2020 and claimed the CVE of 2020-19204 But now the cve is claimed by other person. How is this possible  (above mail chain is attached regarding our previous discussion). Any insights on this would be appreciated  thanks Pisher/Mohan  On Wed, Oct 30, 2019 at 4:30 PM IPFire Bugzilla <bugzilla@ipfire.org> wrote:  > Michael Tremer <michael.tremer@ipfire.org> changed [bug 12226](show_bug.cgi?id=12226 "CLOSED FIXED - CSRF protection bypass with XSS") > <[https://bugzilla.ipfire.org/show_bug.cgi?id=12226](show_bug.cgi?id=12226 "CLOSED FIXED - CSRF protection bypass with XSS")> > What Removed Added > Assignee nobody@ipfire.org michael.tremer@ipfire.org > CC   michael.tremer@ipfire.org > Status NEW MODIFIED > > *[Comment # 2](show_bug.cgi?id=12226#c2) <[https://bugzilla.ipfire.org/show_bug.cgi?id=12226#c2](show_bug.cgi?id=12226#c2 "CLOSED FIXED - CSRF protection bypass with XSS")> on bug > 12226 <[https://bugzilla.ipfire.org/show_bug.cgi?id=12226](show_bug.cgi?id=12226 "CLOSED FIXED - CSRF protection bypass with XSS")> from Michael > Tremer <michael.tremer@ipfire.org> * > > Thank you for reporting this. > > Could you please verify for me that this patch fixes the problem? > > <https://patchwork.ipfire.org/patch/2561/> > > ------------------------------ > You are receiving this mail because: > >    - You reported the bug. >    - You are on the CC list for the bug. > > ```  [Comment 13](show_bug.cgi?id=12226#c13)  Michael Tremer    2024-11-21 09:26:12 UTC  ``` Hello,  Said CVE has not been changed by us. Who has claimed this instead of yourself? ```  [Comment 14](show_bug.cgi?id=12226#c14)  Pisher Honda    2024-11-21 14:39:52 UTC  ``` Created [attachment 1615](attachment.cgi?id=1615 "attachment-899617-0.html") [[details]](attachment.cgi?id=1615&action=edit "attachment-899617-0.html") attachment-899617-0.html  That's a issue from NVD I believe  On Thu, 21 Nov 2024, 14:57 IPFire Bugzilla, <bugzilla@ipfire.org> wrote:  > *[Comment # 13](show_bug.cgi?id=12226#c13) <[https://bugzilla.ipfire.org/show_bug.cgi?id=12226#c13](show_bug.cgi?id=12226#c13 "CLOSED FIXED - CSRF protection bypass with XSS")> on > [bug 12226](show_bug.cgi?id=12226 "CLOSED FIXED - CSRF protection bypass with XSS") <[https://bugzilla.ipfire.org/show_bug.cgi?id=12226](show_bug.cgi?id=12226 "CLOSED FIXED - CSRF protection bypass with XSS")> from Michael > Tremer <michael.tremer@ipfire.org> * > > Hello, > > Said CVE has not been changed by us. Who has claimed this instead of yourself? > > ------------------------------ > You are receiving this mail because: > >    - You reported the bug. >    - You are on the CC list for the bug. > > ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=12226)
* - [XML](show_bug.cgi?ctype=xml&id=12226)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=12226)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=12226&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=12226&GoAheadAndLogIn=1#forgot)
    Login:

    [x]


