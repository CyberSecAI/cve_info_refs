- **Root cause of vulnerability**: The vulnerability is caused by insufficient server-side validation of uploaded file types in the avatar upload functionality. The CMS only performs file extension validation on the client-side using JavaScript, which can be bypassed.
- **Weaknesses/vulnerabilities present**: Arbitrary file upload vulnerability due to lack of server-side file type validation.
- **Impact of exploitation**: An attacker can upload malicious PHP scripts (e.g., web shells) to the server, leading to remote code execution and allowing the attacker to gain full control of the server, including access to sensitive data and the ability to modify or delete files.
- **Attack vectors**: The attack vector is through the avatar upload functionality in the CMS. An attacker can intercept the upload request with a tool like Burp Suite, modify the file extension and content to a malicious php file, and then forward it.
- **Required attacker capabilities/position**: The attacker needs to have access to the admin panel that allows changing user avatars and be able to manipulate HTTP requests, usually through a proxy tool.