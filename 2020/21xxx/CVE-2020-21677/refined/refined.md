The provided content is related to CVE-2020-21677.

**Root cause of vulnerability:**
The vulnerability is a heap-buffer-overflow in the `sixel_encoder_output_without_macro` function within the `encoder.c` file of the libsixel library. This occurs during the processing of a crafted GIF image.

**Weaknesses/vulnerabilities present:**
- Heap-buffer-overflow: A memory corruption vulnerability where data is written beyond the allocated buffer, potentially overwriting other heap allocations.

**Impact of exploitation:**
- Denial of Service: The overflow causes the program to crash, leading to a denial-of-service condition.
- Potential for Code Execution: While not explicitly mentioned, a heap-buffer-overflow can potentially lead to arbitrary code execution if crafted carefully.

**Attack vectors:**
- Input file: A specially crafted GIF image is used as input to the `img2sixel` command-line tool.

**Required attacker capabilities/position:**
- The attacker needs to provide a malicious GIF file as an input to `img2sixel`. The user needs to run the tool on the malicious file.

**Additional details:**
- The ASAN log clearly identifies the overflow occurring in the `__asan_memcpy` function, which is called within `sixel_encoder_output_without_macro` on line 814 of encoder.c
- The provided PoC file can reproduce the crash.