=== Content from security.gentoo.org_5ddd1c2b_20250119_122553.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# NASM: Multiple Vulnerabilities — GLSA **202312-09**

Multiple vulnerabilities have been discovered in NASM, the worst of which could lead to arbitrary code execution.

### Affected packages

| Package | **dev-lang/nasm** on all architectures |
| --- | --- |
| Affected versions | < **2.16.01** |
| Unaffected versions | >= **2.16.01** |

### Background

NASM is a 80x86 assembler that has been created for portability and modularity. NASM supports Pentium, P6, SSE MMX, and 3DNow extensions. It also supports a wide range of objects formats (ELF, a.out, COFF, etc), and has its own disassembler.

### Description

Multiple vulnerabilities have been discovered in NASM. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All NASM users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=dev-lang/nasm-2.16.01"

```
### References

* [CVE-2019-8343](https://nvd.nist.gov/vuln/detail/CVE-2019-8343)
* [CVE-2020-21528](https://nvd.nist.gov/vuln/detail/CVE-2020-21528)
* [CVE-2022-44370](https://nvd.nist.gov/vuln/detail/CVE-2022-44370)

**Release date**

December 22, 2023

**Latest revision**

December 22, 2023: 1

**Severity**

high

**Exploitable**

local and remote

**Bugzilla entries**

* [686720](https://bugs.gentoo.org/show_bug.cgi?id=686720)
* [903755](https://bugs.gentoo.org/show_bug.cgi?id=903755)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugzilla.nasm.us_f2aae5ab_20250119_122553.html ===


Bugzilla – Bug 3392637
Segmentation Fault in ieee\_segment()
Last modified: 2020-11-04 02:16:31 PST

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Help](docs/en/html/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=3392637&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=3392637&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

Self-registration is disabled due to spam issue (mail gorcunov@gmail.com or hpa@zytor.com to create an account)

[**Bug 3392637**](show_bug.cgi?id=3392637)
- Segmentation Fault in ieee\_segment()

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Segmentation Fault in ieee\_segment()

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | NASM | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=NASM "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Assembler ([show other bugs](buglist.cgi?component=Assembler&product=NASM&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 2.15.xx | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | PC Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | Medium normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | nobody | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2019-12-08 20:11 PST by Suhwan | | --- | --- | | Modified: | 2020-11-04 02:16 PST ([History](show_activity.cgi?id=3392637)) | | CC List: | 4 users (show)  chang.seok.bae gorcunov hpa nasm-bugs | |  | | | [Obtained from:](page.cgi?id=fields.html#cf_build "Please indicate where you obtained and/or built your version of NASM.") | Build from source archive using configure | | [Generated by:](page.cgi?id=fields.html#cf_robot "Was this bug report generated by an automatic tool, such as a memory leak detector or fuzzer, *without* including a human validation description or analysis of the problem?") | --- | | [Bug category:](page.cgi?id=fields.html#cf_category "The general category of this bug oor request.") |  | | [Breaks existing code:](page.cgi?id=fields.html#cf_breaks "This bug report breaks existing code in production or under development.") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**poc**](attachment.cgi?id=411751 "View the content of the attachment") (1.97 KB, text/plain)  [2019-12-08 20:11 PST](#attach_411751 "Go to the comment associated with the attachment"), Suhwan | [Details](attachment.cgi?id=411751&action=edit) | | [Add an attachment](attachment.cgi?bugid=3392637&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=3392637&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=3392637#c0)  Suhwan    2019-12-08 20:11:41 PST  ``` Created [attachment 411751](attachment.cgi?id=411751 "poc") [[details]](attachment.cgi?id=411751&action=edit "poc") poc  Hi,  I found Segmentation Fault in ieee_segment() at output/outieee.c:705:18 It is triggered in nasm version 2.15 and nasm-2.14.03rc2. Please run following command    nasm -f ieee -o /dev/null $PoC  Here's ASAN log  ==8545==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x00000042e7f0 bp 0x7ffecb7c3590 sp 0x7ffecb7c2d10 T0) ==8545==The signal is caused by a READ memory access. ==8545==Hint: address points to the zero page.     #0 0x42e7ef in __interceptor_strcmp /tmp/final/llvm.src/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc     #1 0x953e76 in ieee_segment nasm-2.15rc0-20191023/output/outieee.c:705:18     #2 0x5359f7 in process_directives nasm-2.15rc0-20191023/asm/directiv.c:243:23     #3 0x4f061b in assemble_file nasm-2.15rc0-20191023/asm/nasm.c:1639:17     #4 0x4f061b in main nasm-2.15rc0-20191023/asm/nasm.c:637     #5 0x7f0b02e3eb96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)     #6 0x41abc9 in _start (nasm+0x41abc9)  AddressSanitizer can not provide additional info. SUMMARY: AddressSanitizer: SEGV /tmp/final/llvm.src/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc in __interceptor_strcmp ==8545==ABORTING  NASM version 2.15rc0-20191023 compiled on Dec  9 2019 ```  [Comment 1](show_bug.cgi?id=3392637#c1)  Cyrill Gorcunov    2020-08-19 01:08:34 PDT  ``` Indeed, this is because name for section doesn't get updated. Since ieee format is not that popular I defer it for a while. ```  [Comment 2](show_bug.cgi?id=3392637#c2)  Cyrill Gorcunov    2020-11-03 13:55:09 PST  ``` Bisection pointed to commit 98578071b9d71ecaa2344dd9c185237c1765041e ```  [Comment 3](show_bug.cgi?id=3392637#c3)  Cyrill Gorcunov    2020-11-04 02:16:31 PST  ``` fixed in 93c774d482694643cafbc82578ac8b729fb5bc8b ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=3392637)
* - [XML](show_bug.cgi?ctype=xml&id=3392637)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=3392637)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](docs/en/html/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=3392637&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=3392637&GoAheadAndLogIn=1#forgot)
    Login:

    [x]


