Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
The vulnerability is a time-based blind SQL injection in CSZCMS version 1.2.4. The vulnerability stems from the insufficient sanitization of the User-Agent header within the `MY_Security.php` file.

**Weaknesses/Vulnerabilities:**
- **Insufficient Input Sanitization:** The code attempts to sanitize input using `escape_string`, but then it processes the sanitized input with the `xss_clean` function, which includes a `rawurldecode` operation. This effectively undoes the initial escaping, allowing for SQL injection.
- **Time-Based Blind SQL Injection:** The attacker can inject malicious SQL queries, including `sleep()` functions. Since the output of the query isn't directly visible, the attacker can determine if the query is successful based on the time taken by the application to respond.

**Impact of Exploitation:**
- **Data Exfiltration:** An attacker could use this vulnerability to extract sensitive data from the database.
- **Potential System Compromise:**  Depending on the database permissions, an attacker might be able to perform actions beyond just data exfiltration, possibly leading to more severe compromises, including full system compromise.

**Attack Vectors:**
- **HTTP User-Agent Header:** The attack vector is the User-Agent header of an HTTP request.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker needs to be able to send HTTP requests to the server running the vulnerable CSZCMS application.
- **Understanding of SQL Injection:** The attacker must have knowledge of SQL syntax and techniques for crafting malicious SQL injection payloads.

**Additional details:**
- The vulnerable code is located in `cszcms/core/MY_Security.php` file, specifically around line 47.
- The attacker exploits this vulnerability by encoding a malicious SQL payload within the User-Agent header, which is later decoded by `rawurldecode` and then passed to a SQL query.
- The suggested fix is to remove the `xss_clean` function, which is causing the decoding and undoing the escaping.