```
RELATED:
The provided content describes a stack overflow vulnerability in PostgreSQL that occurs when the server process is continuously sent SIGHUP signals.

Root cause of vulnerability:
- The vulnerability is a stack overflow caused by repeatedly calling the SIGHUP signal handler. The handler recursively calls itself due to the sigprocmask function calls within the handler, eventually overflowing the stack.

Weaknesses/vulnerabilities:
- Stack overflow: The SIGHUP handler recursively calls itself without adequate safeguards, leading to stack exhaustion.
- Recursive Signal Handling: The signal handler logic contains a recursive loop when handling SIGHUP, making it prone to this type of issue.
- Inadequate Signal Masking: The use of sigprocmask within the SIGHUP handler, in conjunction with other logic, seems to result in the handler being re-entered before it has fully completed processing, resulting in the recursive calls.

Impact of exploitation:
- Denial of service: The server process terminates due to a segmentation fault (address boundary error) or stack overflow, which leads to a denial of service.
- Server crash: The PostgreSQL server instance crashes when the stack overflows and the program aborts.

Attack vectors:
- Sending continuous SIGHUP signals: An attacker can repeatedly send SIGHUP signals to the PostgreSQL server process to trigger the stack overflow.

Required attacker capabilities/position:
- Ability to send signals to the PostgreSQL server process. This generally means the attacker has to be on the same machine or have a way to execute code on the same machine that is running the PostgreSQL server.
- Knowledge that sending continuous SIGHUP signals will lead to a crash.

Additional Notes:
- The vulnerability was fixed in the main branch but was not backported to prior versions as it was deemed unlikely to be a problem in practice.
- The vulnerability is not considered a security vulnerability that needs to be addressed for older versions because a valid SQL statement can cause a denial of service which is typically not considered a security vulnerability.
- AddressSanitizer (Asan) was used to detect the stack overflow, which produced the detailed call stack information.
- The provided call stack shows the recursive calls of SIGHUP_handler and sigprocmask which result in the stack overflow.
```