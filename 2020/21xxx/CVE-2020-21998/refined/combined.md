=== Content from www.zeroscience.mk_35b9acee_20250119_120233.html ===

![](../../images/header1.jpg)

* [Home](../../en)
* [Vulnerabilities!](../../en/vulnerabilities)
* [Blog](/blog)
* [Services](../../en/services)
* [About](../../en/about)
* [Contact](../../en/contact)

![EN](../../images/en_f.jpg)
[![MK](../../images/mk_f.jpg)](../../mk/vulnerabilities/ZSL-2019-5559.php)

#### HomeAutomation v3.3.2 Open Redirect

Title: HomeAutomation v3.3.2 Open Redirect

Advisory ID: [ZSL-2019-5559](ZSL-2019-5559.php)

Type: Local/Remote

Impact: Spoofing

Risk: (2/5)

Release Date: 29.12.2019
##### Summary

HomeAutomation is an open-source web interface and scheduling solution.
It was initially made for use with the Telldus TellStick, but is now based on a
plugin system and except for Tellstick it also comes with support for Crestron,
OWFS and Z-Wave (using OpenZWave). It controls your devices (switches, dimmers,
etc.) based on an advanced scheduling system, taking into account things like
measurements from various sensors. With the houseplan view you can get a simple
overview of the status of your devices at their location in your house.
##### Description

Input passed via the 'redirect' GET parameter in 'api.php' script is not
properly verified before being used to redirect users. This can be exploited to
redirect a user to an arbitrary website e.g. when a user clicks a specially crafted
link to the affected script hosted on a trusted domain.
##### Vendor

Tom Rosenback and Daniel Malmgren - <http://karpero.mine.nu/ha/>
##### Affected Version

3.3.2
##### Tested On

Apache/2.4.41 (centos) OpenSSL/1.0.2k-fips

Apache/2.4.29 (Ubuntu)

PHP/7.4.0RC4

PHP/7.3.11

PHP 7.2.24-0ubuntu0.18.04.1
##### Vendor Status

[06.11.2019] Vulnerability discovered.

[07.11.2019] Vendor contacted.

[29.11.2019] No response from the vendor.

[30.11.2019] Vendor contacted.

[28.12.2019] No response from the vendor.

[29.12.2019] Public security advisory released.
##### PoC

[homeautomation\_redirect.txt](../../codes/homeautomation_redirect.txt)
##### Credits

Vulnerability discovered by Gjoko Krstic - <gjoko@zeroscience.mk>
##### References

[1] <https://packetstormsecurity.com/files/155795/HomeAutomation-3.3.2-Open-Redirect.html>

[2] <https://cxsecurity.com/issue/WLB-2019120132>

[3] <https://exchange.xforce.ibmcloud.com/vulnerabilities/173657>

[4] <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-21998>

[5] <https://nvd.nist.gov/vuln/detail/CVE-2020-21998>
##### Changelog

[29.12.2019] - Initial release

[24.01.2020] - Added reference [1], [2] and [3]

[19.06.2021] - Added reference [4] and [5]
##### Contact

Zero Science Lab

Web: <http://www.zeroscience.mk>

e-mail: lab@zeroscience.mk

* ## Rete mirabilia
* ## We Suggest
* ## Profiles

  [![](../../images/fb_icon.png)](http://www.facebook.com/Zero.Science.Lab)
  [![](../../images/tw_icon.png)](http://www.twitter.com/zeroscience)
  [![](../../images/li_icon.png)](http://www.linkedin.com/companies/zero-science-lab)
* [![Site Meter](http://sm9.sitemeter.com/meter.asp?site=sm9lqwrm)](http://sm9.sitemeter.com/stats.asp?site=sm9lqwrm)

[Copyleft](http://www.gnu.org/copyleft) Â© 2007-2025 Zero Science Lab. Some rights reserved.



=== Content from cxsecurity.com_7f7e31f4_20250119_134631.html ===

[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **HomeAutomation 3.3.2 Open Redirect** **2019.12.31** Credit:  **[LiquidWorm](https://cxsecurity.com/author/LiquidWorm/1/)**  Risk: **Medium** Local: **No** Remote: ****Yes**** CVE: **N/A** CWE: **[CWE-601](https://cxsecurity.com/cwe/CWE-601 "Click to see CWE-601")** | | --- | |
| --- | --- | --- | --- |

HomeAutomation v3.3.2 Open Redirect
Vendor: Tom Rosenback and Daniel Malmgren
Product web page: http://karpero.mine.nu/ha/
Affected version: 3.3.2
Summary: HomeAutomation is an open-source web interface and scheduling solution.
It was initially made for use with the Telldus TellStick, but is now based on a
plugin system and except for Tellstick it also comes with support for Crestron,
OWFS and Z-Wave (using OpenZWave). It controls your devices (switches, dimmers,
etc.) based on an advanced scheduling system, taking into account things like
measurements from various sensors. With the houseplan view you can get a simple
overview of the status of your devices at their location in your house.
Desc: Input passed via the 'redirect' GET parameter in 'api.php' script is not
properly verified before being used to redirect users. This can be exploited to
redirect a user to an arbitrary website e.g. when a user clicks a specially crafted
link to the affected script hosted on a trusted domain.
===============================================================================
/api.php:
---------
80: if(file\_exists(HA\_ROOT\_PATH."/api/".$\_GET["do"].".php")) {
81: $redirect = getFormVariable("redirect", "");
82:
83: include(HA\_ROOT\_PATH."/api/".$\_GET["do"].".php");
84: $output = getFormVariable("output", "text");
85:
86: if($redirect != "") {
87: redirectTo($redirect);
88: } else {
89: echo $result;
90: }
91: }
====================
/functions.php:
---------------
2252: function redirectTo($url, $statusCode = 303) {
2253: if($url !== "") {
2254: SaveLog("Redirecting to ".$url, false, "redirects");
2255: header('Location: ' . $url, true, $statusCode);
2256: die();
2257: }
2258: }
===============================================================================
Tested on: Apache/2.4.41 (centos) OpenSSL/1.0.2k-fips
Apache/2.4.29 (Ubuntu)
PHP/7.4.0RC4
PHP/7.3.11
PHP 7.2.24-0ubuntu0.18.04.1
Vulnerability discovered by Gjoko 'LiquidWorm' Krstic
@zeroscience
Advisory ID: ZSL-2019-5559
Advisory URL: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2019-5559.php
06.11.2019
--
http://localhost/homeautomation\_v3\_3\_2/api.php?do=groups/toggle&groupid=1&status=1&redirect=https://zeroscience.mk

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2019120132)
[Tweet](https://twitter.com/share)

Vote for this issue:

 0
 0

50%
50%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top


