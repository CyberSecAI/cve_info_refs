- **Root cause of vulnerability:** The application fails to sanitize user-supplied input when setting the language preference. Specifically, the `lang` parameter in the URL is vulnerable to Cross-Site Scripting (XSS) injection.
- **Weaknesses/vulnerabilities present:** Cross-Site Scripting (XSS). The application does not properly sanitize or encode the value of the `lang` parameter when setting the language, allowing an attacker to inject malicious JavaScript code.
- **Impact of exploitation:** An attacker can execute arbitrary JavaScript code in the context of a user's browser when they access the vulnerable application pages. This could lead to session hijacking, cookie theft, redirecting users to malicious sites, displaying phishing pages, and other malicious activities. The issue is present in both the frontend and backend.
- **Attack vectors:** By crafting a malicious URL with a javascript payload in the `lang` parameter. The attacker would need to induce a victim to visit the crafted URL.
- **Required attacker capabilities/position:** The attacker needs to be able to craft a malicious URL, and convince the user to visit the url.