=== Content from blog.nintechnet.com_c54d0681_20250119_120349.html ===

[![NinTechNet](https://blog.nintechnet.com/wp-content/uploads/2018/07/nintechnet_logo.png)](https://nintechnet.com/)

[NinTechNet](https://nintechnet.com/ "Back to NinTechNet's home")

The Ninja Technologies Network

[Skip to content](#content)
[Menu](#header-menu-responsive)

* [Blog Summary](https://blog.nintechnet.com/)
* [NinTechNet’s Home](https://nintechnet.com/)

# Zero-day vulnerability exploited in WordPress Lara Google Analytics plugin.

* by [Jerome Bruandet](https://blog.nintechnet.com/author/bruandet/)
* Posted on [October 14, 2019 - 4:47pm [+0700]October 14, 2019 - 4:53pm [+0700]](https://blog.nintechnet.com/zero-day-vulnerability-exploited-in-wordpress-lara-google-analytics-plugin/)

The WordPress [Lara Google Analytics plugin](https://wordpress.org/plugins/lara-google-analytics/), which has 20,000+ active installations, was prone to an authenticated stored XSS vulnerability in version 2.0.4 and below.

> This vulnerability is currently being exploited, make sure to follow the recommendations below.

### Reference

*A CVE ID has been requested and we’ll update this post when it is assigned.*

### Authenticated Stored XSS

In the main “lara-google-analytics.php” script, the `lrgawidget_setProfileID` action is used to call the `lrgawidget_callback` function via the WordPress AJAX API.

```

add_action( 'wp_ajax_lrgawidget_setProfileID', 'lrgawidget_callback' );
...
...
function lrgawidget_callback() {
   global $wpdb;
   $user_id = get_current_user_id();
   $lrperm = lrgawidget_internal_permissions();
   $lrdata = $_POST;
   $modifiedAction = explode("_", $lrdata['action']);
   $lrdata['action'] = $modifiedAction[1];

   if ($lrdata['action'] == "setProfileID"){
      if ( (isset($lrdata['enable_universal_tracking'])) && !empty($lrdata['property_id'])){
         update_option('lrgawidget_property_id', $lrdata['property_id']);
      }else{
         delete_option('lrgawidget_property_id');
      }
   }
...
...

```

Attackers are using it to inject JS code in the `property_id` field. It is injected into all pages and posts of the CMS:

![](../wp-content/uploads/2019/10/lara-google_analytics-xss-vulnerability.png)

Note that the attack requires a user account on the blog, such as a subscriber.

### Timeline

The vulnerability was reported to the wordpress.org team on October 13, 2019, and a new version 2.0.5 was released the same day.

### Recommendations

Update as soon as possible if you have version 2.0.4 or below installed.

Note that the new version was released only a few hours after we reported the issue – which is a great thing – and it does block the ongoing attack, however it still lacks capability check and hopefully the author will come up with a better patch in the next few days.

If you are using our web application firewall for WordPress, [NinjaFirewall WP Edition](https://wordpress.org/plugins/ninjafirewall/) (free) and [NinjaFirewall WP+ Edition](https://nintechnet.com/ninjafirewall/wp-edition/) (premium), you are protected against this vulnerability.

Stay informed about the latest vulnerabilities in WordPress plugins and themes: [@nintechnet](https://twitter.com/nintechnet)

Tagged: [NinjaFirewall](https://blog.nintechnet.com/tag/ninjafirewall/), [Security](https://blog.nintechnet.com/tag/security/), [Vulnerability](https://blog.nintechnet.com/tag/vulnerability/), [WordPress](https://blog.nintechnet.com/tag/wordpress/)

* [Share on Twitter](https://twitter.com/share?text=Zero-day%20vulnerability%20exploited%20in%20WordPress%20Lara%20Google%20Analytics%20plugin.&url=https%3A%2F%2Fblog.nintechnet.com%2Fzero-day-vulnerability-exploited-in-wordpress-lara-google-analytics-plugin%2F)
* [Share on Facebook](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.nintechnet.com%2Fzero-day-vulnerability-exploited-in-wordpress-lara-google-analytics-plugin%2F)
* [Share on Reddit](https://www.reddit.com/submit?title=Zero-day%20vulnerability%20exploited%20in%20WordPress%20Lara%20Google%20Analytics%20plugin.&url=https%3A%2F%2Fblog.nintechnet.com%2Fzero-day-vulnerability-exploited-in-wordpress-lara-google-analytics-plugin%2F)
* [RSS icon](https://blog.nintechnet.com/feed/)

## Post navigation

[Previous Stored XSS vulnerability in WordPress Download Plugins and Themes from Dashboard plugin.](https://blog.nintechnet.com/stored-xss-vulnerability-in-wordpress-download-plugins-and-themes-from-dashboard-plugin/)[Next Multiple vulnerabilities in Sliced Invoices plugin.](https://blog.nintechnet.com/multiple-vulnerabilities-in-sliced-invoices-plugin/)

## Our Products

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfwp-150.png)

**NinjaFirewall WP+**

Web Application Firewall for WordPress. It will give your blog the highest level of protection it deserves.

Free Download

---

![SaferCheckout](https://blog.nintechnet.com/wp-content/uploads/safercheckout_150x150.png)

**SaferCheckout**

A powerful security plugin to protect WooCommerce stores from fraudulent transactions.

Free Download

---

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfpro-150.png)

**NinjaFirewall Pro+**

Web Application Firewall for PHP applications. It will protect your PHP site, from custom scripts to popular shopping cart and CMS applications.

Free Download

---

![Code Profiler](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-cp-150.png)

**Code Profiler**

Speed up your WordPress website by locating bottlenecks and performance issues in your plugins and themes.

Free Download

---

![NinjaScanner](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-ns-150.png)

**NinjaScanner**

A lightweight, fast and powerful malware and virus scanner for WordPress which includes many features to help you scan your blog for malware and virus.

Free Download
## Categories

Categories
Select Category
Benchmarks  (5)
Changelog  (1)
Code Profiler  (1)
HHVM  (1)
Joomla!  (2)
Magento  (1)
NinjaFirewall  (150)
NinjaScanner  (8)
Performance  (2)
Privacy  (1)
Security  (154)
   Brute-force attack  (5)
   Malware  (7)
   Phishing  (2)
   Virus  (2)
   Vulnerability  (129)
Troubleshooting  (14)
Tutorial  (26)
WooCommerce  (2)
WordPress  (149)

## Search

Search for:

Search

## Recent Posts

* [XSS / HTML injection vulnerability in WordPress Plugin Check (PCP) plugin.](https://blog.nintechnet.com/xss-html-injection-vulnerability-in-wordpress-plugin-check-pcp-plugin/)
  December 6, 2024 - 7:24pm [+0700]
* [How to debug WooCommerce Add to Cart action with Code Profiler.](https://blog.nintechnet.com/how-to-debug-woocommerce-add-to-cart-action-with-code-profiler/)
  November 28, 2024 - 7:00pm [+0700]
* [SaferCheckout: Fraud prevention plugin for WooCommerce stores.](https://blog.nintechnet.com/safercheckout-fraud-prevention-plugin-for-woocommerce-stores/)
  August 5, 2024 - 5:31pm [+0700]
* [Unauthenticated function injection vulnerability in WordPress Shortcode Addons plugin (unpatched).](https://blog.nintechnet.com/unauthenticated-function-injection-vulnerability-in-wordpress-shortcode-addons-plugin-unpatched/)
  April 22, 2024 - 11:29am [+0700]
* [Broken access control vulnerability fixed in WordPress 10Web AI Assistant plugin.](https://blog.nintechnet.com/broken-access-control-vulnerability-fixed-in-wordpress-10web-ai-assistant-plugin/)
  January 26, 2024 - 1:50pm [+0700]

© Copyright
2025 – [The Ninja Technologies Network](https://nintechnet.com/)


