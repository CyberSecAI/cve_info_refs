=== Content from github.com_e07b305e_20250119_110912.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyzmcms%2Fyzmcms%2Fissues%2F44)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fyzmcms%2Fyzmcms%2Fissues%2F44)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=yzmcms%2Fyzmcms)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[yzmcms](/yzmcms)
/
**[yzmcms](/yzmcms/yzmcms)**
Public

* [Notifications](/login?return_to=%2Fyzmcms%2Fyzmcms) You must be signed in to change notification settings
* [Fork
  78](/login?return_to=%2Fyzmcms%2Fyzmcms)
* [Star
   281](/login?return_to=%2Fyzmcms%2Fyzmcms)

* [Code](/yzmcms/yzmcms)
* [Issues
  11](/yzmcms/yzmcms/issues)
* [Pull requests
  1](/yzmcms/yzmcms/pulls)
* [Actions](/yzmcms/yzmcms/actions)
* [Projects
  0](/yzmcms/yzmcms/projects)
* [Security](/yzmcms/yzmcms/security)
* [Insights](/yzmcms/yzmcms/pulse)

Additional navigation options

* [Code](/yzmcms/yzmcms)
* [Issues](/yzmcms/yzmcms/issues)
* [Pull requests](/yzmcms/yzmcms/pulls)
* [Actions](/yzmcms/yzmcms/actions)
* [Projects](/yzmcms/yzmcms/projects)
* [Security](/yzmcms/yzmcms/security)
* [Insights](/yzmcms/yzmcms/pulse)

# A SSRF in yzmcms v5.5 management #44

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[A SSRF in yzmcms v5.5 management](#top)#44Copy link![@mntn0x](https://avatars.githubusercontent.com/u/26903390?u=94288c71cdd5d5ecef670b412f58a14c320288d2&v=4&size=80)
## Description

![@mntn0x](https://avatars.githubusercontent.com/u/26903390?u=94288c71cdd5d5ecef670b412f58a14c320288d2&v=4&size=48)[mntn0x](https://github.com/mntn0x)opened [on Mar 27, 2020](https://github.com/yzmcms/yzmcms/issues/44#issue-588954669)

后台编辑文章处，最下方选项`将远程文件保存到本地`，漏洞代码在yzmphp/core/function/global.func.php#grab\_image()

[![](https://camo.githubusercontent.com/1c188baa013ca322a54c1f973b6a0dee6d2299d948bc1e36279a122e8fb2d7e3/68747470733a2f2f73312e617831782e636f6d2f323032302f30332f32372f4750476452482e6a7067)](https://camo.githubusercontent.com/1c188baa013ca322a54c1f973b6a0dee6d2299d948bc1e36279a122e8fb2d7e3/68747470733a2f2f73312e617831782e636f6d2f323032302f30332f32372f4750476452482e6a7067)

当修改文章或者添加文章时选择了将远程文件加载到本地，则会进入grab\_image函数，正则匹配文章内容中的img标签，提取出链接保存在$val=$value，然后通过`strpos`判断链接中是否有http，如果没有则直接返回（说明这不是外网图片链接）。

接着从右往左读取第一个点号作为分割，得到后缀名，然后白名单校验后缀，此处的后缀名可以通过`1.php?2.jpg`来绕过。接着出现漏洞点

```
ob_start();
readfile($value);
$data = ob_get_contents();
ob_end_clean();
file_put_contents($filename, $data);
```

`readfile`读取文件内容，然后保存到jpg文件。如果`readfile`读取文件有warning或者error，就会跳转到错误处理函数。

payload：

```
<img src="http://127.0.0.1:80/2.jpg" width="100" height="100"/>

```

可通过此处探测内网端口及ip。

同时，此处也是一个文件读取漏洞，只是读取php文件有可能会报错，尝试读取config.php，因为YZMPHP\_PATH变量没有声明而报错。

---

Edit the background, the bottom option`将远程文件保存到本地`, Vulnerable code:

[![](https://camo.githubusercontent.com/1c188baa013ca322a54c1f973b6a0dee6d2299d948bc1e36279a122e8fb2d7e3/68747470733a2f2f73312e617831782e636f6d2f323032302f30332f32372f4750476452482e6a7067)](https://camo.githubusercontent.com/1c188baa013ca322a54c1f973b6a0dee6d2299d948bc1e36279a122e8fb2d7e3/68747470733a2f2f73312e617831782e636f6d2f323032302f30332f32372f4750476452482e6a7067)

When modifying an article or adding an article, you chose to load a remote file locally,It will enter the functiongrab\_image() , which matches the img tag in the article content, extracts the link and saves it in $ val = $ value, and then uses `strpos` to determine whether there is http in the link. If not, it returns directly (indicating that this is not an external network image link).

Then read the first dot from right to left as the segmentation to get the suffix name, and then check the suffix on the white list. The suffix name here can be bypassed by `1.php? 2.jpg`. Then there are vulnerabilities

```
ob_start();
readfile($value);
$data = ob_get_contents();
ob_end_clean();
file_put_contents($filename, $data);
```

`readfile` reads the file content and saves it to a jpg file. If `readfile` reads a file with warning or error, it will jump to the error handling function.

payload：

```
<img src="http://127.0.0.1:80/2.jpg" width="100" height="100"/>

```

You can probe the intranet port and ip here.

At the same time, here is also a file reading vulnerability, but reading php files may report an error. Try reading config.php because the YZMPHP\_PATH variable is not declared and an error is reported.

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


