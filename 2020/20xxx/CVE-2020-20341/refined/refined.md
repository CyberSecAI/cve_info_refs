- **Root cause of vulnerability**: The `grab_image` function in `yzmphp/core/function/global.func.php` uses `readfile` to fetch and save remote images without proper validation, allowing an attacker to supply a URL to an internal resource.
- **Weaknesses/vulnerabilities present**:
    - **Server-Side Request Forgery (SSRF)**: The application makes a request to a user-supplied URL without proper sanitization, allowing an attacker to probe internal network resources.
    - **File Read**: The `readfile` function can be used to read arbitrary files accessible to the web server process, including potentially sensitive configuration files.
    - **Bypass of filename check**: The filename check using `strrpos` can be bypassed with `1.php?2.jpg` URL to trick the application into fetching arbitrary URLs.
- **Impact of exploitation**:
    - **Internal Port Scanning**: An attacker can use SSRF to scan internal ports and IPs, potentially identifying running services.
    - **File Disclosure**: An attacker can potentially read sensitive files like configuration files or other application source code.
- **Attack vectors**:
    - The attacker crafts an HTML payload containing an `img` tag with a malicious `src` attribute pointing to the internal resource they want to access or read.
- **Required attacker capabilities/position**:
    - The attacker needs to be able to submit or modify article content on the vulnerable system and enable the "save remote file to local" option. They need access to the article editing functionality of the yzmcms application.