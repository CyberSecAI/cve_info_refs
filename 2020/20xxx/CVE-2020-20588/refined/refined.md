Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from an insecure file upload mechanism in the `/action/Core.class.php` file. The code uses the Plupload library for handling uploads but does not enforce any restrictions on the types of files that can be uploaded. The line `'//allow_extensions' => 'jpg,jpeg,png'` is commented out, effectively allowing any file type to be uploaded.

**Weaknesses/Vulnerabilities:**

*   **Arbitrary File Upload:** The primary vulnerability is the lack of file type validation, which enables an attacker to upload arbitrary files, including executable files like PHP scripts.
*   **Predictable File Path:** The uploaded files are stored in a predictable location based on the user's UID (user ID) and filename. This predictability makes it easy for an attacker to locate and execute the uploaded file.
*   **Insecure permissions:** The code creates directories with 0777 permissions, making them world-writable

**Impact of Exploitation:**

*   **Remote Code Execution (RCE):** By uploading a PHP file (e.g., a backdoor), an attacker can execute arbitrary code on the server, potentially gaining full control of the application and the underlying server. This could lead to data breaches, service disruption, and other malicious activities.

**Attack Vectors:**

*   **HTTP Request:** The attack vector involves sending a crafted HTTP request to the `/index.php?m=user&a=avatar` endpoint, which triggers the upload functionality.

**Required Attacker Capabilities/Position:**

*   **Authenticated User:** The attacker needs to be a logged-in user, as the code uses the UID from the session/cookies.
*   **Knowledge of Endpoint:** The attacker must know the target endpoint `/index.php?m=user&a=avatar` and the parameter names required for uploading a file.
*   **Basic HTTP Knowledge:** The attacker needs the ability to make HTTP requests to upload the file and then know how to access the file based on the user ID and filename.

**Additional Details:**

*   The provided code snippet shows that the upload logic is handled by the `upload()` function in `/action/Core.class.php`.
*   The uploaded file location is based on user ID (UID). For example, if the UID is `185` and the file name is `backdoor.php`, the file can be found at `<http://mywebsite.com/files/18/05/backdoor.php>`.
* The issue was reported by user Tazkimi