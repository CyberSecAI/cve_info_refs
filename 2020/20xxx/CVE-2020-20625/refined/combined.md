=== Content from blog.nintechnet.com_eb4fcbc0_20250119_115805.html ===

[![NinTechNet](https://blog.nintechnet.com/wp-content/uploads/2018/07/nintechnet_logo.png)](https://nintechnet.com/)

[NinTechNet](https://nintechnet.com/ "Back to NinTechNet's home")

The Ninja Technologies Network

[Skip to content](#content)
[Menu](#header-menu-responsive)

* [Blog Summary](https://blog.nintechnet.com/)
* [NinTechNet’s Home](https://nintechnet.com/)

# Multiple vulnerabilities in Sliced Invoices plugin.

* by [Jerome Bruandet](https://blog.nintechnet.com/author/bruandet/)
* Posted on [October 17, 2019 - 5:00pm [+0700]October 17, 2019 - 5:02pm [+0700]](https://blog.nintechnet.com/multiple-vulnerabilities-in-sliced-invoices-plugin/)

The WordPress [Sliced Invoices plugin](https://wordpress.org/plugins/sliced-invoices/), which has 6,000+ active installations, was prone to multiple vulnerabilities in version 3.8.2 and below that could lead to information disclosure and SQL injection.

### Reference

*A CVE ID has been requested and we’ll update this post when it is assigned.*

### Unauthenticated information disclosure

In “core/class-sliced.php” line 220, the `export_csv_full` function is registered via the `admin_init` hook.

```

$this->loader->add_action( 'admin_init', $plugin_admin, 'export_csv_full' );

```

This function is located in “admin/class-sliced-admin.php” lines 2452-2586:

```

public function export_csv_full() {

   // Do the checks
   if ( ! isset( $_POST['csv_exporter_type'] ) ) {
      return;
   }

   if ( $_POST['csv_exporter_type'] === 'sliced_quote' ) {
      $post_type = 'sliced_quote';
      $type = 'quote';
   } elseif ( $_POST['csv_exporter_type'] === 'sliced_invoice' ) {
      $post_type = 'sliced_invoice';
      $type = 'invoice';
   } else {
      return;
   }
...
...

```

It doesn’t check for capability and doesn’t have a security nonce either. An unauthenticated attacker can export all invoices and quotes, which include customers’ name, home address, email address etc.

### Authenticated SQL injection and information disclosure

In “core/class-sliced.php” line 211, the `duplicate_quote_invoice` function is registered via the `admin_action_*` hook:

```

$this->loader->add_action( 'admin_action_duplicate_quote_invoice', $plugin_admin, 'duplicate_quote_invoice' );

```

The function is located in “admin/class-sliced-admin.php” lines 2143-2238 and has two issues:

1. The function lacks capability check and a security nonce. It is used to duplicate quotes or invoices, but because the plugin does not check which type of post it duplicates and the duplicated post has the “published” status, an authenticated attacker could duplicate all posts and pages available on the blog and those that were marked as “pending”, “draft” or even “private” would have their copy with a “published” status and thus would become accessible to anyone.
2. Line 2154, it assigns the post ID value, `$_GET['post']`, to the `$post_id` variable:
   ```

   2154 $post_id = (isset($_GET['post']) ? $_GET['post'] : $_POST['post']);
   ...
   ...
   2202 $post_meta_infos = $wpdb->get_results("SELECT meta_key, meta_value FROM $wpdb->postmeta WHERE post_id=$post_id");

   ```

   It is inserted in the SQL query line 2202, unchecked and unsanitized which can lead to SQLi.

### Additional issues

In “core/class-sliced.php” lines 201 and 202, it registers the `ajax_search_clients` and `ajax_search_non_clients` functions via the “wp\_ajax\_\*” hook:

```

$this->loader->add_action( 'wp_ajax_sliced-search-clients', $plugin_admin, 'ajax_search_clients' );
$this->loader->add_action( 'wp_ajax_sliced-search-non-clients', $plugin_admin, 'ajax_search_non_clients' );

```

Both functions are located in “admin/class-sliced-admin.php” (line 56 and 132). They lack capability check and security nonces. An authenticated user can search all invoices and quotes, the search result will be returned as a json-encoded string.

### Timeline

The vulnerability was reported on October 08, 2019.

### Recommendations

Update as soon as possible if you have version 3.8.2 or below installed.

If you are using our web application firewall for WordPress, [NinjaFirewall WP Edition](https://wordpress.org/plugins/ninjafirewall/) (free) and [NinjaFirewall WP+ Edition](https://nintechnet.com/ninjafirewall/wp-edition/) (premium), you are protected against this vulnerability.

Stay informed about the latest vulnerabilities in WordPress plugins and themes: [@nintechnet](https://twitter.com/nintechnet)

Tagged: [NinjaFirewall](https://blog.nintechnet.com/tag/ninjafirewall/), [Security](https://blog.nintechnet.com/tag/security/), [Vulnerability](https://blog.nintechnet.com/tag/vulnerability/), [WordPress](https://blog.nintechnet.com/tag/wordpress/)

* [Share on Twitter](https://twitter.com/share?text=Multiple%20vulnerabilities%20in%20Sliced%20Invoices%20plugin.&url=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-vulnerabilities-in-sliced-invoices-plugin%2F)
* [Share on Facebook](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-vulnerabilities-in-sliced-invoices-plugin%2F)
* [Share on Reddit](https://www.reddit.com/submit?title=Multiple%20vulnerabilities%20in%20Sliced%20Invoices%20plugin.&url=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-vulnerabilities-in-sliced-invoices-plugin%2F)
* [RSS icon](https://blog.nintechnet.com/feed/)

## Post navigation

[Previous Zero-day vulnerability exploited in WordPress Lara Google Analytics plugin.](https://blog.nintechnet.com/zero-day-vulnerability-exploited-in-wordpress-lara-google-analytics-plugin/)[Next Multiple WordPress plugins vulnerable to HTML injection.](https://blog.nintechnet.com/multiple-wordpress-plugins-vulnerable-to-html-injection/)

## Our Products

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfwp-150.png)

**NinjaFirewall WP+**

Web Application Firewall for WordPress. It will give your blog the highest level of protection it deserves.

Free Download

---

![SaferCheckout](https://blog.nintechnet.com/wp-content/uploads/safercheckout_150x150.png)

**SaferCheckout**

A powerful security plugin to protect WooCommerce stores from fraudulent transactions.

Free Download

---

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfpro-150.png)

**NinjaFirewall Pro+**

Web Application Firewall for PHP applications. It will protect your PHP site, from custom scripts to popular shopping cart and CMS applications.

Free Download

---

![Code Profiler](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-cp-150.png)

**Code Profiler**

Speed up your WordPress website by locating bottlenecks and performance issues in your plugins and themes.

Free Download

---

![NinjaScanner](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-ns-150.png)

**NinjaScanner**

A lightweight, fast and powerful malware and virus scanner for WordPress which includes many features to help you scan your blog for malware and virus.

Free Download
## Categories

Categories
Select Category
Benchmarks  (5)
Changelog  (1)
Code Profiler  (1)
HHVM  (1)
Joomla!  (2)
Magento  (1)
NinjaFirewall  (150)
NinjaScanner  (8)
Performance  (2)
Privacy  (1)
Security  (154)
   Brute-force attack  (5)
   Malware  (7)
   Phishing  (2)
   Virus  (2)
   Vulnerability  (129)
Troubleshooting  (14)
Tutorial  (26)
WooCommerce  (2)
WordPress  (149)

## Search

Search for:

Search

## Recent Posts

* [XSS / HTML injection vulnerability in WordPress Plugin Check (PCP) plugin.](https://blog.nintechnet.com/xss-html-injection-vulnerability-in-wordpress-plugin-check-pcp-plugin/)
  December 6, 2024 - 7:24pm [+0700]
* [How to debug WooCommerce Add to Cart action with Code Profiler.](https://blog.nintechnet.com/how-to-debug-woocommerce-add-to-cart-action-with-code-profiler/)
  November 28, 2024 - 7:00pm [+0700]
* [SaferCheckout: Fraud prevention plugin for WooCommerce stores.](https://blog.nintechnet.com/safercheckout-fraud-prevention-plugin-for-woocommerce-stores/)
  August 5, 2024 - 5:31pm [+0700]
* [Unauthenticated function injection vulnerability in WordPress Shortcode Addons plugin (unpatched).](https://blog.nintechnet.com/unauthenticated-function-injection-vulnerability-in-wordpress-shortcode-addons-plugin-unpatched/)
  April 22, 2024 - 11:29am [+0700]
* [Broken access control vulnerability fixed in WordPress 10Web AI Assistant plugin.](https://blog.nintechnet.com/broken-access-control-vulnerability-fixed-in-wordpress-10web-ai-assistant-plugin/)
  January 26, 2024 - 1:50pm [+0700]

© Copyright
2025 – [The Ninja Technologies Network](https://nintechnet.com/)


