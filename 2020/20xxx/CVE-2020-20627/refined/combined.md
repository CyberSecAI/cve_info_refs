=== Content from blog.nintechnet.com_eeb0fc2a_20250119_120216.html ===

[![NinTechNet](https://blog.nintechnet.com/wp-content/uploads/2018/07/nintechnet_logo.png)](https://nintechnet.com/)

[NinTechNet](https://nintechnet.com/ "Back to NinTechNet's home")

The Ninja Technologies Network

[Skip to content](#content)
[Menu](#header-menu-responsive)

* [Blog Summary](https://blog.nintechnet.com/)
* [NinTechNet’s Home](https://nintechnet.com/)

# Multiple vulnerabilities fixed in WordPress GiveWP plugin.

* by [Jerome Bruandet](https://blog.nintechnet.com/author/bruandet/)
* Posted on [October 30, 2019 - 10:43pm [+0700]October 30, 2019 - 10:46pm [+0700]](https://blog.nintechnet.com/multiple-vulnerabilities-fixed-in-wordpress-givewp-plugin/)

The WordPress [GiveWP](https://wordpress.org/plugins/give/) plugin, which has 70,000+ active installations, fixed vulnerabilities affecting version 2.5.9 and below.

### Reference

*A CVE ID has been requested and we’ll update this post when it is assigned.*

### Unauthenticated settings change

In the “includes/gateways/stripe/includes/admin/admin-actions.php” script, the `give_stripe_connect_save_options` function is loaded via the `admin_init` hook:

```
function give_stripe_connect_save_options() {

   $get_vars = give_clean( $_GET );

   // If we don't have values here, bounce.
   if (
      ! isset( $get_vars['stripe_publishable_key'] )
      || ! isset( $get_vars['stripe_user_id'] )
      || ! isset( $get_vars['stripe_access_token'] )
      || ! isset( $get_vars['stripe_access_token_test'] )
      || ! isset( $get_vars['connected'] )
   ) {
      return false;
   }

   // Update keys.
   give_update_option( 'give_stripe_connected', $get_vars['connected'] );
   give_update_option( 'give_stripe_user_id', $get_vars['stripe_user_id'] );
   give_update_option( 'live_secret_key', $get_vars['stripe_access_token'] );
   give_update_option( 'test_secret_key', $get_vars['stripe_access_token_test'] );
   give_update_option( 'live_publishable_key', $get_vars['stripe_publishable_key'] );
   give_update_option( 'test_publishable_key', $get_vars['stripe_publishable_key_test'] );

   // Delete option for user API key.
   give_delete_option( 'stripe_user_api_keys' );

}
add_action( 'admin_init', 'give_stripe_connect_save_options' );

```

The function lacks a capability check and a security nonce. Because the `admin_init` hook can be triggered by anyone, an unauthenticated user can tamper with the authentication credentials of the Stripe Connect payment gateway: ACCESS\_TOKEN, REFRESH\_TOKEN, PUBLISHABLE\_KEY, ACCOUNT\_ID.

### Authenticated settings change

In the “includes/admin/emails/ajax-handler.php” script, the `give_set_notification_status_handler` function is loaded via the `wp_ajax` hook. It is used to enable or disable email notifications sent by GiveWP to the administrator:

```
function give_set_notification_status_handler() {
   $notification_id = isset( $_POST['notification_id'] ) ? give_clean( $_POST['notification_id'] ) : '';
   if ( ! empty( $notification_id ) && give_update_option( "{$notification_id}_notification", give_clean( $_POST['status'] ) ) ) {
      wp_send_json_success();
   }

   wp_send_json_error();
}

add_action( 'wp_ajax_give_set_notification_status', 'give_set_notification_status_handler' );

```

The function lacks a capability check and a security nonce and thus can be accessed by an authenticated user such as a subscriber.

This vulnerability could be used in conjunction with the previous one: after tampering with the payment gateway, the attacker could disable all email notifications sent to the admin, which includes the notification sent when a new donation is received.

### Additional issues

In the “includes/misc-functions.php” script, the `give_get_ip` function is used to retrieve the user IP address:

```
function give_get_ip() {

   $ip = '127.0.0.1';

   if ( ! empty( $_SERVER['HTTP_CLIENT_IP'] ) ) {
      // check ip from share internet
      $ip = $_SERVER['HTTP_CLIENT_IP'];
   } elseif ( ! empty( $_SERVER['HTTP_X_FORWARDED_FOR'] ) ) {
      // to check ip is pass from proxy
      $ip = $_SERVER['HTTP_X_FORWARDED_FOR'];
   } elseif ( ! empty( $_SERVER['REMOTE_ADDR'] ) ) {
      $ip = $_SERVER['REMOTE_ADDR'];
   }

   /**
    * Filter the IP
    *
    * @since 1.0
    */
   $ip = apply_filters( 'give_get_ip', $ip );

   // Filter empty values.
   if ( false !== strpos( $ip, ',' ) ) {
      $ip = give_clean( explode( ',', $ip ) );
      $ip = array_filter( $ip );
      $ip = implode( ',', $ip );
   } else {
      $ip = give_clean( $ip );
   }

   return $ip;
}

```

It relies on untrusted user input (`HTTP_CLIENT_IP` and `HTTP_X_FORWARDED_FOR`) that is sanitised in order to prevent attacks such as XSS, but isn’t properly validated: GiveWP will accept `Client-IP: foo` as a valid IP address.

### Timeline

The vulnerability was reported to the authors on October 18, 2019 and a new version 2.5.10 was released on October 28, 2019.

### Recommendations

Update as soon as possible if you have version 2.5.9 or below installed.

If you are using our web application firewall for WordPress, [NinjaFirewall WP Edition](https://wordpress.org/plugins/ninjafirewall/) (free) and [NinjaFirewall WP+ Edition](https://nintechnet.com/ninjafirewall/wp-edition/) (premium), you are protected against this vulnerability.

Stay informed about the latest vulnerabilities in WordPress plugins and themes: [@nintechnet](https://twitter.com/nintechnet)

Tagged: [NinjaFirewall](https://blog.nintechnet.com/tag/ninjafirewall/), [Security](https://blog.nintechnet.com/tag/security/), [Vulnerability](https://blog.nintechnet.com/tag/vulnerability/), [WordPress](https://blog.nintechnet.com/tag/wordpress/)

* [Share on Twitter](https://twitter.com/share?text=Multiple%20vulnerabilities%20fixed%20in%20WordPress%20GiveWP%20plugin.&url=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-vulnerabilities-fixed-in-wordpress-givewp-plugin%2F)
* [Share on Facebook](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-vulnerabilities-fixed-in-wordpress-givewp-plugin%2F)
* [Share on Reddit](https://www.reddit.com/submit?title=Multiple%20vulnerabilities%20fixed%20in%20WordPress%20GiveWP%20plugin.&url=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-vulnerabilities-fixed-in-wordpress-givewp-plugin%2F)
* [RSS icon](https://blog.nintechnet.com/feed/)

## Post navigation

[Previous Multiple WordPress plugins vulnerable to HTML injection.](https://blog.nintechnet.com/multiple-wordpress-plugins-vulnerable-to-html-injection/)[Next Authenticated settings change vulnerability in YIT Plugin Framework.](https://blog.nintechnet.com/authenticated-settings-change-vulnerability-in-yit-plugin-framework/)

## Our Products

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfwp-150.png)

**NinjaFirewall WP+**

Web Application Firewall for WordPress. It will give your blog the highest level of protection it deserves.

Free Download

---

![SaferCheckout](https://blog.nintechnet.com/wp-content/uploads/safercheckout_150x150.png)

**SaferCheckout**

A powerful security plugin to protect WooCommerce stores from fraudulent transactions.

Free Download

---

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfpro-150.png)

**NinjaFirewall Pro+**

Web Application Firewall for PHP applications. It will protect your PHP site, from custom scripts to popular shopping cart and CMS applications.

Free Download

---

![Code Profiler](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-cp-150.png)

**Code Profiler**

Speed up your WordPress website by locating bottlenecks and performance issues in your plugins and themes.

Free Download

---

![NinjaScanner](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-ns-150.png)

**NinjaScanner**

A lightweight, fast and powerful malware and virus scanner for WordPress which includes many features to help you scan your blog for malware and virus.

Free Download
## Categories

Categories
Select Category
Benchmarks  (5)
Changelog  (1)
Code Profiler  (1)
HHVM  (1)
Joomla!  (2)
Magento  (1)
NinjaFirewall  (150)
NinjaScanner  (8)
Performance  (2)
Privacy  (1)
Security  (154)
   Brute-force attack  (5)
   Malware  (7)
   Phishing  (2)
   Virus  (2)
   Vulnerability  (129)
Troubleshooting  (14)
Tutorial  (26)
WooCommerce  (2)
WordPress  (149)

## Search

Search for:

Search

## Recent Posts

* [XSS / HTML injection vulnerability in WordPress Plugin Check (PCP) plugin.](https://blog.nintechnet.com/xss-html-injection-vulnerability-in-wordpress-plugin-check-pcp-plugin/)
  December 6, 2024 - 7:24pm [+0700]
* [How to debug WooCommerce Add to Cart action with Code Profiler.](https://blog.nintechnet.com/how-to-debug-woocommerce-add-to-cart-action-with-code-profiler/)
  November 28, 2024 - 7:00pm [+0700]
* [SaferCheckout: Fraud prevention plugin for WooCommerce stores.](https://blog.nintechnet.com/safercheckout-fraud-prevention-plugin-for-woocommerce-stores/)
  August 5, 2024 - 5:31pm [+0700]
* [Unauthenticated function injection vulnerability in WordPress Shortcode Addons plugin (unpatched).](https://blog.nintechnet.com/unauthenticated-function-injection-vulnerability-in-wordpress-shortcode-addons-plugin-unpatched/)
  April 22, 2024 - 11:29am [+0700]
* [Broken access control vulnerability fixed in WordPress 10Web AI Assistant plugin.](https://blog.nintechnet.com/broken-access-control-vulnerability-fixed-in-wordpress-10web-ai-assistant-plugin/)
  January 26, 2024 - 1:50pm [+0700]

© Copyright
2025 – [The Ninja Technologies Network](https://nintechnet.com/)


