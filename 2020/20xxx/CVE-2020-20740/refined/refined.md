Based on the provided content, here's an analysis of CVE-2020-20740:

**Root cause of vulnerability:**

- The vulnerability stems from a lack of proper header validation checks in the `pdf_get_version()` function of the `pdfresurrect` tool. Specifically, the function does not adequately verify the structure of the PDF header before attempting to extract the PDF version, leading to an out-of-bounds read.

**Weaknesses/vulnerabilities present:**

- **Heap-based buffer overflow:** The `pdf_get_version()` function uses `strstr` to locate the PDF version string (`%PDF-`). It then uses `atoi` to parse the major and minor version numbers. The code assumes a specific format (`%PDF-M.m`), but does not validate the input before using `atoi`, which leads to a heap buffer overflow.

**Impact of exploitation:**

- **Heap-based buffer overflow:** Attackers can trigger a heap-based buffer overflow by providing a malformed PDF file with an invalid header, leading to a crash.  This could potentially be leveraged for arbitrary code execution.

**Attack vectors:**

- **Maliciously crafted PDF files:** The attack vector involves providing a specially crafted PDF file to the `pdfresurrect` tool. The malformed header within the PDF causes a heap-buffer-overflow during version parsing.

**Required attacker capabilities/position:**

- An attacker needs to be able to provide a malicious PDF file to the vulnerable `pdfresurrect` tool to trigger the vulnerability.

**Additional Details:**

- The vulnerability was reported by `yifengchen-cc`.
- The fix involves adding more robust header validation, specifically checking for the presence of the separator (`.`), major and minor version digits before using `atoi`.
- The fix was implemented in commit `1b422459f07353adce2878806d5247d9e91fb397`.
- Patched versions include: `pdfresurrect-0.21-1.fc32` and `pdfresurrect-0.21-1.fc33`.