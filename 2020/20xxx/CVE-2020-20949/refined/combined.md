=== Content from archiv.infsec.ethz.ch_755bbf5d_20250119_114519.html ===
Chosen Ciphertext Attacks Against Protocols
Based on the RSA Encryption Standard
PKCS #1

Daniel Bleichenbacher

Bell Laboratories
700 Mountain Ave., Murray Hill, NJ 07974
bleichen@research.bell-labs.com

Abstract. This paper introduces a new adaptive chosen ciphertext at-
tack against certain protocols based on RSA. We show that an RSA
private-key operation can be performed if the attacker has access to
an oracle that, for any chosen ciphertext, returns only one bit telling
whether the ciphertext corresponds to some unknown block of data en-
crypted using PKCS #1. An example of a protocol susceptible to our
attack is SSL V.3.0.

Keywords: chosen ciphertext attack, RSA, PKCS, SSL

1 Overview

In this paper, we analyze the following situation. Let n, e be an RSA public key,
and let d be the corresponding secret key. Assume that an attacker has access to
an oracle that, for any chosen ciphertext c, indicates whether the corresponding
plaintext cd mod n has the correct format according to the RSA encryption
standard PKCS #1.

We show how to use this oracle to decrypt or sign a message. The attacker
carefully prepares ciphertexts that are sent to the oracle. Combining the returns
from the oracle, the attacker gradually gains information on cd. The chosen ci-
phertexts are based on previous outcomes of the oracle. Thus, this technique is
an example of an adaptive chosen-ciphertext attack. Usually, a chosen ciphertext
attack is based on the theoretical assumption that the attacker has access to a
decryption device that returns the complete decryption for a chosen ciphertext.
Hence, if a public-key cryptosystem is susceptible to a chosen-ciphertext attack,
that often is considered to be only a theoretical weakness. However, the attack
shown in this paper is practical, because it is easy to get the necessary infor-
mation corresponding to the oracle reply. The attack can be carried out if, for
example, the attacker has access to a server that accepts encrypted messages
and returns an error message depending on whether the decrypted message is
PKCS conforming.

This paper is organized as follows. We describe the RSA encryption stan-
dard PKCS #1 in Section 2. In Section 3, we describe and analyze our chosen-
ciphertext attack. Di(cid:11)erent situations in which this attack can be carried out

H. Krawczyk (Ed.): CRYPTO’98, LNCS 1462, pp. 1–12, 1998.
c(cid:13) Springer-Verlag Berlin Heidelberg 1998

2

Daniel Bleichenbacher

are listed in Section 4. We then analyze the vulnerability of SSL to our attack in
Section 5. In Section 6, we report experiments with the technique. In Section 7,
we conclude by o(cid:11)ering recommendations.

2 PKCS #1

In this section, we describe brieﬂy the RSA encryption standard PKCS #1; refer
to [11] for details. Currently, there are three block formats: Block types 0 and 1
are reserved for digital signatures, and block type 2 is used for encryption. We
describe only block type 2, because it is relevant for this paper.

00

02

padding string

00

data block

Fig. 1. PKCS #1 block format for encryption. The (cid:12)rst two bytes in this format
are constant. The length of the padding block can vary.

Let n, e be an RSA public key, and let p, q, d be the corresponding secret key
(i.e, n = pq and d (cid:17) e−1
(mod ϕ(n))). Moreover, let k be the byte length of n.
Hence, we have 28(k−1) (cid:20) n < 28k. A data block D, consisting of jDj bytes, is
encrypted as follows. First, a padding string P S, consisting of k −3−jDj nonzero
bytes, is generated pseudo-randomly. Here, jDj must not exceed k − 11; in other
words, the byte length of P S is a least 8. Now, the encryption block EB =
00jj02jjP Sjj00jjD is formed (Figure 1), is converted into an integer x, and is
encrypted with RSA, giving the ciphertext c (cid:17) xe
(mod n). The representation
of the ciphertext is not important for this paper.

We are, however, interested in how the receiver parses a ciphertext. First, he
gets an integer x0 by decrypting the ciphertext with his private key. Then, he
0
converts x0 into an encryption block EB
. Now he looks for the (cid:12)rst zero byte,
which indicates the ending of the padding string PS and the start of the data
block D. The following de(cid:12)nition speci(cid:12)es when this parsing process is successful.

Deﬁnition 1. An encryption block EB consisting of k bytes – that is,

EB = EB1jj...jjEBk

is called PKCS conforming – if it satisﬁes the requirements of block type 2 in
PKCS #1. In particular, EB must satisfy the following conditions:

– EB1 = 00.
– EB2 = 02.
– EB3 through EB10 are nonzero.
– At least one of the bytes EB11 through EBk is 00.

Chosen Ciphertext Attacks Against Protocols

3

We also call a ciphertext c PKCS conforming if its decryption is PKCS conform-
ing.

Note that the de(cid:12)nition of conforming does not include possible integrity
checks. We show in Section 3 that it should not be possible for an attacker to
decide whether a chosen ciphertext is PKCS conforming. It is sometimes possible
for an attacker to do so even if the data block contains further integrity checks.

3 Chosen-Ciphertext Attacks

In a chosen-ciphertext attack, the attacker selects the ciphertext, sends it to the
victim, and is given in return the corresponding plaintext or some part thereof. A
chosen-plaintext attack is called adaptive if the attacker can chose the ciphertexts
depending on previous outcomes of the attack.

It is well known that plain RSA is susceptible to a chosen-ciphertext at-
tack [5]. An attacker who wishes to (cid:12)nd the decryption m (cid:17) cd
(mod n) of
a ciphertext c can chose a random integer s and ask for the decryption of the
innocent-looking message c0 (cid:17) sec mod n. From the answer m0 (cid:17) (c0)d, it is easy
to recover the original message, because m (cid:17) m0s−1

(mod n).

Another well-known result is that the least signi(cid:12)cant bit of RSA encryption
is as secure as the whole message [8] (see also [1]). In particular, there exists an
algorithm that can decrypt a ciphertext if there exists another algorithm that
can predict the least signi(cid:12)cant bit of a message given only the corresponding
ciphertext and the public key. H(cid:23)astad and N¨aslund recently extended this result
to show that all individual RSA bits are secure [9].

Hence, it is not necessary for an attacker to learn the complete decrypted
message in a chosen-ciphertext attack: Single bits per chosen ciphertext may be
su(cid:14)cient.

The result reported in this paper is similar. We assume that the attacker has
access to an oracle that, for every ciphertext, returns whether the corresponding
plaintext is PKCS conforming. We show that we can use this oracle to compute
cd
(mod n) for any chosen integer c. Theoretically, we can use H(cid:23)astad’s and
N¨aslund’s algorithm [9] to (cid:12)nd c. In this paper, we describe a di(cid:11)erent algorithm
that has as its goal to minimize the number of chosen ciphertexts; thus, we show
the practicality of the attack. That is, we are not trying to generalize the attack;
rather, we would like to take advantage of speci(cid:12)c properties of PKCS #1. In
particular, the algorithm relies on the facts that the (cid:12)rst two bytes of the PKCS
#1 format are constant, and that we know these two bytes with certainty when
a ciphertext is accepted. Also, we use heuristic arguments in our the analysis of
the algorithm to approximate the number of expected chosen ciphertexts, rather
than (cid:12)nding an upper bound.

3.1 Description of the Attack

First, we give a short overview over the attack; then, we describe the attack in
detail.

4

Daniel Bleichenbacher

Assume that the attacker wants to (cid:12)nd m (cid:17) cd

(mod n), where c is an

arbitrary integer. Basically, the attacker chooses integers s, computes

c0 (cid:17) cse

(mod n),

and sends c0 to the oracle. If the oracle says that c0 is PKCS conforming, then
the attacker knows that the (cid:12)rst two bytes of ms are 00 and 02. For convenience,
let

B = 28(k−2).

Recall that k is the length of n in bytes. Hence, that ms is PKCS conforming

implies that

2B (cid:20) ms mod n < 3B.

By collecting several such pieces of information, we can eventually derive m.
Typically, 220 chosen ciphertexts will be su(cid:14)cient, but this number varies widely
depending on numerous implementation details.

The attack can be divided into three phases. In the (cid:12)rst phase, the message
is blinded, giving a ciphertext c0 that corresponds to an unknown message m0.
In the second phase, the attacker tries to (cid:12)nd small values si for which the ci-
phertext c0(si)e mod n is PKCS conforming. For each successful value for si, the
attacker computes, using previous knowledge about m0, a set of intervals that
must contain m0. We elaborate this process later. The third phase starts when
only one interval remains. Then, the attacker has su(cid:14)cient information about
m0 to choose si such that c0(si)e mod n is much more likely to be PKCS con-
forming than is a randomly chosen message. The size of si is increased gradually,
narrowing the possible range of m0 until only one possible value remains.

Now we describe this attack in detail. The variable Mi will always be a set
of (closed) intervals that is computed after a successful si has been found, such
that m0 is contained in one of the intervals of Mi.
Step 1: Blinding. Given an integer c, choose di(cid:11)erent random integers s0; then
check, by accessing the oracle, whether c(s0)e mod n is PKCS conforming.
For the (cid:12)rst successful value s0, set

c0   c(s0)e mod n
M0   f[2B, 3B − 1]g

i   1.

Step 2: Searching for PKCS conforming messages.
Step 2.a: Starting the search. If i = 1, then search for the smallest posi-
tive integer s1 (cid:21) n/(3B), such that the ciphertext c0(s1)e mod n is PKCS
conforming.

Step 2.b: Searching with more than one interval left. Otherwise, if i >
1 and the number of intervals in Mi−1 is at least 2, then search for the
smallest integer si > si−1, such that the ciphertext c0(si)e mod n is PKCS
conforming.

Chosen Ciphertext Attacks Against Protocols

5

(1)

(2)

Step 2.c: Searching with one interval left. Otherwise, if Mi−1 contains ex-
actly one interval (i.e., Mi−1 = f[a, b]g), then choose small integer values
ri, si such that

ri (cid:21) 2

bsi−1 − 2B
n

and

2B + rin
b
until the ciphertext c0(si)e mod n is PKCS conforming.

(cid:20) si < 3B + rin

a

,

Step 3: Narrowing the set of solutions. After si has been found, the set

Mi is computed as
(cid:26)(cid:20)

(cid:91)

Mi

(a,b,r)

(cid:18)

(cid:24)

max

a,

(cid:25)(cid:19)

(cid:18)

(cid:22)

, min

b,

2B + rn
si

3B − 1 + rn
si

(cid:23)(cid:19)(cid:21)(cid:27)

(3)

for all [a, b] 2 Mi−1 and

asi − 3B + 1
n

(cid:20) r (cid:20)

bsi − 2B
n

.

Step 4: Computing the solution. If Mi contains only one interval of length
1 (i.e., Mi = f[a, a]g), then set m   a(s0)−1 mod n, and return m as solution
of m (cid:17) cd
(mod n). Otherwise, set i   i + 1 and go to step 2.

Remarks. Step 1 can be skipped if c is already PKCS conforming (i.e., when
c is an encrypted message). In that case, we set s0   1. However, step 1 is
always necessary for computing a signature, even if we do not wish to get a
blind signature.

In Step 2.a, we start with s1 = dn/(3B)e, because, for smaller values m0s1

is never PKCS conforming.

We use condition (1) because we want to divide the remaining interval in

each iteration roughly in half.

We can often improve the attack by using more information. For example,
we have not used the fact that any PKCS-conforming message m0si contains
at least one zero byte. Moreover, if the attack is performed in a client{server
environment, where both parties use the message m0si to generate session keys,
we might be able to (cid:12)nd this message by exhaustive search if we already knew
a su(cid:14)cient portion of it.

3.2 Analysis of the Attack

We now analyze the correctness of the attack and approximate the complexity
of, and, in particular, the number of oracle accesses necessary for, this attack.
We must make a few heuristic assumptions; hence, we cannot give a rigorous
proof of our result.

First, we approximate the probability Pr(P ) that a randomly chosen integer
n be the probability that, for a

0 (cid:20) m < n is PKCS conforming. Let Pr(A) = B

6

Daniel Bleichenbacher

randomly chosen integer, the (cid:12)rst two bytes are 00 and 02, respectively. Since
we have 216B > n > 28B, it follows that

2−16 < Pr(A) < 2−8.

The RSA modulus is usually chosen to be a multiple of 8; hence, Pr(A) will
usually be close to 2−16. The probability that the padding block PS contains at
least 8 non-zero bytes followed by a zero byte is
(cid:18)

(cid:33)

(cid:32)

(cid:18)

Pr(P jA) =

(cid:1)

1 −

(cid:19)8

255
256

(cid:19)k−10

.

255
256

Assuming a modulus n of at least 512 bit (i.e. k (cid:21) 64), we have

0.18 < Pr(P jA) < 0.97;

hence, we have

0.18 (cid:1) 2−16 < Pr(P ) < 0.97 (cid:1) 2−8.

Next, we explain why our algorithm (cid:12)nds m0 and thus m. We prove that
m0 2 Mi for all i by induction over i. Since m0 is PKCS conforming, we have
2B (cid:20) m0 (cid:20) 3B − 1, and so, trivially, m0 2 M0.

Now assume that m0 2 Mi−1. Hence, there exists an interval [a, b] 2 Mi−1
with a (cid:20) m0 (cid:20) b. Since m0si is PKCS conforming, there exists an integer r such
that 2B (cid:20) m0si − rn (cid:20) 3B − 1, and hence asi − (3B − 1) (cid:20) rn (cid:20) bsi − 2B. We
also have

2B + rn
si

(cid:20) m0 (cid:20) 3B − 1 + rn

.

si

Hence, it follows from the de(cid:12)nition of Mi that m0 is contained in one of the
intervals.

Now we analyze the complexity of the attack. The messages in step 1 are
chosen randomly; therefore, this step needs about 1/Pr(P ) accesses to the oracle
on average to (cid:12)nd s0. We assume again that, on average, we need 1/Pr(P )
accesses to the oracle to (cid:12)nd si for i (cid:21) 1 in step 2.a and 2.b. (See also the
remark at the end of this section.)

Let ωi be the number of intervals in Mi. Using heuristic arguments, we can

expect that ωi will satisfy the following equation for i (cid:21) 1.

ωi (cid:20) 1 + 2i−1si

(cid:19)i

(cid:18)

B
n

Indeed, the length of an interval in Mi is upper bounded by
(cid:7)
that m0si is PKCS conforming alone would lead to

(cid:6)

(cid:20)(cid:24)

(cid:25)

(cid:22)

,

2B + rn
si

Ir =

3B − 1 + rn
si

since r can take at most

(cid:7)

(cid:6)

siB
n

values in equation (3).

(4)

(cid:108)

(cid:109)

B
si

. The knowledge

intervals of the form

,

(5)

siB
n
(cid:23)(cid:21)

Chosen Ciphertext Attacks Against Protocols

7

In particular, M1 will contain about

intervals. If i > 1, then each of the
intervals Ir or a fraction of Ir is included in Mi if Ir overlaps with one interval
of Mi−1. No interval Ir can overlap with two intervals in Mi−1. If intervals Ir
were randomly distributed, then the probability that one intersects with Mi−1
would be upper bounded by

(cid:6)

(cid:7)

s1B
n

(cid:18)

1
si

+

1
si−1

(cid:19)

ωi−1.

Hence, we get Equation (4) by taking into account that one interval must con-
tain m0. In our case, we expect s2 to be approximately 2/Pr(P ), and we have
2(B/n)2/Pr(P ) = 2B/(nPr(P jA)) < 2B/(0.18n) < 1/20. Hence, w2 is 1 with
high probability. Thus, we expect that Step 2.b will be executed only once.

thus

Now we analyze Step 2.c. We have Mi = f[a, b]g; hence, a (cid:20) m0 (cid:20) b, and
(cid:20) si (cid:20) 3B − 1 + rin

.

(cid:20) 3B − 1 + rin
a

2B + rin
b

(cid:20) 2B + rin
m0

The length of the interval [ 2B+rin

b

, 3B−1+rin
a

m0
] is

3B − 1 + rin
a

− 2B + rin
b

(cid:21) 3B − 1 + rin
m0

− 2B + rin
m0

(cid:21)

B − 1
m0

(cid:21) 1
3

B − 1
B

.

Therefore, we can expect to (cid:12)nd a pair ri, si that satis(cid:12)es (2) for about each
third value of ri that is tried. Thus, it seems easy to (cid:12)nd such pairs ri, si that
satisfy (1) and (2) just by iterating through possible values for ri.

The probability that si 2 [ 2B+rin

, 3B−1+rin
m0

m0

] is roughly 1/2. Thus, we will

(cid:12)nd a PKCS-conforming si after trying about 2/Pr(P jA) chosen ciphertexts.

Since the remaining interval in Mi is divided in half in each step 2.c, we

expect to (cid:12)nd m0 with about

3/Pr(P ) + 16k/Pr(P jA)

chosen ciphertexts, where k denotes the size of the modulus in bytes. For Pr(P ) =
0.18 (cid:1) 2−16 and k = 128 (which corresponds to a 1024-bit modulus), we expect
that the attack needs roughly 220 chosen ciphertexts to succeed. The bit length
of the modulus is usually a multiple of 8; hence, Pr(P ) is close to 0.18 (cid:1) 2−16, as
assumed previously.

Remarks. The probabilities in this section were computed under the assump-
tion that the values si are independent of each other. We made that assumption
to allow a heuristic analysis of the algorithm. However, the assumption may be
wrong in special cases. For example, let us assume that m0 and sim0 are both
PKCS conforming with padding strings of similar length; that is, we have, for
some integer j,

m0 = 2 (cid:1) 28(k−2) + 28jPS + D
sim0 = 2 (cid:1) 28(k−2) + 28jPS0 + D0.

8

Daniel Bleichenbacher

Then, (2si − 1)m0 is PKCS conforming with high probability, since

(2si − 1)m0 = 2 (cid:1) 28(k−2) + 28j(2PS0 − PS) + 2D0 − D

often is PKCS conforming too. We believe that such relations generally help the
attacker, but it in certain situations the attack might require many more chosen
ciphertexts than our analysis indicates.

Usually, the bit size of the RSA modulus is a multiple of 8. This choice is a
good one, because, for such a modulus, Pr(P ) is small. A modulus with a bit
length 8k − 7 would make the attack much easier, because, in that case, only
about 213 chosen messages would be necessary.

4 Access to an Oracle

In this section, we describe three situations in which an attacker could get access
to an oracle.

4.1 Plain Encryption

Let us assume that a cryptographic protocol starts as follows. Alice generates
a message m (e.g., a randomly chosen key). She encrypts it with PKCS #1,
without applying any further integrity checks, and sends the ciphertext to Bob.
Bob decrypts the message. If the format of the message is not PKCS conforming,
then he returns an error; otherwise, he proceeds according to the protocol.

If Eve impersonates Alice, she can easily send messages to Bob and check
them for conformance. Note that Eve’s attack works even when the protocol
includes strong authentication at a later step, since Eve has obtained useful
information before she has to respond with an authenticated message.

Note that the RSA encryption standard PKCS #1 [11, page 8, note 3] recom-
mends that a message digest be included before an RSA operation, but for only
the signing procedure. Even though the standard mentions that an encrypted
message does not ensure integrity by itself, the standard does not indicate where
such an integrity check should be included.

4.2 Detailed Error Messages

Thus far, we have shown that a reliable integrity check is an important part
of an RSA encryption. One way to include such a check is to let the sender
sign the message with his private key, before he encrypts it with the receiver’s
public key. Then, an attacker can no longer hope to create a correct message by
accident. Her attack will nonetheless be successful when, in the case of a failed
veri(cid:12)cation, the receiver returns an error message that gives detailed information
about where the veri(cid:12)cation failed. In particular, it would compromise security
to return di(cid:11)erent error messages for a message that is not PKCS conforming
and for a message where only the signature veri(cid:12)cation failed.

Chosen Ciphertext Attacks Against Protocols

9

4.3 A Timing Attack

Certain applications combine encryption and signatures. In such cases, a reliable
integrity check often is part of the signature, but is not included in the encryp-
tion. Let us assume that an encrypted message c is decrypted and veri(cid:12)ed as
shown in the following pseudo-code:

(mod n) be the RSA-decryption of c.

1. Let m (cid:17) cd
2. If m is not PKCS conforming, then reject.
3. Otherwise, verify the signature of m.
4. If the signature is not correct, then reject; otherwise, accept.

An attacker will not be able to generate a chosen ciphertext c such that this
message has a correct signature. However, she will be able to generate messages
such that c sometimes passes the check in step 2 and is rejected only after the
signature is checked. Hence, by measuring the server’s response time, an attacker
could determine whether c is PKCS conforming. This timing attack is much eas-
ier to perform than is Kocher’s timing attack [10], which measures the time
di(cid:11)erence of single modular multiplications { a small fraction of the time used
for one exponentiation. In our case, however, we have to distinguish between
performing only an decryption and performing both an decryption and a signa-
ture veri(cid:12)cation. In the worst case, the time for the signature veri(cid:12)cation could
be signi(cid:12)cantly longer than the time for the decryption { when, for example,
we have a 512-bit encryption key because of export restrictions, but we use a
2048-bit key to ensure strong authentication. In addition, the attacker can chose
what signing key is sent to the server.

5 SSL V.3.0

00

02

padding string

00

03

00

premastersecret

46 bytes

Fig. 2. SSL block format. Unlike the PKCS format, this format contains the
SSL version number. Moreover, the length of the data block is constant.

The situation discussed in this paper arises in SSL V.3.0 [7] during the hand-
shake protocol. In particular. the client and server (cid:12)rst exchange the messages
client.hello and server.hello, which, among other information exchanges,
select the cryptographic routines. After that, the client and server may send
their public keys and certi(cid:12)cates. The client then generates a random secret bit

10

Daniel Bleichenbacher

string called pre master secret, encrypts that secret bit string with RSA (if
that mode was chosen earlier), and sends the resulting ciphertext to the server.
The server decrypts the ciphertext. If the plaintext is not PKCS conforming,
the server sends an alert message to the client and closes the connection; oth-
erwise, the server continues the handshake protocol. Finally, the client has to
send a finished message, which contains strong authentication. In particular,
the client has to know the pre master secret to compute that message.

Because an attacker must generate a finished message that depends on the
pre master secret, she cannot complete the handshake protocol successfully.
However, she does not have to complete it; she gets the necessary information {
namely, whether her chosen message is PKCS conforming { before the protocol
is (cid:12)nished.

There are details of SSL V.3.0 that might hinder this attack if they are
implemented the right way. Figure 2 shows the format of the message containing
the pre master secret before the latter is encrypted with RSA. It contains
the version number of the protocol, the purpose of which is to detect version-
rollback attacks, in which an attacker tries to modify the hello messages such
that both client and server use the compatibility mode and hence use the Version
2.0, instead of Version 3.0, protocols. One implementation that we analyzed [12]
checks the version number only if the server is running in the compatibility mode,
because otherwise obviously no rollback attack has occurred.

A much more secure implementation would check the version number in all
modes, and, if it identi(cid:12)ed a mismatch, would send back to the client the same
error alert as it sends in the case of a decryption error. The result would be that
a randomly generated message would be accepted with a probability of about
2−40; although such a protocol still could not be called secure, the attack shown
in this paper would at least be impractical.

The SSL documentation does not specify clearly the error conditions and
corresponding alerts. As a result, di(cid:11)erent implementations of SSL do not react
consistently with one another in error situations.

6 Experimental Results

We implemented the algorithm described in Section 3 and veri(cid:12)ed experimentally
that this algorithm can decrypt a PKCS #1 encrypted message given access
to an oracle that, for any ciphertext, indicates whether the the corresponding
plaintext is PKCS conforming. We tested the algorithm with di(cid:11)erent 512-bit
and 1024-bit keys. The algorithm needed between 300 thousand and 2 million
chosen ciphertexts to (cid:12)nd the message. We implemented our own version of the
oracle, rather than using an existing software product.

Finney checked three di(cid:11)erent SSL servers [6] to (cid:12)nd out how carefully the
servers analyze the message format and what error alerts are returned. One of
the servers veri(cid:12)ed only the PKCS format. The second server checked the PKCS
format, message length, and version number, but returned di(cid:11)erent message

Chosen Ciphertext Attacks Against Protocols

11

alerts, thus still allowing our attack. Only the third server checked all aspects
correctly and did not leak information by sending di(cid:11)erent alerts.

7 Conclusion

We have shown a chosen-ciphertext attack that can be carried out when only par-
tial information about the corresponding message is leaked. We conclude not only
that it is important to include a strong integrity check into an RSA encryption,
but also that this integrity check must be performed in the correct step of the
protocol { preferably immediately after decryption. The phase between decryp-
tion and integrity check is critical, because even sending out error messages can
present a security risk. We also believe that we have provided a strong argument
to use plaintext-aware encryption schemes, such as the one described by Bellare
and Rogaway [3]. Note that plaintext awareness implies security against chosen-
ciphertext attacks [2,3]. In particular, Version 2 of PKCS #1, which makes use
of [3], is not susceptible to the attack described in this paper.

It is a good idea to have a receiver check the integrity of a message imme-
diately after decrypting that message. Even better is to check integrity before
decrypting a message, as Cramer and Shoup show is possible [4].

Acknowledgments

I thank Markus Jakobsson, David M. Kristol, and Jean-Fran(cid:24)cois Misarsky, as
well as the members of the program committee, for all their comments and
suggestions. I am grateful for the cooperation of the people at RSA Laboratories.
I thank Hal Finney for telling me about his experiments on di(cid:11)erent SSL servers.
I am also grateful to Lyn Dupr(cid:19)e for editing this paper.

References

1. W. Alexi, B. Chor, O. Goldreich, and P. Schnorr. Bit security of RSA and Rabin

functions. SIAM Journal of computing, 17(2):194{209, Apr. 1988. 3

2. M. Bellare, A. Desai, D. Pointcheval, and P. Rogaway. Relations among notions of
security for public-key encryptions schemes. In H. Krawczyk, editor, Advances in
Cryptology – CRYPTO ’98, Lecture Notes in Computer Science. Springer Verlag.
(in press). 11

3. M. Bellare and P. Rogaway. Optimal asymmetric encryption.

In A. D. Santis,
editor, Advances in Cryptology – EUROCRYPT ’94, volume 950 of Lecture Notes
in Computer Science, pages 92{111, Berlin, 1995. Springer Verlag. 11, 11, 11
4. R. Cramer and V. Shoup. A practical public key cryptosystem provably secure
against adaptive chosen ciphertext attack. In H. Krawczyk, editor, Advances in
Cryptology – CRYPTO ’98, Lecture Notes in Computer Science. Springer Verlag.
(in press). 11

5. G. I. Davida. Chosen signature cryptanalysis of the RSA (MIT) public key cryp-
tosystem. Technical Report TR-CS-82-2, Departement of Electrical Engineering
and Computer Science, University of Wisconsin, Milwaukee, 1982. 3

12

Daniel Bleichenbacher

6. H. Finney. personal communication. 10
7. A. O. Freier, P. Karlton, and P. C. Kocher. The SSL Protocol, Version 3.0.

Netscape, Mountain View, CA, 96. 9

8. S. Goldwasser, S. Micali, and P. Tong. Why and how to establish a private code
on a public network. In Proc. 23rd IEEE Symp. on Foundations of Comp. Science,
pages 134{144, Chicago, 1982. 3

9. J. H(cid:23)astad and M. N¨aslund. The security of individual RSA bits. manusrcipt, 1998.

3, 3

10. P. C. Kocher. Timing attacks on implementations of Di(cid:14)e{Hellman RSA, DSS,
and other systems. In N. Koblitz, editor, Advances in Cryptology – CRYPTO ’96,
volume 1109 of Lecture Notes in Computer Science, pages 104{113, Berlin, 1996.
Springer Verlag. 9

11. RSA Data Security, Inc. PKCS #1: RSA Encryption Standard. Redwood City,

CA, Nov. 1993. Version 1.5. 2, 8

12. E. A. Young. SSLeay 0.8.1. url = http://www.cryptsoft.com/ 10



=== Content from st.com_2fac4d66_20250119_114520.html ===


* English
* [中文](https://www.st.com.cn/content/st_com/zh.html)
* [日本語](https://www.st.com/content/st_com/ja.html)

                                                                                                                                                                                                                                  Our **ST Recruiting Privacy Terms (Privacy Terms)** describes the privacy and security practices that STMicroelectronics, its subsidiaries, and affiliates employ when collecting, using, and handling personal information about you in connection with our online and offline recruitment activities. It also explains the choices you have in relation to these processing activities.   By engaging with us (clicking one of the Call-To-Action buttons) you are subject to the Privacy Terms that we invite you to read them by clicking on [ST Recruiting Privacy Terms](/content/st_com/en/common/privacy-portal/st-recruiting-privacy-terms/st-recruiting-privacy-terms-en.html)  Please note that when clicking a Call-To-Action button you are directed to the recruiting platform of our partner Eightfold, the Privacy Terms are always governing our online and offline recruitment activities.   Find your next adventure                           ![A true game changer for the future of quantum computing](/content/dam/0hp/2025-01/top-static-image/bn2501Quobly-T.jpg)

ST + Quobly collaboration

A true game changer for the future of quantum computing

     [More information here](https://newsroom.st.com/media-center/press-item.html/t4667.html)                  ![A true game changer for the future of quantum computing](/content/dam/0hp/2025-01/top-static-image/bn2501Quobly-T.jpg)

ST + Quobly collaboration

A true game changer for the future of quantum computing

   [More information here](https://newsroom.st.com/media-center/press-item.html/t4667.html)        ![A true game changer for the future of quantum computing](/content/dam/0hp/2025-01/top-static-image/bn2501Quobly-M.jpg)

ST + Quobly collaboration

A true game changer for the future of quantum computing

   [More information here](https://newsroom.st.com/media-center/press-item.html/t4667.html)                  Quick start

* [Careers](/content/st_com/en/about/careers.html)
* [Design tools](/content/st_com/en/support/resources/edesign.html)
* [Development tools](/en/development-tools/software-development-tools.html)   [STM32 Developer Zone](/content/st_com/en/stm32-mcu-developer-zone.html)
* [Community](https://community.st.com/s/)
* [eStore](https://estore.st.com/en/)
* [Contact us](/content/st_com/en/support/support-home.html)

## Products & innovations for you

## Products & innovations for you

  Smart Mobility   Power & Energy   Cloud-connected Autonomous Things
### Smart Mobility

We are improving mobility by making it safer, greener, and more connected for everyone.    [![](/content/dam/0hp/2025-01/innovations-title/hp-tile-stripfet-f8-automotive-.jpg)](https://www.st.com/content/st_com/en/campaigns/stripfet-f8-n-channel-low-voltage-power-mosfets-for-automotive-applications.html?icmp=tt42028_gl_bn_dec2024)   [#### Safer driving experience](https://www.st.com/content/st_com/en/campaigns/stripfet-f8-n-channel-low-voltage-power-mosfets-for-automotive-applications.html?icmp=tt42028_gl_bn_dec2024)
#### Safer driving experience

Achieve high levels of reliability and safety in next-gen vehicles with advanced STripFET F8 low-voltage power MOSFETs

  [Discover our portfolio](https://www.st.com/content/st_com/en/campaigns/stripfet-f8-n-channel-low-voltage-power-mosfets-for-automotive-applications.html?icmp=tt42028_gl_bn_dec2024)         [![](/content/dam/0hp/2024-12/innovation-tile/hp-tile-autodevkit-bms-use-case.png)](https://www.st.com/content/st_com/en/support/learning/essentials-and-insights/smart-driving/use-cases/how-a-battery-management-system-bms-works-and-how-to-design-it.html?icmp=tt42025_gl_bn_dec2024)   [#### BMS design made easy](https://www.st.com/content/st_com/en/support/learning/essentials-and-insights/smart-driving/use-cases/how-a-battery-management-system-bms-works-and-how-to-design-it.html?icmp=tt42025_gl_bn_dec2024)
#### BMS design made easy

Ready-to-use AutoDevKit development ecosystem provides a comprehensive solution to start your BMS application

  [Go electric!](https://www.st.com/content/st_com/en/support/learning/essentials-and-insights/smart-driving/use-cases/how-a-battery-management-system-bms-works-and-how-to-design-it.html?icmp=tt42025_gl_bn_dec2024)         ![](/content/dam/crew/drone-takeoff-building.jpg)
### Power & Energy

We are enabling industries to increase energy efficiency and use more renewable energy.    [![](/content/dam/0hp/2025-01/innovations-title/factory-automation.jpg)](https://www.st.com/content/st_com/en/campaigns/next-generation-high-side-power-switches-for-smart-factory-asp-mcips.html?icmp=tt42198_gl_bn_dec2024)   [#### Smart factory enhanced](https://www.st.com/content/st_com/en/campaigns/next-generation-high-side-power-switches-for-smart-factory-asp-mcips.html?icmp=tt42198_gl_bn_dec2024)
#### Smart factory enhanced

Octal high-side switches feature protection and diagnostics in space-saving footprint.

  [Optimize your design](https://www.st.com/content/st_com/en/campaigns/next-generation-high-side-power-switches-for-smart-factory-asp-mcips.html?icmp=tt42198_gl_bn_dec2024)         [![](/content/dam/0hp/2024-11/innovation-tile/l9961-industrial-bms-whitepaper.jpg)](https://content.st.com/whitepaper-advanced-bms-for-sustainable-efficient-cordless-power-tools-l9961.html?icmp=tt41822_gl_bn_nov2024)   [#### Designing cordless tools](https://content.st.com/whitepaper-advanced-bms-for-sustainable-efficient-cordless-power-tools-l9961.html?icmp=tt41822_gl_bn_nov2024)
#### Designing cordless tools

Valuable insights on how to enhance the efficiency, reliability, and longevity of cordless power tools

  [Download our whitepaper](https://content.st.com/whitepaper-advanced-bms-for-sustainable-efficient-cordless-power-tools-l9961.html?icmp=tt41822_gl_bn_nov2024)         ![](/content/dam/crew/solar-panel-blue-sky.jpg)
### Cloud-connected Autonomous Things

We are supporting the proliferation of secure, connected, autonomous devices enabled by edge AI.    [![](/content/dam/0hp/2024-12/innovation-tile/HP%20tile%20file.jpg)](https://www.st.com/en/microcontrollers-microprocessors/stm32n6-series.html?icmp=tt42144_gl_bn_dec2024)   [#### New AI-accelerated STM32 MCU](https://www.st.com/en/microcontrollers-microprocessors/stm32n6-series.html?icmp=tt42144_gl_bn_dec2024)
#### New AI-accelerated STM32 MCU

Redefine your MCU performance for industrial and consumer applications with the groundbreaking AI-accelerated STM32N6.

  [Discover more](https://www.st.com/en/microcontrollers-microprocessors/stm32n6-series.html?icmp=tt42144_gl_bn_dec2024)         [![](/content/dam/0hp/2025-01/innovations-title/staiot-craft-human-activity-recognition-banner.jpg)](https://staiotcraft.st.com/index.html#/project-examples?icmp=tt42203_jk_bn_dec2024)   [#### In-sensor AI recognition](https://staiotcraft.st.com/index.html#/project-examples?icmp=tt42203_jk_bn_dec2024)
#### In-sensor AI recognition

Use ST AIoT Craft to customize machine learning code examples and distinguish standing, running, and walking in ST MEMS.

  [Simplify edge AI](https://staiotcraft.st.com/index.html#/project-examples?icmp=tt42203_jk_bn_dec2024)         ![](/content/dam/crew/smart-city-night-buildings.jpg)     ![](/content/dam/crew/drone-takeoff-building.jpg) ![](/content/dam/crew/solar-panel-blue-sky.jpg) ![](/content/dam/crew/smart-city-night-buildings.jpg)
## Upcoming events

Want to know more about our latest technologies?Come and meet us.

[Check out all our upcoming events](/content/st_com/en/about/events.html) [Check out all our upcoming events](/content/st_com/en/about/events.html)    Jan
 19 - 23   [![event-tile-1-en](/content/dam/0hp/2024-12/upcoming-event/biosensors-image-ieee-mems-ds.jpg)  ![event-tile-1-en](/content/dam/0hp/2024-12/upcoming-event/biosensors-image-ieee-mems-ds.jpg) Tradeshow   Tradeshow Kaohsiung, TW
### IEEE MEMS

  19 Jan  - 23 Jan  Kaohsiung, TW
### IEEE MEMS](https://www.st.com/content/st_com/en/events/ieee-mems.html)    Jan
 21    [![event-tile-2-en](/content/dam/0hp/2025-01/upcoming-events/GUI-solutions-from-STM32-264x176px.jpg)  ![event-tile-2-en](/content/dam/0hp/2025-01/upcoming-events/GUI-solutions-from-STM32-264x176px.jpg) Webinar   Webinar Online
### Achieve maximum GUI performance with STM32 microcontrollers

  21 Jan  Online
### Achieve maximum GUI performance with STM32 microcontrollers](https://content.st.com/maximum-gui-performance-with-stm32-microcontrollers.html)    Dec 20
  - Jan 20   [![event-tile-3-en](/content/dam/0hp/2024-12/upcoming-event/wireless-metering-264x176px.jpg)  ![event-tile-3-en](/content/dam/0hp/2024-12/upcoming-event/wireless-metering-264x176px.jpg) Webinar   Webinar On-demand
### Simplify your design approach for IoT devices with the STM32WL3

  20 Dec  - 20 Jan  On-demand
### Simplify your design approach for IoT devices with the STM32WL3](https://content.st.com/simplify-your-design-with-low-power-long-range-stm32wl3.html)                       R&D

9,500 employees.

 Innovation

20,000 patents.

 Partnerships

180+ active R&D program.

## We have an unwavering commitment to innovation & technology

We innovate to create unique technologies and products that provide our customers the best solutions to address their challenges and opportunities.

 [Discover innovation and technology at ST](/content/st_com/en/about/innovation---technology/innovation---technology.html)    [Discover innovation and technology at ST](/content/st_com/en/about/innovation---technology/innovation---technology.html)    ![robot-industry-factory](/content/dam/st-crew/robot-industry-factory-1920x950.jpg) ![robot-industry-factory](/content/dam/st-crew/robot-industry-factory-1920x950.jpg)
## ST highlights

We create technology for a sustainable world, in a sustainable way. We enable safer, smarter and greener ways of living while acting together to protect the planet.

  [![tile-1-careers](/content/dam/0hp/2024-10/st-highlights-tile/man-in-front-of-monitor-homepage.jpg)
### The ST Foundation develops, coordinates, and sponsors projects to tackle the digital divide](https://www.st.com/content/st_com/en/about/st_company_information/st-foundation.html?icmp=tt40977_gl_bn_sep2024)  [![tile-2-innovation](/content/dam/0hp/2024-11/highlights/automotive-mcu-rendering.jpg)
### ST is committed to supporting car makers' transformation journey with innovative solutions](https://www.st.com/content/st_com/en/campaigns/automotive-microcontrollers-mcu-st-strategy-for-future-zonal-architectures-and-electrification-systems.html?icmp=tt41591_gl_bn_nov2024)  [![tile-3-sustainability](/content/dam/0hp/2024-11/highlights/health-and-safety.jpg)
### All our manufacturing sites are ISO 45001 certified, ensuring high standard of work environment](https://www.st.com/content/st_com/en/about/sustainability/prioritizing-people.html?icmp=tt41802_gl_bn_nov2024)                 ![customer-success-story-hp](/content/dam/0hp/2025-01/middle-image/bn2412MonnaieDeParis-D.jpg)
## Minting the future with the first connected coin

   [Read success story](https://www.st.com/content/st_com/en/about/customer-success-stories/how-monnaie-de-paris-created-the-world-first-connected-coin.html)   ![](/content/dam/0hp/2025-01/middle-image/MonnaieDeParis_ST_W_D.svg)                     Connect.

83,000+ Community members.

 Engage.

1,500+ New conversations every month.

 Find guidance.

70+ ST experts sharing insights.

## Reach your design goals faster

Visit the ST Community to find answers, share technical insights, and increase your knowledge. Subscribe to the news section to stay informed on the latest updates for developers.

 [Join the ST Community](https://community.st.com/)    [Join the ST Community](https://community.st.com/)    ![Join the ST Community](/content/dam/0hp/2025-01/bottom-image/st-community-china-developer-work-desktop.jpg) ![Join the ST Community](/content/dam/0hp/2025-01/bottom-image/st-community-china-developer-work-mobile.jpg)
### Newsroom

See all the latest news from ST.

   [Visit the Newsroom](https://newsroom.st.com)        [![https://newsroom.st.com/wp-content/uploads/2025/01/c3304-top-employer-global-home.jpg](https://newsroom.st.com/wp-content/uploads/2025/01/c3304-top-employer-global-home.jpg)](https://newsroom.st.com/media-center/press-item.html/c3304.html)    Jan 16, 2025 [### STMicroelectronics recognized as a Global Top Employer 2025](https://newsroom.st.com/media-center/press-item.html/c3304.html)      [![](/content/dam/new-st-homepage/news-updates-placeholder-384x384.jpg)](https://newsroom.st.com/media-center/press-item.html/c3301.html)    Jan 07, 2025 [### STMicroelectronics Announces Timing for Fourth Quarter and Full Year 2024 Earnings Release and Conference Call](https://newsroom.st.com/media-center/press-item.html/c3301.html)      [![https://newsroom.st.com/wp-content/uploads/2024/12/Quobly-t4667-home.jpg](https://newsroom.st.com/wp-content/uploads/2024/12/Quobly-t4667-home.jpg)](https://newsroom.st.com/media-center/press-item.html/t4667.html)    Dec 12, 2024 [### Quobly Forges Strategic Collaboration with STMicroelectronics to Accelerate its Quantum Processor Manufacturing for Large-Scale Quantum Computing Solutions](https://newsroom.st.com/media-center/press-item.html/t4667.html)      [![https://newsroom.st.com/wp-content/uploads/2024/12/ST67W611-Qualcomm-module-P4666-home.jpg](https://newsroom.st.com/wp-content/uploads/2024/12/ST67W611-Qualcomm-module-P4666-home.jpg)](https://newsroom.st.com/media-center/press-item.html/p4666.html)    Dec 11, 2024 [### STMicroelectronics introduces first STM32-ready wireless IoT modules leveraging collaboration with Qualcomm](https://newsroom.st.com/media-center/press-item.html/p4666.html)
### Blog

Read our latest technical articles.

   [Visit the Blog](https://blog.st.com)        [![https://blog.st.com/wp-content/uploads/Thumbnails-subbrands-36.jpg](https://blog.st.com/wp-content/uploads/Thumbnails-subbrands-36.jpg)](https://blog.st.com/introducing-young-learners-to-coding-st-activities-for-kindergarten-and-primary-schools/)    Jan 16, 2025 [### Introducing young learners to coding: ST activities for kindergarten and primary schools](https://blog.st.com/introducing-young-learners-to-coding-st-activities-for-kindergarten-and-primary-schools/)      [![https://blog.st.com/wp-content/uploads/Thumbnails-subbrands-35.jpg](https://blog.st.com/wp-content/uploads/Thumbnails-subbrands-35.jpg)](https://blog.st.com/matter-commissioning/)    Jan 15, 2025 [### Matter commissioning with NFC: how contactless communication touches new use cases and why it matters](https://blog.st.com/matter-commissioning/)      [![https://blog.st.com/wp-content/uploads/prog4x4.jpg](https://blog.st.com/wp-content/uploads/prog4x4.jpg)](https://blog.st.com/stm32cubeprogrammer/)    Dec 19, 2024 [### STM32CubeProgrammer 2.18: looking forward to MCUs in 2025 and more](https://blog.st.com/stm32cubeprogrammer/)      [![https://blog.st.com/wp-content/uploads/ieee-4x4-1.jpg](https://blog.st.com/wp-content/uploads/ieee-4x4-1.jpg)](https://blog.st.com/body-sensing-for-advanced-human-machine-interface/)    Dec 18, 2024 [### Body sensing for advanced human machine interface](https://blog.st.com/body-sensing-for-advanced-human-machine-interface/)
## Newsroom

See all the latest news from ST.

     Jan 16, 2025
### [STMicroelectronics recognized as a Global Top Employer 2025](https://newsroom.st.com/media-center/press-item.html/c3304.html)

  [![https://newsroom.st.com/wp-content/uploads/2025/01/c3304-top-employer-global-home.jpg](https://newsroom.st.com/wp-content/uploads/2025/01/c3304-top-employer-global-home.jpg)](https://newsroom.st.com/media-center/press-item.html/c3304.html)     Jan 07, 2025
### [STMicroelectronics Announces Timing for Fourth Quarter and Full Year 2024 Earnings Release and Conference Call](https://newsroom.st.com/media-center/press-item.html/c3301.html)

  [![](/content/dam/new-st-homepage/news-updates-placeholder-384x384.jpg)](https://newsroom.st.com/media-center/press-item.html/c3301.html)     Dec 12, 2024
### [Quobly Forges Strategic Collaboration with STMicroelectronics to Accelerate its Quantum Processor Manufacturing for Large-Scale Quantum Computing Solutions](https://newsroom.st.com/media-center/press-item.html/t4667.html)

  [![https://newsroom.st.com/wp-content/uploads/2024/12/Quobly-t4667-home.jpg](https://newsroom.st.com/wp-content/uploads/2024/12/Quobly-t4667-home.jpg)](https://newsroom.st.com/media-center/press-item.html/t4667.html)     Dec 11, 2024
### [STMicroelectronics introduces first STM32-ready wireless IoT modules leveraging collaboration with Qualcomm](https://newsroom.st.com/media-center/press-item.html/p4666.html)

  [![https://newsroom.st.com/wp-content/uploads/2024/12/ST67W611-Qualcomm-module-P4666-home.jpg](https://newsroom.st.com/wp-content/uploads/2024/12/ST67W611-Qualcomm-module-P4666-home.jpg)](https://newsroom.st.com/media-center/press-item.html/p4666.html)     [Visit the Newsroom](https://newsroom.st.com)
## Blog

Read our latest technical articles.

     Jan 16, 2025
### [Introducing young learners to coding: ST activities for kindergarten and primary schools](https://blog.st.com/introducing-young-learners-to-coding-st-activities-for-kindergarten-and-primary-schools/)

  [![https://blog.st.com/wp-content/uploads/Thumbnails-subbrands-36.jpg](https://blog.st.com/wp-content/uploads/Thumbnails-subbrands-36.jpg)](https://blog.st.com/introducing-young-learners-to-coding-st-activities-for-kindergarten-and-primary-schools/)     Jan 15, 2025
### [Matter commissioning with NFC: how contactless communication touches new use cases and why it matters](https://blog.st.com/matter-commissioning/)

  [![https://blog.st.com/wp-content/uploads/Thumbnails-subbrands-35.jpg](https://blog.st.com/wp-content/uploads/Thumbnails-subbrands-35.jpg)](https://blog.st.com/matter-commissioning/)     Dec 19, 2024
### [STM32CubeProgrammer 2.18: looking forward to MCUs in 2025 and more](https://blog.st.com/stm32cubeprogrammer/)

  [![https://blog.st.com/wp-content/uploads/prog4x4.jpg](https://blog.st.com/wp-content/uploads/prog4x4.jpg)](https://blog.st.com/stm32cubeprogrammer/)     Dec 18, 2024
### [Body sensing for advanced human machine interface](https://blog.st.com/body-sensing-for-advanced-human-machine-interface/)

  [![https://blog.st.com/wp-content/uploads/ieee-4x4-1.jpg](https://blog.st.com/wp-content/uploads/ieee-4x4-1.jpg)](https://blog.st.com/body-sensing-for-advanced-human-machine-interface/)     [Visit the Blog](https://blog.st.com)

* All our products
  + Back
* Tools & software
  + Back
* Applications
  + Back
* Solutions
  + Back

* My Account
* [My Space](/content/my_st_com/en/my-space/my-preferences.html)
* [My Account](/content/my_st_com/en/my-space/manage-my-account/Update_My_Profile.html)
* [Logout](/cas/logout?lang=en)
      日本語ウェブサイトをご覧いただけます 该网站提供您所使用的语言版本     日本語ウェブサイトへ移動   跳转本地站点     表示を閉じる   不用，谢谢

* [Careers](/content/st_com/en/about/careers.html)
* Sample & buy
  + [Buy from eStore](https://estore.st.com)
  + [Contact our sales offices & distributors](/content/st_com/en/contact-us.html)
* Support & community
  + [Support](/content/st_com/en/support/support-home.html)
  + [Partner program](/content/st_com/en/partner/partner-program.html)
  + [Learning](/content/st_com/en/support/learning.html)
  + [Video center](/content/st_com/en/support/learning/video-page.html)
  + [ST community](https://community.st.com)
  + [ST wiki](/content/st_com/en/wiki/wiki-portal.html)
* English
  + English
  + [中文](https://www.st.com.cn/content/st_com/zh.html)
  + [日本語](https://www.st.com/content/st_com/ja.html)

   ![](/etc/clientlibs/st-site-cx/media/app/images/loading-spinner.svg)            Products           Search

* Products
* Tools & Software
* Resources
* Videos
* Solutions
* Applications
* Publications
* X-Reference
* All site

Search History

Bookmark

Please log in to show your saved searches.

* Products   [Amplifiers and comparators](/en/amplifiers-and-comparators.html) [Audio ICs](/en/audio-ics.html) [Automotive ADAS devices](/en/automotive-adas-devices.html) [Automotive analog and power](/en/automotive-analog-and-power.html) [Automotive infotainment and telematics](/en/automotive-infotainment-and-telematics.html) [Automotive logic ICs](/en/automotive-logic-ics.html) [Automotive microcontrollers](/en/automotive-microcontrollers.html) [Clocks and timers](/en/clocks-and-timers.html) [Data converters](/en/data-converters.html) [Digital set-top box ICs](/en/digital-set-top-box-ics.html) [Diodes and rectifiers](/en/diodes-and-rectifiers.html) [Imaging and photonics solutions](/en/imaging-and-photonics-solutions.html) [Interfaces and transceivers](/en/interfaces-and-transceivers.html) [Memories](/en/memories.html) [MEMS and sensors](/en/mems-and-sensors.html) [Microcontrollers & microprocessors](/en/microcontrollers-microprocessors.html) [Motor drivers](/en/motor-drivers.html) [NFC](/en/nfc.html) [Positioning](/en/positioning.html) [Power management](/en/power-management.html) [Power modules and IPM](/en/power-modules-and-ipm.html) [Power transistors](/en/power-transistors.html) [Protections and EMI filters](/en/protections-and-emi-filters.html) [Radio frequency transistors](/en/radio-frequency-transistors.html) [Reset and supervisor ICs](/en/reset-and-supervisor-ics.html) [Secure MCUs](/en/secure-mcus.html) [SiC devices](/en/sic-devices.html) [Space products](/en/space-products.html) [Switches and multiplexers](/en/switches-and-multiplexers.html) [Thyristors (SCR) and AC switches](/en/thyristors-scr-and-ac-switches.html) [Touch and display controllers](/en/touch-and-display-controllers.html) [Wireless connectivity](/en/wireless-connectivity.html)
* Tools & software   [Calculators, Simulators and Models](/content/st_com/en/support/resources/calculators.html) [Development tools](/en/development-tools.html) [Ecosystems](/en/ecosystems.html) [Embedded software](/en/embedded-software.html) [Evaluation tools](/en/evaluation-tools.html) [Mobile Applications](/en/mobile-applications.html) [Partner products and services](/en/partner-products-and-services.html)
* Applications   [Automotive](/en/applications/automotive.html) [Communications equipment, computers and peripherals](/en/applications/communications-equipment-computers-and-peripherals.html) [Functions](/en/applications/functions.html) [Industrial](/en/applications/industrial.html) [IoT applications](/en/applications/iot-applications.html) [Personal electronics](/en/applications/personal-electronics.html)
* Solutions   [Audio solutions](/en/solutions-reference-designs/audio-solutions.html) [Connectivity solutions](/en/solutions-reference-designs/connectivity-solutions.html) [Edge AI solutions](/en/solutions-reference-designs/edge-ai-solutions.html) [Human machine interface (HMI) solutions](/en/solutions-reference-designs/human-machine-interface-hmi-solutions.html) [Lighting solutions](/en/solutions-reference-designs/lighting-solutions.html) [Motor control solutions](/en/solutions-reference-designs/motor-control-solutions.html) [Power & energy management solutions](/en/solutions-reference-designs/power-energy-management-solutions.html) [Safety solutions](/en/solutions-reference-designs/safety-solutions.html) [Security solutions](/en/solutions-reference-designs/security-solutions.html) [Sensing solutions](/en/solutions-reference-designs/sensing-solutions.html)
* ST Developer Zone
* About us
* {{level\_1.title}}      {{level\_1.browseAllBtnText}}
  + {{level\_2.title}}  {{level\_2.title}}    {{level\_2.title}}   Browse {{level\_2.title}}        {{level\_3.title}}
  + {{level\_4.title}}

* Sample & buy
  + [Buy from eStore](https://estore.st.com)
  + [Contact our sales offices & distributors](/content/st_com/en/contact-us.html)
* Support & community
  + [Support](/content/st_com/en/support/support-home.html)

  ---

  + [Partner program](/content/st_com/en/partner/partner-program.html)

  ---

  + [Learning](/content/st_com/en/support/learning.html)
  + [Video center](/content/st_com/en/support/learning/video-page.html)

  ---

  + [ST community](/content/st_com/en/st-community.html)
  + [ST wiki](/content/st_com/en/wiki/wiki-portal.html)
     **STM32 MCU Developer Zone** ▼     [![](/content/dam/st-crew/developer-zone/navigation/home-2-line.png)](/content/st_com/en/stm32-mcu-developer-zone.html)  ![](/content/dam/st-crew/developer-zone/navigation/home-2-fill.png)     [Jump start](/content/st_com/en/stm32-mcu-developer-zone/start-a-project-with-an-mcu.html)     [MCU Portfolio](/content/st_com/en/stm32-mcu-developer-zone/mcu-portfolio.html)     [Boards and hardware tools](/content/st_com/en/stm32-mcu-developer-zone/boards-and-hardware-tools.html)      [Software development tools](/content/st_com/en/stm32-mcu-developer-zone/software-development-tools.html)     [Embedded software](/content/st_com/en/stm32-mcu-developer-zone/embedded-software.html)      [Solutions](/content/st_com/en/stm32-mcu-developer-zone/solutions.html)     [Developer resources](/content/st_com/en/stm32-mcu-developer-zone/developer-resources.html)     [MCU Community ![](/content/dam/st-crew/developer-zone/navigation/share-box-fill.png)](https://community.st.com/s/topic/0TO0X000000BSqSWAW/stm32-mcus)        [STM32 MCU Developer Zone](/content/st_com/en/stm32-mcu-developer-zone.html)     [STM32 MPU Developer Zone](/content/st_com/en/stm32-mpu-developer-zone.html)     [ST Edge AI Suite](/content/st_com/en/st-edge-ai-suite.html)    OUR FLAGSHIP SOFTWARE TOOLS    [STM32CubeMX](/content/st_com/en/stm32cubemx.html)     [STM32CubeIDE](/content/st_com/en/stm32cubeide.html)         **STM32 MPU Developer Zone** ▼    [![](/content/dam/st-crew/developer-zone/navigation/home-2-line.png)](/content/st_com/en/stm32-mpu-developer-zone.html)  ![](/content/dam/st-crew/developer-zone/navigation/home-2-fill.png)     [MPU Portfolio](/en/microcontrollers-microprocessors/stm32-arm-cortex-mpus/products.html)     [Boards and hardware tools](/content/st_com/en/stm32-mpu-developer-zone/boards-and-hardware-tools.html)      [Embedded software](/content/st_com/en/stm32-mpu-developer-zone/embedded-software.html)     [Software development tools](/content/st_com/en/stm32-mpu-developer-zone/software-development-tools.html)      [Solutions](/content/st_com/en/stm32-mpu-developer-zone/solutions.html)     [Developer resources](/content/st_com/en/stm32-mpu-developer-zone/developer-resources.html)     [MPU Community ![](/content/dam/st-crew/developer-zone/navigation/share-box-fill.png)](https://community.st.com/s/topic/0TO0X0000003u2AWAQ/stm32-mpus)        [STM32 MCU Developer Zone](/content/st_com/en/stm32-mcu-developer-zone.html)     [STM32 MPU Developer Zone](/content/st_com/en/stm32-mpu-developer-zone.html)     [ST Edge AI Suite](/content/st_com/en/st-edge-ai-suite.html)    OUR FLAGSHIP SOFTWARE TOOLS    [STM32CubeMX](/content/st_com/en/stm32cubemx.html)     [STM32CubeIDE](/content/st_com/en/stm32cubeide.html)         **STM32CubeMX** ▼       [STM32 MCU Developer Zone](/content/st_com/en/stm32-mcu-developer-zone.html)     [STM32 MPU Developer Zone](/content/st_com/en/stm32-mpu-developer-zone.html)     [ST Edge AI Suite](/content/st_com/en/st-edge-ai-suite.html)    OUR FLAGSHIP SOFTWARE TOOLS    [STM32CubeMX](/content/st_com/en/stm32cubemx.html)     [STM32CubeIDE](/content/st_com/en/stm32cubeide.html)        **STM32CubeIDE** ▼      [STM32 MCU Developer Zone](/content/st_com/en/stm32-mcu-developer-zone.html)     [STM32 MPU Developer Zone](/content/st_com/en/stm32-mpu-developer-zone.html)     [ST Edge AI Suite](/content/st_com/en/st-edge-ai-suite.html)    OUR FLAGSHIP SOFTWARE TOOLS    [STM32CubeMX](/content/st_com/en/stm32cubemx.html)     [STM32CubeIDE](/content/st_com/en/stm32cubeide.html)         **ST Edge AI Suite** ▼    [![](/content/dam/st-crew/developer-zone/navigation/home-2-line.png)](/content/st_com/en/st-edge-ai-suite.html)  ![](/content/dam/st-crew/developer-zone/navigation/home-2-fill.png)    [Case studies](/content/st_com/en/st-edge-ai-suite/case-studies.html)     [Tools](/content/st_com/en/st-edge-ai-suite/tools.html)     [Community](https://community.st.com/t5/edge-ai/bd-p/edge-ai)        [STM32 MCU Developer Zone](/content/st_com/en/stm32-mcu-developer-zone.html)     [STM32 MPU Developer Zone](/content/st_com/en/stm32-mpu-developer-zone.html)     [ST Edge AI Suite](/content/st_com/en/st-edge-ai-suite.html)    OUR FLAGSHIP SOFTWARE TOOLS    [STM32CubeMX](/content/st_com/en/stm32cubemx.html)     [STM32CubeIDE](/content/st_com/en/stm32cubeide.html)

* [Careers](/content/st_com/en/about/careers.html)
* Sample & buy
  + [Buy from eStore](https://estore.st.com)
  + [Contact our sales offices & distributors](/content/st_com/en/contact-us.html)
* Support & community
  + [Support](/content/st_com/en/support/support-home.html)
  + [Partner program](/content/st_com/en/partner/partner-program.html)
  + [Learning](/content/st_com/en/support/learning.html)
  + [Video center](/content/st_com/en/support/learning/video-page.html)
  + [ST community](https://community.st.com)
  + [ST wiki](/content/st_com/en/wiki/wiki-portal.html)
* English
  + English
  + [中文](https://www.st.com.cn/content/st_com/zh.html)
  + [日本語](https://www.st.com/content/st_com/ja.html)

       ![](/etc/clientlibs/st-site-cx/media/app/images/loading-spinner.svg)
             [![st-logo-blue-vertical](/content/dam/st-crew/st-logo-blue.svg)](/content/st_com/en.html)

* About STMicroelectronics
* [Who we are](/content/st_com/en/about/st_company_information/who-we-are.html)
* [Investor relations](https://investors.st.com/)
* [Sustainability](/content/st_com/en/about/sustainability.html)
* [Innovation & technology](/content/st_com/en/about/innovation---technology/innovation---technology.html)
* [Careers](/content/st_com/en/about/careers.html)
* [Blog](https://blog.st.com/)
* [General terms and conditions](/content/st_com/en/about/procurement/general-terms-and-conditions.html)

* Connect with us
* [Contact ST offices](/content/st_com/en/contact-us.html)
* [Find sales offices & distributors](/content/st_com/en/contact-us.html)
* [Community](https://community.st.com)
* [Newsroom](https://newsroom.st.com/)
* [Events & trainings](/content/st_com/en/about/events/upcoming-events-and-technical-seminars.html)

* Browse
* [Shortcuts](/content/st_com/en/shortcuts.html)
* [Sitemap](/content/st_com/en/sitemap.html)

* Compliance, ethics, security & privacy
* [Ethics and compliance](/content/st_com/en/about/st_company_information/ethics-and-compliance.html)
* [ST ethics hotline](https://www.speakupfeedback.eu/web/stmicroelectronics/)
* [Security & privacy portal](/content/st_com/en/about/security-and-privacy.html)

* Newsletter sign up
* Submit
   x   Subscription to ST newsletters                        Email: \*         Please review our [Privacy Statement](/content/st_com/en/common/privacy-portal/corporate-privacy-statement.html) that describes how we process your profile information and how to assert your personal data protection rights    Continue          x   Thanks! Your newsletter subscription has been submitted

Please click on the link inside the email we have just sent you to confirm your subscription. If you did not receive an email from us, please check your spam box.

Follow us

             All rights reserved © 2025 STMicroelectronics |   [Terms of use](https://www.st.com/content/st_com/en/about/terms-of-use.html)  |  [Sales terms & conditions](https://www.st.com/content/ccc/resource/legal/legal_agreement/sales_agreement/49/05/8c/68/a0/35/4a/6e/ST%20Terms%20and%20Conditions%20of%20Sales.pdf/files/ST%20Terms%20and%20Conditions%20of%20Sales.pdf/jcr%3Acontent/translations/en.ST%20Terms%20and%20Conditions%20of%20Sales.pdf) |  [Trademarks](/content/st_com/en/about/st-trademark-list.html) |  [Security & privacy portal](/content/st_com/en/about/security-and-privacy.html) |  [Manage cookies](#.html)                     日本語ウェブサイトをご覧いただけます 该网站提供您所使用的语言版本     日本語ウェブサイトへ移動   跳转本地站点     表示を閉じる   不用，谢谢                                   ![](/etc/clientlibs/st-site-cx/media/app/images/loading-spinner.svg)                 Products

* Products
* Tools & Software
* Resources
* Videos
* Solutions
* Applications
* Publications
* X-Reference
* All site

Search History

Bookmark

Please log in to show your saved searches.

Search History

Bookmark

Please log in  to show your saved searches.

                                         ![](/etc/clientlibs/st-site-cx/media/app/images/loading-spinner.svg)                ▼

* + [Home](/content/st_com/en/stm32-mcu-developer-zone.html)
  + [Jump Start](/content/st_com/en/stm32-mcu-developer-zone/start-a-project-with-an-mcu.html)
  + [MCU Portfolio](/content/st_com/en/stm32-mcu-developer-zone/mcu-portfolio.html)
  + [Boards & hardware tools](/content/st_com/en/stm32-mcu-developer-zone/boards-and-hardware-tools.html)
  + [Software development tools](/content/st_com/en/stm32-mcu-developer-zone/software-development-tools.html)
  + [Embedded software](/content/st_com/en/stm32-mcu-developer-zone/embedded-software.html)
  + [Solutions](/content/st_com/en/stm32-mcu-developer-zone/solutions.html)
  + [Developer resources](/content/st_com/en/stm32-mcu-developer-zone/developer-resources.html)
* + [Home](/content/st_com/en/stm32-mpu-developer-zone.html)
  + [MPU Portfolio](/en/microcontrollers-microprocessors/stm32-arm-cortex-mpus/products.html)
  + [Boards & hardware tools](/content/st_com/en/stm32-mpu-developer-zone/boards-and-hardware-tools.html)
  + [Software development tools](/content/st_com/en/stm32-mpu-developer-zone/software-development-tools.html)
  + [Embedded software](/content/st_com/en/stm32-mpu-developer-zone/embedded-software.html)
  + [Solutions](/content/st_com/en/stm32-mpu-developer-zone/solutions.html)
  + [Developer resources](/content/st_com/en/stm32-mpu-developer-zone/developer-resources.html)
* + [Home](/content/st_com/en/st-edge-ai-suite.html)
  + [Case studies](/content/st_com/en/st-edge-ai-suite/case-studies.html)
  + [Tools](/content/st_com/en/st-edge-ai-suite/tools.html)
  + [Community](https://community.st.com/t5/edge-ai/bd-p/edge-ai)
* MCU Developer Zone
* MPU Developer Zone
* ST Edge AI Suite
* OUR FLAGSHIP SOFTWARE TOOLS
* [STM32CubeMX](/content/st_com/en/stm32cubemx.html)
* [STM32CubeIDE](/content/st_com/en/stm32cubeide.html)

  Back

* [Home](/content/st_com/en/stm32-mpu-developer-zone.html)
* [MPU Portfolio](/en/microcontrollers-microprocessors/stm32-arm-cortex-mpus/products.html)
* [Boards & hardware tools](/content/st_com/en/stm32-mpu-developer-zone/boards-and-hardware-tools.html)
* [Software development tools](/content/st_com/en/stm32-mpu-developer-zone/software-development-tools.html)
* [Embedded software](/content/st_com/en/stm32-mpu-developer-zone/embedded-software.html)
* [Solutions](/content/st_com/en/stm32-mpu-developer-zone/solutions.html)
* [Developer resources](/content/st_com/en/stm32-mpu-developer-zone/developer-resources.html)
   Back

* [Home](/content/st_com/en/stm32-mcu-developer-zone.html)
* [Jump Start](/content/st_com/en/stm32-mcu-developer-zone/start-a-project-with-an-mcu.html)
* [MCU Portfolio](/content/st_com/en/stm32-mcu-developer-zone/mcu-portfolio.html)
* [Boards & hardware tools](/content/st_com/en/stm32-mcu-developer-zone/boards-and-hardware-tools.html)
* [Software development tools](/content/st_com/en/stm32-mcu-developer-zone/software-development-tools.html)
* [Embedded software](/content/st_com/en/stm32-mcu-developer-zone/embedded-software.html)
* [Solutions](/content/st_com/en/stm32-mcu-developer-zone/solutions.html)
* [Developer resources](/content/st_com/en/stm32-mcu-developer-zone/developer-resources.html)
   Back

* [Home](/content/st_com/en/st-edge-ai-suite.html)
* [Case studies](/content/st_com/en/st-edge-ai-suite/case-studies.html)
* [Tools](/content/st_com/en/st-edge-ai-suite/tools.html)
* [Community](https://community.st.com/t5/edge-ai/bd-p/edge-ai)

* Support & Learning
  + Back
  + [Support](/content/st_com/en/support/support-home.html)
  + [Partner program](/content/st_com/en/partner/partner-program.html)
  + [Learning](/content/st_com/en/support/learning.html)
  + [Video center](/content/st_com/en/support/learning/video-page.html)
  + [ST community](/content/st_com/en/st-community.html)
  + [ST wiki](/content/st_com/en/wiki/wiki-portal.html)
* Sample & buy
  + Back
  + [Buy from eStore](https://estore.st.com)
  + [Contact our sales offices & distributors](/content/st_com/en/contact-us.html)
* About ST
  + Back
  + [Who we are](/content/st_com/en/about/st_company_information/who-we-are.html)
  + [Careers](/content/st_com/en/about/careers.html)
  + [Sustainability](/content/st_com/en/about/sustainability.html)
  + [Innovation & technology](/content/st_com/en/about/innovation---technology/innovation---technology.html)
  + [Manufacturing at ST](/content/st_com/en/about/manufacturing-at-st.html)
  + [Quality and reliability](/content/st_com/en/about/quality-and-reliability.html)
  + [Newsroom](https://newsroom.st.com/)
  + [Customer success stories](/content/st_com/en/about/customer-success-stories.html)
  + [Investor relations](https://investors.st.com/)
* [Contact Us](/content/st_com/en/contact-us.html)
* Language: English
  + Back
  + English
  + [中文](https://www.st.com.cn/content/st_com/zh.html)
  + [日本語](https://www.st.com/content/st_com/ja.html)

 Sorry!  Your browser is out-of-date

This browser is out of date and not supported by st.com.
 As a result, you may be unable to access certain features.
 Consider that modern browsers:

* are more secure and protect better during navigation
* are faster
* are more compatible with newer technologies
* provide a better experience and features

  Don't show this message again  I got it

So why not taking the opportunity to update your browser and see this site correctly?

 [Google Chrome](https://www.google.com/chrome/)  [Mozilla Firefox](https://www.mozilla.com/firefox/)                         ![](https://www.st.com/akam/13/pixel_26b0a4d9?a=dD1lODAzZGE5ZjM5NTMxOTFmZDRkM2E4MjAxYzI4MDZmMjhjMmYwMzM5JmpzPW9mZg==)

=== Content from www.st.com_5bf9ad27_20250119_114522.html ===


* English
* [中文](https://www.st.com.cn/zh/embedded-software/x-cube-cryptolib.html)
* [日本語](https://www.st.com/ja/embedded-software/x-cube-cryptolib.html)

1. 1. [Embedded software](/en/embedded-software.html)
   2. [MCU and MPU embedded software](/en/embedded-software/mcu-and-mpu-embedded-software.html)
   3. [STM32 embedded software](/en/embedded-software/stm32-embedded-software.html)
   4. [STM32Cube Expansion Packages](/en/embedded-software/stm32cube-expansion-packages.html)
   5. [X-CUBE-CRYPTOLIB](/en/embedded-software/x-cube-cryptolib.html)

# X-CUBE-CRYPTOLIB

 Active  ![Design Win](/etc/clientlibs/st-site-cx/media/app/images/icon-w-personalised.png "Design Win")    Save to myST

STM32 cryptographic firmware library software expansion for STM32Cube

Get Software  [Download databrief](https://www.st.com/resource/en/data_brief/x-cube-cryptolib.pdf "Download datasheet")               [Overview](#overview)   [Sample & Buy](#sample-buy)   [Solutions](#solutions)   [Documentation](#documentation)   [CAD Resources](#cad-resources)   [Tools & Software](#tools-software)   [Quality & Reliability](#quality-reliability)     Partner products       Sales Briefcase       Get Started                    Your browser does not support JavaScript. Some components may not be visible.          File Type PDF ZIP       Latest update    Reset Please enter your desired search query and search again     Show filters      Filters       Quick filters   File Type    All file types PDF ZIP      Latest update    All dates                   Your browser does not support JavaScript. Some components may not be visible.          Served country/region Worldwide Africa Asia Europe North America Oceania South America Afghanistan Albania Algeria Andorra Angola Antigua and Barbuda Argentina Armenia Australia Austria Azerbaijan Bahamas Bahrain Bangladesh Barbados Belarus Belgium Belize Benin Bhutan Bolivia Bosnia and Herzegovina Botswana Brazil Brunei Bulgaria Burkina Burma (Myanmar) Burundi Cambodia Cameroon Canada Cape Verde Central African Republic Chad Chile China Colombia Comoros Costa Rica Croatia Cyprus Czech Republic Democratic Republic of Congo Denmark Djibouti Dominica Dominican Republic East Timor Ecuador Egypt El Salvador Equatorial Guinea Eritrea Estonia Ethiopia Fiji Finland France Gabon Gambia Georgia Germany Ghana Greece Grenada Guatemala Guinea Guinea-Bissau Guyana Haiti Honduras Hungary Iceland India Indonesia Iraq Ireland Israel Italy Ivory Coast Jamaica Japan Jordan Kazakhstan Kenya Kiribati Kuwait Kyrgyzstan Laos Latvia Lesotho Liberia Libya Liechtenstein Lithuania Luxembourg Macedonia Madagascar Malawi Malaysia Maldives Mali Malta Marshall Islands Mauritania Mauritius Mexico Micronesia Moldova Monaco Mongolia Montenegro Morocco Mozambique Namibia Nauru Nepal Netherlands New Zealand Nicaragua Niger Nigeria Norway Oman Pakistan Palau Panama Papua New Guinea Paraguay Peru Philippines Poland Portugal Qatar Romania Russian Federation Rwanda Saint Kitts and Nevis Saint Lucia Saint Vincent and the Grenadines Samoa San Marino Sao Tome and Principe Saudi Arabia Senegal Serbia Seychelles Sierra Leone Singapore Slovakia Slovenia Solomon Islands Somalia South Africa South Korea Spain Sri Lanka Suriname Swaziland Sweden Switzerland Taiwan Tajikistan Tanzania Thailand Togo Tonga Trinidad and Tobago Tunisia Turkey Turkmenistan Tuvalu Uganda Ukraine United Arab Emirates United Kingdom United States Uruguay Uzbekistan Vanuatu Vatican City Venezuela Vietnam Yemen Zambia Zimbabwe      on off  Show only products supplied by ST  Reset Please enter your desired search query and search again     Show filters     Filters       Quick filters      Served country/region Worldwide Africa Asia Europe North America Oceania South America Afghanistan Albania Algeria Andorra Angola Antigua and Barbuda Argentina Armenia Australia Austria Azerbaijan Bahamas Bahrain Bangladesh Barbados Belarus Belgium Belize Benin Bhutan Bolivia Bosnia and Herzegovina Botswana Brazil Brunei Bulgaria Burkina Burma (Myanmar) Burundi Cambodia Cameroon Canada Cape Verde Central African Republic Chad Chile China Colombia Comoros Costa Rica Croatia Cyprus Czech Republic Democratic Republic of Congo Denmark Djibouti Dominica Dominican Republic East Timor Ecuador Egypt El Salvador Equatorial Guinea Eritrea Estonia Ethiopia Fiji Finland France Gabon Gambia Georgia Germany Ghana Greece Grenada Guatemala Guinea Guinea-Bissau Guyana Haiti Honduras Hungary Iceland India Indonesia Iraq Ireland Israel Italy Ivory Coast Jamaica Japan Jordan Kazakhstan Kenya Kiribati Kuwait Kyrgyzstan Laos Latvia Lesotho Liberia Libya Liechtenstein Lithuania Luxembourg Macedonia Madagascar Malawi Malaysia Maldives Mali Malta Marshall Islands Mauritania Mauritius Mexico Micronesia Moldova Monaco Mongolia Montenegro Morocco Mozambique Namibia Nauru Nepal Netherlands New Zealand Nicaragua Niger Nigeria Norway Oman Pakistan Palau Panama Papua New Guinea Paraguay Peru Philippines Poland Portugal Qatar Romania Russian Federation Rwanda Saint Kitts and Nevis Saint Lucia Saint Vincent and the Grenadines Samoa San Marino Sao Tome and Principe Saudi Arabia Senegal Serbia Seychelles Sierra Leone Singapore Slovakia Slovenia Solomon Islands Somalia South Africa South Korea Spain Sri Lanka Suriname Swaziland Sweden Switzerland Taiwan Tajikistan Tanzania Thailand Togo Tonga Trinidad and Tobago Tunisia Turkey Turkmenistan Tuvalu Uganda Ukraine United Arab Emirates United Kingdom United States Uruguay Uzbekistan Vanuatu Vatican City Venezuela Vietnam Yemen Zambia Zimbabwe      Show only products supplied by ST   on off
## Product overview

#### Key Benefits

  ![](/content/ccc/fragment/product_related/rpn_information/product_key_benefits/group0/6d/5d/55/3c/f6/02/45/19/image-new-products/files/new-products.svg/_jcr_content/translations/en.new-products.svg)
##### STM32U0 support

The new version of this software now support our latest STM32U0.

### Description

The STM32 cryptographic library package (X-CUBE-CRYPTOLIB) includes all the major security algorithms for encryption, hashing, message authentication, and digital signing, enabling developers to satisfy application requirements for any combination of data integrity, confidentiality, identification/authentication, and non-repudiation.

 ![](/bin/ecommerce/api/image.PF262570.en.feature-description-include-personalized-no-cpn-medium.jpg "X-CUBE-CRYPTOLIB versions")     ![](/bin/ecommerce/api/image.PF262570.en.feature-description-include-personalized-no-cpn-large.jpg)

The library includes firmware functions for the STM32 microcontrollers in the STM32F0 series, STM32F1 series, STM32F2 series, STM32F3 series, STM32F4 series, STM32F7 series, STM32G0 series, STM32G4 series, STM32H5 series, STM32H7 series, STM32L0 series, STM32L1 series, STM32L4 series, STM32L4+ series, STM32L5 series, STM32U0 series, STM32U5 series, STM32WBA series, STM32WB series, and STM32WL series depending on their Arm® Cortex®-M processor. For more details, refer to the STM32 cryptographic library dedicated pages of the STM32 MCU wiki at https://wiki.st.com/stm32mcu.

Most of the well-used algorithms are certified according to the US cryptographic algorithm validation program (CAVP), helping customers to prove quickly and cost-effectively the security of their new products.

Full details are available online at the NIST CSRC algorithm validation lists website, selecting the CAVP web page.

In this package, there are examples for each algorithm for popular development tools including IAR Systems® EWARM (IAR Embedded Workbench®), Keil® MDK-ARM, and GCC -based IDEs such as STMicroelectronics STM32CubeIDE.

To benefit from STM32 cryptographic accelerators, refer to the STM32Cube MCU and MPU package hardware abstraction layer (HAL) functions and examples.

* ### All features

  + Cipher encryption and decryption:
    - AES: CBC, CCM, CFB, CTR, ECB, GCM, OFB, XTS, KeyWrap
    - SM4: CBC, CFB, CTR, ECB, OFB
    - Chacha-Poly1305
  + Digest generation:
    - SHA-1
    - SHA-2: SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, SHA-512/256
    - SHA-3: SHA3-224, SHA3-256, SHA3-384, SHA3-512
    - SM3
    - SHAKE
  + Message authentication code (MAC) generation:
    - HMAC:
      * SHA-1
      * SHA-2: SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, SHA-512/256
      * SM3
    - AES: CMAC
    - KMAC: SHAKE
  + Elliptic curves based on key generation, signature and verification:
    - Elliptic curve digital signature algorithm (ECDSA): NIST-R (P-224, P-256, P-384, P-521), NIST-K P-256, BRAINPOOL R/T (P-160, P-192, P-224, P-256, P-320, P-384, P-512), ANSSI P-256
    - Edwards-curve digital signature algorithm (EdDSA): Ed448, Ed25519
    - SM2 digital signature algorithm: OSCCA 256-bits curve
  + Elliptic curves Diffie-Hellman:
    - Curve448, curve25519
    - NIST-R (P-224, P-256, P-384, P-521), NIST-K P-256, BRAINPOOL R/T (P-160, P-192, P-224, P-256, P-320, P-384, P-512), ANSSI P-256
  + RSA signature, verification, encryption and decryption:
    - PKCS#1 v1.5 and v2.2
    - Chinese remainder theorem (CRT) key representation
    - Hash method:
      * SHA-1
      * SHA-2: SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, SHA-512/256
  + Deterministic random bit generator (DRBG):
    - CTR-DRBG      Read more      Read less
                     x   Request Software
##### Something went wrong with the server request. Please try again in a few moments.

##### Project Title:

   A project title is required.
##### Project Description:

   A project description is required.
##### Application:

    An application is required.
##### End Application:

    Please choose a sub-application  An end application is required.
##### Nature of Business:

    Education Institute / University Other Research Center Investors Consultant Private / Personal User Manufacturer of OEM equipment Outsourced Manufacturer Distributor of Components Retailers  A nature of business is required.
##### Military Related:

    Yes No  A military relation status is required.
##### Country/Region where the Software will be used:

    Afghanistan Aland Islands Albania Algeria American Samoa Andorra Angola Anguilla Antartica Antigua and Barbuda Argentina Armenia Aruba Australia Austria Azerbaijan Bahamas Bahrain Bangladesh Barbados Belarus Belgium Belize Benin Bermuda Bhutan Bolivia, Plurinational State of Bonaire,Sint Eustatius and Saba Bosnia and Herzegovina Botswana Bouvet Island Brazil British Indian Ocean Territory Brunei Darussalam Bulgaria Burkina Faso Burundi Cambodia Cameroon Canada Cape Verde Cayman Islands Central Africa Republic Chad Chile China Christmas Island Cocos (Keeling) Islands Colombia Comoros Congo Congo, the Democratic Republic of the Cook Islands Costa Rica Côte d'Ivoire Croatia Cuba Curaçao Cyprus Czech Republic Denmark Djibouti Dominica Dominican Republic Ecuador Egypt EI Salvador Equatorial Guinea Eritrea Estonia Ethiopia Falkland Islands (Malvinas) Faroe Islands Fiji Finland France French Guiana French Polynesia French Southern Territories Gabon Gambia Georgia Germany Ghana Gibraltar Greece Greenland Grenada Guadeloupe Guam Guatemala Guernsey Guinea Guinea-Bissau Guyana Haiti Heard Island and McDonald Islands Holy See (Vatican City State) Honduras Hong Kong Hungary Iceland India Indonesia Iran, Islamic Republic of Iraq Ireland Isle of Man Israel Italy Jamaica Japan Jersey Jordan Kazakhstan Kenya Kiribati Korea, Democratic People's Republic of Korea, Republic of Kuwait Kyrgyzstan Lao People's Democratic Republic Latvia Lebanon Lesotho Liberia Libya Liechtenstein Lithuania Luxembourg Macao Macedonia, the Former Yugoslav Republic of Madagascar Malawi Malaysia Maldives Mali Malta Marshall Islands Martinique Mauritania Mauritius Mayotte Mexico Micronesia, Federated States of Moldova, Republic of Monaco Mongolia Montenegro Montserrat Morocco Mozambique Myanmar Namibia Nauru Nepal Netherlands New Caledonia New Zealand Nicaragua Niger Nigeria Niue Norfolk Island Northern Mariana Islands Norway Oman Pakistan Palau Palestine, State of Panama Papua New Guinea Paraguay Peru Philippines Pitcairn Poland Portugal Puerto Rico Qatar Réunion Romania Russian Federation Rwanda Saint Barthélemy Saint Helena,Ascension and Tristan da Cunha Saint Kitts and Nevis Saint Lucia Saint Martin (French part) Saint Pierre and Miquelon Saint Vincent and the Grenadines Samoa San Marino Sao Tome and Principe Saudi Arabia Senegal Serbia Seychelles Sierra Leone Singapore Sint Maarten (Dutch part) Slovakia Slovenia Solomon Islands Somalia South Africa South Georgia and the South Sandwich Islands South Sudan Spain Sri Lanka Sudan Suriname Svalbard and Jan Mayen Swaziland Sweden Switzerland Syrian Arab Republic Taiwan Tajikistan Tanzania, United Republic of Thailand Timor-Leste Togo Tokelau Tonga Trinidad and Tobago Tunisia Turkey Turkmenistan Turks and Caicos Islands Tuvalu Uganda Ukraine United Arab Emirates United Kingdom United States Minor Outlying Islands United States of America Uruguay Uzbekistan Vanuatu Venezuela, Bolivarian Republic of Viet Nam Virgin Islands, British Virgin Islands, U.S. Wallis and Futuna Western Sahara Yemen Zambia Zimbabwe  A country/region of use is required         Please keep me informed about future updates for this product.
##### Comment:

           I accept all [Terms & Conditions](/content/my_st_com/en/common/export-regulation-acceptance.html) of the Export Control regulations Accept Terms & Conditions      Confirm Request Cancel
#### Request for software successfully submitted. The approval process may take up to 48 hours. After you have been approved, you should receive a link to the requested software via email.

       x   Let us help you in downloading this file

        Start Over
## Get Software

    Your browser does not support JavaScript. Some components may not be visible.
### Recommended for you

Related Applications

Functions

* Embedded security  (1)
  + Embedded security for personal electronics  (1)
    - [Platform security](/en/applications/embedded-security/platform-security.html "Platform security")
               ![](/content/ccc/fragment/sales_and_marketing/banner/homepage_banner/group3/f7/aa/2b/5a/e6/64/49/7c/Subbrand_STM32/files/Subbrand_STM32.svg/_jcr_content/translations/en.Subbrand_STM32.svg)
STM32 cryptographic library dedicated pages    [Go to wiki](https://wiki.st.com/stm32mcu)                   Your browser does not support JavaScript. Some components may not be visible.      Your browser does not support JavaScript. Some components may not be visible.      Your browser does not support JavaScript. Some components may not be visible.         Your browser does not support JavaScript. Some components may not be visible.

* All our products
  + Back
* Tools & software
  + Back
* Applications
  + Back
* Solutions
  + Back

* My Account
* [My Space](/content/my_st_com/en/my-space/my-preferences.html)
* [My Account](/content/my_st_com/en/my-space/manage-my-account/Update_My_Profile.html)
* [Logout](/cas/logout?lang=en)
      日本語ウェブサイトをご覧いただけます 该网站提供您所使用的语言版本     日本語ウェブサイトへ移動   跳转本地站点     表示を閉じる   不用，谢谢

* [Careers](/content/st_com/en/about/careers.html)
* Sample & buy
  + [Buy from eStore](https://estore.st.com)
  + [Contact our sales offices & distributors](/content/st_com/en/contact-us.html)
* Support & community
  + [Support](/content/st_com/en/support/support-home.html)
  + [Partner program](/content/st_com/en/partner/partner-program.html)
  + [Learning](/content/st_com/en/support/learning.html)
  + [Video center](/content/st_com/en/support/learning/video-page.html)
  + [ST community](https://community.st.com)
  + [ST wiki](/content/st_com/en/wiki/wiki-portal.html)
* English
  + English
  + [中文](https://www.st.com.cn/zh/embedded-software/x-cube-cryptolib.html)
  + [日本語](https://www.st.com/ja/embedded-software/x-cube-cryptolib.html)

   ![](/etc/clientlibs/st-site-cx/media/app/images/loading-spinner.svg)            Products           Search

* Products
* Tools & Software
* Resources
* Videos
* Solutions
* Applications
* Publications
* X-Reference
* All site

Search History

Bookmark

Please log in to show your saved searches.

* Products   [Amplifiers and comparators](/en/amplifiers-and-comparators.html) [Audio ICs](/en/audio-ics.html) [Automotive ADAS devices](/en/automotive-adas-devices.html) [Automotive analog and power](/en/automotive-analog-and-power.html) [Automotive infotainment and telematics](/en/automotive-infotainment-and-telematics.html) [Automotive logic ICs](/en/automotive-logic-ics.html) [Automotive microcontrollers](/en/automotive-microcontrollers.html) [Clocks and timers](/en/clocks-and-timers.html) [Data converters](/en/data-converters.html) [Digital set-top box ICs](/en/digital-set-top-box-ics.html) [Diodes and rectifiers](/en/diodes-and-rectifiers.html) [Imaging and photonics solutions](/en/imaging-and-photonics-solutions.html) [Interfaces and transceivers](/en/interfaces-and-transceivers.html) [Memories](/en/memories.html) [MEMS and sensors](/en/mems-and-sensors.html) [Microcontrollers & microprocessors](/en/microcontrollers-microprocessors.html) [Motor drivers](/en/motor-drivers.html) [NFC](/en/nfc.html) [Positioning](/en/positioning.html) [Power management](/en/power-management.html) [Power modules and IPM](/en/power-modules-and-ipm.html) [Power transistors](/en/power-transistors.html) [Protections and EMI filters](/en/protections-and-emi-filters.html) [Radio frequency transistors](/en/radio-frequency-transistors.html) [Reset and supervisor ICs](/en/reset-and-supervisor-ics.html) [Secure MCUs](/en/secure-mcus.html) [SiC devices](/en/sic-devices.html) [Space products](/en/space-products.html) [Switches and multiplexers](/en/switches-and-multiplexers.html) [Thyristors (SCR) and AC switches](/en/thyristors-scr-and-ac-switches.html) [Touch and display controllers](/en/touch-and-display-controllers.html) [Wireless connectivity](/en/wireless-connectivity.html)
* Tools & software   [Calculators, Simulators and Models](/content/st_com/en/support/resources/calculators.html) [Development tools](/en/development-tools.html) [Ecosystems](/en/ecosystems.html) [Embedded software](/en/embedded-software.html) [Evaluation tools](/en/evaluation-tools.html) [Mobile Applications](/en/mobile-applications.html) [Partner products and services](/en/partner-products-and-services.html)
* Applications   [Automotive](/en/applications/automotive.html) [Communications equipment, computers and peripherals](/en/applications/communications-equipment-computers-and-peripherals.html) [Functions](/en/applications/functions.html) [Industrial](/en/applications/industrial.html) [IoT applications](/en/applications/iot-applications.html) [Personal electronics](/en/applications/personal-electronics.html)
* Solutions   [Audio solutions](/en/solutions-reference-designs/audio-solutions.html) [Connectivity solutions](/en/solutions-reference-designs/connectivity-solutions.html) [Edge AI solutions](/en/solutions-reference-designs/edge-ai-solutions.html) [Human machine interface (HMI) solutions](/en/solutions-reference-designs/human-machine-interface-hmi-solutions.html) [Lighting solutions](/en/solutions-reference-designs/lighting-solutions.html) [Motor control solutions](/en/solutions-reference-designs/motor-control-solutions.html) [Power & energy management solutions](/en/solutions-reference-designs/power-energy-management-solutions.html) [Safety solutions](/en/solutions-reference-designs/safety-solutions.html) [Security solutions](/en/solutions-reference-designs/security-solutions.html) [Sensing solutions](/en/solutions-reference-designs/sensing-solutions.html)
* ST Developer Zone
* About us
* {{level\_1.title}}      {{level\_1.browseAllBtnText}}
  + {{level\_2.title}}  {{level\_2.title}}    {{level\_2.title}}   Browse {{level\_2.title}}        {{level\_3.title}}
  + {{level\_4.title}}

* Sample & buy
  + [Buy from eStore](https://estore.st.com)
  + [Contact our sales offices & distributors](/content/st_com/en/contact-us.html)
* Support & community
  + [Support](/content/st_com/en/support/support-home.html)

  ---

  + [Partner program](/content/st_com/en/partner/partner-program.html)

  ---

  + [Learning](/content/st_com/en/support/learning.html)
  + [Video center](/content/st_com/en/support/learning/video-page.html)

  ---

  + [ST community](/content/st_com/en/st-community.html)
  + [ST wiki](/content/st_com/en/wiki/wiki-portal.html)
     **STM32 MCU Developer Zone** ▼     [![](/content/dam/st-crew/developer-zone/navigation/home-2-line.png)](/content/st_com/en/stm32-mcu-developer-zone.html)  ![](/content/dam/st-crew/developer-zone/navigation/home-2-fill.png)     [Jump start](/content/st_com/en/stm32-mcu-developer-zone/start-a-project-with-an-mcu.html)     [MCU Portfolio](/content/st_com/en/stm32-mcu-developer-zone/mcu-portfolio.html)     [Boards and hardware tools](/content/st_com/en/stm32-mcu-developer-zone/boards-and-hardware-tools.html)      [Software development tools](/content/st_com/en/stm32-mcu-developer-zone/software-development-tools.html)     [Embedded software](/content/st_com/en/stm32-mcu-developer-zone/embedded-software.html)      [Solutions](/content/st_com/en/stm32-mcu-developer-zone/solutions.html)     [Developer resources](/content/st_com/en/stm32-mcu-developer-zone/developer-resources.html)     [MCU Community ![](/content/dam/st-crew/developer-zone/navigation/share-box-fill.png)](https://community.st.com/s/topic/0TO0X000000BSqSWAW/stm32-mcus)        [STM32 MCU Developer Zone](/content/st_com/en/stm32-mcu-developer-zone.html)     [STM32 MPU Developer Zone](/content/st_com/en/stm32-mpu-developer-zone.html)     [ST Edge AI Suite](/content/st_com/en/st-edge-ai-suite.html)    OUR FLAGSHIP SOFTWARE TOOLS    [STM32CubeMX](/content/st_com/en/stm32cubemx.html)     [STM32CubeIDE](/content/st_com/en/stm32cubeide.html)         **STM32 MPU Developer Zone** ▼    [![](/content/dam/st-crew/developer-zone/navigation/home-2-line.png)](/content/st_com/en/stm32-mpu-developer-zone.html)  ![](/content/dam/st-crew/developer-zone/navigation/home-2-fill.png)     [MPU Portfolio](/en/microcontrollers-microprocessors/stm32-arm-cortex-mpus/products.html)     [Boards and hardware tools](/content/st_com/en/stm32-mpu-developer-zone/boards-and-hardware-tools.html)      [Embedded software](/content/st_com/en/stm32-mpu-developer-zone/embedded-software.html)     [Software development tools](/content/st_com/en/stm32-mpu-developer-zone/software-development-tools.html)      [Solutions](/content/st_com/en/stm32-mpu-developer-zone/solutions.html)     [Developer resources](/content/st_com/en/stm32-mpu-developer-zone/developer-resources.html)     [MPU Community ![](/content/dam/st-crew/developer-zone/navigation/share-box-fill.png)](https://community.st.com/s/topic/0TO0X0000003u2AWAQ/stm32-mpus)        [STM32 MCU Developer Zone](/content/st_com/en/stm32-mcu-developer-zone.html)     [STM32 MPU Developer Zone](/content/st_com/en/stm32-mpu-developer-zone.html)     [ST Edge AI Suite](/content/st_com/en/st-edge-ai-suite.html)    OUR FLAGSHIP SOFTWARE TOOLS    [STM32CubeMX](/content/st_com/en/stm32cubemx.html)     [STM32CubeIDE](/content/st_com/en/stm32cubeide.html)         **STM32CubeMX** ▼       [STM32 MCU Developer Zone](/content/st_com/en/stm32-mcu-developer-zone.html)     [STM32 MPU Developer Zone](/content/st_com/en/stm32-mpu-developer-zone.html)     [ST Edge AI Suite](/content/st_com/en/st-edge-ai-suite.html)    OUR FLAGSHIP SOFTWARE TOOLS    [STM32CubeMX](/content/st_com/en/stm32cubemx.html)     [STM32CubeIDE](/content/st_com/en/stm32cubeide.html)        **STM32CubeIDE** ▼      [STM32 MCU Developer Zone](/content/st_com/en/stm32-mcu-developer-zone.html)     [STM32 MPU Developer Zone](/content/st_com/en/stm32-mpu-developer-zone.html)     [ST Edge AI Suite](/content/st_com/en/st-edge-ai-suite.html)    OUR FLAGSHIP SOFTWARE TOOLS    [STM32CubeMX](/content/st_com/en/stm32cubemx.html)     [STM32CubeIDE](/content/st_com/en/stm32cubeide.html)         **ST Edge AI Suite** ▼    [![](/content/dam/st-crew/developer-zone/navigation/home-2-line.png)](/content/st_com/en/st-edge-ai-suite.html)  ![](/content/dam/st-crew/developer-zone/navigation/home-2-fill.png)    [Case studies](/content/st_com/en/st-edge-ai-suite/case-studies.html)     [Tools](/content/st_com/en/st-edge-ai-suite/tools.html)     [Community](https://community.st.com/t5/edge-ai/bd-p/edge-ai)        [STM32 MCU Developer Zone](/content/st_com/en/stm32-mcu-developer-zone.html)     [STM32 MPU Developer Zone](/content/st_com/en/stm32-mpu-developer-zone.html)     [ST Edge AI Suite](/content/st_com/en/st-edge-ai-suite.html)    OUR FLAGSHIP SOFTWARE TOOLS    [STM32CubeMX](/content/st_com/en/stm32cubemx.html)     [STM32CubeIDE](/content/st_com/en/stm32cubeide.html)

* [Careers](/content/st_com/en/about/careers.html)
* Sample & buy
  + [Buy from eStore](https://estore.st.com)
  + [Contact our sales offices & distributors](/content/st_com/en/contact-us.html)
* Support & community
  + [Support](/content/st_com/en/support/support-home.html)
  + [Partner program](/content/st_com/en/partner/partner-program.html)
  + [Learning](/content/st_com/en/support/learning.html)
  + [Video center](/content/st_com/en/support/learning/video-page.html)
  + [ST community](https://community.st.com)
  + [ST wiki](/content/st_com/en/wiki/wiki-portal.html)
* English
  + English
  + [中文](https://www.st.com.cn/zh/embedded-software/x-cube-cryptolib.html)
  + [日本語](https://www.st.com/ja/embedded-software/x-cube-cryptolib.html)

       ![](/etc/clientlibs/st-site-cx/media/app/images/loading-spinner.svg)
             [![st-logo-blue-vertical](/content/dam/st-crew/st-logo-blue.svg)](/content/st_com/en.html)

* About STMicroelectronics
* [Who we are](/content/st_com/en/about/st_company_information/who-we-are.html)
* [Investor relations](https://investors.st.com/)
* [Sustainability](/content/st_com/en/about/sustainability.html)
* [Innovation & technology](/content/st_com/en/about/innovation---technology/innovation---technology.html)
* [Careers](/content/st_com/en/about/careers.html)
* [Blog](https://blog.st.com/)
* [General terms and conditions](/content/st_com/en/about/procurement/general-terms-and-conditions.html)

* Connect with us
* [Contact ST offices](/content/st_com/en/contact-us.html)
* [Find sales offices & distributors](/content/st_com/en/contact-us.html)
* [Community](https://community.st.com)
* [Newsroom](https://newsroom.st.com/)
* [Events & trainings](/content/st_com/en/about/events/upcoming-events-and-technical-seminars.html)

* Browse
* [Shortcuts](/content/st_com/en/shortcuts.html)
* [Sitemap](/content/st_com/en/sitemap.html)

* Compliance, ethics, security & privacy
* [Ethics and compliance](/content/st_com/en/about/st_company_information/ethics-and-compliance.html)
* [ST ethics hotline](https://www.speakupfeedback.eu/web/stmicroelectronics/)
* [Security & privacy portal](/content/st_com/en/about/security-and-privacy.html)

* Newsletter sign up
* Submit
   x   Subscription to ST newsletters                        Email: \*         Please review our [Privacy Statement](/content/st_com/en/common/privacy-portal/corporate-privacy-statement.html) that describes how we process your profile information and how to assert your personal data protection rights    Continue          x   Thanks! Your newsletter subscription has been submitted

Please click on the link inside the email we have just sent you to confirm your subscription. If you did not receive an email from us, please check your spam box.

Follow us

             All rights reserved © 2025 STMicroelectronics |   [Terms of use](https://www.st.com/content/st_com/en/about/terms-of-use.html)  |  [Sales terms & conditions](https://www.st.com/content/ccc/resource/legal/legal_agreement/sales_agreement/49/05/8c/68/a0/35/4a/6e/ST%20Terms%20and%20Conditions%20of%20Sales.pdf/files/ST%20Terms%20and%20Conditions%20of%20Sales.pdf/jcr%3Acontent/translations/en.ST%20Terms%20and%20Conditions%20of%20Sales.pdf) |  [Trademarks](/content/st_com/en/about/st-trademark-list.html) |  [Security & privacy portal](/content/st_com/en/about/security-and-privacy.html) |  [Manage cookies](#.html)                     日本語ウェブサイトをご覧いただけます 该网站提供您所使用的语言版本     日本語ウェブサイトへ移動   跳转本地站点     表示を閉じる   不用，谢谢                                   ![](/etc/clientlibs/st-site-cx/media/app/images/loading-spinner.svg)                 Products

* Products
* Tools & Software
* Resources
* Videos
* Solutions
* Applications
* Publications
* X-Reference
* All site

Search History

Bookmark

Please log in to show your saved searches.

Search History

Bookmark

Please log in  to show your saved searches.

                                         ![](/etc/clientlibs/st-site-cx/media/app/images/loading-spinner.svg)                ▼

* + [Home](/content/st_com/en/stm32-mcu-developer-zone.html)
  + [Jump Start](/content/st_com/en/stm32-mcu-developer-zone/start-a-project-with-an-mcu.html)
  + [MCU Portfolio](/content/st_com/en/stm32-mcu-developer-zone/mcu-portfolio.html)
  + [Boards & hardware tools](/content/st_com/en/stm32-mcu-developer-zone/boards-and-hardware-tools.html)
  + [Software development tools](/content/st_com/en/stm32-mcu-developer-zone/software-development-tools.html)
  + [Embedded software](/content/st_com/en/stm32-mcu-developer-zone/embedded-software.html)
  + [Solutions](/content/st_com/en/stm32-mcu-developer-zone/solutions.html)
  + [Developer resources](/content/st_com/en/stm32-mcu-developer-zone/developer-resources.html)
* + [Home](/content/st_com/en/stm32-mpu-developer-zone.html)
  + [MPU Portfolio](/en/microcontrollers-microprocessors/stm32-arm-cortex-mpus/products.html)
  + [Boards & hardware tools](/content/st_com/en/stm32-mpu-developer-zone/boards-and-hardware-tools.html)
  + [Software development tools](/content/st_com/en/stm32-mpu-developer-zone/software-development-tools.html)
  + [Embedded software](/content/st_com/en/stm32-mpu-developer-zone/embedded-software.html)
  + [Solutions](/content/st_com/en/stm32-mpu-developer-zone/solutions.html)
  + [Developer resources](/content/st_com/en/stm32-mpu-developer-zone/developer-resources.html)
* + [Home](/content/st_com/en/st-edge-ai-suite.html)
  + [Case studies](/content/st_com/en/st-edge-ai-suite/case-studies.html)
  + [Tools](/content/st_com/en/st-edge-ai-suite/tools.html)
  + [Community](https://community.st.com/t5/edge-ai/bd-p/edge-ai)
* MCU Developer Zone
* MPU Developer Zone
* ST Edge AI Suite
* OUR FLAGSHIP SOFTWARE TOOLS
* [STM32CubeMX](/content/st_com/en/stm32cubemx.html)
* [STM32CubeIDE](/content/st_com/en/stm32cubeide.html)

  Back

* [Home](/content/st_com/en/stm32-mpu-developer-zone.html)
* [MPU Portfolio](/en/microcontrollers-microprocessors/stm32-arm-cortex-mpus/products.html)
* [Boards & hardware tools](/content/st_com/en/stm32-mpu-developer-zone/boards-and-hardware-tools.html)
* [Software development tools](/content/st_com/en/stm32-mpu-developer-zone/software-development-tools.html)
* [Embedded software](/content/st_com/en/stm32-mpu-developer-zone/embedded-software.html)
* [Solutions](/content/st_com/en/stm32-mpu-developer-zone/solutions.html)
* [Developer resources](/content/st_com/en/stm32-mpu-developer-zone/developer-resources.html)
   Back

* [Home](/content/st_com/en/stm32-mcu-developer-zone.html)
* [Jump Start](/content/st_com/en/stm32-mcu-developer-zone/start-a-project-with-an-mcu.html)
* [MCU Portfolio](/content/st_com/en/stm32-mcu-developer-zone/mcu-portfolio.html)
* [Boards & hardware tools](/content/st_com/en/stm32-mcu-developer-zone/boards-and-hardware-tools.html)
* [Software development tools](/content/st_com/en/stm32-mcu-developer-zone/software-development-tools.html)
* [Embedded software](/content/st_com/en/stm32-mcu-developer-zone/embedded-software.html)
* [Solutions](/content/st_com/en/stm32-mcu-developer-zone/solutions.html)
* [Developer resources](/content/st_com/en/stm32-mcu-developer-zone/developer-resources.html)
   Back

* [Home](/content/st_com/en/st-edge-ai-suite.html)
* [Case studies](/content/st_com/en/st-edge-ai-suite/case-studies.html)
* [Tools](/content/st_com/en/st-edge-ai-suite/tools.html)
* [Community](https://community.st.com/t5/edge-ai/bd-p/edge-ai)

* Support & Learning
  + Back
  + [Support](/content/st_com/en/support/support-home.html)
  + [Partner program](/content/st_com/en/partner/partner-program.html)
  + [Learning](/content/st_com/en/support/learning.html)
  + [Video center](/content/st_com/en/support/learning/video-page.html)
  + [ST community](/content/st_com/en/st-community.html)
  + [ST wiki](/content/st_com/en/wiki/wiki-portal.html)
* Sample & buy
  + Back
  + [Buy from eStore](https://estore.st.com)
  + [Contact our sales offices & distributors](/content/st_com/en/contact-us.html)
* About ST
  + Back
  + [Who we are](/content/st_com/en/about/st_company_information/who-we-are.html)
  + [Careers](/content/st_com/en/about/careers.html)
  + [Sustainability](/content/st_com/en/about/sustainability.html)
  + [Innovation & technology](/content/st_com/en/about/innovation---technology/innovation---technology.html)
  + [Manufacturing at ST](/content/st_com/en/about/manufacturing-at-st.html)
  + [Quality and reliability](/content/st_com/en/about/quality-and-reliability.html)
  + [Newsroom](https://newsroom.st.com/)
  + [Customer success stories](/content/st_com/en/about/customer-success-stories.html)
  + [Investor relations](https://investors.st.com/)
* [Contact Us](/content/st_com/en/contact-us.html)
* Language: English
  + Back
  + English
  + [中文](https://www.st.com.cn/zh/embedded-software/x-cube-cryptolib.html)
  + [日本語](https://www.st.com/ja/embedded-software/x-cube-cryptolib.html)

 Sorry!  Your browser is out-of-date

This browser is out of date and not supported by st.com.
 As a result, you may be unable to access certain features.
 Consider that modern browsers:

* are more secure and protect better during navigation
* are faster
* are more compatible with newer technologies
* provide a better experience and features

  Don't show this message again  I got it

So why not taking the opportunity to update your browser and see this site correctly?

 [Google Chrome](https://www.google.com/chrome/)  [Mozilla Firefox](https://www.mozilla.com/firefox/)
### Did you know?

Please provide email

Please enter code

Congratulations!

Simple subscription

Congratulations!

 x

You can start following this product to receive updates when new Resources, Tools and SW become available. It's easy and takes only 1 minute.

  Receive updates     Don't show anymore

You can start following this product to receive updates when new Resources, Tools and SW become available. It's easy and takes only 1 minute.

    Submit  E-mail address:  Please enter a valid email address.

You can start following this product to receive updates when new Resources, Tools and SW become available. It's easy and takes only 1 minute.

 A code has been sent to
 Not the right address? Click here to go back           Enter your code en:       Validate  Invalid code, please check the code sent to your email address and validate again. In case you did not receive any code please select 'I did not receive code'     I didn't receive code

You can start following this product to receive updates when new Resources, Tools and SW become available. It's easy and takes only 1 minute.

    Subscribe  A code has been sent to           Please review our [Privacy Statement](/content/st_com/en/common/privacy-portal/corporate-privacy-statement.html) that describes how we process your profile information and how to assert your personal data protection rights

You are now subscribed to
 - X-CUBE-CRYPTOLIB

You can re-use the validation code to subscribe to another product or application.

    Sorry, there was a problem on our servers. Please try again.                           ![](https://www.st.com/akam/13/pixel_26b0a4d9?a=dD1lODAzZGE5ZjM5NTMxOTFmZDRkM2E4MjAxYzI4MDZmMjhjMmYwMzM5JmpzPW9mZg==)

=== Content from bi-zone.medium.com_0dc88fe8_20250119_114521.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe6134846f5bb&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fbi-zone.medium.com%2Fsilence-will-fall-or-how-it-can-take-2-years-to-get-your-vuln-registered-e6134846f5bb&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fbi-zone.medium.com%2Fsilence-will-fall-or-how-it-can-take-2-years-to-get-your-vuln-registered-e6134846f5bb&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Silence Will Fall (Or How It Can Take 2 Years to Get Your Vuln Registered)

[![BI.ZONE](https://miro.medium.com/v2/resize:fill:88:88/1*cj9yFPo_JbHzvR2AQVUedg.png)](/?source=post_page---byline--e6134846f5bb--------------------------------)

[BI.ZONE](/?source=post_page---byline--e6134846f5bb--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3882bedad280&operation=register&redirect=https%3A%2F%2Fbi-zone.medium.com%2Fsilence-will-fall-or-how-it-can-take-2-years-to-get-your-vuln-registered-e6134846f5bb&user=BI.ZONE&userId=3882bedad280&source=post_page-3882bedad280--byline--e6134846f5bb---------------------post_header-----------)

18 min read·Jan 18, 2021

--

Listen

Share

**By** [**Innokentii Sennovskii**](https://twitter.com/rumata888)

![]()

Photo credit: <https://www.deviantart.com/heroeswho>

How long can it take to register a vulnerability? We are quite used to bug bounties, where most of the time you just have to wait for the company in question to triage your report, and that’s it, now you have a CVE. However, if the company doesn’t have an established framework for submitting security issues, then all your attempts can be met with a lack of understanding and sometimes even pushback. This is a story of how I discovered two similar vulnerabilities in cryptographic libraries for embedded devices and how it took two years to get them registered. If you don’t care about the story and just want to see PoC description, check out the chapter below.

# Intro

In 2018, we at [BI.ZONE](https://bi.zone) were preparing [CTFZone](https://twitter.com/CTFZone) Finals (held offline) that were meant to coincide with the [OFFZONE](https://offzone.moscow) conference. We really wanted to spice up the competition, so we decided to host the PWN challenge on actual hardware. Since this was an Attack-Defense CTF (that’s where teams are given identical services to host and protect, and all the teams try to steal flags from each other), we could give each team a custom circuit board with the CTFZone logo. The circuit board had dual purpose: a somewhat unusual task and a piece of memorabilia. At the start of the project, when the deadlines were still far ahead, we imagined a design, where the board would host two chips: one containing the core logic and one just for authentication. The attackers would be able to upload their malicious code to the core chip’s memory by leveraging the embedded vulnerabilities, but it was impossible to break into the authentication chip. This way we could prevent the attacking team from simply cloning the defending team’s device once and being able to emulate it later. Instead they would have to interact with the authentication chip on the target device in order to get the flag for each round. Such mechanisms require cryptographic solutions. Thankfully (or so I thought), ST (we were going to use STM chips for both microcontrollers) provided a precompiled cryptographic library for its devices that is called [STM32 cryptographic firmware library software expansion for STM32Cube (X-CUBE-CRYPTOLIB)](https://www.st.com/en/embedded-software/x-cube-cryptolib.html).

So I downloaded the documentation and started scrolling through the provided algorithms. I came across the descriptions of various Elliptic Curve Cryptography Primitives and was nearing SHA-1, which I wanted to try out to check if the API was working at all, but then something utterly disturbing caught my eye when skimming the RSA chapter. The firmware library contained four exported functions that you can see in the following table.

![]()

This was in 2018, and at the time I thought that PKCS#1v1.5 had already died out, since the specification contains a vulnerability. The discovery of this led to the realization that faulty legacy implementations can still be found in the wild. Let’s look into the reasons why PKCS#1v1.5 must not be used, and then get back to the disclosure chronology.

# PKCS#1v1.5

PKCS#1 is the RSA Cryptography Standard. It defines the primitives and schemes for using the RSA algorithm for public-key cryptography. Its current version is 2.2, but the version used in the X-CUBE-CRYPTOLIB is 1.5. This version of the specification is infamous for introducing a critical vulnerability into the encryption / decryption process. However, to understand it in full we must first cover the inner workings of RSA and what is inside PKCS#1.

# Basic RSA

The RSA primitive relies on the hard problem of factorizing a product of two large prime numbers. Imagine Bob wants to send Alice a message that only she would be able to read. They decide on the following algorithm (all the formulas will follow the list, since medium can’t handle Latex):

1. Alice randomly picks two prime numbers (*p* and *q*) of predefined length (for example, 1024 bits).
2. Alice computes their product *N* (the modulus).
3. Alice takes the predefined public exponent *e*. The most common value is *65537*, because it has just 2 bits set. In the past *3* and *17* have also been used, but they are not guaranteed to wrap the modulus during exponentiation.
4. Alice computes private exponent *d*. Now (*d*, *N*) is Alice’s private key and (*e*, *N*) is Alice’s public key.
5. Alice sends her public key to Bob.
6. Bob converts the message *M* which he wants to send to Alice into a number *m* less than *N*. He exponentiates the number to *e* modulo *N* and sends the result to Alice.
7. Alice takes the result, exponentiates it to *d* modulo *N* and gets the initial *m* as a result, which she then converts back into *M*! On a side note, since Medium does not support Latex, some exponents are expressed in brackets using the ^ symbol. *N*=*p*∗*q*, where *p*, *q* are prime
   *e∗d = 1(mod (p-1)*∗*(q-1))
   ∀m ≠ 0: m ^(e∗ d) (mod N)=m^(1+k∗(p−1)∗(q−1)) (mod N)=m (mod N),* where *k∈ N*

# RSA teething problems

RSA has several problems. For example, you can’t just pick any two prime numbers to compute the modulus, they need to fulfill certain requirements. Otherwise, the primitive becomes unsafe. And even if you’ve picked the perfect *p* and *q*, you’d still be left with some issues. We’ll use the following notation from now on: *m* stands for plaintext (message) and *c* stands for ciphertext.

First, what if instead of using *65537* as the public exponent, you pick a smaller one such as *3*? If *p* and *q* are both 1024 bits, then the modulus is *2048* bits or *256* bytes. If the message Bob wants to send to Alice is less or equal to

⌊256/3⌋=85

then the result of the exponentiation operations doesn’t overflow the modulus. In which case decrypting the ciphertext is easy, you just need to take its third root.

Second, if Bob is repeating certain messages, then they encrypt to the same ciphertext and as a result an adversary performing a Man-in-the-Middle attack can extract partial information about the messages: the fact that at particular points in time Bob sent the same messages.

# Specification

To address these issues, RSA (as in the company) created a specification that became [PKCS#1 v1.5](https://tools.ietf.org/html/rfc2313) (Public Key Cryptography Standards). The specification introduces formatting for encrypted (or signed) blocks (effectively, a special padding). This padding is used before the whole block is encrypted. Let’s say the length of modulus *N* in octets (bytes) is equal to *k*. The data we want to encrypt/sign is *D*. Then the encryption block is:

`EB = 00 || BT || PS || 00 || D`

where *BT* is *00* or *01* for private-key operations (signing) and *02* is for public-key operations (encryption). The encryption block is translated to integer using big-endian conversion (the first octet of EB is the most significant one) *PS* consists of *k-3-len(D)* octets. Its contents depend on *BT*:

1. *BT=00*, all octets in *PS* are set to *00*
2. *BT=01*, all octets in *PS* are set to *FF*
3. *BT=02*, all octets in *PS* are pseudorandomly generated and not equal to *00*

It is recommended to use *BT=01* for signatures and *BT=02* for encryption, since

1. With *BT=01*, *D* can be unpadded regardless of its contents, with *BT=00* the first byte of *D*, which is equal to *00*, will also be unpadded, thereby creating a problem.
2. Both *BT=01* and *BT=02* create large integers for encryption, so all attacks requiring a small (short) *D* don’t work

You can also notice, that the first octet of *EB* is *00*. This value was chosen so that the integer resulting from *EB* is always less than the modulus *N*.

At first glance, this scheme seems pretty reliable and it obviously solves the problems mentioned earlier.

# Bleichenbacher’s Padding Oracle Attack

Unfortunately, not all is well and good with PKCS#1v1.5, or I would not be sitting here writing this article. The following attack is 22 years old.

You can find the original paper here: [Chosen Ciphertext Attacks Against Protocls Based on the RSA Encryption Standard PKCS#1](http://archiv.infsec.ethz.ch/education/fs08/secsem/bleichenbacher98.pdf).

Now, let’s think back to Alice and imagine that she has already created the key pair and sent Bob the public key, but now Bob and Alice are using PKCS#1v1.5 padding in their encrypted messages. What happens when you send Alice a ciphertext?

1. Alice decrypts the ciphertext with the RSA primitive.
2. Alice unpads the message.
3. Alice parses the message and performs actions based on the message.

Various programs and systems (Alice in this analogy) tend to signal to the sender (Bob), that something has gone wrong if there is a problem with receiving commands. The issue is that these signals quite often show exactly where the problem has arisen: during the second stage (padding is incorrect) or the third stage (something wrong with the command itself). Usually, discerning stages two and three is only possible with a private key, so when Alice tells us whether unpadding failed or succeeded, she actually leaks information about the plaintext.

As a thought experiment, what if we send a random integer *c* for decryption instead of a legitimate message? What is the probability that no error will surface during unpadding? The first 2 octets of *EB* should be *00 || 02*, the other octets should have at least one *00*. If *k* is 256, then P=1/256² ∙ (1 — (255/256²⁵⁴))≈1/104031. The probability seems way too small, but it is actually high enough to be leveraged in an attack. The attack uses the fact that RSA is homomorphic with regards to multiplication:

*∀x: (x∗m)ᵉ (mod N)=xᵉ∗mᵉ (mod N)*

Here is how the attack unfolds. We choose the *c*, for which we want to find

*m=cᵈ mod N*

For the sake of convenience, we’ll use the following constants in further explanation

*B=2^(8(k-2)), k=*∣∣*N*∣∣*.*

We say that ciphertext is PKCS-conforming if it decrypts to a PKCS conforming plaintext. Basically, we choose integers *s*, compute

*c*′=*cs*ᵉ *mod* *N*

and send them to the oracle (Alice). If *c*′ passes the error check, then

*2B* ⪯ *ms mod N*≺ *3B.*

By collecting enough different *s* we can derive *m*, this typically requires around 2²⁰ ciphertexts, but this number varies widely. The attack can be divided into three phases:

1. Blinding the ciphertext, creating *cₒ*, that corresponds to unknown *mₒ*
2. Finding small sᵢ*​*, such that *mₒsᵢ mod N* is PKCS-conforming. For every such sᵢ the attacker computes intervals that must contain *mₒ* using previously known information
3. Starts when only one interval remains. The attacker has sufficient information about *mₒ* to choose sᵢ such that *mₒsᵢ mod N* is more likely to be PKCS conforming than a randomly chosen message. The size of sᵢ is increased gradually, narrowing the possible range of *mₒ* until only one possible value remains.

(Actually, when the interval is small enough, it is more efficient to just bruteforce the values locally than continue submitting queries to the oracle).

So, the model of the attack is:

1. Intercept some message from Bob to Alice.
2. Use Alice as a padding oracle to decrypt the message.

# Back to disclosure

Since I found this vulnerability in one software library for microcontrollers, I decided to check if there are any other libraries that provide this specification as the default method for RSA encryption/decryption. Turns out, ST is not the only company. Microchip also provides a library that contains cryptographic primitives and lo and behold — the only encryption scheme for RSA is once again PKCS#1v1.5. Here is an excerpt from the RSA decryption function:

Here, the order of bytes in memory is inversed, so we actually check that the plaintext ends with *0200* instead of starting with *0002*. Anyway, we can see that the function returns a different status when the padding is incorrect and this is what makes it dangerous.

So it was time to alert the manufacturers. I submitted the descriptions to ST and Microchip in September of 2018 and started the waiting game.

In the beginning ST was quite responsive, but there was some miscommunication. Part of it was on me, since I initally wrote that the fault was in STM32-CRYP-LIB (another cryptographic library provided by ST) instead of X-CUBE-CRYPTOLIB (and the problem is that STM32-CRYP-LIB doesn’t provide encryption/decryption primitives for RSA, only signing/verification). There was also the regular pushback associated with Bleichenbacher’s padding oracle in libraries, namely, that it doesn’t necessarily mean that the end product will contain a vulnerability, but they agreed that it is hard to mitigate this problem once you’ve chosen to use PKCS#1v1.5. In October I was told that they have started work on implementing PKCS#1v2.2. I emphasised the need for a CVE to alert users, but their next responce came only in December:

* They didn’t want to register a CVE, because they just followed the specification and the library itself didn’t return any padding errors (this is just partially true)
* They were developing PKCS#1v2.2 (a newer specification with safer padding) and were going to publish it with a new version of X-CUBE-CRYPTOLIB in the spring.

I tried to change their mind on registering a CVE, but in the end couldn’t.

I submitted the issue to Microchip in September. The Development team only got back to me with a “solution” to my problem in March of 2019. They advised me to use Microchip Harmony (their Embedded Software Development Framework) instead of Microchip Libraries for Applications package. I must admit that it is indeed a valid solution, since Harmony contains more modern specifications that can be used instead of the vulnerable one. However, there still was a need to alert users about the pitfalls of using RSA in Microchip Libraries for Applications and it took almost 6 months for them to respond to my initial request, so I decided to take a different route.

MITRE requires you to try every possible method for registering a CVE before applying directly to them. By March of 2019, I tried to contact the vendors, but that didn’t help with the registration. After that the vulnerabilities is supposed to be submitted to one of the CVE Numbering Authorities, but none except MITRE were in fact relevant. However, HackerOne is actually a CNA and they have a program called “The Internet”. To qualify for it you have to either find a vulnerablity in some widely-used open-source project, or the vulnerability should affect several vendors (which is my case). However, now, there was a need for a Proof-of-Concept (PoC). So, I set out to create just that.

# Proof of Concepts

# General information

Since these libraries are aimed at embedded devices, using them on a regular PC with amd64 architecture comes with certain limits. The worst of them is the speed of computation.

The MLA is distributed as source code, but the actual bigint computations are implemented in PIC architecture assembly. I had to rewrite them to amd64 architecture, but suffered a slowdown, since the procedures in C code relied of 16-bit computations in assembly routines. This makes RSA quite slow, even though it is executed “natively”. It can take up to several days to complete the attack. On a device it would take significantly less.

X-CUBE-CRYPTOLIB is distributed in compiled format. To use it on a PC, I had to emulate the firmware with QEMU. Obviously, it is a significant obstacle for time. What makes it even worse is that the only available interface to transport the data is emulated UART, which is painfully slow (it takes 2 minutes to transmit 256 bytes). To deal with the interface problem, I’ve implemented a debug hook (so QEMU is running with debugging) that transfers data to and from memory. This allows us to avoid at least the transmission emulation bottleneck.

Still in these conditions the attack is quite slow. So I implemented two versions of the attack for both platforms to save the tester’s time:

* The full attack (will take a long time on MLA, an absurdly long time on ST)
* The attack with precalculated successful steps

The second variant is basically running the algorithm beforehand with a python server which performs the same checks as the vulnerable library. It saves all the steps which produce the correct decryption outcome (these steps allow the attacker to narrow the plaintext space). The attacker only tries these with the vulnerable implementation later (thereby skipping most of painful bruteforce).

![]()

It’s also worth noting that the X-CUBE-CRYPTOLIB library is protected against being used on non-ST devices (the check is performed by writing and reading bits from specific memory registers). You can see them in the picture on the left (**MEMORY** accesses). QEMU fails this check, but fortunately instead of refusing to decrypt/encrypt data the routines just mask data during encryption and give back more data (including some of the random padding) during decryption. The mask can be rolled back as long as the plaintext contains only ASCII-7 characters, since all of them are less than 128. So, the unmasking function also had to be implemented to use the library with QEMU.

There was only one change made to the MLA library: implementing bigint arithmetic in intel assembly instead of PIC.

There were no changes made to the ST library.

What follows are instructions on how to reproduce the issues (on Linux).

# Preliminary steps

MLA library is readily available here: <https://www.microchip.com/mplab/microchip-libraries-for-applications>, but you have to request X-CUBE-CRYPTOLIB in advance here (you’ll have to register): <https://www.st.com/en/embedded-software/x-cube-cryptolib.html>. Or if you’ve already registered and are logged in: <https://my.st.com/content/my_st_com/en/products/embedded-software/mcu-mpu-embedded-software/stm32-embedded-software/stm32cube-expansion-packages/x-cube-cryptolib.html>.

To use RSA, we first need to generate a private key. The private key will be used to create the speedup trace and it will be used by the vulnerable servers.

Unpack the archive “*Bleichenbacher\_on\_microcontrollers*.tar.gz” (available [here](https://github.com/Rumata888/bleichenbacher-in-microcontrollers)). Go to subfolder “*Preparation*”.

List of files in *“Preparation”*:

* requirements.txt (file with python requirements for *“create\_traces\_and\_imports.py”* and python attack clients)
* create\_traces\_and\_imports.py (python script which parses a pem file, creates headers and imports for vulnerable servers and clients, also encrypts one message, which is to be decrypted by the attacking clients and creates a trace to show the attack without taking too much time)
* [initialize.sh](http://initialize.sh) (runs openssl to create a 2048-bit RSA key, then runs *“create\_traces\_and\_imports.py”*)

You need to install openssl, python3, pip, python3-gmpy2 and pycryptodome. If on ubuntu, run:

```
sudo apt install openssl python3 python3-pip python3-gmpy2 && python3 -m pip install -r requirements.txt
```

Now, you can run the initialization file which will create the keys, the trace and the headers for the future use. “[initialize.sh](http://initialize.sh)” first creates an RSA key “private.pem” and then runs the “create\_traces\_and\_imports.py”. The files contain comments, so you can look inside to see what’s happening.

Run:

```
./initialize.sh
```

Files and folders created:
**microchip\_files**
- attacker\_params.py
- key\_params.h

**speedup
-** info.txt
- trace.txt

The “info.txt” file contains information on how long it would take for the client to complete each variant of attack (based on my hardware, yours can be better).

# Microchip PoC

Install [Microchip Libraries for Applications (MLA)](https://www.microchip.com/mplab/microchip-libraries-for-applications). The latest version at the time of writing is “v2018\_11\_26”. It has to be installed in a non-virtualized environment. For some reason they’ve implemented this check in the installer.

Go to the directory where you’ve extracted all files from “Bleichenbacher\_on\_microcontrollers.tar.gz” (available [here](https://github.com/Rumata888/bleichenbacher-in-microcontrollers)). Go to “Microchip/vulnerable\_server”*.*

List of files in the directory:

* bigint\_helper\_16bit\_intel.S (rewritten *“bigint\_helper\_16bit.S”* from the bigint library inside MLA. It was written for PIC architecture, making the library unusable on a PC. I rewrote all functions in intel (x86\_64) assembly, to use the same bigint library that crypto\_sw in MLA uses)
* bleichenbacher\_oracle\_mla.c (the main file containing high-level server functions)
* crypto\_support\_params.h (enums and function definitions for cryptographic functions)
* crypto\_sw.patch (a patchfile that comments out one line in crypto\_sw library to stop type collision when building on a PC)
* crypto.c (contains all functions which initialize and deinitialize MLA’s RSA implementation and functions that wrap around encryption and decryption routines)
* do\_patch.sh (a simple bash script to apply the patch)
* makefile
* oracle\_params.h (some server parameters)
* support.c (decrypted message checking function)
* support.h (check\_message function and return values’ definitions and seed length definition)

Copy the folders “*bigint*” and “*crypto\_sw*” from “~/microchip/mla/v2018\_11\_26/framework” to “*microchip\_build*”. Copy the file “*key\_params.h*” from “*Preparation/microchip\_files*” in the initialization phase to the *“Microchip/vulnerable\_server”*. Run *do\_patch.sh*. It will change one line in the crypto\_sw library (there is a type definition collision because we are using system’s stdint). And finally you can run make.

```
cd Microchip/vulnerable_server
cp -r ~/microchip/mla/v2018_11_26/framework/bigint .
cp -r ~/microchip/mla/v2018_11_26/framework/crypto_sw .
cp ../../Preparation/microchip_files/key_params.h .
./do_patch.sh
make
```

The file "*bleichenbacher\_oracle\_mla*" is the program containing the vulnerable oracle server using microchip's library.

Now, open another terminal (let's call it "AttackerTerminal" and the previously used one "VictimTerminal"). Go to *"Attacker"* in this newly created terminal and copy *"Preparation/attacker/attacker\_params.py"* to *"Attacker"*. You can also copy the tracefile if you want to speedup the attack. Look in the *"Preparation/speedup/info.txt"* to see how much time you'd have to spend on each version of the attack (without speeding up/skipping the initial bruteforce/just checking the trace) with the current key and encrypted message.

```
#AttackerTerminal
cp ../Preparation/attacker/attacker_params.py .
cp ../Preparation/speedup/trace.txt .
```

Now, open the victim terminal and run *bleichenbacher\_oracle\_mla*. It will open port 13337 and listen for one incoming connection. This means that if you want to rerun the attack, you have to stop the attacker and rerun the server, then run the attacker script again.

```
#VictimTerminal
./bleichenbacher_oracle_mla
```

You have 3 options depending on how you want to run the attack:

1. Run the full attack (you will have to wait a long time, however)

```
#AttackerTerminal
python3 attacker.py
```

2. Skip the first part of the attack (finding the first s. This is the longest part of the whole attack)

```
#AttackerTerminal
python3 -t trace.txt -s
```

3. Run only the successful queries (taken from the trace). The quickest version of the attack.

```
#AttackerTerminal
python3 -t trace.txt
```

After the attack completes, the attacking script will print the decrypted message, it will login on the vulnerable server and ask it to give the flag, printing the final answer from the server.

# ST PoC

Download and unzip [qemu\_stm32](https://github.com/beckus/qemu_stm32/archive/stm32_v0.1.3.zip).

```
wget https://github.com/beckus/qemu_stm32/archive/stm32_v0.1.2.zip
unzip stm32_v0.1.2.zip
cd qemu_stm32-stm32_v0.1.2
```

Install the necessary packages:

```
sudo apt install arm-none-eabi-gcc-arm-non-eabi-newlib gcc
```

Configure and build qemu:

```
./configure --extra-cflags="-w" --enable-debug --target-list="arm-softmmu"
make
```

If there is a problem with linking which stems from undefined references to symbols “minor”, “major”, “makedev”, then you need to add the following include to the file *“qemu\_stm32-stm32\_v0.1.2/hw/9pfs/virtio-9p.c”*:

```
#include <sys/sysmacros.h>
```

The error is due to the changes in libc after version 2.28.

You can do this easily, like so:

```
cd qemu_stm32-stm32_v0.1.2
cp ../stm32_qemu.patch .
cp ../do_qemu_patch.sh .
```

Now, just configure and make it again.

The qemu executable, that can execute images for STM, is located in *“qemu\_stm32-stm32\_v0.1.2/arm-softmmu”* and is named *“qemu-system-arm”*.

Now, let’s build the image. Go back to *“ST/vulnerable\_server/binary”*. Download the [stm32\_p103\_demos](https://github.com/beckus/stm32_p103_demos/archive/v0.3.0.zip) archive and unzip it.

```
wget https://github.com/beckus/stm32_p103_demos/archive/v0.3.0.zip
unzip v0.3.0.zip
```

Put the X-CUBE-CRYPTOLIB archive *“en.x-cube-cryptolib.zip”* in the *“ST/binary”* and unzip it. Copy the library files for STM32F1 to the *“stm32\_p103\_demos-0.3.0”*:

```
unzip en.x-cube-cryptolib.zip
cp -r STM32CubeExpansion_Crypto_V3.1.0/Fw_Crypto/STM32F1/Middlewares/ST/STM32_Cryptographic stm32_p103_demos-0.3.0/
```

Now, you need to apply the patch containing vulnerable server’s source code and changes to makefile and the linkage file (without it the compilation will fail during linkage).

```
cd stm32_p103_demos-0.3.0
cp ../do_demos_patch.sh .
cp ../stm32_p103_demos.patch .
./do_demos_patch.sh
```

The list of files in the folder *“demos/bleich/”*:

* main.c — the main file containing high-level functionality of the server
* stm32f10x\_conf.h — configuration file
* support.c — message parsing and fixing
* support.h — definitions for the use of support.c

You need to copy the parameters of the key:

```
cp ../../../../Preparation/st_files/key_params.h demos/bleich/
```

Now, you can build the vulnerable server.

```
make bleich_ALL
```

Bear in mind that if you create a new key and run create\_traces\_and\_imports.py you will need to perform *make clean* first to rebuild with new parameters.

For this one you’ll need 3 terminals:

* Server QEMU terminal
* Server GDB terminal
* Attacker terminal

In the first terminal, go to the *“<some\_prefix>/ST/vulnerable\_server/binary/qemu\_stm32-stm32\_v0.1.2/arm-softmmu”* folder and start qemu with gdb server:

```
#Server QEMU terminal
./qemu-system-arm -M stm32-p103 -kernel ../../stm32_p103_demos-0.3.0/demos/bleich/main.bin -gdb tcp::3333
```

In Server GDB terminal do the following:

* Go to *“<some\_prefix>/ST/vulnerable\_server/”*
* install gdb-multiarch if it’s not installed
* run gdb-multiarch
* load file *“binary/stm32\_p103\_demos-0.3.0/demos/bleich/main.elf”* (this is necessary for the script to work)
* connect to qemu gdb server
* load python script *“<some\_prefix>/ST/vulnerable\_server/gdb\_server/python-extender.py”* (gdb has to use python3)

```
#Server GDB terminal
gdb-multiarch
file binary/stm32_p103_demos-0.3.0/demos/bleich/main.elf
target remote localhost:3333
source gdb_server/python-extender.py
```

At this point, the terminal should hang. This is ok, it’s waiting for a connection from the server.

The steps to attack the server are the same as in Microchip PoC. If you want to do the attack again, first you have to stop qemu, then you need to kill gdb.

```
pkill -9 gdb
```

Unfortunately, it can’t exit itself because of python threads. After you’ve killed the server you can restart the emulator and gdb server in the same order.

# Back to disclosure… Again

So, I submitted these PoCs to HackerOne in October of 2019. However, since Bleichenbacher’s Padding Oracle Attack has only Medium severity, the impact wasn’t high enough for the report to be eligible for the Internet program. Sigh… Ok, the only thing that was left was to submit the vulnerabilities directly to MITRE. On the 21st of October I submitted the request and got the automatic reply. A few days after that I replied to the letter, asking if they required any more information, but there was silence. I got preoccupied with work and CTF preparations (a year has passed) and completey forgot about that letter.

In December of 2019, ST got back to me with an update: that they were to publish a new version with PKCS#1v2.2 in the beginning of 2020 and the the user manual for X-CUBE-CRYPTOLIB was going to be updated with a warning regarding the vulnerability. To this day there is no update to the library (although they did later mention that they would only provide the update for the modern STM32 families). But they did add a warning to their documentation, so at least this story had some positive outcome:

![]()

Later, in October of 2020, somebody reminded me about these vulnerabilities. I resubmitted the request through my work email. Once again, MITRE were silent even after I replied to the automatic response two weeks after receiving it. The situation was preposterous. At this time I looked at my first email to them and noticed, that a year has passed since I first submitted the vulnerabilities for numbering. And we all know that only one thing can get the ball rolling when you’ve found yourself in such a predicament: a Twitter rant. To be fair to MITRE, once I mentioned them in a tweet they quickly reserved CVEs and replied to my old emails. So, in conclusion, here are the CVEs:

1. CVE-2020–20949 (Vulnerability in ST X-CUBE-CRYPTOLIB 3.1.0, 3.1.2)
2. CVE-2020–20950 (Vulnerability in Microchip Libraries for Applications 2018–11–26)

The end.

[Cve](https://medium.com/tag/cve?source=post_page-----e6134846f5bb--------------------------------)[Vulnerability](https://medium.com/tag/vulnerability?source=post_page-----e6134846f5bb--------------------------------)[Rsa](https://medium.com/tag/rsa?source=post_page-----e6134846f5bb--------------------------------)[Cryptography](https://medium.com/tag/cryptography?source=post_page-----e6134846f5bb--------------------------------)

--

--

[![BI.ZONE](https://miro.medium.com/v2/resize:fill:96:96/1*cj9yFPo_JbHzvR2AQVUedg.png)](/?source=post_page---post_author_info--e6134846f5bb--------------------------------)[![BI.ZONE](https://miro.medium.com/v2/resize:fill:128:128/1*cj9yFPo_JbHzvR2AQVUedg.png)](/?source=post_page---post_author_info--e6134846f5bb--------------------------------)Follow[## Written by BI.ZONE](/?source=post_page---post_author_info--e6134846f5bb--------------------------------)[186 Followers](/followers?source=post_page---post_author_info--e6134846f5bb--------------------------------)·[1 Following](/following?source=post_page---post_author_info--e6134846f5bb--------------------------------)

[BI.ZONE](http://BI.ZONE): an expert in digital risks management. We help organizations around the world to develop their businesses safely in the digital age

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----e6134846f5bb--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----e6134846f5bb--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----e6134846f5bb--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----e6134846f5bb--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----e6134846f5bb--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----e6134846f5bb--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e6134846f5bb--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e6134846f5bb--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----e6134846f5bb--------------------------------)[Teams](https://medium.com/business?source=post_page-----e6134846f5bb--------------------------------)


