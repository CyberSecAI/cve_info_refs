- **Root cause of vulnerability:** The CGI scripts "Book of guests" and "Post it!" do not properly filter metacharacters from user input, particularly within the email field. This allows an attacker to inject shell commands.
- **Weaknesses/vulnerabilities present:** Command injection vulnerability due to insufficient input validation and sanitization. The scripts directly pass user-provided data to the shell without filtering metacharacters.
- **Impact of exploitation:** An attacker can execute arbitrary shell commands on the server. In the example given, the attacker is shown to be able to read sensitive files such as `/etc/passwd` and email the contents to an attacker controlled email address, demonstrating full system compromise.
- **Attack vectors:** The vulnerability is exploited by injecting shell commands within the email field of the CGI scripts.
- **Required attacker capabilities/position:** The attacker only needs the ability to access and interact with the vulnerable CGI scripts via a web interface, specifically the email field.