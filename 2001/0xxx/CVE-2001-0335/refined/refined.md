- **Root cause of vulnerability**: The vulnerability arises from the FTP service improperly handling user logins when a user specifies an account name prefixed with a specific set of characters. This bypasses the requirement to specify the domain, causing the system to search all trusted domains for a matching username.
- **Weaknesses/vulnerabilities present**: Information disclosure vulnerability. The FTP service incorrectly searches for user accounts in all trusted domains when a specific prefix is used with the username.
- **Impact of exploitation**: An attacker can potentially gain access to a domain user account if they know the password, especially if the Guest account on a trusted domain is enabled and has a known default password (blank).
- **Attack vectors**: The attacker would need to establish an FTP session with the affected server and provide a username with the specific prefix.
- **Required attacker capabilities/position**: The attacker needs to be able to start an FTP session and know the username (or be able to guess it, as in the case of the Guest account), and the password for the user account on a trusted domain. The FTP server must be a member of a domain, and that domain must trust another domain where the target user account exists.