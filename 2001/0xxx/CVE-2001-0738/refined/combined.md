=== Content from www.kb.cert.org_5f80a68b_20250124_215500.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#249579

## klogd does not adequately handle NULL byte when parsing text using LogLine( )

#### Vulnerability Note VU#249579

Original Release Date: 2001-07-24 | Last Revised: 2003-04-09

---

### Overview

There is a denial-of-service vulnerability in certain distributions of the Linux kernel logging daemon (klogd) which could allow an attacker to cause klogd to hang.

### Description

| The Linux kernel logging daemon (klogd) can be forced to hang if it receives a null byte in a log message from the Linux kernel. Please see the following bug report for more information:  <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=85478> |
| --- |

### Impact

| This vulnerability causes klogd to go into an infinite loop, thus preventing further kernel log messages from being written to disk. |
| --- |

### Solution

| Upgrade to latest version of klogd for your Linux distribution. |
| --- |

| The following workaround is taken from <http://bugs.debian.org/cgi-bin/bugreport.cgi?archive=no&bug=85478>:The patch below contains a possible fix for this, by treating a null byte as a delimiter, equivalent to \. Additionally, the patch prevents LogLine from being invoked with a negative counter as an argument.diff -u sysklogd-1.3.orig/klogd.c sysklogd-1.3/klogd.c--- sysklogd-1.3.orig/klogd.c\t\t Sat Feb 10 13:04:06 2001+++ sysklogd-1.3/klogd.c\t\t Sat Feb 10 12:58:11 2001@@ -707,7 +707,7 @@ \t\t break; /\* full line\_buff or end of input buffer \*/ }- if( \*ptr == '\' ) /\* newline \*/+ if( \*ptr == '\' || \*ptr == '\0') /\* newline or null terminator \*/ { ptr++;\t\t /\* skip newline \*/ space -= 1;@@ -877,8 +877,10 @@ \t\t fprintf(stderr, "klogd: Error return from sys\_sycall: " \ \t\t \t\t "%d - %s\", errno, strerror(errno)); }-\t\t -\t\t LogLine(log\_buffer, rdcnt);+ else+ \t\t LogLine(log\_buffer, rdcnt);+ + return; }@@ -902,8 +904,8 @@ \t\t Syslog(LOG\_ERR, "Cannot read proc file system: %d - %s.", \ \t\t errno, strerror(errno)); }-\t\t -\t\t LogLine(log\_buffer, rdcnt);+ else+ \t\t \t\t LogLine(log\_buffer, rdcnt); return; } |
| --- |

### Vendor Information

249579
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23249579/) to view vendors.**
### [Debian](#IAFY-4YTND2) Affected

Notified:  February 10, 2001  Updated: July 20, 2001

### Status

Affected

### Vendor Statement

Please see <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=85478>

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Immunix](#IAFY-4Y6NF9) Affected

Notified:  February 10, 2001  Updated: July 20, 2001

### Status

Affected

### Vendor Statement

Please see <http://download.immunix.org/ImmunixOS/7.0/updates/IMNX-2001-70-026-01>

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://bugs.debian.org/cgi-bin/bugreport.cgi?archive=no&bug=85478>
* <http://download.immunix.org/ImmunixOS/7.0/updates/IMNX-2001-70-026-01>
### Acknowledgements

This vulnerability was discovered by Thomas Roessler  and was reported to the bugs.debian.org mailing list on February 10, 2001.

This document was written by Ian A. Finlay

### Other Information

| **CVE IDs:** | [CVE-2001-0738](http://web.nvd.nist.gov/vuln/detail/CVE-2001-0738) |
| --- | --- |
| **Severity Metric:** | 1.83 |
| **Date Public:** | 2001-02-10 |
| **Date First Published:** | 2001-07-24 |
| **Date Last Updated:** | 2003-04-09 19:19 UTC |
| **Document Revision:** | 51 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from marc.info_1eda2af6_20250124_215500.html ===

```
[[prev in list](?l=bugtraq&m=99258537004993&w=2)] [[next in list](?l=bugtraq&m=99262959706063&w=2)] [prev in thread] [[next in thread](?l=stackguard&m=99357995421841&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [sysklogd update -- Immunix OS 6.2, 7.0-beta, 7.0](?t=99258636300002&r=1&w=2)
From:       [Immunix Security Team <security () wirex ! com>](?a=99126584700001&r=1&w=2)
Date:       [2001-06-14 23:55:57](?l=bugtraq&r=1&w=2&b=200106)
[Download RAW [message](?l=bugtraq&m=99258618906506&q=mbox) or [body](?l=bugtraq&m=99258618906506&q=raw)]

-----------------------------------------------------------------------
	Immunix OS Security Advisory

Packages updated:	sysklogd
Affected products:	Immunix OS 6.2, 7.0-beta, and 7.0
Bugs fixed:		immunix/1623
Date:			Thu Jun 14 2001
Advisory ID:		IMNX-2001-70-026-01
Author:			Seth Arnold <sarnold@wirex.com>
-----------------------------------------------------------------------

Description:
  The Linux kernel logging daemon klogd distributed in the sysklogd
  package can be forced to quit if it receives a null byte in a log
  message from the Linux kernel. These updates have applied a patch
  from roessler at does-not-exist dot org to fix this problem.

  Because an attacker would need to convince the kernel to log a null
  byte in order to exploit this problem, we don't think it is an issue
  for most sites; however, the bug was found when a kernel module
  supplied with kernel 2.4 attempted to print a null byte.

  We recommend Immunix OS users upgrade their sysklogd packages.

  References:
  <http://bugs.debian.org/cgi-bin/bugreport.cgi?archive=no&bug=85478>

Package names and locations:
  Precompiled binary packages for Immunix 6.2 are available at:
<http://download.immunix.org/ImmunixOS/6.2/updates/RPMS/sysklogd-1.3.31-18_StackGuard.i386.rpm>

  Source packages for Immunix 6.2 are available at:
<http://download.immunix.org/ImmunixOS/6.2/updates/SRPMS/sysklogd-1.3.31-18_StackGuard.src.rpm>

  Precompiled binary packages for Immunix 7.0-beta and 7.0 are available at:
<http://download.immunix.org/ImmunixOS/7.0/updates/SRPMS/sysklogd-1.3.33-9_imnx.src.rpm>

  Source package for Immunix 7.0-beta and 7.0 is available at:
<http://download.immunix.org/ImmunixOS/7.0/updates/SRPMS/sysklogd-1.3.33-9_imnx.src.rpm>

md5sums of the packages:
6.2:
  8f1dca74c72179aba3a04226f916b4a2  RPMS/sysklogd-1.3.31-18_StackGuard.i386.rpm
  4fdf88fd615bce2d730915d5812eaf97  SRPMS/sysklogd-1.3.31-18_StackGuard.src.rpm

7.0:
  577a073a871475704a68fde712a90b1e  RPMS/sysklogd-1.3.33-9_imnx.i386.rpm
  3add2ae895e9c4dad1e9737807cc1f30  SRPMS/sysklogd-1.3.33-9_imnx.src.rpm

GPG verification:
  Our public key is available at <<http://wirex.com/security/GPG_KEY>>.
  *** NOTE *** This key is different from the one used in advisories
  IMNX-2001-70-020-01 and earlier.

Online version of all Immunix 6.2 updates and advisories:
  <http://immunix.org/ImmunixOS/6.2/updates/>

Online version of all Immunix 7.0-beta updates and advisories:
  <http://immunix.org/ImmunixOS/7.0-beta/updates/>

Online version of all Immunix 7.0 updates and advisories:
  <http://immunix.org/ImmunixOS/7.0/updates/>

NOTE:
  Ibiblio is graciously mirroring our updates, so if the links above are
  slow, please try:
    ftp://ftp.ibiblio.org/pub/Linux/distributions/immunix/
  or one of the many mirrors available at:
    <http://www.ibiblio.org/pub/Linux/MIRRORS.html>

Contact information:
  To report vulnerabilities, please contact security@wirex.com. WireX
  attempts to conform to the RFP vulnerability disclosure protocol
  <<http://www.wiretrip.net/rfp/policy.html>>.

[[Attachment #3 (application/pgp-signature)]](?l=bugtraq&m=99258618906506&q=p3)

[[prev in list](?l=bugtraq&m=99258537004993&w=2)] [[next in list](?l=bugtraq&m=99262959706063&w=2)] [prev in thread] [[next in thread](?l=stackguard&m=99357995421841&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


