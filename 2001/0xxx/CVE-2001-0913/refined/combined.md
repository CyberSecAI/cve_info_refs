=== Content from marc.info_4a729a31_20250124_213834.html ===

```
[[prev in list](?l=bugtraq&m=100654667822594&w=2)] [[next in list](?l=bugtraq&m=100654855928828&w=2)] [[prev in thread](?l=vuln-dev&m=100640001308792&w=2)] [[next in thread](?l=vuln-dev&m=100656759913567&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [[NetGuard Security] NSI Rwhoisd another Remote Format String Vulnerability](?t=100640027800003&r=1&w=2)
From:       [alert7 <alert7 () netguard ! com ! cn>](?a=100640030500001&r=1&w=2)
Date:       [2001-11-22 2:22:04](?l=bugtraq&r=1&w=2&b=200111)
[Download RAW [message](?l=bugtraq&m=100655265508104&q=mbox) or [body](?l=bugtraq&m=100655265508104&q=raw)]

	NSI Rwhoisd another Remote Format String Vulnerability

Release infomation
------------------

Release Date: 2001-11-22
Author:   By NetGuard Security Team
          alert7 (alert7@netguard.com.cn)
Homepage: <http://www.netguard.com.cn/>

Description
-----------

  Rwhoisd is a publicly available RWHOIS server daemon for Unix based
systems developed and maintained by Network Solutions Inc.

  Rwhoisd contains another remotely exploitable format string vulnerability.
It is possible to overwrite memory by syslog() if set use-syslog: YES.
$ normal default is YES

Attackers may be able to execute arbitrary code on affected hosts.

Version and Platform
--------------------

Network Solutions rwhoisd 1.5
Network Solutions rwhoisd 1.5.1a
Network Solutions rwhoisd 1.5.2
Network Solutions rwhoisd 1.5.3
Network Solutions rwhoisd 1.5.5
Network Solutions rwhoisd 1.5.6
Network Solutions rwhoisd 1.5.7.1
Network Solutions rwhoisd 1.5.7
Network Solutions rwhoisd 1.5.7-1
Network Solutions rwhoisd 1.5.7.2

Details
-------

log() function will call syslog(syslog_level,message) if set use-syslog: YES
in rwhoisd.conf file. Unfortunately,message is a user supplied format string.

demo
-----

[alert7@redhat62 ]# telnet 0 4321
Trying 0.0.0.0...
Connected to 0.
Escape character is '^]'.
%rwhois V-1.5:003fff:00 localhost.localdomain (by Network Solutions, Inc. V-1.5.7-1)
%p%p%p%p  <------input
%error 230 No Objects Found
Connection closed by foreign host.

[alert7@redhat62 ]# tail /var/log/messages
Nov 21 13:04:06 redhat62 rwhoisd[27697]: CLIENT:127.0.0.1: query: 0xbffff8b00xbffff7fc0x808def80x806be4c
Nov 21 13:04:06 redhat62 rwhoisd[27697]: CLIENT:127.0.0.1: query response: 0 hits

Prove-Of-Concept exploit
------------------------

wait for vendor fix it first ;)

Vendor information
------------------

Vendor was informed at 2001-11-21
Vendor Homepage: <http://www.rwhois.net/>

About Netguard
--------------

China Net Security Technology Corporation (CNTC) is a leading provider of comput
er network and information security services in China.

Copyright 2001 <http://www.netguard.com.cn>, All rights reserved.

[[prev in list](?l=bugtraq&m=100654667822594&w=2)] [[next in list](?l=bugtraq&m=100654855928828&w=2)] [[prev in thread](?l=vuln-dev&m=100640001308792&w=2)] [[next in thread](?l=vuln-dev&m=100656759913567&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


