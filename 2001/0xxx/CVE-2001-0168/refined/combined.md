=== Content from marc.info_3d5ca328_20250125_155134.html ===

```
[[prev in list](?l=vnc-list&m=98080298925504&w=2)] [[next in list](?l=vnc-list&m=98080762505444&w=2)] [[prev in thread](?l=bugtraq&m=98089504929227&w=2)] [[next in thread](?l=vnc-list&m=98086836109115&w=2)]
List:       [vnc-list](?l=vnc-list&r=1&w=2)
Subject:    [[CORE SDI ADVISORY] WinVNC server buffer overflow](?t=98080773200004&r=1&w=2)
From:       [Iván_Arce <iarce () core-sdi ! com>](?a=97483977300005&r=1&w=2)
Date:       [2001-01-29 22:18:43](?l=vnc-list&r=1&w=2&b=200101)
[Download RAW [message](?l=vnc-list&m=98080763005455&q=mbox) or [body](?l=vnc-list&m=98080763005455&q=raw)]

                               CORE SDI
                        <http://www.core-sdi.com>

 Vulnerability report for server overflow in ATT VNC for Windows

Date Published: 2001-01-29

Advisory ID: CORE-2001011502

Bugtraq ID: 2306

CVE CAN: None currently assigned.

Title; ATT VNC Windows Server Buffer Overflow

Class: Boundary Error Condition (Buffer Overflow)

Remotely Exploitable: yes

Locally Exploitable: yes

Release Mode: USER RELEASE

Vulnerability Description:

 As stated in the VNC home page ( <http://www.uk.research.att.com/vnc/> ):

 "VNC stands for Virtual Network Computing. It is, in essence, a
 remote display system which allows you to view a computing 'desktop'
 environment not only on the machine where it is running, but from anywhere
 on the Internet and from a wide variety of machine architectures"

 The ATT VNC server for windows ships with a remotely and locally
exploitable
 buffer overflow if it is configured with a certain debug level.

 By providing a specially crafted HTTP request an attacker has the ability
 to obtain access to the VNC server and execute arbitrary commands with
 the privileges of the user running the server.

Vulnerable Packages/Systems:

 VNC version 3.3.3r7 for Windows.

Solution/Vendor Information/Workaround:

  Contact vendor for an appropriate fix.

  In the meantime apply this patch while inside the vnc_winsrc/winvnc
  directory:

--- Log.cpp Mon Jan 15 18:17:46 2001
+++ Log.cpp Mon Jan 15 18:18:31 2001
@@ -130,7 +130,7 @@

  // - Write the log message
  TCHAR line[LINE_BUFFER_SIZE];
-    vsprintf(line, format, ap);
+    _vsnprintf(line, sizeof(line)-sizeof(TCHAR), format, ap);
  ReallyPrintLine(line);
 }

  This patch can also be downloaded from:
  ftp://ftp.core-sdi.com/pub/patches/VNC-serverBO.patch

Vendor notified on: 2001-01-15

Credits:

 This vulnerability was found by Emiliano Kargieman, Agustin Azubel
 and Maximiliano Caceres from Core SDI, <http://www.core-sdi.com>

 This advisory was drafted with the help of the SecurityFocus.com
 Vulnerability Help Team. For more information or assistance drafting
 advisories please mail vulnhelp@securityfocus.com.

 This and other CORE SDI security advisories are available at
 <http://www.core-sdi.com/english/publications.html>

Technical Description:

 Buffer overflows in WinVNC server:

 The following vulnerability depends on having the registry key 'DebugLevel'
 with a value greater than 0, and the ability to send the right shellcode.

 The VNC server listens on the network for incoming HTTP requests.
 In the file vncHTTPConnect.cpp, method vncHTTPConnectThread::DoHTTP,
 data read from the network is parsed using sscanf( x, "GET %s", s ) into a
 buffer with 1024 bytes of length.
 The request is logged issuing a call to Log::Print() with the following
 string: "vncHTTPConnect.cpp : " + s + " file requested\n".

 In turn, Log::Print() (in Log.h) calls the private method ReallyPrint()
 (in Log.cpp) which calls in turn vsprintf(3) with a local buffer of fixed
 length (1024 bytes). Since the length of the string might be as long as
 1024 + 38 = 1062 bytes, the saved return address in the stack can be
 overwritten, allowing the attacker to execute arbitrary code with the
 privileges of the account running the VNC server.

DISCLAIMER:

 The content of this advisory are copyright (c) 2000 CORE SDI Inc.
 and may be distributed freely provided that no fee is charged for this
 distribution and proper credit is given.

$Id: VNC-serverbo-advisory.txt,v 1.9 2001/01/29 21:26:45 iarce Exp $
---

"Understanding. A cerebral secretion that enables one having it to know
 a house from a horse by the roof on the house,
 Its nature and laws have been exhaustively expounded by Locke,
 who rode a house, and Kant, who lived in a horse." - Ambrose Bierce

==================[ CORE Seguridad de la Informacion S.A. ]=========
Ivan Arce
Presidente
PGP Fingerprint: C7A8 ED85 8D7B 9ADC 6836  B25D 207B E78E 2AD1 F65A
email   : iarce@core-sdi.com
<http://www.core-sdi.com>
Florida 141 2do cuerpo Piso 7
C1005AAC Buenos Aires, Argentina.
Tel/Fax : +(54-11) 4331-5402
=====================================================================
---------------------------------------------------------------------
To unsubscribe, send a message with the line: unsubscribe vnc-list
to majordomo@uk.research.att.com
See also: <http://www.uk.research.att.com/vnc/intouch.html>
---------------------------------------------------------------------

[[prev in list](?l=vnc-list&m=98080298925504&w=2)] [[next in list](?l=vnc-list&m=98080762505444&w=2)] [[prev in thread](?l=bugtraq&m=98089504929227&w=2)] [[next in thread](?l=vnc-list&m=98086836109115&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.kb.cert.org_281b6fff_20250125_155135.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#598581

## AT&T WinVNC server contains buffer overflow in Log.cpp

#### Vulnerability Note VU#598581

Original Release Date: 2001-06-28 | Last Revised: 2001-06-28

---

### Overview

A buffer overflow in the WinVNC server on Windows systems can allow an intruder to gain control of the VNC server and execute arbitrary code with the privileges of the user running the server.

### Description

| AT&T [WinVNC](http://www.uk.research.att.com/vnc/winvnc.html) is a free software package available from [AT&T Labs Cambridge](http://www.uk.research.att.com/) that allows users to interact with the desktop of a remote Windows host. By providing a specially crafted HTTP request to the VNC server, an attacker can overflow a buffer in Log.cpp, resulting in access to the VNC server and the ability to execute arbitrary code with the privileges of the user running the server. It is worth noting that the VNC server does not listen on 80/tcp by default. See the following url:  <http://www.uk.research.att.com/vnc/faq.html#q52> |
| --- |

### Impact

| Local and remote users can execute arbitrary code with the privileges of the user running the server. |
| --- |

### Solution

|  |
| --- |

| Apply this patch while inside the vnc\_winsrc/winvnc directory:  --- Log.cpp Mon Jan 15 18:17:46 2001+++ Log.cpp Mon Jan 15 18:18:31 2001@@ -130,7 +130,7 @@ // - Write the log message TCHAR line[LINE\_BUFFER\_SIZE];- vsprintf(line, format, ap);+ \_vsnprintf(line, sizeof(line)-sizeof(TCHAR), format, ap); ReallyPrintLine(line); } |
| --- |

### Vendor Information

598581
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23598581/) to view vendors.**
### [ATT](#IAFY-4XDQNG) Affected

Notified:  January 15, 2001  Updated: June 15, 2001

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

Please see <http://www.kb.cert.org/vuls/id/598581>

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.securityfocus.com/bid/2306>
* <http://www.uk.research.att.com/vnc/>
### Acknowledgements

Our thanks to CORE SDI for the information contained in their bulletin.

This document was written by Ian A. Finlay and is based on information obtained from a Core SDI Security Advisory.

### Other Information

| **CVE IDs:** | [CVE-2001-0168](http://web.nvd.nist.gov/vuln/detail/CVE-2001-0168) |
| --- | --- |
| **Severity Metric:** | 12.60 |
| **Date Public:** | 2001-01-29 |
| **Date First Published:** | 2001-06-28 |
| **Date Last Updated:** | 2001-06-28 15:57 UTC |
| **Document Revision:** | 32 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


