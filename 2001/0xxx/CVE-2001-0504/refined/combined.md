=== Content from docs.microsoft.com_b6e81028_20250125_062819.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2001/ms01-037.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 03/01/2023
* 5 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS01-037 - Critical

## Authentication Error in SMTP Service Could Allow Mail Relaying

Published: July 05, 2001 | Updated: June 13, 2003

**Version:** 1.1

**Originally posted:** July 05, 2001

**Updated:** June 13, 2003

#### Summary

**Who should read this bulletin:**

Customers using MicrosoftÂ® WindowsÂ® 2000.

**Impact of vulnerability:**

Mail relaying

**Recommendation:**

Customers who need SMTP services should apply the patch; all others should disable the SMTP service.

**Affected Software:**

* Microsoft Windows 2000

### General Information

## Technical details

**Technical description:**

An SMTP service installs by default as part of Windows 2000 server products, and can be selected for installation on Windows 2000 Professional. A vulnerability results because of a flaw in the authentication process used by the service. The vulnerability could allow an unauthorized user to successfully authenticate to the service using incorrect credentials. An attacker who exploited the vulnerability could gain user-level privileges on the SMTP service, thereby enabling the attacker to use the service but not to administer it. The most likely purpose in exploiting the vulnerability would be to perform mail relaying via the server.

**Mitigating factors:**

* Exchange servers -- even when run on Windows 2000 -- are not affected by this vulnerability.
* Best practices recommend disabling unneeded services. If the SMTP service has been disabled, the vulnerability could not be exploited.
* The vulnerability only affects stand-alone machines, not domain members.
* Proper firewalling could prevent Internet-based attacks by blocking port 25 on servers that do not specifically need to accept SMTP traffic.

**Vulnerability identifier:** [CAN-2001-0504](https://cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0504)

**Tested Versions:**

Microsoft tested Windows 2000, Windows NTÂ® 4.0, Exchange 5.5 and Exchange 2000 to assess whether they are affected by these vulnerabilities. Previous versions are no longer supported, and may or may not be affected by these vulnerabilities.

## Frequently asked questions

**What's the scope of the vulnerability?**

This vulnerability could enable an unauthorized user to conduct [mail relaying](https://technet.microsoft.com/security/bulletin/glossary) via a Windows 2000 server. This could enable an attacker to disguise the origination point of a mail, or co-opt a server's resources for mass mailings. The vulnerability is subject to several constraints:

* It would only affect servers running the native Windows 2000 mail service. Mail servers running Exchange, even on Windows 2000, would not be affected.
* Even a machine that has the native Windows 2000 mail service installed would only be affected if it were configured as a stand-alone machine rather than a member of a domain.
* Proper firewalling could be used to prevent Internet users from exploiting the vulnerability.

**What causes the vulnerability?**

The vulnerability results because of an authentication error in the SMTP service that installs as part of IIS. In the case where the server is a stand-alone machine rather than a domain member, it could be possible for an unauthorized user to authenticate to the machine and use it for mail relaying.

**What is SMTP?**

SMTP (Simple Mail Transfer Protocol) is an industry standard for delivery of mail via the Internet, defined in RFCs [2821](https://www.ietf.org/rfc/rfc2821.txt?number=2821) and [2822](https://www.ietf.org/rfc/rfc2822.txt?number=2822). The protocol defines the format of mail messages, the fields in them and their contents, and the handling procedures for mails.
An SMTP implementation is provided with Windows 2000, and it installs by default. Microsoft Exchange Server also includes an SMTP service, but the component that performs SMTP authentication is different from the base SMTP Service in Windows 2000 and is not affected by the vulnerability.

**What's wrong with the Windows 2000 SMTP service?**

By design, a user should have to authenticate to the server before being allowed to use the SMTP service. However, a flaw in the Windows 2000 version of the SMTP service could cause it to accept incorrect authentication information as though it were valid. This could enable an attacker to gain the ability to use the SMTP service without authorization.

**What would this enable the attacker to do?**

Let's start with what it would **not** enable an attacker to do. The vulnerability would only confer user-level privileges on the SMTP service to the attacker - it would not grant administrative privileges to the service, nor would it grant the attacker the ability to run programs or operating system commands.
The vulnerability would enable an attacker to levy mail requests as an authorized user. That is, it would enable the attacker to send or receive mail. The most likely use of this vulnerability would be in performing mail relaying.

**What's mail relaying?**

Mail relaying is a practice in which e-mail is routed to an intermediate mail server, which then delivers it to the recipient's mail server. Mail relaying is often a legitimate practice. For example, suppose a company with several servers has designated one of them as a mail gateway to the Internet. Any e-mail sent to the company would arrive at the gateway server, then be relayed to the appropriate server for delivery to the recipient.
However, malicious users also sometimes try to perform unauthorized mail relaying. For example, a spammer who has a low-end server and a slow network connection might use mail relaying in order to get someone else's higher-powered mail server and fast network connection to send spam on their behalf. Mail relaying also has been misused to disguise the point of origination for an email. For instance, there have been cases in which threatening e-mails were relayed in order to prevent the recipient from being able to trace where they came from.

**Are all Windows 2000 servers affected by the vulnerability?**

A Windows 2000 server would only be affected by it if the SMTP service is installed and running. This is the default configuration, but Microsoft always recommends reviewing the list of services and disabling any that aren't needed.

**If the SMTP service is installed and running, is the server automatically vulnerable?**

No. Even if the SMTP service is installed and running, it would only be susceptible to this vulnerability if it were not part of a domain - that is, if it were a stand-alone machine. Domain members are not affected by the vulnerability.

**How often are Windows 2000 servers configured as stand-alone machines?**

In general, most Windows 2000 servers are configured as domain members, and would therefore not be affected by the vulnerability. However, one category of machines is often configured in a stand-alone, rather than domain member, role -- web servers.
Best practices frequently recommend that web servers be configured as stand-alone machines, in order to minimize their utility to an attacker who managed to compromise one. As a result, it's quite possible that a particular Windows 2000 web server would be configured as a stand-alone machine. However, it's reasonable to assume that an administrator who followed best practices in deciding to configure a server as a stand-alone machine would also follow best practices and remove all unneeded services.

**Would a firewall protect an affected server?**

If a firewall were employed to block port 25, Internet-based users would be unable to reach the SMTP service, even if it was enabled, and would as a result be unable to exploit the vulnerability.

**Does the vulnerability affect the SMTP service in Windows NT 4.0?**

No. Only the SMTP service that ships with Windows 2000 is affected.

**Does the vulnerability affect the SMTP service in Exchange?**

Neither Exchange 5.5 nor Exchange 2000 are affected by the vulnerability.

* Exchange 5.5 installs its own components for providing SMTP services, and these are not affected by the vulnerability.
* Exchange 2000 uses the Windows 2000 SMTP Service, but replaces the component responsible for SMTP authentication with one that is is not vulnerable. In addition, Exchange 2000 servers must be members of a domain, but this vulnerability only affects standalone machines.

**What does the patch do?**

The patch eliminates the vulnerability by ensuring that the SMTP service properly authenticates users before allowing them to levy requests on it.

## Patch availability

**Download locations for this patch**

* Microsoft Windows 2000:

  [https://www.microsoft.com/download/details.aspx?FamilyId=1A88BACC-08A2-47DD-9D78-E406709B6624&displaylang;=en](https://www.microsoft.com/download/details.aspx?familyid=1a88bacc-08a2-47dd-9d78-e406709b6624&displaylang;=en)
* Windows 2000 Datacenter Server:

  Patches for Windows 2000 Datacenter Server are hardware-specific and available from the original equipment manufacturer.

#### Additional information about this patch

**Installation platforms:**

This patch can be installed on systems running Windows 2000 [Service Pack 1](https://www.microsoft.com/windows2000/downloads/servicepacks/sp1/default.mspx) or [Service Pack 2](https://www.microsoft.com/windows2000/downloads/servicepacks/sp2/default.mspx).

**Inclusion in future service packs:**

The fix for this issue will be included in Windows 2000 Service Pack 3.

**Reboot needed:** Yes

**Superseded patches:** None.

**Verifying patch installation:**

* To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine:

  HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP3\Q302755.
* To verify the individual files, use the date/time and version information provided in the following registry key:

  HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP3\Q302755\Filelist

**Caveats:**

None

**Localization:**

Localized versions of this patch are available from the download locations discussed in "Patch Availability".

**Obtaining other security patches:**

Patches for other security issues are available from the following locations:

* Security patches are available from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129), and can be most easily found by doing a keyword search for "security\_patch".
* Patches for consumer platforms are available from the [WindowsUpdate](https://windowsupdate.microsoft.com/) web site.

#### Other information:

**Acknowledgments**

Microsoft [thanks](https://technet.microsoft.com/security/bulletin/policy) Joao Gouveia for reporting this issue to us and working with us to protect customers.

**Support:**

* Microsoft Knowledge Base article Q302755 discusses this issue and will be available approximately 24 hours after the release of this bulletin. Knowledge Base articles can be found on the [Microsoft Online Support](https://support.microsoft.com/?scid=fh;en-us;kbhowto) web site.
* Technical support is available from [Microsoft Product Support Services](https://support.microsoft.com/directory/question.asp?sd=gn&fr;=0). There is no charge for support calls associated with security patches.

**Security Resources:** The [Microsoft TechNet Security](https://www.microsoft.com/technet/security/default.mspx) Web Site provides additional information about security in Microsoft products.

**Disclaimer:**

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

**Revisions:**

* V1.0 (July 05, 2001): Bulletin Created.
* V1.1 (June 13, 2003): Updated download links to Windows Update.

*Built at 2014-04-18T13:49:36Z-07:00*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from www.kb.cert.org_5ec081d6_20250125_062819.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#435963

## Microsoft Windows 2000 SMTP service fails to properly authenticate credentials of unauthorized user (MS01-037)

#### Vulnerability Note VU#435963

Original Release Date: 2001-08-18 | Last Revised: 2001-08-18

---

### Overview

A vulnerability exists in the SMTP service installed by default on Microsoft Windows 2000 Server (and optionally on Windows 2000 professional) that could allow an intruder to use the service to send mail.

### Description

| The Simple Mail Transfer Protocol (SMTP) is the standard protocol used to transport mail across the Internet. Microsoft Windows 2000 Server contains an SMTP server that requires authentication before users are permitted to send mail. A flaw in the way the server handles authentication could permit an intruder to use the service to send mail without providing genuine credentials.  For more information, see Microsoft security bulletin [MS01-037](http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/ms01-037.asp). It should be noted that even in the best of circumstances, SMTP is a very difficult to authenticate without end-to-end cryptographic solutions. Quoting from RFC 2821:   *SMTP mail is inherently insecure in that it is feasible for even fairly casual users to negotiate directly with receiving and relaying SMTP servers and create messages that will trick a naive recipient into believing that they came from somewhere else. Constructing such a message so that the "spoofed" behavior cannot be detected by an expert is somewhat more difficult, but not sufficiently so as to be a deterrent to someone who is determined and knowledgeable. Consequently, as knowledge of Internet mail increases, so does the knowledge that SMTP mail inherently cannot be authenticated, or integrity checks provided, at the transport level. Real mail security lies only in end-to-end methods involving the message bodies, such as those which use digital signatures...* |
| --- |

### Impact

| Intruders may be able to send mail through a vulnerable server in violation of local security policies. |
| --- |

### Solution

| The CERT/CC is currently unaware of a general purpose solution to this problem without strong digital signatures on all mail messages. To address the specific problem in the Microsoft SMTP server, apply a patch as described in [MS01-037](http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/ms01-037.asp). |
| --- |

### Vendor Information

435963
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23435963/) to view vendors.**
### [Microsoft](#SVHN-4ZQ4QM) Affected

Updated:  August 17, 2001

### Status

Affected

### Vendor Statement

See <http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/ms01-037.asp>

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.microsoft.com/technet/security/bulletin/MS01-037.asp>
* <http://www.securityfocus.com/bid/2988>
* <http://www.ietf.org/rfc/rfc2821.txt?number=2821>
* <http://www.ietf.org/rfc/rfc2822.txt?number=2822>
### Acknowledgements

This document was written by Shawn V. Hernan.

### Other Information

| **CVE IDs:** | [CVE-2001-0504](http://web.nvd.nist.gov/vuln/detail/CVE-2001-0504) |
| --- | --- |
| **Severity Metric:** | 5.70 |
| **Date Public:** | 2001-07-05 |
| **Date First Published:** | 2001-08-18 |
| **Date Last Updated:** | 2001-08-18 03:00 UTC |
| **Document Revision:** | 5 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


