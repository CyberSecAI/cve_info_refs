- **Root cause of vulnerability:** A single-byte buffer overflow occurs in the `replydirname` function of `ftpd`.
- **Weaknesses/vulnerabilities present:** The code iterates through the input `name` string and copies it to a buffer `npath`. If a double quote `"` is encountered, another double quote is inserted. The loop condition `i < sizeof(npath) - 1` is intended to prevent overflows, but the increment of `i` inside the if statement allows `i` to reach `MAXPATHLEN`, causing a single byte overflow when the null terminator `\0` is written to `npath[i]`.
- **Impact of exploitation:**  Remote users with write access to at least one directory on the vulnerable system can exploit the buffer overflow, potentially gaining root access.
- **Attack vectors:** The attack vector is through a specially crafted input string to the `replydirname` function, sent via FTP commands.
- **Required attacker capabilities/position:** The attacker must be a remote user with write access to at least one directory on the vulnerable FTP server. The FTP server must also be explicitly enabled, as it's off by default in OpenBSD.