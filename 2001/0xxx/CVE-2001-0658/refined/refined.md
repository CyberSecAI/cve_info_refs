- **Root cause of vulnerability**: The vulnerability is due to the fact that the error page generated by ISA Server 2000 in response to a failed request for a web page is susceptible to cross-site scripting. Specifically, the error page includes the requested URL without checking for the presence of script commands.
- **Weaknesses/vulnerabilities present**: Cross-site scripting (XSS) vulnerability.
- **Impact of exploitation**:
    - An attacker could run arbitrary script in the security domain of a trusted web site. This could potentially allow the attacker to perform actions within the trusted site as if they were the legitimate user.
    - An attacker could read or modify cookies set by a trusted website. This could lead to session hijacking if session information is stored in the cookies.
- **Attack vectors**:
    - An attacker can include a link on their website to an unavailable page on a website that a user behind an ISA Server trusts. If the user visits the attacker's site, the bogus link can be triggered, exploiting the XSS vulnerability.
    - An attacker can include the malicious link in an HTML email, which would trigger the vulnerability when the recipient opens the email.
- **Required attacker capabilities/position**:
    - The attacker needs to be able to craft a URL that will cause the ISA server to generate an error page.
    - The attacker needs to be able to entice a user behind an ISA server to click or otherwise trigger the malicious URL.