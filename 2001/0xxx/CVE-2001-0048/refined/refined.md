- **Root cause of vulnerability**: When the "Configure Your Server" tool is used to promote a Windows 2000 server to the first domain controller in a forest, the Directory Service Restore Mode and Recovery Console passwords are left blank. This is because the tool doesn't prompt for these passwords and passes a null value to the underlying DCPROMO tool.
- **Weaknesses/vulnerabilities present**: The vulnerability lies in the blank passwords for Directory Service Restore Mode and Recovery Console, which are normally used for troubleshooting and recovery of domain controllers. The "Configure Your Server" tool fails to set these passwords, leaving them vulnerable to unauthorized access.
- **Impact of exploitation**: A malicious user with physical access to the domain controller can boot the machine into Directory Service Restore Mode or access the Recovery Console using the blank password. This allows them to gain administrative access, install malicious software, and potentially take full control of the domain, including creating/modifying user accounts, changing Active Directory information, and altering domain security policies.
- **Attack vectors**: The primary attack vector is physical access to the domain controller. The attacker needs to reboot the machine and choose either Directory Services Restore Mode or access the Recovery Console.
- **Required attacker capabilities/position**: The attacker requires physical access to the domain controller. They also need to be able to reboot the machine and select the Directory Service Restore Mode or access the Recovery Console through the Windows 2000 Setup CD. The vulnerability is limited to the first domain controller in a forest if it was promoted using the "Configure Your Server" tool.