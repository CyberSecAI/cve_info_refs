=== Content from www.openbsd.org_b2ea39cb_20250125_200400.html ===


OpenBSD: Errata and Patches

## [*Open***BSD**](index.html) Errata and Patches

---

For OpenBSD patch branch information, please refer
[here](stable.html).

For errata on a certain release, click below:

[2.0](errata20.html),
[2.1](errata21.html),
[2.2](errata22.html),
[2.3](errata23.html),
[2.4](errata24.html),
[2.5](errata25.html),
[2.6](errata26.html),
[2.7](errata27.html),
[2.8](errata28.html),
[2.9](errata29.html),
[3.0](errata30.html),
[3.1](errata31.html),
[3.2](errata32.html),
[3.3](errata33.html),
[3.4](errata34.html),
[3.5](errata35.html),

[3.6](errata36.html),
[3.7](errata37.html),
[3.8](errata38.html),
[3.9](errata39.html),
[4.0](errata40.html),
[4.1](errata41.html),
[4.2](errata42.html),
[4.3](errata43.html),
[4.4](errata44.html),
[4.5](errata45.html),
[4.6](errata46.html),
[4.7](errata47.html),
[4.8](errata48.html),
[4.9](errata49.html),
[5.0](errata50.html),
[5.1](errata51.html),

[5.2](errata52.html),
[5.3](errata53.html),
[5.4](errata54.html),
[5.5](errata55.html),
[5.6](errata56.html),
[5.7](errata57.html),
[5.8](errata58.html),
[5.9](errata59.html),
[6.0](errata60.html),
[6.1](errata61.html),
[6.2](errata62.html),
[6.3](errata63.html),
[6.4](errata64.html),
[6.5](errata65.html),
[6.6](errata66.html),
[6.7](errata67.html),

[6.8](errata68.html),
[6.9](errata69.html),
[7.0](errata70.html),
[7.1](errata71.html),
[7.2](errata72.html),
[7.3](errata73.html),
[7.4](errata74.html),
[7.5](errata75.html),
[7.6](errata76.html).



=== Content from www.kb.cert.org_22c466ac_20250125_200359.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#358960

## BSD i386\_set\_ldt syscall does not appropriately validate call gate targets

#### Vulnerability Note VU#358960

Original Release Date: 2001-02-16 | Last Revised: 2001-03-02

---

### Overview

There are a set of kernel interfaces called "call gates" which are code primitives used to build system-level calls into an operating system's kernel. A subset of these "calls gates" may be able to be manipulated on some operating systems which use improper privilege checking when accessing local descriptor tables (LDTs)

### Description

| Of specific concern is the syscall "i386\_set\_ldt" , which accesses a call gate without first validating whether a ring transition to a more privileged segment in the LDT is appropriate.  Of special note is an observation shared in the NetBSD security advisory on this issue:A common misunderstanding of how gate descriptors work may result inthe programmer believing they've defended against this attack (bychecking the gate's DPL) without having done so (you need to check theDPL of the code segment that the gate targets).Note that this behaviour is not restricted to Intel processors; the bugapplies to implementations of the x86 architecture by othermanufacturers as well.This programming defect is likely to affect other platforms as well. |
| --- |

### Impact

| A user with access to a local account may gain privileges reserved for the kernel. |
| --- |

### Solution

| Apply kernel patches provided by your vendor. |
| --- |

| The fix to NetBSD [for example]:  Index: i386/sys\_machdep.c===================================================================RCS file: /cvsroot/syssrc/sys/arch/i386/i386/sys\_machdep.c,vretrieving revision 1.54diff -u -r1.54 sys\_machdep.c--- i386/sys\_machdep.c\t2001/01/16 01:50:36\t1.54+++ i386/sys\_machdep.c\t2001/01/16 02:37:22@@ -222,6 +222,15 @@break;case SDT\_SYS286CGT:case SDT\_SYS386CGT:+/\*+ \* Only allow call gates targeting a segment in the LDT or+ \* a user segment in the fixed part of the gdt.+ \* Segments in the LDT are constrained (below) to be user segments.+ \*/+if (desc.gd.gd\_p != 0 && !ISLDT(desc.gd.gd\_selector) &&+    ((IDXSEL(desc.gd.gd\_selector) >= NGDT) ||+     (gdt[IDXSEL(desc.gd.gd\_selector)].sd.sd\_dpl != SEL\_UPL)))+return (EACCES);/\* Can't replace in use descriptor with gate. \*/if (n == fsslot || n == gsslot)return (EBUSY); |
| --- |

### Vendor Information

358960
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23358960/) to view vendors.**
### [NetBSD](#JSHA-4TZMTL) Affected

Notified:  January 16, 2001  Updated: February 16, 2001

### Status

Affected

### Vendor Statement

NetBSD is vulnerable on x86 platforms only. Please see NetBSD-SA2001-002, "Vulnerability in x86 USER\_LDT validation":

ftp://ftp.netbsd.org/pub/NetBSD/misc/security/advisories/NetBSD-SA2001-002.txt.asc

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [OpenBSD](#JSHA-4TZRSV) Affected

Notified:  January 19, 2001  Updated: March 02, 2001

### Status

Affected

### Vendor Statement

Please see OpenBSD 2.8 Errata 022: SECURITY FIX: Mar 2, 2001 at

<http://www.openbsd.com/errata.html#userldt>

The OpenBSD Project also released a security announcement on Mar 2 titled: "Vulnerability in USER\_LDT i386 kernel option"

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

Some excerpts from the OpenBSD advisory:

This USER\_LDT kernel option is not in the OpenBSD kernel by default, and is
only suggested for use by users running the WINE port. This option is not
documented elsewhere.

----------------------------------------------------------------------------

AFFECTED SYSTEMS

OpenBSD/i386 does not use or document the USER\_LDT option. Only users of
the WINE port are instructed to enable this option.

A patch for this option was commited to the source tree on January 19, 2001.

----------------------------------------------------------------------------

RESOLUTION

If you are using an OpenBSD kernel compiled with "option USER\_LDT", apply
the patch supplied at the bottom of this advisory and recompile your
kernel.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* ftp://ftp.netbsd.org/pub/NetBSD/misc/security/advisories/NetBSD-SA2001-002.txt.asc
* <http://www.openbsd.org/errata.html#userldt>
### Acknowledgements

This was initially reported by Bill Sommerfeld.

This document was written by Jeff S Havrilla

### Other Information

| **CVE IDs:** | [None](http://web.nvd.nist.gov/vuln/detail/None) |
| --- | --- |
| **Severity Metric:** | 7.13 |
| **Date Public:** | 2001-02-16 |
| **Date First Published:** | 2001-02-16 |
| **Date Last Updated:** | 2001-03-02 22:12 UTC |
| **Document Revision:** | 7 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


