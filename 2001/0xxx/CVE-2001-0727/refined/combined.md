=== Content from marc.info_a62c6594_20250125_171409.html ===

```
[[prev in list](?l=bugtraq&m=100834976403161&w=2)] [[next in list](?l=bugtraq&m=100837486611350&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=100837189103753&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [MSIE may download and run progams automatically](?t=100835221600001&r=1&w=2)
From:       [Jouko Pynnonen <jouko () solutions ! fi>](?a=97640797500002&r=1&w=2)
Date:       [2001-12-14 14:41:09](?l=bugtraq&r=1&w=2&b=200112)
[Download RAW [message](?l=bugtraq&m=100835204509262&q=mbox) or [body](?l=bugtraq&m=100835204509262&q=raw)]

This posting is a revision of the one sent to Bugtraq on 26 Nov 2001 with
the subject "File extensions spoofable in Microsoft IE download dialog"
and discusses some details and newly found impacts the vulnerability has.

OVERVIEW

Due to a flaw in the way Microsoft Internet Explorer handles certain HTTP
reply strings, a web site can spoof the name of a file being requested
and disguise it as a harmless file. As opposed to what I stated in the
previous posting, a variation of this exploit may cause the browser
to download and run a program file automatically without any user
interaction or decision. This may lead to system compromise when visiting
a malicious web site or opening an HTML mail message which directs the
user to such site. Opening an e-mail attachment or accepting a file
download is NOT required.

With some versions of IE, the origin web server of the file being
downloaded can also be hidden by using a variation of this exploit. In
this case it will show and empty string instead of the host name in the
download dialog.

Internet Explorer versions 6, 5.5, and 5.0 have been tested and found
vulnerable. The only version which hasn't automatically downloaded and
started an .exe program in our tests is is 5.5 with Service Pack 2. We
don't know whether it could be vulnerable to some other variation of the
exploit (different MIME types or other HTTP header contents maybe?). It
is however vulnerable to the "plain" file name spoofing attack.

VULNERABLE VERSIONS

IE            File ext     Bypassing      Hiding file
Version       spoofing     all dialogs    origin
----------------------------------------------------------
IE 6          yes          yes            no
IE 5.5 SP2    yes          no?            yes
IE 5.5        yes          yes            yes
IE 5.0        yes          yes

DETAILS

The problem is in the way Internet Explorer handles the Content-type and
Content-disposition HTTP headers of a web server reply. With certain
combinations of specially crafted reply strings, the browser can be made
first to start downloading the file without asking for confirmation from
the user, and then to open it - or in this case, run it.

The same method which can mislead the user in the "plain" file name spoof
variation of the attack can be used to mislead the browser's logics
resulting in automatical execution of the program.

WORKAROUNDS

If the patch for some reason couldn't be applied, disabling file
downloads from Tools -> Internet options -> Security -> Custom level ->
Downloads/File download seems to stop the exploit. No other known
workarounds exist at the moment, except from switching to another browser
such as Opera or Netscape, which don't seem to suffer from this problem.

VENDOR STATUS

Microsoft was initially contacted on November 19th with the information
regarding the "file extension spoofing" problem. The Security Warning
dialogs of IE5 could be bypassed with that exploit, but the "automatically
start an .exe" variation of the vulnerability wasn't known at the time.
Microsoft didn't consider the file extension spoofing problem a security
vulnerability. The company was informed about the new variation on
November 27th and started working on a patch to correct the flaw. The
patch is now out and downloadable on Microsoft's site at

<http://www.microsoft.com/technet/security/bulletin/MS01-058.asp>

--
Jouko Pynnonen          Online Solutions Ltd       Secure your Linux -
jouko@solutions.fi      <http://www.solutions.fi>    <http://www.secmod.com>

[[prev in list](?l=bugtraq&m=100834976403161&w=2)] [[next in list](?l=bugtraq&m=100837486611350&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=100837189103753&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.cert.org_8d333e5e_20250125_171414.html ===


search

icon-carat-right

cmu-wordmark

[Carnegie Mellon University](https://www.cmu.edu)

# [Software Engineering Institute](/)

##

1. [SEI](/)
2. [About](/about/)
3. [Divisions](/about/divisions/)
4. The CERT Division

## The CERT Division

The CERT Division is a leader in cybersecurity. We partner with government, industry, law enforcement, and academia to improve the security and resilience of computer systems and networks. We study problems that have widespread cybersecurity implications and develop advanced methods and tools to counter large-scale, sophisticated cyber threats.

* [Leadership](/about/divisions/cert/index.cfm#leadership)
* [What We Do](/about/divisions/cert/index.cfm#cert-division-what-we-do)
* [Careers in the CERT Division](/about/divisions/cert/index.cfm#careers)
* [Recent Vulnerabilities](/about/divisions/cert/index.cfm#CERTRecentlyPublishedVulnerabilityNotes)
* [Case Studies](/about/divisions/cert/index.cfm#case-studies)
* [History](/about/divisions/cert/index.cfm#history)

## Leadership

[![Gregory J. Touhill](/sei-images/images/Touhill_Greg_393_2023_2622.png)](/about/leadership/display.cfm?customel_datapageid_2623=314857)
#### [Gregory J. Touhill](/about/leadership/display.cfm?customel_datapageid_2623=314857)

Director, CERT Division

[![William Wilson](/sei-images/images/Wilson_William_324_200113_2622.png)](/about/leadership/display.cfm?customel_datapageid_2623=3871)
#### [William Wilson](/about/leadership/display.cfm?customel_datapageid_2623=3871)

Deputy Director, CERT Division

[![Chris Inacio](/sei-images/images/inacio-chris-96_2622.jpg)](/about/leadership/display.cfm?customel_datapageid_2623=494689)
#### [Chris Inacio](/about/leadership/display.cfm?customel_datapageid_2623=494689)

Chief Engineer, CERT Division

## What We Do

CERT experts are a diverse group of researchers, software engineers, security analysts, and digital intelligence specialists working together to research security vulnerabilities in software products, contribute to long-term changes in networked systems, and develop cutting-edge information and training to improve the practice of cybersecurity.

Our connection to the internationally known [Carnegie Mellon University](https://www.cmu.edu/) creates multidisciplinary collaboration opportunities and amplifies our research abilities.

#### Autonomy Security and Resilience

Develop and sustain security, resilience, and assurance best practices for the development, construction, and employment of machine learning systems.

#### [Cybersecurity Center Development](https://www.sei.cmu.edu/our-work/cybersecurity-center-development/index.cfm)

Develop measurable and repeatable practices to prepare CSIRTs and other operational security organizations.

#### [Cybersecurity Engineering](https://www.sei.cmu.edu/our-work/cybersecurity-engineering/index.cfm)

Develop methods for engineering mission-essential capabilities that balance security and resiliency with mission performance.

#### [Cyber Workforce Development](https://www.sei.cmu.edu/our-work/cyber-workforce-development/index.cfm)

Develop and maintain a well-equipped cyber workforce that is immediately able to support the cybersecurity needs of organizations.

#### [Enterprise Risk and Resilience Management](https://www.sei.cmu.edu/our-work/enterprise-risk-resilience-management/index.cfm)

Develop measurable practices and frameworks that enable organizations to measure and mitigate risks.

#### [Insider Threat](https://www.sei.cmu.edu/our-work/insider-threat/index.cfm)

Detect and mitigate the impact of insider threats and reduce their occurrence in organizations.

#### [Reverse Engineering for Malware Analysis](https://www.sei.cmu.edu/our-work/reverse-engineering-for-malware-analysis/index.cfm)

Develop tools and methods to identify and mitigate code that causes unintended effects in software systems.

#### [Situational Awareness](https://www.sei.cmu.edu/our-work/situational-awareness/index.cfm)

Analyze the cyber terrain as it evolves to characterize assets at risk, measure adversary activity, and prioritize responses to threat.

#### [Secure Development](https://www.sei.cmu.edu/our-work/secure-development/index.cfm)

Assess platforms through the analysis of source code to assure they adhere to security best practices.

#### [System and Platform Evaluation](https://www.sei.cmu.edu/our-work/projects/display.cfm?customel_datapageid_4050=21361)

Assess software, devices, systems, and platforms of unknown design or origin to find vulnerabilities and strategies for defending against possible attacks.

#### [Security Vulnerabilities](https://www.sei.cmu.edu/our-work/security-vulnerabilities/index.cfm)

Reduce exposure to known vulnerabilities in systems.

* ## Careers in the CERT Division

#### [Cyber Risk Intern](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Cyber-Risk-Intern_2022294-1)

Pittsburgh, PA

#### [Senior Software Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Software-Engineer_2020922-1)

Pittsburgh, PA

#### [Associate Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Associate-Research-Scientist---Quantum_2021979)

Pittsburgh, PA

#### [Documentation Specialist and Content Strategist](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Documentation-Specialist-and-Content-Strategist_2022203-1)

Pittsburgh, PA

#### [Senior Communications Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Communications-Engineer_2022179-1)

Pittsburgh, PA

#### [Senior AI Security Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-AI-Security-Researcher_2021569-1)

Pittsburgh, PA

#### [Technical Manager - Cybersecurity Assurance Team](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Technical-Manager---Cybersecurity-Assurance-Team_2022101-1)

2 Locations

#### [Software Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/System-Designer_2017276)

Pittsburgh, PA

#### [AI Security Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/AI-Security-Researcher_2020107)

Pittsburgh, PA

#### [Vulnerability Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Vulnerability-Researcher_2019726-1)

Pittsburgh, PA

#### [Senior Vulnerability Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Vulnerability-Researcher_2020002-1)

Pittsburgh, PA

#### [Assistant Communications Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Assistant-Communications-Engineer_2021848-2)

Pittsburgh, PA

#### [Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Research-Scientist---Quantum_2021633-1)

Pittsburgh, PA

#### [Senior Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Research-Scientist---Quantum_2021632)

Pittsburgh, PA

#### [Cybersecurity Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Cybersecurity-Engineer_2020646-1)

2 Locations

[SEE ALL SEI JOB OPENINGS](https://cmu.wd5.myworkdayjobs.com/en-US/SEI/)

## Recently Published Vulnerabilities

#### [VU#199397: Insecure Implementation of Tunneling Protocols (GRE/IPIP/4in6/6in4)](https://kb.cert.org/vuls/id/199397)

###### January 17, 2025

#### [VU#952657: Rsync contains six vulnerabilities](https://kb.cert.org/vuls/id/952657)

###### January 14, 2025

#### [VU#529659: Howyar Reloader UEFI bootloader vulnerable to unsigned software execution](https://kb.cert.org/vuls/id/529659)

###### January 14, 2025

[More Vulnerabilities](https://www.kb.cert.org/vuls)
[Report a Vulnerability](https://www.kb.cert.org/vuls/report/)

## Case Studies

[![Cyber Lightning Case Study](/sei-images/images/thumb_mid_thumb_cyber-lightning_380x380_1_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)
#### [Cyber Lightning Case Study](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)

The SEI hosted Cyber Lightning, a three-day joint training exercise involving Air National Guard and Air Force Reserve units from western Pennsylvania and eastern Ohio.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)

[![SEI Hosts Crisis Simulation Exercise for Cyber Intelligence Research Consortium](/sei-images/images/thumb_mid_thumb_crisis-simulation_380x380_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)
#### [SEI Hosts Crisis Simulation Exercise for Cyber Intelligence Research Consortium](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)

In SEI crisis simulation exercises, participants use scenarios that present fictitious malicious actors and environmental factors based on real-world events.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)

[![USPS Case Study](/sei-images/images/thumb_standard_thumb_usps-improves-its-cybersecurity-and-resilience_260x260_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)
#### [USPS Case Study](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)

The SEI teamed with the U.S. Postal Service to help it improve its cybersecurity and resilience and collaborated on a program to develop a strong cybersecurity workforce.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)

## History

The CERT Division is the birthplace of cybersecurity. For nearly 30 years, the CERT Division of the SEI has partnered with government, industry, law enforcement, and academia to advance cybersecurity and improve the security and resilience of computer systems and networks.

Originally focused on incident response, we have expanded into cybersecurity areas such as network situational awareness, malicious code analysis, secure coding, resilience management, insider threats, digital investigations and intelligence, workforce development, DevOps, forensics, software assurance, vulnerability discovery and analysis, and risk management.

     ![The CERT Division - Barbara Fraser and Ed DeHart](/sei-images/images/about-divisions-cert-history-aside-144-2_2134.jpg "The CERT Division - Barbara Fraser and Ed DeHart")   Barbara Fraser and Ed DeHart, part of the SEI’s CERT/CC in the early 1990s

## Former Director Richard Pethia

[Richard Pethia](/about/leadership/display.cfm?customel_datapageid_2623=3545) was founding director of the SEI's CERT Division. Pethia, who served as director of CERT from 1988 to 2016, guided the organization through tremendous growth and change. Under Pethia's leadership, the unit expanded and evolved from the CERT Coordination Center—a small group focused on computer incident response—to a research organization of more than 200 professionals dedicated to solving problems with widespread cybersecurity implications.

[SEE FULL PROFILE](/about/leadership/display.cfm?customel_datapageid_2623=3545)

     ![Former Director Richard Pethia](/sei-images/images/about-divisions-cert-pethia-aside-144-2_2159.jpg "Former Director Richard Pethia")

## Related Links

* [CERT Podcast Series](http://www.cert.org/podcasts/index.cfm)
* [CERT/CC Blog Series](http://insights.sei.cmu.edu/cert)
* [Computer Security Incident Response Teams](/education-outreach/computer-security-incident-response-teams/index.cfm)

* [FloCon](https://resources.sei.cmu.edu/news-events/events/flocon)
* [Insider Threat Blog Series](https://insights.sei.cmu.edu/insider-threat)
* [Insider Threat Symposium](https://www.eventbrite.com/e/2017-cert-insider-threat-symposium-registration-31893497309)

* [NatCSIRT Meeting](https://resources.sei.cmu.edu/news-events/events/natcsirt/index.cfm)
* [Vulnerability Database](https://www.kb.cert.org/vuls)

[Report a Vulnerability to CERT/CC](https://www.kb.cert.org/vuls/report/)
[Subscribe to SEI Bulletin](/subscribe-to-sei-bulletin/)
[Request Permission to Use SEI Materials](/legal/request-permission-to-use-sei-material)

Carnegie Mellon University
 Software Engineering Institute
 4500 Fifth Avenue
 Pittsburgh, PA 15213-2612
 412-268-5800

 [  [Facebook](https://www.facebook.com/SEICMU/)  |  [Twitter](https://twitter.com/SEI_CMU)  |  [LinkedIn](https://www.linkedin.com/company/software-engineering-institute)  |  [YouTube](https://www.youtube.com/user/TheSEICMU)  |  [iTunes](https://itunes.apple.com/us/podcast/software-engineering-institute-sei-podcast-series/id566573552?mt=2)  ]

[Contact Us](/contact-us/)

 [  [Office Locations](/locations/index.cfm)  |  [Additional Sites Directory](/additional-sites-directory/index.cfm)  |  [Legal](/legal/index.cfm)  |  [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm)  |  [CMU Ethics Hotline](https://www.cmu.edu/hr/resources/ethics-hotline.html)  |  [www.sei.cmu.edu](/index.cfm)  ]

©2025 Carnegie Mellon University



=== Content from docs.microsoft.com_7ffd78c7_20250125_171423.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2001/ms01-058.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 03/01/2023
* 5 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS01-058 - Critical

## 13 December 2001 Cumulative Patch for IE

Published: December 13, 2001 | Updated: May 09, 2003

**Version:** 1.3

**Originally posted:** December 13, 2001

**Updated:** May 09, 2003

#### Summary

**Who should read this bulletin:**

Customers using MicrosoftÂ® Internet Explorer.

**Impact of vulnerability:**

Run code of attacker's choice.

**Maximum Severity Rating:**

Critical

**Recommendation:**

Customers using IE should install the patch immediately.

**Affected Software:**

* Microsoft Internet Explorer 5.5
* Microsoft Internet Explorer 6.0

### General Information

## Technical details

**Technical description:**

This is a cumulative patch that, when installed, eliminates all previously discussed security vulnerabilities affecting IE 5.5 and IE 6. In addition, it eliminates three newly discovered vulnerabilities.

* The first vulnerability involves a flaw in the handling of the Content-Disposition and Content-Type header fields in an HTML stream. These fields, the hosting URL, and the hosted file data determine how a file is handled upon download in Internet Explorer. A security vulnerability exists because, if an attacker altered the HTML header information in a certain way, it could be possible to make IE believe that an executable file was actually a different type of file -- one that it is appropriate to simply open without asking the user for confirmation. This could enable the attacker to create a web page or HTML mail that, when opened, would automatically run an executable on the user's system. This vulnerability affects IE 6.0 only. It does not affect IE5.5 or 5.01.
* The second vulnerability is a newly discovered variant of the "Frame Domain Verification" vulnerability discussed in Microsoft Security Bulletin [MS01-015](https://technet.microsoft.com/security/bulletin/ms01-015). The vulnerability could enable a malicious web site operator to open two browser windows, one in the web site's domain and the other on the user's local file system, and to pass information from the latter to the former. This could enable the web site operator to read, but not change, any file on the user's local computer that could be opened in a browser window. This vulnerabilty affects both IE 5.5 and 6.0.
* The third vulnerability involves a flaw related to the display of file names in the File Download dialogue box. When a file download is initiated, a dialogue provides the name of the file. However, in some cases, it would be possible for an attacker to misrepresent the name of the file in the dialogue. This could be invoked from a web page or in an HTML email in an attempt to fool users into accepting unsafe file types from a trusted source. This vulnerabilty affects both IE 5.5 and 6.0.

**Mitigating factors:**

File Execution Vulnerability:

* The vulnerability could not be exploited if File Downloads have been disabled in the Security Zone from which the file is being received. In most attempts to maliciously exploit this vulnerability the file would be received from the Internet or Intranet zone. Therefore, disabling File Downloads in these zones can protect customers. This is not the default setting for either of these zone, however.
* This affects IE 6.0 only.

Frame Domain Verification Variant:

* The vulnerability could only be used to view files. It could not be used to create, delete, modify or execute them.
* The vulnerability would only allow an attacker to read files that can be opened in a browser window, such as image files, HTML files and text files. Other file file types, such as binary files, executable files, Word documents, and so forth, could not be read.
* The attacker would have to have knowledge of the exact file name and location in other to successfully read the file on the local system.

File Name Spoofing Vulnerability:

* The determination on choosing to accept a file download from an Internet site should always be based on the trustworthiness of the source and not on the file type. File downloads should never be accepted from an untrusted source, no matter how harmless the type may appear to be.

**Severity Rating:**

File Execution vulnerability:

|  | Internet Servers | Intranet Servers | Client Systems |
| --- | --- | --- | --- |
| **Internet Explorer 6.0** | Critical | Critical | Critical |

Frame Domain Verification Variant:

|  | Internet Servers | Intranet Servers | Client Systems |
| --- | --- | --- | --- |
| **Internet Explorer 5.5** | Moderate | Moderate | Moderate |
| **Internet Explorer 6.0** | Moderate | Moderate | Moderate |

File Name Spoofing Vulnerability:

|  | Internet Servers | Intranet Servers | Client Systems |
| --- | --- | --- | --- |
| **Internet Explorer 5.5** | Moderate | Moderate | Moderate |
| **Internet Explorer 6.0** | Moderate | Moderate | Moderate |

Aggregate severity of all vulnerabilities eliminated by patch:

|  | Internet Servers | Intranet Servers | Client Systems |
| --- | --- | --- | --- |
| **Internet Explorer 5.5** | Critical | Critical | Critical |
| **Internet Explorer 6.0** | Critical | Critical | Critical |

The above [assessment](https://technet.microsoft.com/security/bulletin/rating) is based on the types of systems affected by the vulnerability, their typical deployment patterns, and the effect that exploiting the vulnerability would have on them. For the File Execution vulnerability, the vulnerability by-passes the security control for making trust decisions regarding file downloadings. For the Frame Domain Verification variant, the file would have to be of a type that could be displayed in a browser window and the full path and file name would have to be known to the attacker. For the File Name Spoofing vulnerability, file downloads from the Internet should be trusted on the basis of their source and not the file type. Finally, this aggregate rating includes ratings for issues addressed from previous patches which are superceded by this patch.

**Vulnerability identifiers:**

* File Execution Vulnerability: [CAN-2001-0727](https://cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0727)
* Frame Domain Verification Variant: [CAN-2001-0874](https://cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0874)
* File Name Spoofing Vulnerability: [CAN-2001-0875](https://cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0875)

**Tested Versions:**

The following table indicates which of the currently supported versions of Internet Explorer are affected by the vulnerabilities. Versions of IE prior to 5.01 Service Pack 2 are no longer eligible for [hotfix](https://support.microsoft.com/directory/discontinue.asp) support. IE 5.01 SP2 is supported only via WindowsÂ® 2000 Service Packs and Security Roll-up Packages.

|  | IE 5.01 SP2 | IE 5.5 SP1 | IE 5.5 SP2 | IE 6.0 |
| --- | --- | --- | --- | --- |
| **File Execution Vulnerability:** | No | Yes | Yes | Yes |
| **Frame Domain Verification Variant:** | No | Yes | Yes | Yes |
| **File Name Spoofing Vulnerability:** | Yes | Yes | Yes | Yes |

## Frequently asked questions

**What vulnerabilities are eliminated by this patch?**

This patch, when installed, eliminates all known security vulnerabilities affecting Internet Explorer 5.5 and 6.0. In addition to eliminating all previously discussed vulnerabilities affecting these versions, it also eliminates three new ones:

* A vulnerability involving the handling of downloads that can lead to automatic code execution.
* A newly discovered variant of the the "Frame Domain Verification" vulnerability discussed in Microsoft Security Bulletin [MS01-015](https://technet.microsoft.com/security/bulletin/ms01-015).
* A vulnerability involving the display of file names in the File Download dialogue box.

**What's the scope of the first vulnerability?**

This vulnerability could enable an attacker to potentially run a program of her choice on the machine of another user. Such a program would be capable of taking any action that the user himself could take on his machine, including adding, changing or deleting data, communicating with web sites, or reformatting the hard drive.
In order for the attacker to successfully attack the user via this vulnerability, she would need to craft a specially formed web page and host the malicious executable on a site that is accessible to the victim, either on the Internet or on their local network. She would then have to force the user to view the web page. She could do this either by enticing the user to go to her site, or by sending the web page as an HTML email. When the web page on the site finished loading, the file could execute automatically. In the case of an HTML email, when the user opened the mail or viewed it in a preview pane, the file could execute automatically.

**What causes the vulnerability?**

The vulnerability results because it is possible to malform the HTML header information in a web page, in such a way as to misrepresent the filetype of a file that's referenced by the HTML page. If done properly, this could cause IE to handle the file inappropriately when opening the HTML page. In the worst case, a page could misrepresent an executable file as one that's safe to open without user confirmation, causing IE to automatically run an executable file when the HTML page was opened.

**What are HTML headers?**

HTML headers are fields within web pages that tell the browser how to handle certain aspects of the page. For instance, HTML headers may tell the browser how to render the page or interpret data on it. The vulnerability at issue here results because of a flaw in the way IE handles two HTML headers fields that tell it how to handle a non-HTML file referenced by a web page.

**What do you mean by "a non-HTML file referenced by a web page"?**

Web pages usually consist of HTML files - that is, files that contain commands that tell the browser what text to display and how to display it. However, in some cases, a web page may need to refer to a file that consists of other data. For instance, a web page might need to refer to a streaming media file, a text file, a program file, or some other type of data.
Early browsers were built to read and display only HTML; all other files would be downloaded to the local system and the user would then open those files using the appropriate application. However, to provide a richer browsing experience, browser capabilities have been extended so that they can handle non-HTML files directly. For instance, IE handles .DOC files by opening them directly in WordPad or Word, and handles streaming media files by starting the user's media player and playing the file.

**How does IE determine the appropriate way to handle a non-HTML file?**

Most modern browsers, including IE, use Multipurpose Internet Mail Extensions (MIME) information to handle non-HTML data. MIME types were first developed so that Internet mail clients could handle file attachments intelligently, but their use has been extended so that browsers too can use them to handle files intelligently.
When a web page instructs IE to download a non-HTML page, it provides the MIME type information via two HTML header fields, known as Content-Disposition and Content-Type. Once IE has determined the MIME type of the non-HTML file, it consults an internal table that tells it what the right way to handle the file is.

**What are the Content-Disposition and Content-Type header fields?**

The [Content-Disposition](https://www.ietf.org/rfc/rfc1806.txt?number=1806) and Content-Type header fields are used in conjunction to provide the MIME type information to the browser. The Content-Disposition field [alerts](https://support.microsoft.com/default.aspx?scid=kb;en-us;q260519) the browser that non-HTML data is coming. The Content-Type field then provides the MIME type information.

**So, is the problem that IE is handling certain MIME types incorrectly?**

No. IE handles files appropriate for their MIME types - the problem in this case is that it's possible to convince IE that a file is of a different MIME type than it really is, by altering the Content-Disposition and Content-Header fields. IE would then handle the file in the wrong way, potentially with dangerous results.

**What would this vulnerability enable an attacker to do?**

An attacker could use this vulnerability to make a program run when a user opened a web page. Specifically, the attacker could create a program and host it on a web site, then create a web page that would open the program. By altering the Content-Disposition and Content-Header fields in a certain way, the attacker could tell IE that the program was actually a different type of file - one that's safe to simply open.
The vulnerability could be exploited through either of two scenarios. The attacker could simply host the program and the web page on a web site, in order to attack anyone who visited the site. Alternatively, she could send the web page as an HTML mail; in this case, the program would be automatically executed when the recipient opened the mail.

**Why would an attacker be able to exploit this via HTML email?**

HTML mails are essentially web pages that are sent by mail. By creating a web page that exploits the vulnerability, and then sending it as an HTML mail, an attacker could mount essentially the same attack as discussed above via a web site. When the mail was opened, either by double-clicking the message or viewing it in a preview pane, the file would download and execute automatically.

**Would the user have any opportunity to prevent the program from running?**

He might. While the file was being downloaded, a dialogue would be displayed that would enable the user to cancel the download. If he cancelled the download before it was completed, the program could not run. However, how long the button would be available to halt the process would depend on the speed of the download and the size of the file.

**What kind of actions could the executable take if it ran?**

The executable would be able to take any action that the user himself could take on his system. The exact actions it could take would depend on the privileges of the user when they viewed the page and ran the attachment. If they were running in as an unprivileged user, it might be able to do very little. However, if the user were an administrator on his system, the attachment would be able to do virtually anything, including reformatting the hard drive.

**Could a web page and executable accidentally be created that would exploit this vulnerability?**

No. To create such a web page and executable, an attacker would need to craft the page and executable in a particular, purposeful way. This could not be done accidentally.

**You said that the attacker would have to "post a malicious executable on a server", what does that mean?**

For the attack to succeed, the malicious file would have to be downloaded to the user's computer. To accomplish this, the file would have to be placed in a location from which the user would be able to access it. If that server were unreachable for any reason, the attack would fail. This means, for example, that if a known server were hosting this malicious executable on the Internet, a company could protect its users by blocking access to that server. If a server on the local Intranet were hosting the executable, the threat would be eliminated if that server were removed from the network or made inaccessible through other means.

**So, for the attack to succeed, the attacker needs to be able to download their file to my computer?**

Correct. If the malicious executable cannot be downloaded for any reason, the attempted attack would fail. This offers an additional means of protecting against the attack.
If File Downloads are disabled in the Security Zone from which the malicious code was being received, the attack would fail. Since most attempts to exploit this vulnerability would originate from the Internet, which is governed by the Internet Zone, or the local network, which is governed by the Intranet Zone, disabling file downloads in these zones would help to protect vulnerable systems. However, this setting is not the default for either zone.

**What versions of IE are affected by this?**

IE 6.0 only is affected by this. IE 5.5 is not affected by this particular vulnerability.

**What does the patch do?**

The patch eliminates the vulnerability by instituting proper checking for incorrect Content-Disposition and Content-Type headers.

**What's the scope of the second vulnerability?**

The second vulnerability is a new variant of the "Frame Domain Verification" vulnerability originally discussed in Microsoft Security Bulletin [MS01-015](https://technet.microsoft.com/security/bulletin/ms01-015). The vulnerability could allow a malicious web site operator to view files on the computer of visiting user.
There a number of significant mitigating factors associated with this vulnerability:

* It could only be used to read file - not create, change, delete, or execute them.
* The attacker would need to know the name and location of the file on the user's computer
* Even if successfully exploited, the attacker could only view files that can be opened in a browser window, such as HTML files, image files, or text files.
* The vulnerability requires Active Scripting in order to succeed. If the malicious site were in a Security Zone that does not allow Active Scripting, the vulnerability could not be exploited.

**Where can I get more information on the "Frame Domain Verification" vulnerability?**

Microsoft Security Bulletins [MS00-033](https://technet.microsoft.com/security/bulletin/ms00-033), [MS00-055](https://technet.microsoft.com/security/bulletin/ms00-055), [MS00-093](https://technet.microsoft.com/security/bulletin/ms00-093), and [MS01-015](https://technet.microsoft.com/security/bulletin/ms01-015) discuss the vulnerability in detail.

**Are there any differences between the new variant and the previous variants?**

No. The scope of the new variant is exactly the same as for previous ones.

**Does this patch eliminate the original variants as well as the new one?**

Yes. It eliminates all known variants.

**What's the scope of the third vulnerability?**

The third vulnerability could enable an attacker to cause the wrong name to appear in a File Download dialogue box. An attacker could exploit this vulnerability in an attempt to fool a user into downloading an unsafe file.
The vulnerability would not provide any way for the attacker to override normal system behavior with respect to the download. That is, it would not provide a way for the attacker to force the user to accept the download - the user could simply cancel the operation via the dialogue box. Likewise, even if the user did choose to allow the download to proceed, the attacker would have no way to make the file open - the default action is to save, not run, the file.

**What causes the vulnerability?**

This vulnerability occurs because, when the IE File Download dialogue encounters certain special characters, it stops displaying the file name. By carefully selecting a file name and inserting such a character into it at the proper place, an attacker could cause IE to display a misleading name for the file - one that the user might choose to trust.

**What's wrong with the way the File Download dialogue handles file names?**

When a web page initiates a file download, IE displays a dialogue that shows the file name and asks the user whether to save the file, open it, or cancel the download. By design, IE should display the entire name. However, a vulnerability exists because IE will actually stop displaying the name upon reaching certain special characters.
This could enable an attacker to cause only a subset of the name to be displayed. For instance, suppose the attacker created a program named file.txt.exe. By inserting one of the special characters at issue here after the ".txt", the attacker could cause the file name to be shown in the dialogue as "file.txt", not "file.txt.exe".

**What could this enable an attacker to do?**

It could potentially enable an attacker to create a web page that, when displayed, would start a file download and display a misleading name for the file, in the hope of convincing the user that it was safe to download. The page could be hosted on a web server or sent to a user as an HTML mail.

**Where would the file be located?**

The file would need to be located on a server that the attacker controlled. If that server couldn't be reached for some reason, the attack would fail.

**Would the web page be able to automatically start such a download?**

Yes. By design, a web page can always initiate a file download. However, it's important to be specific about what that means. The user is still in control of whether the download will proceed or not. That is, as soon as the file download starts, the File Download dialogue is displayed, and the user has the opportunity to cancel the download. Nothing in the vulnerability enables the attacker to prevent the user from simply choosing "Cancel" at the download dialogue.

**If the user did choose to let the download proceed, what would happen?**

It would depend on the user's choice. The default choice in the File Download dialogue is to save the file to a location of the user's choosing on the system. If the user chose this option, the file would be stored on the system but would only run if the user later located the file and deliberately ran it. On the other hand, if the user chose the option to open it, the program would execute.

**If the attacker can't force the user to accept the download, and can't force the program to run, why is this a security vulnerability?**

In the web-borne scenario, this doesn't actually quality as a security vulnerability. IE always lets the user identify the web site that he or she is visiting, and users should always base trust decisions like this on the degree to which they trust the site. That is, trust should be based on the source of the file, not what's displayed in a dialogue.
However, the email-borne scenario is a different story, and is the reason why this qualifies as a security vulnerability. It's not possible to base trust on the source of an email. Not only is it simple to spoof an email address, many viruses cause infected systems to send copies of themselves to other users. That is, just because an email says it came from someone you trust, it doesn't mean that it actually did - and even if it did come from that person's email account, it doesn't necessarily mean that the person deliberately sent it.

**What does the patch do?**

The patch causes IE's File Download dialogue to correctly handle special characters within file names.

## Patch availability

**Download locations for this patch**

* Microsoft Internet Explorer 5.5 and 6.0:

  [https://www.microsoft.com/windows/ie/downloads/critical/Q313675/default.asp](https://www.microsoft.com/windows/ie/downloads/critical/q313675/default.asp)

#### Additional information about this patch

**Installation platforms:**

* The IE 5.5 patch can be installed on IE 5.5 [Service Pack 2](https://www.microsoft.com/windows/ie/ie6/previous/default.mspx).
* The IE 6 patch can be installed on IE 6 [Gold](https://www.microsoft.com/windows/ie/downloads/critical/ie6sp1/default.mspx).

**Inclusion in future service packs:**

The fix for these issue will be included in IE 5.5 Service Pack 3, and IE 6 Service Pack 1.

**Reboot needed:** Yes

**Superseded patches:** [MS01-055](https://technet.microsoft.com/security/bulletin/ms01-055).

**Verifying patch installation:**

* To verify that the patch has been installed on the machine, open IE, select Help, then select About Internet Explorer and confirm that Q313675 is listed in the Update Versions field.
* To verify the individual files, use the patch manifest provided in Knowledge Base articles Q313675.

**Caveats:**

None

**Localization:**

Localized versions of this patch are available at the locations discussed in "Patch Availability".

**Obtaining other security patches:**

Patches for other security issues are available from the following locations:

* Security patches are available from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129), and can be most easily found by doing a keyword search for "security\_patch".
* Patches for consumer platforms are available from the [WindowsUpdate](https://windowsupdate.microsoft.com/) web site.

#### Other information:

**Acknowledgments**

Microsoft [thanks](https://technet.microsoft.com/security/bulletin/policy) Jouko Pynnonen of [Oy Online Solutions Ltd](https://www.solutions.fi/) and Juan Carlos G. Cuartango of [Instituto Seguridad Internet](https://www.instisec.com/) and JesÃºs LÃ³pez de Aguileta ([aguileta@eunate.net](https://technet.microsoft.com/mailto%3Aaguileta%40eunate.net)) for reporting this issue to us and working with us to protect customers.

**Support:**

* Microsoft Knowledge Base article Q313675 discusses this issue and will be available approximately 24 hours after the release of this bulletin. Knowledge Base articles can be found on the [Microsoft Online Support](https://support.microsoft.com/?scid=fh;en-us;kbhowto) web site.
* Technical support is available from [Microsoft Product Support Services](https://support.microsoft.com/directory/question.asp?sd=gn&fr;=0). There is no charge for support calls associated with security patches.

**Security Resources:** The [Microsoft TechNet Security](https://www.microsoft.com/technet/security/default.mspx) Web Site provides additional information about security in Microsoft products.

**Disclaimer:**

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

**Revisions:**

* V1.0 (December 13, 2001): Bulletin Created.
* V1.1 (February 08, 2002): Updated with table containing vulnerability information for IE 5.01 SP2 on Windows 2000, IE 5.5 SP1, IE 5.5SP2, and IE 6.0.
* V1.2 (February 14, 2002): Updated Technical Details with vulnerability information for IE 5.01 SP2 on Windows 2000.
* V1.3 (May 09, 2003): Updated download links to Windows Update.

*Built at 2014-04-18T13:49:36Z-07:00*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from www.kb.cert.org_ea7ca840_20250125_171421.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#443699

## Microsoft Internet Explorer Does Not Respect Content-Disposition and Content-Type MIME Headers

#### Vulnerability Note VU#443699

Original Release Date: 2001-12-14 | Last Revised: 2002-06-07

---

### Overview

Microsoft Internet Explorer contains a vulnerability in its handling of certain MIME headers in web pages and HTML email messages. This vulnerability may allow an attacker to execute arbitrary code on the victim's system when the victim visits a web page or views an HTML email message.

### Description

| Web pages and HTML email messages usually contain HTML text, but other files may also be included. The MIME headers Content-Disposition and Content-Type provide the information needed by the HTML rendering software to determine the type of these files. In Microsoft Internet Explorer, these MIME headers are consulted when evaluating whether to process an embedded file, but they are ignored when the file is actually processed.  For example, if an executable (.exe) file is embedded with MIME headers that misrepresent it as a JPEG image file (.jpg), Internet Explorer will treat the file as a JPEG when evaluating whether it is safe to open. Once this evaluation is complete, the file will be opened according to its .exe file extension and will be executed on the local system. This behavior results in a vulnerability that allows attackers to bypass the security measures that typically screen out executable code. This code would be executed with the privileges the user who views the web page or email message. Users who view a malicious web site or HTML email message may be able to prevent the execution of the attacker's code by using the download progress dialog box to cancel the download. However, depending on the size of the embedded file and the speed of the network connection, users may not have time to cancel the file download. |
| --- |

### Impact

| By convincing a user to view a malicious web page or HTML email message, a remote attacker can cause the user to execute arbitrary code. Any such code would run with the privileges of the user who attempted to view the content. |
| --- |

### Solution

| **Apply a patch from your vendor**Microsoft has released a cumulative patch for Internet Explorer that corrects this vulnerability and several others. For more information about the patch and the vulnerabilities, please see Microsoft Security Bulletin MS01-058:<http://www.microsoft.com/technet/security/bulletin/MS01-058.asp> |
| --- |

| **Disable file downloads in untrusted security zones**  As a workaround, you can prevent malicious files from being downloaded by disabling all file downloads in untrusted security zones. Note that this decision will impact browser functionality. |
| --- |

### Vendor Information

443699
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23443699/) to view vendors.**
### [Microsoft Corporation](#CFCN-55ERWV) Affected

Updated:  December 20, 2001

### Status

Affected

### Vendor Statement

The following documents regarding this vulnerability are available from Microsoft:

<http://www.microsoft.com/technet/security/bulletin/MS01-058.asp>
<http://support.microsoft.com/default.aspx?scid=kb;EN-US;q313675>

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.microsoft.com/technet/security/bulletin/ms01-058.asp>
* <http://support.microsoft.com/default.aspx?scid=kb;EN-US;q313675>
* <http://www.securityfocus.com/bid/3578>
### Acknowledgements

Microsoft has publicly acknowledged Jouko Pynnonen of Oy Online Solutions Ltd as the reporter of this vulnerability.

This document was written by Cory F. Cohen and Jeffrey P. Lanza.

### Other Information

| **CVE IDs:** | [CVE-2001-0727](http://web.nvd.nist.gov/vuln/detail/CVE-2001-0727) |
| --- | --- |
| **CERT Advisory:** | [CA-2001-36](http://www.cert.org/advisories/CA-2001-36.html) |
| **Severity Metric:** | 50.63 |
| **Date Public:** | 2001-12-13 |
| **Date First Published:** | 2001-12-14 |
| **Date Last Updated:** | 2002-06-07 21:06 UTC |
| **Document Revision:** | 21 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from marc.info_d3c88ee1_20250125_171411.html ===

```
[[prev in list](?l=bugtraq&m=100860929404653&w=2)] [[next in list](?l=bugtraq&m=100861159511673&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=100849748116020&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Re: MSIE may download and run progams automatically - NOT SO FAST](?t=100849749300001&r=1&w=2)
From:       ["http-equiv () excite ! com" <http-equiv () excite ! com>](?a=95868532900003&r=1&w=2)
Date:       [2001-12-16 0:29:49](?l=bugtraq&r=1&w=2&b=200112)
[Download RAW [message](?l=bugtraq&m=100861273114437&q=mbox) or [body](?l=bugtraq&m=100861273114437&q=raw)]

Saturday, December 15, 2001

"Jouko Pynnonen" <jouko@solutions.fi> wrote in message

> VENDOR STATUS
>
> Microsoft was initially contacted on November 19th with the information
> regarding the "file extension spoofing" problem. The Security Warning
> dialogs of IE5 could be bypassed with that exploit, but the "automatically
> start an .exe" variation of the vulnerability wasn't known at the time.
> Microsoft didn't consider the file extension spoofing problem a security
> vulnerability. The company was informed about the new variation on
> November 27th and started working on a patch to correct the flaw. The
> patch is now out and downloadable on Microsoft's site at
>
> <http://www.microsoft.com/technet/security/bulletin/MS01-058.asp>

She and her beta team forgot about *the* most important Content-Type:

Clearly what this so-called "patch" does is convert all embedded file types
in MHTML documents viewed in patched Internet Explorer 6 into *.TMP files.
Previously all file types and file names were retained and if accepted would
run.

What that means is when prompted for 'opening or saving', [screen shot:
<http://www.malware.com/dumbload.jpg> 14KB], if your hand should slip or if
you do not know any better and select 'open', because the file extension is
*.TMP, you will be asked 'what do you want to open the file with' (screen
shot: <http://www.malware.com/sesame.jpg> 20KB) which does indeed kill any
accidental or running of the file.

Working example:

[open in IE6 "patched"]

<http://www.malware.com/badman.zip> 11KB

Before the patch and under an MTHML file situated on the web site and viewed
with Internet Explorer 6, you would be in a position to manipulate the file
extension and download box as displayed here:
[screen shot: <http://www.malware.com/ohno.jpg> 27KB]

Now with the so-called "patch", regardless of the filename="malware.exe" or
the Content-Type: image/gif; combination, everything is effectively
converted to a *.TMP file in the Temporary Internet File. Attempting to open
the *.TMP, depending on what it is will either bring up the 'what do you
want to open the file with' box, or display the file as plain text.

Dangerous files such as *.exe or *.scr or *.bat simply will not run if you
elect to run the file through the Internet Explorer 6 patched browser.
Sounds good.

Unfortunately, while she did a fairly reasonable job on this so-called
"patch" she forgot one of the most important content-types. Her very own
invention. The one and only:

Content-Type: application/hta;

We are still able to invoke a download, that if accepted will execute our
malware on the target computer, through the "patched" Internet Explorer 6.

This newly found creation of download file conversion through MHTML to
generic *.TMP file name on the download box coupled with the 'supposed'
security of this so-called "patch" will most definitely yield plenty of
quick prey:

Working Example:

[self explanatory includes harmless *.exe, open in IE6 "patched"]

<http://www.malware.com/dumbload.zip> 4KB

Notes:

1. We note that this patch has zero effect on Outlook Express 6 and the
ability to "spoof" file names [see: <http://www.securityfocus.com/bid/3271>].
Coming up 17 months and counting now.
2. Workhorse: Windows 98 and Internet Explorer 6.0.2600 and this so-called
"patch".
3. Seasons Greetings to Everyone. Yeah you too, incompetent slobs.

End Call

---
<http://www.malware.com>

______________________________________________________________________________
Send a friend your Buddy Card and stay in contact always with Excite Messenger
<http://messenger.excite.com>

[[prev in list](?l=bugtraq&m=100860929404653&w=2)] [[next in list](?l=bugtraq&m=100861159511673&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=100849748116020&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


