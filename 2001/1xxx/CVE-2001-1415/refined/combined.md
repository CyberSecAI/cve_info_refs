=== Content from www.kb.cert.org_6050b721_20250125_091827.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#191675

## /usr/libexec/vi.recover script contains vulnerability allowing arbitrary zero-length files to be removed

#### Vulnerability Note VU#191675

Original Release Date: 2002-09-16 | Last Revised: 2003-09-18

---

### Overview

The /usr/libexec/vi.recover script in OpenBSD has a vulnerability that could allow an attacker to remove arbitrary zero-length files, including device nodes.

### Description

| The /usr/libexec/vi.recover script in OpenBSD cleans up vi temp files and informs a user via email if a recovery file exists for an aborted vi session. The vi.recover script is reported to contain an unspecified vulnerability that may allow the removal of arbitrary zero-length files, including device nodes.  The vi.recover script in OpenBSD is a perl adaptation of a shell script from the nvi package, which is also reported to be vulnerable and may be present in other UNIX-based operating systems.This vulnerability is fixed in OpenBSD 3.1. |
| --- |

### Impact

| An attacker may be able to remove arbitrary zero-length files. This could allow a local attacker to cause a local denial of service by removing devices or files that enable services. |
| --- |

### Solution

| Obtain a patch for your system from one the following URLs.For OpenBSD-2.9:ftp://ftp.openbsd.org/pub/OpenBSD/patches/2.9/common/016\_recover.patchFor OpenBSD-3.0:ftp://ftp.openbsd.org/pub/OpenBSD/patches/3.0/common/007\_recover.patch |
| --- |

| Another alternative is to remove /usr/libexec/vi.recover. |
| --- |

### Vendor Information

191675
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23191675/) to view vendors.**
### [OpenBSD](#SVIM-55DJWU) Affected

Notified:  August 05, 2002  Updated: December 10, 2002

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Apple Computer Inc.](#SVIM-5CL2PE) Not Affected

Notified:  June 07, 2002  Updated: July 31, 2002

### Status

Not Affected

### Vendor Statement

Mac OS X does not ship with vi.recover.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Cray Inc.](#SVIM-5CL2DV) Not Affected

Notified:  June 07, 2002  Updated: July 31, 2002

### Status

Not Affected

### Vendor Statement

Cray, Inc. is not vulnerable as the vi that is released with Unicos, Unicos/mk, and the MTA is based on a different version and does not contain this vulnerability.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [FreeBSD](#SVIM-5CL2QD) Not Affected

Updated:  July 31, 2002

### Status

Not Affected

### Vendor Statement

FreeBSD does not have this vulnerability. Rather than removing files listed on the X-vi-recover-path: line, the owner of the recover file is simply notified via email.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Fujitsu](#SVIM-5CL2KD) Not Affected

Notified:  June 07, 2002  Updated: July 31, 2002

### Status

Not Affected

### Vendor Statement

Regarding the vi.recover vulnerability described in VU#191675, we have determined that the Fujitsu UXP/V operating system is not affected because the implementation of the vi.recover command in UXP/V is different from the one described in VU#191675.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [SGI](#SVIM-5CL2C5) Not Affected

Notified:  June 07, 2002  Updated: July 31, 2002

### Status

Not Affected

### Vendor Statement

IRIX is not vulnerable.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Sun Microsystems Inc.](#SVIM-5CL2MU) Not Affected

Notified:  June 07, 2002  Updated: July 31, 2002

### Status

Not Affected

### Vendor Statement

Solaris uses /usr/lib/expreserve and /usr/lib/exrecover for the related functions, both are binaries and not perl scripts and aren't believed to be affected by this issue.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* ftp://ftp.openbsd.org/pub/OpenBSD/patches/2.9/common/016\_recover.patch
* ftp://ftp.openbsd.org/pub/OpenBSD/patches/3.0/common/007\_recover.patch
### Acknowledgements

Thanks to Todd C. Miller for reporting this vulnerability.

This document was written by Shawn Van Ittersum.

### Other Information

| **CVE IDs:** | [None](http://web.nvd.nist.gov/vuln/detail/None) |
| --- | --- |
| **Severity Metric:** | 0.45 |
| **Date Public:** | 2001-01-15 |
| **Date First Published:** | 2002-09-16 |
| **Date Last Updated:** | 2003-09-18 20:02 UTC |
| **Document Revision:** | 14 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


