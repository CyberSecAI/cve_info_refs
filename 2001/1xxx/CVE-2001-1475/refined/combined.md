=== Content from www.kb.cert.org_5ddff4e9_20250125_232958.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#665372

## SSH connections using RC4 and password authentication can be replayed

#### Vulnerability Note VU#665372

Original Release Date: 2000-10-05 | Last Revised: 2002-03-05

---

### Overview

This vulnerability may allow an attacker to replay a captured SSH1 session.

### Description

| **Preconditions:**     + Client requests RC4 and the server grants request + Client uses password authentication  When an SSH1 session using the RC4 cipher is established, the client and server agree upon a session key (SK), which is generated using a server key (VK) that is renewed on a regular basis (one hour by default). The server uses the first 16 bytes of SK as an RC4 key (SK1) and the client uses the last 16 bytes (SK2). The server also generates a session ID (SID) that uniquely identifies the current session. During the session, the server XORs the SID with SK1 and uses the resulting key (SK1') to encrypt its traffic. However, the client does not perform this XOR operation, so it simply uses SK2 for encrypting traffic to the server.If the victim (client) has requested password authentication for this session, the attacker can record the victim's conversation and then replay it as long as the server key (VK) has not yet expired. Under default configurations, this presents the attacker with a one hour window in which to replay the conversation.The reason this vulnerability exists is twofold. First, the method used to generate the RC4 keys is faulty. Second, when password authentication is used, the server ignores session ID information, preventing it from detecting that the SID of the replayed connection does not match the SID that the server generated when the attacker began the conversation.It is important to note that there are significant preconditions and limitations present in this vulnerability. The preconditions are that the victim must request the use of both RC4 *and* password authentication, and the server must allow both. The limitation is that attackers cannot actually decrypt the original conversation; they can only replay what they've recorded. |
| --- |

### Impact

| Attackers can replay a client's session to the server within a limited window of time. |
| --- |

### Solution

| SSH suggests that customers upgrade to SSH2. |
| --- |

| If an upgrade is not possible, users should disable RC4 and password authentication. |
| --- |

### Vendor Information

665372
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23665372/) to view vendors.**
### [SSH Communications Security](#JPLA-4QQW4S) Affected

Updated:  February 06, 2001

### Status

Affected

### Vendor Statement

RC4 was disabled from SSH Corp.'s distribution in 1997.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [OpenSSH](#SVHN-4TQ4QY) Not Affected

Updated:  October 29, 2001

### Status

Not Affected

### Vendor Statement

See <http://www.openssh.com/security.html>.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

<http://www.ssh.com/products/ssh/cert/>

### Acknowledgements

The CERT/CC thanks Antti Huima, Tuomas Aura, and Janne Salmi for their analysis and Tatu Ylonen for bringing this vulnerability to our attention.

This document was written by Jeffrey P. Lanza.

### Other Information

| **CVE IDs:** | [None](http://web.nvd.nist.gov/vuln/detail/None) |
| --- | --- |
| **Severity Metric:** | 1.69 |
| **Date Public:** | 2001-01-18 |
| **Date First Published:** | 2000-10-05 |
| **Date Last Updated:** | 2002-03-05 20:22 UTC |
| **Document Revision:** | 10 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


