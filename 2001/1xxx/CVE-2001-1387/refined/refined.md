The content is related to CVE-2001-1387.

**Root cause of vulnerability:**
The `iptables-save` utility incorrectly saves rules containing `--reject-with icmp-host-prohibited`, converting them to `--reject-with tcp-reset`. This occurs even for rules that do not involve TCP.

**Weaknesses/vulnerabilities present:**
-   Incorrect rule saving: `iptables-save` misrepresents the intended behavior of the firewall rules when saving them.
-   Silent rule modification: The saved configuration does not match the original intended rules, and the change is not immediately apparent.
-   Potential for firewall bypass: If a rule was intended to use `icmp-host-prohibited` and it's saved as `tcp-reset` , the system may behave in an unintended way with regards to network traffic processing, potentially allowing connections that should have been rejected

**Impact of exploitation:**
-   Incorrect firewall behavior:  Rules are restored incorrectly, potentially leading to a less restrictive firewall than intended.
-   Security compromise: The wrong type of reject is used and can allow traffic through that should be blocked.
-   Firewall downtime: Misconfigured rules may lead to a non-operational firewall after a reboot if the configuration is automatically applied by an init script.
-   Silent failure: The failure might occur silently after a reboot with no warning.

**Attack vectors:**
-   Configuration file modification: An attacker could potentially modify the saved firewall rules (after they have been incorrectly converted by `iptables-save`) to further weaken the firewall or leave it open to attacks.
-   Unattended reboots: System restarts might expose the vulnerabilities of the incorrect rules after the iptables configuration file is reloaded.

**Required attacker capabilities/position:**
-   Local access to the system to execute `iptables` commands or modify configuration files.
-   Knowledge of how `iptables` and the `iptables-save` utility function.