=== Content from marc.info_2c09ea47_20250125_001616.html ===

```
[[prev in list](?l=bugtraq&m=105829982709190&w=2)] [[next in list](?l=bugtraq&m=105830053909950&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Internet Explorer Full-Screen mode threats
From:       ["Marek Bialoglowy" <mb () systemintegra ! com>](?a=105163116400008&r=1&w=2)
Date:       [2003-07-15 14:43:13](?l=bugtraq&r=1&w=2&b=200307)
[Download RAW [message](?l=bugtraq&m=105829174431769&q=mbox) or [body](?l=bugtraq&m=105829174431769&q=raw)]

Hello,

I was reading the "IE chromeless window vulnerabilities" thread and thought
maybe I could add some proof of concept to this discussion.

This very simple demo:

<http://www.systemintegra.com/ie-fullscreen/>

shows how system password could be captured thanks to Internet Explorer
working in full-screen mode.

Certainly it could be more advanced and designed to detect the platform to
show correct login window. It will work fine on the local network, however
it has to be optimised for the Internet use - everything has to appear
immediately and no download process can be visible.

Best Regards,

 Marek Bialoglowy (ultor@systemintegra.com) - IT Security Researcher
 PGPkey: <http://www.systemintegra.com/pgp/ultor.asc> | ID: 0x4B36656E
 JOB: (CTO) System Integra | JKT, Indonesia | Timezone: JAVT, GMT +7

[[prev in list](?l=bugtraq&m=105829982709190&w=2)] [[next in list](?l=bugtraq&m=105830053909950&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.doxdesk.com_36101e31_20250125_001617.html ===

# Chromeless windows

* [Check your bank balance at example-online-bank.com](https://www.example-online-bank.com/)
* [A site you'll really want to bookmark](bookmark.html)
* [Try new Active Security Plus](activex.html)



=== Content from www.kb.cert.org_1a484130_20250125_001619.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#490708

## Microsoft Internet Explorer window.createPopup() method creates chromeless windows

#### Vulnerability Note VU#490708

Original Release Date: 2004-09-10 | Last Revised: 2004-10-27

---

### Overview

The Internet Explorer (IE) window.createPopup() method creates chromeless popup windows. These windows can be used to spoof the user interface in Internet Explorer, any Windows application, or the Windows desktop.

### Description

| The visible area of a web browser window can be categorized into two areas: content and chrome. The content area is where the web browser renders HTML and other data. The chrome area surrounds the content area and includes the status bar, address bar, tool bar, and menu area. In most cases, the entire browser window (chrome and content) is enclosed with "window management decorations" - title, frame, and minimize, maximize, resize, and close controls.  The IE Dynamic HTML ([DHTML](http://msdn.microsoft.com/workshop/author/om/doc_object.asp)) model supports a proprietary method to create chromeless popup windows. This method, [window.createPopup()](http://msdn.microsoft.com/workshop/author/dhtml/reference/methods/createpopup.asp), creates browser windows with the following characteristics:A window created by window.CreatePopup() has the following characteristics:     + It contains no chrome + It has no window manager decoration + It appears on top of all other windows + It can be placed anywhere on the screen + It does not appear in the Windows taskbar + It cannot be focused + It is closed when the user clicks outside of the window  Chromeless windows can appear anywhere on the screen. Any part of the Windows graphical user interface (GUI) can be covered by chromeless windows, including the IE address bar, IE scroll bar, IE HTTPS padlock icon, Start menu, system tray, other Windows applications, or the entire visible screen. When a refresh loop is used, chromeless windows can remain visible even when the user clicks outside of the window. |
| --- |

### Impact

| By convincing the user to view an HTML document (e.g., web page, email message) an attacker can deceive the user by changing the appearance of the GUI. Because of their unique characteristics, chromeless windows can be used to facilitate phishing attacks. For example, an attacker can create a fake address bar and HTTPS padlock icon to spoof a secure website.More importantly, chromeless windows can be used in combination with other vulnerabilities to copy arbitrary files to the user's machine. IE treats arbitrary files as images with respect to drag and drop operations ([VU#526089](http://www.kb.cert.org/vuls/id/526089)), allows windows to be manipulated by mouse events ([VU#413886](http://www.kb.cert.org/vuls/id/413886)), and allows remote web sites to open windows or frames that interact with the local filesystem. By convincing the user to perform drag and drop actions such as clicking an image, selecting text, or dragging the scrollbar, an attacker can copy malicious code to the target machine. |
| --- |

### Solution

|  |
| --- |

| **Install Windows XP Service Pack 2 (SP2)**Microsoft [Windows XP SP2](http://www.us-cert.gov/cas/alerts/SA04-243A.html) significantly improves your computer's defenses against attacks and vulnerabilities. SP2 places [constraints](http://www.microsoft.com/technet/prodtechnol/winxppro/maintain/sp2brows.mspx#ECAA) on popup windows created by window.createPopup(), limiting the ability to spoof the IE and Windows GUI. The constraints are:     + A popup window must appear between the top and bottom of its parent window's chrome, so it does not overlap the Internet Explorer address bar, title bar, status bar, or toolbars. + Horizontally, a popup window must always overlap some area of its parent window. + A popup window must stay immediately on top of its parent, so it cannot be placed over other windows.  These enhancements prevent a large number of spoofing attacks with IE.**Disable Active scripting and ActiveX controls**Disabling Active scripting prevents attackers from creating chromeless windows using window.Createpopup(). Disabling ActiveX controls prevents IE from making images transparent, which is a component of publicly available exploit code. At a minimum, disable Active scripting and ActiveX controls in the Internet zone and the zone used by Outlook, Outlook Express, or any other software that uses the WebBrowser ActiveX control or the IE HTML rendering engine (MSHTML). Instructions for disabling Active scripting and ActiveX controls can be found in the [Malicious Web Scripts FAQ](http://www.cert.org/tech_tips/malicious_code_FAQ.html#ie56).**Apply the Outlook Email Security Update**Another way to effectively disable Active scripting and ActiveX controls in Outlook is to install the Outlook Email Security Update. The update configures Outlook to open email messages in the Restricted Sites Zone, where Active scripting and ActiveX controls are disabled by default. In addition, the update provides further protection against malicious code that attempts to propagate via Outlook. The Outlook Email Security Update is available for [Outlook 98](http://office.microsoft.com/downloads/9798/Out98sec.aspx) and [Outlook 2000](http://office.microsoft.com/downloads/2000/Out2ksec.aspx). The functionality of the Outlook Email Security Update is included in Outlook 2002 and Outlook Express 6.**Render email in plain text**Configure email client software (mail user agent [MUA]) to render email messages in plaint text. Instructions to configure Outlook 2002 and Outlook Express 6 are available in Microsoft Knowledge Base Articles [307594](http://support.microsoft.com/?kbid=307594) and [291387](http://support.microsoft.com/?kbid=291387), respectively. HTML-formatted email messages may not appear properly, however script will not be evaluated, thus preventing certain types of attacks.**Maintain updated antivirus software**[Antivirus software](http://www.cert.org/other_sources/viruses.html#VI) with updated virus definitions may identify and prevent some exploit attempts. Variations of exploits or attack vectors may not be detected. Do not rely on antivirus software to defend against this vulnerability.**Use a different web browser**There are a number of significant vulnerabilities in technologies relating to the IE domain/zone security model, the DHTML object model, MIME type determination, the graphical user interface (GUI), and ActiveX. It is possible to reduce exposure to these vulnerabilities by using a different web browser, especially when browsing untrusted sites. Such a decision may, however, reduce the functionality of sites that require IE-specific features such as DHTML, VBScript, and ActiveX. Note that using a different web browser will not remove IE from a Windows system, and other programs may invoke IE, the WebBrowser ActiveX control, or the HTML rendering engine (MSHTML). |
| --- |

### Vendor Information

490708
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23490708/) to view vendors.**
### [Microsoft Corporation](#AAMN-64PQEY) Affected

Notified:  September 09, 2004  Updated: September 10, 2004

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 0 | AV:--/AC:--/Au:--/C:--/I:--/A:-- |
| Temporal | 0 | E:Not Defined (ND)/RL:Not Defined (ND)/RC:Not Defined (ND) |
| Environmental | 0 | CDP:Not Defined (ND)/TD:Not Defined (ND)/CR:Not Defined (ND)/IR:Not Defined (ND)/AR:Not Defined (ND) |

### References

* [http://www.guninski.com/popspoof.html](http://www.guninski.com/popspoof.html%20)
* <http://www.doxdesk.com/personal/posts/bugtraq/20030713-ie/>
* <http://msdn.microsoft.com/workshop/author/om/doc_object.asp>
* <http://msdn.microsoft.com/workshop/author/dhtml/reference/methods/createpopup.asp>
* <http://xforce.iss.net/xforce/xfdb/7313>
* <http://secunia.com/advisories/12048/>
* <http://securitytracker.com/alerts/2003/Jul/1007190.html>
* <http://www.securityfocus.com/bid/8176>
### Acknowledgements

Thanks to Georgi Guninski and Andrew Clover for reporting this vulnerability.

This document was written by Will Dormann and Art Manion.

### Other Information

| **CVE IDs:** | [CVE-2001-1410](http://web.nvd.nist.gov/vuln/detail/CVE-2001-1410) |
| --- | --- |
| **Severity Metric:** | 31.92 |
| **Date Public:** | 2001-10-21 |
| **Date First Published:** | 2004-09-10 |
| **Date Last Updated:** | 2004-10-27 21:31 UTC |
| **Document Revision:** | 65 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from marc.info_c87f1438_20250125_001545.html ===

```
[[prev in list](?l=bugtraq&m=105820621412149&w=2)] [[next in list](?l=bugtraq&m=105820430209748&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=105820694713102&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [IE chromeless window vulnerabilities](?t=105820246700003&r=1&w=2)
From:       [Andrew Clover <and-bugtraq () doxdesk ! com>](?a=105820244700005&r=1&w=2)
Date:       [2003-07-13 19:20:21](?l=bugtraq&r=1&w=2&b=200307)
[Download RAW [message](?l=bugtraq&m=105820229407274&q=mbox) or [body](?l=bugtraq&m=105820229407274&q=raw)]

Title: IE chromeless window vulnerabilities
Affects: Internet Explorer 5.5 and later
Risk: Medium

Introduction
------------

A window without a frame, title bar, toolbars or scroll bars is known as
a 'chromeless' window. If a chromeless window can be opened on top of
other windows, it is possible to impersonate Windows user interface
elements.

Why is this a security problem? Because Windows and browser UI elements
are themselves part of security mechanisms. If the UI for security features
can be faked, users can be tricked into making inappropriate decisions.

The 'traditional' way of doing chromeless windows was to use the DHTML
method window.open to open a full-screen browser window (which is
chromeless) and then resize this to smaller dimensions. This capability
was removed in IE6 Service Pack 1, presumably due to exactly these
security concerns.

The problem
-----------

It is still possible to get chromeless windows by using the
window.createPopup method. A window opened with createPopup has some
unusual properties:

  - It is closed when one clicks on the outside the popup. This is easy
    to circumvent by simply re-spawning it on close.

  - It cannot be focused. (It is impossible to put controls like text
    input fields in it; this, at least, prevents us from overlaying
    fake login forms onto other websites.) Focus stays with the opener
    window.

  - It floats above other normal windows, allowing it to obscure them
    even whilst they are focused.

One popup may be created per window, allowing one to overlay an
arbitrary rectangle of screen display area with fake UI. More complicated
overlays can be achieved by having multiple windows opening popups at
once; a popup is itself a window so can be used to open further popups.

Exploitation
------------

There are three simple exploit demonstrations at:

  <http://www.doxdesk.com/personal/posts/bugtraq/20030713-ie/>

One fakes the address bar to seem to be another site; another tries to
trick the user into adding a bookmark to the favorites menu by hiding the
dialog box that has focus; another hides an ActiveX download prompt in
order to fool the user into allowing arbitrary code to be run. These
exploits are unpolished and could no doubt be made more convincing and
robust, but this demonstrates the risk.

Solution
--------

window.createPopup() should have the same chromeless window restrictions as
createModalDialog() and createModelessDialog().

Workaround
----------

Disable Active Scripting.

Vendor response
---------------

Microsoft were informed of the problem on 23rd January. After initially
encouraging e-mails, no action has been taken since.

I am posting this issue now as I have seen it being exploited in the
wild.

If you use IE, be extremely wary of trusting what appear to be its
built-in security controls.

--
Andrew Clover
mailto:and@doxdesk.com
<http://www.doxdesk.com/>
[[prev in list](?l=bugtraq&m=105820621412149&w=2)] [[next in list](?l=bugtraq&m=105820430209748&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=105820694713102&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.guninski.com_94d850ef_20250125_001618.html ===

## Javascript in IE may spoof the whole screen

| | cyrillic logo [Home](index.html) **Security** [Internet Explorer](browsers.html) [Windows 2000](win2k.html) [AIX](exploit.html) [Netscape](netscape.html) [Misc](misc.html) **Other** [Greets](greets.html) [About me](me.html) [In the news](menews.html) **Contact** guninski@guninski.com | Georgi Guninski security advisory #50, 2001 Javascript in IE may spoof the whole screen Systems affected: IE 5.5/6.0 on Windows, probably earlier versions Risk: very low (user interaction required) Date: 21 October 2001 Disclaimer: The information in this advisory is believed to be true based on experiments though it may be false. The opinions expressed in this advisory and program are my own and not of any company. The usual standard disclaimer applies, especially the fact that Georgi Guninski is not liable for any damages caused by direct or  indirect use of the information or functionality provided by this advisory or program. Georgi Guninski bears no responsibility for content or misuse of this advisory or program or any derivatives thereof.  Description: This is \*not\* security vulnerability by itself but has some security implications. It is possible a web page containing javascript to take over the whole screen - including menus, modal dialogs, taskbar, clock, etc. This allows "spoofing" the whole screen including modal IE messages. Basically this means that a script initiated IE dialog  "You are downloading malicous.exe from malicous.com - 'Open | Cancel |more info'" may be made to appear to the user: "Welcome to my new site - 'Open'" ('Cancel' is not visible and not clickable) If the user clicks on 'Open' in the spoofed context code may be executed (user interaction is required). Details: Spoofing the UI is done by window.createPopup() and popup.show() - ------------------- op=window.createPopup(); op.document.body.innerHTML="...html..."; op.show(0,0,screen.width,screen.height,document.body); ------------------- Demonstration: Image moving over download/open dialog: [http://www.guninski.com/opf2.html](opf2.html) BSOD emulation: [http://www.guninski.com/bsod1.html](bsod1.html) Workaround: If you consider this threat disable "active scripting" Vendor status: Microsoft was informed on 16 October 2001. Regards, Georgi Guninski http://www.guninski.com | | --- | --- | |
| --- | --- | --- |
|  |

| [Home](index.html) | [Internet Explorer](browsers.html)
| [Windows 2000](win2k.html) | [AIX](exploit.html)
| [Netscape](netscape.html) | [Greets](greets.html)
| [More...](index.html) |


