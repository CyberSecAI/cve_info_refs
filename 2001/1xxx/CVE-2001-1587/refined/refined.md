```
{
  "vulnerability_details": [
    {
      "cve_id": "CVE-2001-1587",
      "details": "The document describes multiple vulnerabilities and fixes related to the NetWare FTP Server (NWFTPD.NLM). Specifically, several buffer overflow issues are addressed where lengthy commands could cause stack corruption and server abends. Additionally, several other bugs related to security restrictions, path handling, and various functionality issues were also fixed.\n\n**Specific Vulnerabilities Addressed:**\n\n*   **Buffer Overflow (Bugzilla 641249 and 569496):** FTP clients could submit overly long commands that overflowed NWFTPD's command buffer. This led to stack corruption, abends of individual FTP session threads, and in some cases, system restarts.\n\n*   **Resource Unloading Issues (Bugzilla 524729):** During rapid cluster resource migrations, the NWFTPD unload process might not complete, leading to immediate unloading of the FTP server after resource migration to a new node.\n\n*  **Incorrect Path Handling (Bugzilla 294038 & 175491):** The 'pwd' command could return duplicate paths in specific scenarios involving NCP shares, NSS volumes or DOS namespaces.\n\n*   **Configuration File Parsing (Bugzilla 349388):**  Manual modification of the FTPSERV.CFG file by adding comments on the same line as a YES/NO parameter could cause an abend.\n\n*   **Restriction Enforcement (Bugzilla 272093 & 260459):** The 'NOREMOTE' restriction and partial matches of container names in the FTPREST.TXT file were not consistently enforced.\n\n*   **Large File Reporting (Bugzilla 227860):**  The FTP server had limitations in reporting large file sizes (over 2GB), with directory lists and the SIZE command not always providing accurate results.\n\n*   **Multiple FTP Server Abends (Bugzilla 174859):** When running multiple FTP server instances, unloading one could cause an abend.\n\n*   **MDTM Command Vulnerability (Bugzilla 139601):** An abend occurred when setting the time using the MDTM command with paths larger than the provided buffer.\n\n*  **TransmitFile API Logic (Bugzilla 150135):** The usage of the TransmitFile API was incorrectly determined based on user's home directory instead of the location of the FTP server.\n\n*  **Password Security (Bugzilla 133977):** A low risk security issue related to passwords was fixed.\n\n*  **FORCE\_PASSIVE\_ADDR Feature Issue (Bugzilla 130954):** When using more than one IP address the FORCE\_PASSIVE\_ADDR feature caused issues with subsequent passive connections.\n\n* **Redundant eDirectory Queries (Bugzilla 130120 & 129932):** When the IGNORE\_HOME\_DIR was set or when a user without a password logs in, redundant eDirectory queries were being made.\n\n*  **Not-Logged-in connections piling up (Bugzilla 97819):** Certain code paths left not-logged-in connections after sessions were completed.\n\n* **Invalid Lines in FTPREST.TXT (Bugzilla 94528):** There was no log message when there was an invalid line in address restrictions of the FTPREST.TXT file.\n\n*   **Log File Formatting (Bugzilla 85926):**  Log files did not consistently use the same delimiter, and added extra delimiters for missing fields.\n\n*   **SIZE command on non-existent files (Bugzilla 80554):** SIZE command was not responding when used against non-existent files.\n\n*   **MDTM command enhancement (Remedy RFE 29806):** The MDTM command was enhanced to allow setting of modified date and time and to function on directories.\n\n*  **ResumeThread API abend (DEFECT000382749):** There was an abend in the ResumeThread API due to an invalid thread handle.\n\n* **Double Page Fault abends (DEFECT000398218):** There were double page fault abends caused by running out of stack space.\n\n* **Trailing slash from PWD and CWD responses (DEFECT500370012):** Trailing slashes were removed from PWD and CWD responses at the root of a volume.\n\n* **File moving via rename (DEFECT000383564):** The ability to rename a file to a different path (effectively moving it) was restored.\n\n*   **Read-only file overwrite message (DEFECT500370012):** The error message for failing to overwrite a read-only file was changed.\n\n*  **Delays in closing DS connections (DEFECT500368598):** Delays in closing DS connections were holding FTP connections open longer than necessary.\n\n*   **Multiple slashes in path (DEFECT500368598):** The feature of accepting multiple slashes within a path was restored, treating them as a single slash.\n\n*  **PSEUDO\_PERMISSIONS parameter (DEFECT500368598):** The PSEUDO\_PERMISSIONS parameter was changed to PSEUDO\_SERVER\_FLAG to support multiple Unix-related options.\n\n* **Address range restrictions failure (DEFECT000374943):** Address range restrictions in FTPREST.TXT involving nested ranges were failing.\n\n*   **Data Connection Port (DEFECT500367363):** Data connections were initiated from port 20 instead of L-1 (control port minus 1).\n\n*   **KeepAlive option (DEFECT500272228):** KeepAlive option was only watching control connections and not data connections.\n\n*  **PWD Response with GUEST restriction (DEFECT000353990):** PWD response was leaving out the volume name if the GUEST restriction was in force.\n\n* **64 Bit Reads and Writes (NEW FEATURE):** NWFTPD senses whether it is running on NetWare 5.1 and avoids 64 bit reads and writes accordingly.\n\n* **System console hang during unload (DEFECT500350446):** System console could hang when unloading NWFTPD with 1000 active sessions.\n\n* **Buffer overflow in username or password (DEFECT000353973):** An abend could occur due to buffer overflow when pushing over 1024 characters into username or password.\n\n*   **Files larger than 4GB (NEW FEATURE):** FTP server now supports storage or retrieval of files larger than 4 GB.\n\n*   **Multiple sequential slashes (MODIFIED FEATURE):** Stopped accepting multiple slashes within paths.\n\n*   **DISABLE\_SITE\_CMDS (MODIFIED FEATURE):** Paramter DISABLE\_SITE\_CMDS was re-introduced.\n\n* **Extended characters in passwords (DEFECT000338587):** Added support for extended characters in passwords.\n\n*   **Login with relative name and trailing dot (DEFECT100309544):** FTP restrictions could fail if the login name was relative and had a trailing dot.\n\n* **Domain name login restrictions (DEFECT500287422):** Domain name login restrictions were not coming into effect.\n\n*  **SEARCH\_LIST usage (DEFECT000349126):** Use of SEARCH\_LIST could cause NWFTPD to locate a user object in an unintended context.\n\n* **FTP restrictions based on bindery context (DEFECT000349127):** FTP restrictions could fail depending on the bindery context setting.\n\n*  **Dynamic learning of FTP restrictions (DEFECT000349295):** There was a problem with dynamically learning of changes to the FTP restrictions file.\n\n*   **NWFTPD -A hang issue (DEFECT500289807):**  If an NWFTPD -A operation was not completed, an attempt to unload NWFTPD would hang the server console.\n\n*   **PWD response showing lower case directory names (DEFECT100275271):** PWD response now shows correct case of directory names, instead of all lower-case.\n\n*  **Increased contexts in SEARCH\_LIST (MODIFIED FEATURE):** Number of contexts allowed in SEARCH\_LIST was increased.\n\n*  **Case-sensitivity with volume names (DEFECT000336285):** Modified the LIST output for NetWare volume names to improve compatibility with some FTP clients.\n\n*   **Improved error message with long names (DEFECT500289544):** Improved error message when trying to PUT a file with a LONG name during an FTP session using DOS name space.\n\n*  **Config file creation (NEW FEATURE):** NWFTPD creates a new config file if one does not exist.\n\n*  **RFC 2228 Security Extensions support (NEW FEATURE):** Added support for FTP security extensions to allow encrypted FTP sessions using SSL.\n\n*  **Loophole in FTPREST.TXT (DEFECT500287708):** Fix to close a loophole in the enforcement of the restrictions in FTPREST.TXT file.\n\n*   **Loading with -c parameter (MODIFIED FEATURE):** If NWFTPD is loaded with -c to specify a certain configuration file and the file does not exist, NWFTPD will abort.\n\n*  **Multi-lined messages over FTP Control Connection (MODIFIED FEATURE):**  Format of multi-lined messages were changed to avoid FTP Sessions being improperly reset by CheckPoint firewalls.\n\n*  **Intruder Detection Loophole (DEFECT500287489):** Closed a loop-hole in intruder detection methods.\n\n*   **NWFTPD -A hangs and replica server issues (FIX):** Fix for various defects dealing with hangs or abends when running NWFTPD -A, when a replica server is not available.\n\n*   **Active data connections and multiple IP addresses (DEFECT000342408):** When one FTP Server was listening on multiple IP addresses, active data connections initiated from the FTP Server would come from the primary IP address rather than from the IP address of the particular FTP session. That has been corrected.\n\n*  **Dynamic changes to FTPREST.TXT (NEW FEATURE):** Changes to the FTP restrictions file now take effect dynamically.\n\n*   **LONG paths in FTPSERV.CFG file (MODIFIED FEATURE):** LONG path and filenames can now be used in the FTPSERV.CFG file.\n\n*  **FTP log file size control (MODIFIED FEATURE):** The size of the FTP log files is now controlled by size in Kbytes.\n\n*   **NLST command as LIST (MODIFIED FEATURE):** The FTP command NLST (ls) will now be treated as the FTP command LIST (dir) if one of the following parameters is used: -l, -al, -la.\n\n*  **Unloading individual FTP Server instances (NEW FEATURE):**  Individual FTP server instances can be unloaded with NWFTPD -U command.\n\n*  **Clear intruder lockouts without unloading (NEW FEATURE):** Existing intruder lockouts can be cleared without unloading NWFTPD.\n\n*   **Default DATA\_BUFF\_SIZE value change (MODIFIED FEATURE):** The default setting for DATA\_BUFF\_SIZE was changed from 32 to 64 (Kbytes).\n\n*   **Memory resource release (DEFECT500276455):**  Corrected a failure to release memory resources when NWFTPD is loaded and unloaded multiple times.\n\n*   **DEFAULT\_USER\_HOME issues (DEFECT000327201 & 000319984):** Setting DEFAULT\_USER\_HOME to a solitary slash would prevent other parameters from taking effect.\n\n*  **NWFTPD -? output improvement (MODIFIED FEATURE):** Improved the output of the console command NWFTPD -?.\n\n*   **New FTPSERV.CFG parameters (NEW FEATURE):** Various new FTPSERV.CFG parameters are introduced including PSEUDO\_PERMISSIONS, PSEUDO\_FILE\_PERMISSIONS, PSEUDO\_DIR\_PERMISSIONS, ANONYMOUS\_PASSWORD\_REQUIRED, DEFAULT\_FTP\_CONTEXT, KEEPALIVE\_TIME.\n\n*  **Optional format for dir command output (NEW FEATURE):** Support for a unix-style output of directory listing.\n\n*   **Anonymous password prompting (NEW FEATURE):** FTP Server can optionally prompt for the anonymous password even when anonymous access is disabled.\n\n* **Default directory context control (NEW FEATURE):** The DEFAULT\_FTP\_CONTEXT parameter can control the default directory context used by FTP Server.\n\n* **Dynamic FTPSERV.CFG configuration changes (NEW FEATURE):** Changes to the FTPSERV.CFG file will come into effect automatically instead of requiring NWFTPD.NLM to be unloaded and reloaded.\n\n*   **TCP Keep Alive Time config (MODIFIED FEATURE):**  The TCP Keep Alive Time is now configurable in FTPSERV.CFG.\n\n*   **NWFTPD -C parameter modification (MODIFIED FEATURE):** The -C parameter of NWFTPD was modified to accept optional volume and path syntax.\n\n* **NWFTPD -A prompts for FDN (MODIFIED FEATURE):**  When loading NWFTPD -A, the user is now prompted for the Fully Distinguished Name (FDN) of the admin user object.\n\n*   **BSD socket leaks (DEFECT500284033):** NWFTPD was leaking BSD sockets, especially when using passive data connections.\n\n*   **File deletion failure from root (DEFECT000325339):**  Deleting files from the root of a volume could fail and return an invalid error code.\n\n*   **Anonymous user rename failure (DEFECT000307961):** Guest or anonymous users were unable to rename files.\n\n*   **NFS Gateway volume access issue (DEFECT500276294):**  Anonymous users with a home directory on a NFS Gateway volume could receive too much access.\n\n*   **Improper path syntax error handling (DEFECT000310498):** Improved error handling for improper usage of path syntax.\n\n* **Missing \"total\" line from dir output (DEFECT000317490):** Restored the 'total' line in the 'dir' output at the root of the server.\n\n* **TCP connection closure (DEFECT500279626):** When receiving a QUIT command, FTP Server was doing a TCP RESET instead of a FIN/ACK process.\n\n*   **TCP bind error handling (DEFECT500282439):** If a TCP bind error occurs, NWFTPD will unload rather than stay loaded in a non-functional state.\n\n*  **Username abend fix (NWFTPD 5.03b):** Eliminated an abend which occurs when unusual character strings are included in a username.\n\n*  **ABOR command abend fix (NWFTPD 5.03b):** Eliminated an abend which could occur when an ABOR command is preceded by additional characters.\n\n*   **Page fault abend fix (NWFTPD 5.03b):** Eliminated a page fault abend involving stack overflows and invalid pointers.\n\n* **Directory output change (NWFTPD 5.03b):** Altered the directory output (from the 'dir' or 'LIST' command) to not include a beginning "total" line except when no filename or wildcard is specified.\n\n*  **Memory leak fix (NWFTPD 5.02y):** Eliminated a memory leak.\n\n*  **Deletion with wildcard fix (NWFTPD 5.02y):**  Enabled deletion with 'del' or'DELE' commands using wildcard file specs, on a legacy NetWare volume.\n\n*  **Guest restriction fix (NWFTPD 5.02y):** Corrected a failure to get directory listing for users with the GUEST restriction.\n\n*   **ls and dir output enhancement (NWFTPD 5.02y):** Enhanced ls (NLST) and dir (LIST) output to include directory paths.\n\n*  **Volume access restriction (NWFTPD 5.02y):** Disabled the ability of FTP users to read/write to volumes on servers where no user/connection license can be obtained.\n\n*   **High utilization problem (NWFTPD 5.02r):** Eliminated high-utilization problems that could occur when invalid commands were sent to the FTP server.\n\n*   **Page fault during load/unload (NWFTPD 5.02r):** Eliminated a Page Fault Processor Exception abend that could occur when NWFTPD.NLM was loaded and unloaded in rapid succession.\n\n*   **FTP message correction (NWFTPD 5.02r):** Several corrections to certain FTP messages / responses.\n\n*   **Not logged-in connection fix (NWFTPD 5.02r):** Corrected a failure to clear old not-logged-in connections.\n\n*   **Multi-processor abend fix (NWFTPD 5.02r):** Corrected a potential abend on multi-processor systems.\n\n*   **Intruder detection improvements (NWFTPD 5.02r):** Improvements to intruder detection.\n\n*  **Page fault after NW 5.1 SP4 fix (NWFTPD 5.02i):** Fixed a page fault abend which could occur after applying NW 5.1 SP4, due to a TCP.NLM issue under heavy FTP load. \n\n*   **File write error reporting correction (January 7th, 2002 build):** Corrected the error reporting that would occur when the FTP server could not write a file.\n\n*   **User object finding fix (January 7th, 2002 build):** Corrected a potential failure to find user objects underneath country or locality containers.\n\n*   **Rename operation message fix (January 7th, 2002 build):** Minor changes to the messages given during a rename operation.\n\n*   **FTPAUDIT.LOG file expansion (January 7th, 2002 build):** Expanded the logging of IP address & anonymous user in FTPAUDIT.LOG file, when anonymous login fails.\n\n*   **Intruder detection improvements (January 7th, 2002 build):** Minor improvements to user and host intruder detection.\n\n*  **FTP connection closure on unload fix (January 7th, 2002 build):**  Fix to ensure closure of FTP connections if NWFTPD.NLM is unloaded during FTP transfers.\n\n*  **User context setting fix (January 7th, 2002 build):** Fix to set the user's context correctly when the NetWare Server object's context is different than the server's first bindery context.\n\n*  **International message handling fix (January 7th, 2002 build):** Improvements to message handling for international environments (usage of non-default code pages).\n\n*  **Record Structure support (NWFTPD 5.02b):** Added support for Record Structure (implented the STRU R functionality).\n\n*  **ABOR command processing (NWFTPD 5.02b):** Altered the FTP command processor to accept various control sequences before the ABOR (abort) command.\n\n*  **DEFAULT\_USER\_HOME\_SERVER conflict fix (NWFTPD 5.02b):** Eliminated a conflict between the parameter DEFAULT\_USER\_HOME\_SERVER and the parameters IGNORE\_HOME\_DIR and IGNORE\_REMOTE\_HOME.\n\n* **GUEST access restriction fix (NWFTPD 5.02b):** Corrected a problem with GUEST access restrictions, which had been causing failures in FTP directory lists.\n\n*  **DIR command internationalization fix (NWFTPD 5.01y):** The prior FTP release had some internationalization improvements which inadvertently altered the format of the date / time information in a DIR (LIST) command.\n\n*  **Netscape Navigator URL failure fix (NWFTPD 5.01y):** Certain syntaxes of URLs used in Netscape Navigator were resulting in failure of the intial list of files available in an FTP session.\n\n*  **User restriction failure fix (NWFTPD 5.01y):** User-based restrictions in the SYS:ETC\\FTPREST.TXT file were failing under certain conditions.\n\n*   **Contextless login enhancement (NWFTPD 5.01w):** Enhancement to provide contextless login without the need for Catalog Services. SYS:ETC\\FTPSERV.CFG can now use the parameter: SEARCH\_LIST.\n\n*  **NFAP and NAS compatibility fix (NWFTPD 5.01w):** Adjustments for compatibility between FTP and other services in Native File Access Pack (NFAP) and Network Attached Storage (NAS).\n\n*   **SUNIQUE mode abend fix (NWFTPD 5.01w):** Solved an ABEND that could occur if the anonymous user used SUNIQUE mode to PUT a file (STOU, or Store Unique).\n\n*   **File rename fail fix (NWFTPD 5.01w):** When moving a file by renaming to a new path, if the file name contained the directory name, the rename would fail, which is corrected.\n\n*  **Container based restriction fix (NWFTPD 5.01w):** When defining container-based restrictions in the SYS:ETC/FTPREST.TXT file, if the container name contained a space character, the restriction would not come into effect.\n\n*  **SYS:ETC\\WELCOME.TXT file of 0 bytes fix (NWFTPD 5.01w):** A SYS:ETC\\WELCOME.TXT file of 0 (zero) bytes will no longer result in an blank line (Carriage-Return / Line Feed) being sent before the \"220 ready for new user\" message.\n\n*   **DEFAULT\_USER\_HOME\_SERVER parameter fix (NWFTPD 5.01w):** Users without a home directory specified in their NDS user object will be handled correctly by the DEFAULT\_USER\_HOME\_SERVER parameter.\n\n* **Disk space error fix (NWFTPD 5.01w):** When a user attempts to PUT a file to a location that is out of disk space, the message \"No space left on the device\" will be returned.\n\n* **Write access PUT fix (NWFTPD 5.01w):** More accurate error message is returned when a user without WRITE access attempts to PUT a file.\n\n* **Anonymous user access security weakness fix (NWFTPD 5.01o):** Eliminated two security weaknesses involving anonymous user access.\n\n*   **NLST command output fix (NWFTPD 5.01o):** Removed the line "total 0" from the output of a NLST (ls) command.\n\n*   **DEFAULT\_USER\_HOME\_SERVER and GUEST conflict fix (NWFTPD 5.01o):** Resolved a conflict between the DEFAULT\_USER\_HOME\_SERVER parameter and the GUEST restriction.\n\n*   **Host intruder lockout fix (NWFTPD 5.01o):** Host Intruder Lockout feature now counts login attempts even when the attempted username does not exist in NDS.\n\n* **Rename abend fix (NWFTPD 5.01o):** Eliminated possible abend while renaming.\n\n* **NDS home directory placement fix (NWFTPD 5.01i):** Some users were not being placed in their NDS-specified home directory upon logging in.\n\n*   **STOU command implementation (NWFTPD 5.01i):** STOU (Store Unique) command has been implemented.\n\n*   **STRU F command implementation (NWFTPD 5.01i):** STRU F (File Structure) command has been implemented.\n\n*  **MODE S command implementation (NWFTPD 5.01i):** MODE S (Stream Mode) command has been implemented.\n\n*  **Rename with servername fix (NWFTPD 5.01i):**  Renaming a file would fail if a servername was specified in the target name.\n\n*   **Dots in user or context name login fix (NWFTPD 5.01i):** Users who had dots (periods) in their names or context names could not log in through FTP.\n\n*  **quote help and quote site help responses fix (NWFTPD 5.01i):** Corrected the FTP Server responses to the user commands \"quote help\" and \"quote site help\".\n\n*  **Anonymous password verification fix (NWFTPD 5.01i):** If passwords are required for anonymous user login, NWFTPD now verifies that the password entered matches the pattern x@y.\n\n* **TCP connection clear fix (NWFTPD 5.01i):** TCP connections for FTP were not being cleared if an workstation with an FTP session running was powered off.\n\n*  **Log file size limit control (NWFTPD 5.01i):** NWFTPD previously would add a maximum of 32000 messages to each of it's log files before starting over. Now this limit can be controlled with the parameter NUM\_LOG\_MSG.\n\n* **Default FTP home directory on another server (NWFTPD 5.01i):** Enhanced NWFTPD to allow the default FTP home directory to reside on another server.\n\n",
      "vulnerability_impact": "The vulnerabilities could lead to various issues including:\n\n*   Denial of service (DoS) through crashes of FTP session threads or system restarts.\n*   Unauthorized access or manipulation of files due to bypassed security restrictions.\n*   Information disclosure through incorrect path handling or log file formatting.\n*   Inconsistent behavior or application failures due to improper input handling.\n*   Potential security breaches due to loopholes in security restrictions or intruder detection.\n",
      "attack_vectors": "Attack vectors primarily involve sending specially crafted FTP commands, exploiting configuration file parsing issues, or taking advantage of improper restriction enforcement. This can be done remotely if the FTP server is exposed to network access.",
      "attacker_capabilities": "An attacker would need to be able to connect to the FTP server and send FTP commands. This could involve either authenticated or anonymous connections depending on the specific vulnerability exploited. Some exploits may require an understanding of the internal workings of the NetWare FTP server and how to craft the malicious FTP commands to trigger a vulnerability.",
       "weaknesses": [
        "Buffer Overflow",
        "Improper Input Handling",
        "Insufficient Security Restriction",
        "Incorrect Path Handling",
        "Improper Error Handling",
        "Memory Leak",
        "Resource Exhaustion"
      ]
    }
  ]
}
```